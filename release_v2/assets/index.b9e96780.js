var wt=Object.defineProperty,yt=Object.defineProperties;var bt=Object.getOwnPropertyDescriptors;var Te=Object.getOwnPropertySymbols;var xt=Object.prototype.hasOwnProperty,Et=Object.prototype.propertyIsEnumerable;var Ae=(e,t,r)=>t in e?wt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$=(e,t)=>{for(var r in t||(t={}))xt.call(t,r)&&Ae(e,r,t[r]);if(Te)for(var r of Te(t))Et.call(t,r)&&Ae(e,r,t[r]);return e},ze=(e,t)=>yt(e,bt(t));var le=(e,t,r)=>new Promise((n,o)=>{var s=u=>{try{f(r.next(u))}catch(d){o(d)}},l=u=>{try{f(r.throw(u))}catch(d){o(d)}},f=u=>u.done?n(u.value):Promise.resolve(u.value).then(s,l);f((r=r.apply(e,t)).next())});import{r as c,u as ee,h as D,j as Le,k as ue,R as a,l as z,I as xe,H as Ee,P as St,n as De,o as W,p as Y,q as G,F as de,L as J,s as Mt,t as te,v as Ct,C as X,V as Se,x as He,y as Me,z as Ft,A as $e,D as Ne,E as re,G as fe,J as i,K as Ot,M as Ue,N as Ve,O as qe,Q as kt,U as Pt,W as _t,X as jt,Y as It,Z as Rt,_ as Bt,$ as Tt,a0 as At}from"./vendor.36e124e7.js";import{a as Ce,i as pe,b as ne,I as A,G as T,M as zt,B as Lt,c as Dt,d as Ht,F as $t,g as Nt,e as Ut,f as Vt,h as qt,j as Wt,k as Kt,l as We,m as Yt,n as Gt,o as Jt,p as Xt,q as Zt,r as Qt,s as er,D as tr,t as rr,u as nr,v as ar,w as or,O as sr,x as cr}from"./index.esm.875bdfba.js";import{u as ae}from"./usePath.dec5b771.js";import{_ as Ke}from"./index.2c144d5b.js";import{c as ir}from"./copy-clip.08e8f9de.js";const Ye=(...e)=>e.join("/").replace(/\/{2,}/g,"/");let Fe;const lr=Ce.CancelToken,ur=()=>{const{password:e,page:t}=c.exports.useContext(A);let{pathname:r}=ae(),n=r;return{path:()=>pe.post("path",{path:n,password:e,page_num:t.page_num,page_size:t.page_size},{cancelToken:new lr(function(s){Fe=s})}),cancelPath:()=>{Fe&&Fe()},mkdir:o=>{const s=Ye(n,o);return ne.post("mkdir",{path:s})},rename:(o,s)=>{const l=Ye(n,s);return ne.post("rename",{name:o,path:l})},move:(o,s)=>ne.post("move",{src_dir:n,dst_dir:s,names:o}),copy:(o,s)=>ne.post("copy",{src_dir:n,dst_dir:s,names:o}),refresh:()=>ne.post("refresh",{path:n})}};function dr(e){return T({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M352 115h90c3.3 0 6-2.7 6-6 0-8.2-3.7-16-10-21.3l-77.1-64.2c-4.9-4.1-14.2-7.4-20.6-7.4-4.1 0-7.4 3.3-7.4 7.4V96c.1 10.5 8.6 19 19.1 19z"}},{tag:"path",attr:{d:"M307 96V16H176c-17.6 0-32 14.4-32 32v336c0 17.6 14.4 32 32 32h240c17.6 0 32-14.4 32-32V141h-96c-24.8 0-45-20.2-45-45z"}},{tag:"path",attr:{d:"M116 412V80H96c-17.6 0-32 14.4-32 32v352c0 17.6 14.4 32 32 32h256c17.6 0 32-14.4 32-32v-20H148c-17.6 0-32-14.4-32-32z"}}]})(e)}function fr(e){return T({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M480 119c0-13.3-9.4-23-22.8-23H198.9c-2.8 0-4.3-.6-6.1-2.4l-22.5-22.5-.2-.2c-4.9-4.6-8.9-6.9-17.3-6.9H56.7C42.9 64 32 74.3 32 87v73.7c0 1.6 1.7 1.5 3 .7s5-1.4 7-1.4h428c2 0 5.7.6 7 1.4 1.3.8 3 .9 3-.7V119zM32 416.4c0 17.5 14.2 31.6 31.6 31.6H448c17.6 0 32-14.4 32-32V204c0-8.8-7.2-16-16-16H48c-8.8 0-16 7.2-16 16v212.4z"}}]})(e)}const pr=(e=!1)=>{const{type:t}=c.exports.useContext(A);let{pathname:r}=ae(),n="/";n==="/"&&(n=localStorage.getItem("API_SERVER"));let o=r.endsWith("/")?r.slice(0,-1):r;return t==="file"&&(o=o.substring(0,o.lastIndexOf("/"))),e?`${n}p${o}`:`${n}d${o}`},gr=e=>zt.hashStr(e),Ge=e=>gr(e).slice(8,24),mr=()=>{const{getSetting:e,password:t,loggedIn:r}=c.exports.useContext(A);return(n,o=!0)=>{const s=o?encodeURI(n):n;if(e("check down link")!=="true")return s;const l=n.split("/").pop(),f=localStorage.getItem("admin-token");if(r){const d=Ge(`alist-${f}-${l}`);return s+(o?encodeURI(`?sign=${d}`):`?sign=${d}`)}if(!t)return s;const u=Ge(`alist-${t}-${l}`);return s+(o?encodeURI(`?pw=${u}`):`?pw=${u}`)}},Oe=(e=!1,t=!0)=>{const r=pr(e),n=mr(),{files:o}=c.exports.useContext(A);return(s=void 0)=>{s||(s=o[0]);let l=r;return l.endsWith(s.name)||(l=`${l}/${s.name}`),n(l,t)}};function hr(e){return{all:e=e||new Map,on:function(t,r){var n=e.get(t);n?n.push(r):e.set(t,[r])},off:function(t,r){var n=e.get(t);n&&(r?n.splice(n.indexOf(r)>>>0,1):e.set(t,[]))},emit:function(t,r){var n=e.get(t);n&&n.slice().map(function(o){o(r)}),(n=e.get("*"))&&n.slice().map(function(o){o(t,r)})}}}const ke=hr();function Je(e){if(!e)return"-";const t=1024;return e<t?e+"B":e<Math.pow(t,2)?(e/t).toFixed(2)+"K":e<Math.pow(t,3)?(e/Math.pow(t,2)).toFixed(2)+"M":e<Math.pow(t,4)?(e/Math.pow(t,3)).toFixed(2)+"G":(e/Math.pow(t,4)).toFixed(2)+"T"}const Xe=(...e)=>e.join("/").replace(/\/{2,}/g,"/");let Ze=new Date().valueOf(),Qe=0;const vr=c.exports.forwardRef((e,t)=>{c.exports.useImperativeHandle(t,()=>({upload:()=>{l(0),document.querySelector("#upload-input").click()}}));const{password:r}=c.exports.useContext(A);let{pathname:n}=ae();const o=ee(),[s,l]=c.exports.useState(50),{t:f}=D(),{isOpen:u,onOpen:d,onClose:p}=Le(),m=ue("gray.100","gray.600"),[F,x]=c.exports.useState("Uploading");return a.createElement(z,null,a.createElement(xe,{display:"none",type:"file",multiple:!0,id:"upload-input",onChange:C=>{const E=C.target.files,B=E[0];if(!E||!B)return;d();const O=new FormData;for(let g=0;g<E.length;g++)O.append("files",E[g],E[g].name);O.append("path",n),O.append("password",r),pe.post("upload",O,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:g=>{if(g.lengthComputable){const k=g.loaded/g.total*100|0;console.log("complete",k),l(k);const R=new Date().valueOf(),b=(R-Ze)/1e3;if(b>1){const M=(g.loaded-Qe)/b,S=(g.total-g.loaded)/M;x(`${Je(M)}/s  (${f("about remaining")} ${Math.round(S)}${f("s")})`),Ze=R,Qe=g.loaded}k===100&&x("Back-end processing")}}}).then(g=>{p();const k=document.querySelector("#upload-input");k.value="";const R=g.data;o({title:f(R.message),status:R.code===200?"success":"error",duration:3e3,isClosable:!0}),ke.emit("refresh")})}}),a.createElement(z,{zIndex:99,w:{base:"80vw",md:"40vw"},position:"fixed",bottom:"20px",right:"20px",bgColor:m,rounded:"lg",p:4,display:u?"block":"none"},a.createElement(Ee,{mb:2,fontSize:20},f(F),"..."),a.createElement(St,{hasStripe:!0,isAnimated:!0,rounded:"lg",value:s})))});function Hn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"polygon",attr:{fill:"#546E7A",points:"38,33 38,5 34,5 34,33 28,33 36,43 44,33"}},{tag:"g",attr:{fill:"#2196F3"},child:[{tag:"path",attr:{d:"M16.8,17.2h-5.3l-1.1,3H6.9L12.6,5h2.9l5.7,15.2h-3.2L16.8,17.2z M12.2,14.5H16l-1.9-5.7L12.2,14.5z"}},{tag:"path",attr:{d:"M12.4,40.5H20V43H8.4v-1.9L16,30.3H8.4v-2.5h11.4v1.7L12.4,40.5z"}}]}]})(e)}function $n(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"circle",attr:{fill:"#00ACC1",cx:"24",cy:"24",r:"20"}},{tag:"circle",attr:{fill:"#eee",cx:"24",cy:"24",r:"16"}},{tag:"rect",attr:{x:"23",y:"11",width:"2",height:"13"}},{tag:"rect",attr:{x:"26.1",y:"22.7",transform:"matrix(-.707 .707 -.707 -.707 65.787 27.25)",width:"2.3",height:"9.2"}},{tag:"circle",attr:{cx:"24",cy:"24",r:"2"}},{tag:"circle",attr:{fill:"#00ACC1",cx:"24",cy:"24",r:"1"}}]})(e)}function Nn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#1565C0"},child:[{tag:"polygon",attr:{points:"24,37.1 13,24 35,24"}},{tag:"rect",attr:{x:"20",y:"4",width:"8",height:"4"}},{tag:"rect",attr:{x:"20",y:"10",width:"8",height:"4"}},{tag:"rect",attr:{x:"20",y:"16",width:"8",height:"11"}},{tag:"rect",attr:{x:"6",y:"40",width:"36",height:"4"}}]}]})(e)}function Un(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"circle",attr:{fill:"#B3E5FC",cx:"24",cy:"30",r:"15"}},{tag:"g",attr:{fill:"#1565C0"},child:[{tag:"polygon",attr:{points:"24,38.7 15,28 33,28"}},{tag:"rect",attr:{x:"21",y:"5",width:"6",height:"26"}}]}]})(e)}function Vn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#1976D2"},child:[{tag:"path",attr:{d:"M38,13h-3c-5.5,0-10,4.5-10,10s4.5,10,10,10h3c5.5,0,10-4.5,10-10S43.5,13,38,13z M38,29h-3 c-3.3,0-6-2.7-6-6s2.7-6,6-6h3c3.3,0,6,2.7,6,6S41.3,29,38,29z"}},{tag:"path",attr:{d:"M13,13h-3C4.5,13,0,17.5,0,23s4.5,10,10,10h3c5.5,0,10-4.5,10-10S18.5,13,13,13z M13,29h-3 c-3.3,0-6-2.7-6-6s2.7-6,6-6h3c3.3,0,6,2.7,6,6S16.3,29,13,29z"}}]},{tag:"path",attr:{fill:"#42A5F5",d:"M33,21H15c-1.1,0-2,0.9-2,2s0.9,2,2,2h18c1.1,0,2-0.9,2-2S34.1,21,33,21z"}}]})(e)}function qn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"polygon",attr:{fill:"#546E7A",points:"38,33 38,5 34,5 34,33 28,33 36,43 44,33"}},{tag:"g",attr:{fill:"#2196F3"},child:[{tag:"path",attr:{d:"M16.4,20h-3V8.6L9.9,9.7V7.3L16,5.1h0.3V20z"}},{tag:"path",attr:{d:"M19.4,43H9.2v-2l4.8-5.1c0.4-0.4,0.7-0.8,0.9-1.1c0.2-0.3,0.5-0.6,0.6-0.9c0.2-0.3,0.3-0.5,0.3-0.8 c0.1-0.2,0.1-0.5,0.1-0.7c0-0.7-0.2-1.2-0.5-1.6c-0.3-0.4-0.8-0.6-1.4-0.6c-0.3,0-0.7,0.1-0.9,0.2c-0.3,0.1-0.5,0.3-0.7,0.5 c-0.2,0.2-0.3,0.5-0.4,0.8s-0.1,0.6-0.1,1h-3c0-0.7,0.1-1.3,0.4-1.9c0.2-0.6,0.6-1.1,1-1.6c0.5-0.4,1-0.8,1.6-1.1 c0.6-0.3,1.4-0.4,2.2-0.4c0.8,0,1.5,0.1,2.1,0.3c0.6,0.2,1.1,0.5,1.5,0.8s0.7,0.8,0.9,1.3s0.3,1.1,0.3,1.8c0,0.5-0.1,1-0.2,1.4 S18.3,34.5,18,35s-0.6,0.9-1,1.4c-0.4,0.5-0.9,1-1.4,1.5L13,40.6h6.4V43z"}}]}]})(e)}function Wn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"circle",attr:{fill:"#4CAF50",cx:"24",cy:"24",r:"21"}},{tag:"g",attr:{fill:"#fff"},child:[{tag:"rect",attr:{x:"21",y:"14",width:"6",height:"20"}},{tag:"rect",attr:{x:"14",y:"21",width:"20",height:"6"}}]}]})(e)}function Kn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#1565C0"},child:[{tag:"path",attr:{d:"M13,13c0-3.3,2.7-6,6-6h10c3.3,0,6,2.7,6,6h4c0-5.5-4.5-10-10-10H19C13.5,3,9,7.5,9,13v11.2h4V13z"}},{tag:"polygon",attr:{points:"4.6,22 11,30.4 17.4,22"}}]},{tag:"g",attr:{fill:"#1565C0"},child:[{tag:"path",attr:{d:"M35,35c0,3.3-2.7,6-6,6H19c-3.3,0-6-2.7-6-6H9c0,5.5,4.5,10,10,10h10c5.5,0,10-4.5,10-10V23h-4V35z"}},{tag:"polygon",attr:{points:"30.6,26 37,17.6 43.4,26"}}]}]})(e)}function wr(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#616161"},child:[{tag:"rect",attr:{x:"34.6",y:"28.1",transform:"matrix(.707 -.707 .707 .707 -15.154 36.586)",width:"4",height:"17"}},{tag:"circle",attr:{cx:"20",cy:"20",r:"16"}}]},{tag:"rect",attr:{x:"36.2",y:"32.1",transform:"matrix(.707 -.707 .707 .707 -15.839 38.239)",fill:"#37474F",width:"4",height:"12.3"}},{tag:"circle",attr:{fill:"#64B5F6",cx:"20",cy:"20",r:"13"}},{tag:"path",attr:{fill:"#BBDEFB",d:"M26.9,14.2c-1.7-2-4.2-3.2-6.9-3.2s-5.2,1.2-6.9,3.2c-0.4,0.4-0.3,1.1,0.1,1.4c0.4,0.4,1.1,0.3,1.4-0.1 C16,13.9,17.9,13,20,13s4,0.9,5.4,2.5c0.2,0.2,0.5,0.4,0.8,0.4c0.2,0,0.5-0.1,0.6-0.2C27.2,15.3,27.2,14.6,26.9,14.2z"}}]})(e)}function Yn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#607D8B",d:"M44.7,11L36,19.6c0,0-2.6,0-5.2-2.6s-2.6-5.2-2.6-5.2l8.7-8.7c-4.9-1.2-10.8,0.4-14.4,4 c-5.4,5.4-0.6,12.3-2,13.7C12.9,28.7,5.1,34.7,4.9,35c-2.3,2.3-2.4,6-0.2,8.2c2.2,2.2,5.9,2.1,8.2-0.2c0.3-0.3,6.7-8.4,14.2-15.9 c1.4-1.4,8,3.7,13.6-1.8C44.2,21.7,45.9,15.9,44.7,11z M9.4,41.1c-1.4,0-2.5-1.1-2.5-2.5C6.9,37.1,8,36,9.4,36 c1.4,0,2.5,1.1,2.5,2.5C11.9,39.9,10.8,41.1,9.4,41.1z"}}]})(e)}function Gn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FF6F00",d:"M38.7,11.9l-3.1,2.5c2.2,2.7,3.4,6.1,3.4,9.5c0,8.3-6.7,15-15,15c-0.9,0-1.9-0.1-2.8-0.3l-0.7,3.9 c1.2,0.2,2.4,0.3,3.5,0.3c10.5,0,19-8.5,19-19C43,19.6,41.5,15.3,38.7,11.9z"}},{tag:"polygon",attr:{fill:"#FF6F02",points:"31,8 42.9,9.6 33.1,19.4"}},{tag:"path",attr:{fill:"#FF6F00",d:"M24,5C13.5,5,5,13.5,5,24c0,4.6,1.6,9,4.6,12.4l3-2.6C10.3,31.1,9,27.6,9,24c0-8.3,6.7-15,15-15 c0.9,0,1.9,0.1,2.8,0.3l0.7-3.9C26.4,5.1,25.2,5,24,5z"}},{tag:"polygon",attr:{fill:"#FF6F02",points:"17,40 5.1,38.4 14.9,28.6"}}]})(e)}function Jn(e){return T({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#3F51B5"},child:[{tag:"polygon",attr:{points:"17.8,18.1 10.4,25.4 6.2,21.3 4,23.5 10.4,29.9 20,20.3"}},{tag:"polygon",attr:{points:"17.8,5.1 10.4,12.4 6.2,8.3 4,10.5 10.4,16.9 20,7.3"}},{tag:"polygon",attr:{points:"17.8,31.1 10.4,38.4 6.2,34.3 4,36.5 10.4,42.9 20,33.3"}}]},{tag:"g",attr:{fill:"#90CAF9"},child:[{tag:"rect",attr:{x:"24",y:"22",width:"20",height:"4"}},{tag:"rect",attr:{x:"24",y:"9",width:"20",height:"4"}},{tag:"rect",attr:{x:"24",y:"35",width:"20",height:"4"}}]}]})(e)}const yr=e=>{const t=c.exports.useRef(null),{t:r}=D(),{getSetting:n}=c.exports.useContext(A),[o,s]=c.exports.useState(""),l=()=>{f.push(`?s=${o}`)},f=De();return c.exports.useEffect(()=>{var p;e.isSearch&&((p=t.current)==null||p.focus());const u=m=>{["k","K"].includes(m.key)&&m.ctrlKey&&(e.setIsSearch(!e.isSearch),m.preventDefault())};n("enable search")==="true"&&document.addEventListener("keydown",u);const d=m=>{e.setIsSearch(!1)};return document.addEventListener("click",d),()=>{document.removeEventListener("keydown",u),document.removeEventListener("click",d)}},[e.isSearch]),n("enable search")!=="true"?null:a.createElement(W,{spacing:2,onClick:u=>{u.stopPropagation()}},a.createElement(xe,{display:e.isSearch?"block":"none",value:o,onKeyUp:u=>{u.key==="Enter"&&l()},onChange:u=>{s(u.target.value)},ref:t}),a.createElement(Y,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:r("Search files")},a.createElement(G,{boxSize:7,cursor:"pointer",onClick:()=>{e.isSearch?l():e.setIsSearch(!0)},as:wr})))},br=()=>{const{t:e}=D(),t=Oe(),r=ee(),{show:n,setShow:o,type:s,getSetting:l,files:f,multiSelect:u,selectFiles:d,meta:p,loggedIn:m}=c.exports.useContext(A),F=l("logo"),x=ue(F.split(",").shift(),F.split(",").pop()),C=c.exports.useRef(null),[E,B]=c.exports.useState(!1);return a.createElement(de,{className:"header",px:"2",py:"2",justify:"space-between",w:"full"},a.createElement(J,{to:""+localStorage.getItem("DEPLOY_PATH"),className:"logo"},x.includes("http")?a.createElement(Mt,{fallback:a.createElement(te,{color:l("icon color")||"#1890ff"}),rounded:"lg",h:"44px",w:"auto",src:x}):a.createElement(Ee,null,x)),a.createElement(W,{className:"buttons",spacing:"2"},["folder","search"].includes(s)&&a.createElement(yr,{isSearch:E,setIsSearch:B}),!E&&a.createElement(Ct,{in:!E,offsetX:"20px",offsetY:0},a.createElement(W,{spacing:"2"},s==="file"&&a.createElement(Y,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:e("Download")},a.createElement(G,{cursor:"pointer",boxSize:6,as:Lt,onClick:()=>{if(s==="file"){let O=t();window.open(O,"_blank");return}}})),s==="folder"&&!l("no upload").split(",").includes(p.driver)&&(p.upload||m)&&a.createElement(z,null,a.createElement(Y,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:e("Upload file")},a.createElement(G,{cursor:"pointer",boxSize:6,as:Dt,onClick:()=>{C.current.upload()}})),a.createElement(vr,{ref:C})),s!=="error"&&a.createElement(Y,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:e("Copy direct link")},a.createElement(G,{cursor:"pointer",boxSize:6,as:dr,onClick:()=>{let O="";if(s==="file")O=t();else{let g=f;u&&(g=d),O=g.filter(k=>k.type!==1).map(k=>t(k)).join(`
`)}ir(O),r({title:e("Copied"),status:"success",duration:3e3,isClosable:!0})}})),a.createElement(Y,{shouldWrapChildren:!0,hasArrow:!0,placement:"bottom",label:e("switch to layout view",{layout:e(n==="list"?"grid":"list")})},a.createElement(G,{boxSize:6,cursor:"pointer",onClick:()=>{o(n==="list"?"grid":"list"),localStorage.setItem("show",n==="list"?"grid":"list")},as:n==="list"?Ht:$t}))))))},xr=()=>{const{t:e}=D(),{getSetting:t}=c.exports.useContext(A);return a.createElement(X,{py:"4",className:"footer"},a.createElement(Se,null,a.createElement(W,{spacing:"2",className:"line0"},a.createElement(He,{isExternal:!0,href:"https://github.com/Xhofe/alist"},e("Powered by {{project}}",{project:"Alist"})),a.createElement("span",null,"|"),a.createElement(J,{to:localStorage.getItem("DEPLOY_PATH")+"@manage/"},e("Manage"))),t("site beian")&&a.createElement(He,{className:"line1",isExternal:!0,href:"https://beian.miit.gov.cn/"},t("site beian"))))},Er=()=>{Me();const e=ae(),{t}=D();return a.createElement(Ft,{spacing:"1",className:"nav",w:"full",px:"2"},a.createElement($e,null,a.createElement(Ne,{_hover:{textDecoration:"none",bg:"rgba(132,133,141,0.18)"},p:"1",rounded:"lg",as:J,to:""+localStorage.getItem("DEPLOY_PATH")},Nt("home emoji"),t("Home"))),e.pathname.slice(1).split("/").map((r,n)=>{const o=n===e.pathname.split("/").length-2,s=e.pathname.split("/").slice(0,n+2).join("/");return a.createElement($e,{key:s,isCurrentPage:o},a.createElement(Ne,{isCurrentPage:o,wordBreak:"break-word",as:o?void 0:J,to:encodeURI(localStorage.getItem("DEPLOY_PATH")+s.slice(1)),_hover:{textDecoration:"none",bg:"rgba(132,133,141,0.18)"},p:"1",rounded:"lg"},r))}))},Sr=({msg:e})=>{const{t}=D();return a.createElement(z,{className:"error",textAlign:"center",py:10,px:6},a.createElement(Ee,{display:"inline-block",size:"xl"},t("ERROR")),a.createElement(re,{fontSize:"18px",my:3},t(e)),a.createElement(J,{to:""+localStorage.getItem("DEPLOY_PATH")},a.createElement(fe,{variant:"solid"},t("Back Home"))))};function Mr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function et(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function tt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?et(Object(r),!0).forEach(function(n){Mr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):et(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cr(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,s;for(s=0;s<n.length;s++)o=n[s],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Fr(e,t){if(e==null)return{};var r=Cr(e,t),n,o;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function Or(e,t){return kr(e)||Pr(e,t)||_r(e,t)||jr()}function kr(e){if(Array.isArray(e))return e}function Pr(e,t){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,o=!1,s=void 0;try{for(var l=e[Symbol.iterator](),f;!(n=(f=l.next()).done)&&(r.push(f.value),!(t&&r.length===t));n=!0);}catch(u){o=!0,s=u}finally{try{!n&&l.return!=null&&l.return()}finally{if(o)throw s}}return r}}function _r(e,t){if(!!e){if(typeof e=="string")return rt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rt(e,t)}}function rt(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jr(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function at(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nt(Object(r),!0).forEach(function(n){Ir(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(o,s){return s(o)},n)}}function oe(e){return function t(){for(var r=this,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return o.length>=e.length?e.apply(this,o):function(){for(var l=arguments.length,f=new Array(l),u=0;u<l;u++)f[u]=arguments[u];return t.apply(r,[].concat(o,f))}}}function ge(e){return{}.toString.call(e).includes("Object")}function Br(e){return!Object.keys(e).length}function se(e){return typeof e=="function"}function Tr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ar(e,t){return ge(t)||N("changeType"),Object.keys(t).some(function(r){return!Tr(e,r)})&&N("changeField"),t}function zr(e){se(e)||N("selectorType")}function Lr(e){se(e)||ge(e)||N("handlerType"),ge(e)&&Object.values(e).some(function(t){return!se(t)})&&N("handlersType")}function Dr(e){e||N("initialIsRequired"),ge(e)||N("initialType"),Br(e)&&N("initialContent")}function Hr(e,t){throw new Error(e[t]||e.default)}var $r={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},N=oe(Hr)($r),me={changes:Ar,selector:zr,handler:Lr,initial:Dr};function Nr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};me.initial(e),me.handler(t);var r={current:e},n=oe(qr)(r,t),o=oe(Vr)(r),s=oe(me.changes)(e),l=oe(Ur)(r);function f(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(p){return p};return me.selector(d),d(r.current)}function u(d){Rr(n,o,s,l)(d)}return[f,u]}function Ur(e,t){return se(t)?t(e.current):t}function Vr(e,t){return e.current=at(at({},e.current),t),t}function qr(e,t,r){return se(t)?t(e.current):Object.keys(r).forEach(function(n){var o;return(o=t[n])===null||o===void 0?void 0:o.call(t,e.current[n])}),r}var Wr={create:Nr},Kr={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.33.0/min/vs"}};function Yr(e){return function t(){for(var r=this,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return o.length>=e.length?e.apply(this,o):function(){for(var l=arguments.length,f=new Array(l),u=0;u<l;u++)f[u]=arguments[u];return t.apply(r,[].concat(o,f))}}}function Gr(e){return{}.toString.call(e).includes("Object")}function Jr(e){return e||st("configIsRequired"),Gr(e)||st("configType"),e.urls?(Xr(),{paths:{vs:e.urls.monacoBase}}):e}function Xr(){console.warn(ot.deprecation)}function Zr(e,t){throw new Error(e[t]||e.default)}var ot={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},st=Yr(Zr)(ot),Qr={config:Jr},en=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(o){return r.reduceRight(function(s,l){return l(s)},o)}};function ct(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],ct(e[r],t[r]))}),tt(tt({},e),t)}var tn={type:"cancelation",msg:"operation is manually canceled"};function Pe(e){var t=!1,r=new Promise(function(n,o){e.then(function(s){return t?o(tn):n(s)}),e.catch(o)});return r.cancel=function(){return t=!0},r}var rn=Wr.create({config:Kr,isInitialized:!1,resolve:null,reject:null,monaco:null}),it=Or(rn,2),ce=it[0],he=it[1];function nn(e){var t=Qr.config(e),r=t.monaco,n=Fr(t,["monaco"]);he(function(o){return{config:ct(o.config,n),monaco:r}})}function an(){var e=ce(function(t){var r=t.monaco,n=t.isInitialized,o=t.resolve;return{monaco:r,isInitialized:n,resolve:o}});if(!e.isInitialized){if(he({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),Pe(_e);if(window.monaco&&window.monaco.editor)return lt(window.monaco),e.resolve(window.monaco),Pe(_e);en(on,cn)(ln)}return Pe(_e)}function on(e){return document.body.appendChild(e)}function sn(e){var t=document.createElement("script");return e&&(t.src=e),t}function cn(e){var t=ce(function(n){var o=n.config,s=n.reject;return{config:o,reject:s}}),r=sn("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function ln(){var e=ce(function(r){var n=r.config,o=r.resolve,s=r.reject;return{config:n,resolve:o,reject:s}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){lt(r),e.resolve(r)},function(r){e.reject(r)})}function lt(e){ce().monaco||he({monaco:e})}function un(){return ce(function(e){var t=e.monaco;return t})}var _e=new Promise(function(e,t){return he({resolve:e,reject:t})}),ut={config:nn,init:an,__getMonacoInstance:un};function je(){return je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},je.apply(this,arguments)}const dn={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};function fn({content:e}){return a.createElement("div",{style:dn},e)}const Ie={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}};function dt({width:e,height:t,isEditorReady:r,loading:n,_ref:o,className:s,wrapperProps:l}){return a.createElement("section",je({style:ze($({},Ie.wrapper),{width:e,height:t})},l),!r&&a.createElement(fn,{content:n}),a.createElement("div",{ref:o,style:$($({},Ie.fullWidth),!r&&Ie.hide),className:s}))}dt.propTypes={width:i.oneOfType([i.number,i.string]).isRequired,height:i.oneOfType([i.number,i.string]).isRequired,loading:i.oneOfType([i.element,i.string]).isRequired,isEditorReady:i.bool.isRequired,className:i.string,wrapperProps:i.object};var ft=c.exports.memo(dt);function pt(e){c.exports.useEffect(e,[])}function L(e,t,r=!0){const n=c.exports.useRef(!0);c.exports.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}function ie(){}function ve(e,t,r,n){return pn(e,n)||gn(e,t,r,n)}function pn(e,t){return e.editor.getModel(gt(e,t))}function gn(e,t,r,n){return e.editor.createModel(t,r,n&&gt(e,n))}function gt(e,t){return e.Uri.parse(t)}function mn(e){return e===void 0}function mt({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:o,originalModelPath:s,modifiedModelPath:l,keepCurrentOriginalModel:f,keepCurrentModifiedModel:u,theme:d,loading:p,options:m,height:F,width:x,className:C,wrapperProps:E,beforeMount:B,onMount:O}){const[g,k]=c.exports.useState(!1),[R,b]=c.exports.useState(!0),P=c.exports.useRef(null),M=c.exports.useRef(null),U=c.exports.useRef(null),S=c.exports.useRef(O),v=c.exports.useRef(B);pt(()=>{const w=ut.init();return w.then(h=>(M.current=h)&&b(!1)).catch(h=>(h==null?void 0:h.type)!=="cancelation"&&console.error("Monaco initialization: error:",h)),()=>P.current?Z():w.cancel()}),L(()=>{const w=P.current.getModifiedEditor();w.getOption(M.current.editor.EditorOption.readOnly)?w.setValue(t):t!==w.getValue()&&(w.executeEdits("",[{range:w.getModel().getFullModelRange(),text:t,forceMoveMarkers:!0}]),w.pushUndoStop())},[t],g),L(()=>{P.current.getModel().original.setValue(e)},[e],g),L(()=>{const{original:w,modified:h}=P.current.getModel();M.current.editor.setModelLanguage(w,n||r),M.current.editor.setModelLanguage(h,o||r)},[r,n,o],g),L(()=>{M.current.editor.setTheme(d)},[d],g),L(()=>{P.current.updateOptions(m)},[m],g);const V=c.exports.useCallback(()=>{v.current(M.current);const w=ve(M.current,e,n||r,s),h=ve(M.current,t,o||r,l);P.current.setModel({original:w,modified:h})},[r,t,o,e,n,s,l]),H=c.exports.useCallback(()=>{P.current=M.current.editor.createDiffEditor(U.current,$({automaticLayout:!0},m)),V(),M.current.editor.setTheme(d),k(!0)},[m,d,V]);c.exports.useEffect(()=>{g&&S.current(P.current,M.current)},[g]),c.exports.useEffect(()=>{!R&&!g&&H()},[R,g,H]);function Z(){const w=P.current.getModel();if(!f){var h;(h=w.original)===null||h===void 0||h.dispose()}if(!u){var I;(I=w.modified)===null||I===void 0||I.dispose()}P.current.dispose()}return a.createElement(ft,{width:x,height:F,isEditorReady:g,loading:p,_ref:U,className:C,wrapperProps:E})}mt.propTypes={original:i.string,modified:i.string,language:i.string,originalLanguage:i.string,modifiedLanguage:i.string,originalModelPath:i.string,modifiedModelPath:i.string,keepCurrentOriginalModel:i.bool,keepCurrentModifiedModel:i.bool,theme:i.string,loading:i.oneOfType([i.element,i.string]),options:i.object,width:i.oneOfType([i.number,i.string]),height:i.oneOfType([i.number,i.string]),className:i.string,wrapperProps:i.object,beforeMount:i.func,onMount:i.func};mt.defaultProps={theme:"light",loading:"Loading...",options:{},keepCurrentOriginalModel:!1,keepCurrentModifiedModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:ie,onMount:ie};function hn(e){const t=c.exports.useRef();return c.exports.useEffect(()=>{t.current=e},[e]),t.current}const we=new Map;function Re({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:o,path:s,theme:l,line:f,loading:u,options:d,overrideServices:p,saveViewState:m,keepCurrentModel:F,width:x,height:C,className:E,wrapperProps:B,beforeMount:O,onMount:g,onChange:k,onValidate:R}){const[b,P]=c.exports.useState(!1),[M,U]=c.exports.useState(!0),S=c.exports.useRef(null),v=c.exports.useRef(null),V=c.exports.useRef(null),H=c.exports.useRef(g),Z=c.exports.useRef(O),w=c.exports.useRef(null),h=c.exports.useRef(n),I=hn(s);pt(()=>{const y=ut.init();return y.then(j=>(S.current=j)&&U(!1)).catch(j=>(j==null?void 0:j.type)!=="cancelation"&&console.error("Monaco initialization: error:",j)),()=>v.current?_():y.cancel()}),L(()=>{const y=ve(S.current,e||n,t||o,s);y!==v.current.getModel()&&(m&&we.set(I,v.current.saveViewState()),v.current.setModel(y),m&&v.current.restoreViewState(we.get(s)))},[s],b),L(()=>{v.current.updateOptions(d)},[d],b),L(()=>{v.current.getOption(S.current.editor.EditorOption.readOnly)?v.current.setValue(n):n!==v.current.getValue()&&(v.current.executeEdits("",[{range:v.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),v.current.pushUndoStop())},[n],b),L(()=>{S.current.editor.setModelLanguage(v.current.getModel(),o)},[o],b),L(()=>{mn(f)||v.current.revealLine(f)},[f],b),L(()=>{S.current.editor.setTheme(l)},[l],b);const q=c.exports.useCallback(()=>{Z.current(S.current);const y=s||r,j=ve(S.current,n||e,t||o,y);v.current=S.current.editor.create(V.current,$({model:j,automaticLayout:!0},d),p),m&&v.current.restoreViewState(we.get(y)),S.current.editor.setTheme(l),P(!0)},[e,t,r,n,o,s,d,p,m,l]);c.exports.useEffect(()=>{b&&H.current(v.current,S.current)},[b]),c.exports.useEffect(()=>{!M&&!b&&q()},[M,b,q]),h.current=n,c.exports.useEffect(()=>{if(b&&k){var y,j;(y=w.current)===null||y===void 0||y.dispose(),w.current=(j=v.current)===null||j===void 0?void 0:j.onDidChangeModelContent(Q=>{const K=v.current.getValue();h.current!==K&&k(K,Q)})}},[b,k]),c.exports.useEffect(()=>{if(b){const y=S.current.editor.onDidChangeMarkers(j=>{var Q;const K=(Q=v.current.getModel())===null||Q===void 0?void 0:Q.uri;if(K&&j.find(be=>be.path===K.path)){const be=S.current.editor.getModelMarkers({resource:K});R==null||R(be)}});return()=>{y==null||y.dispose()}}},[b,R]);function _(){var y;if((y=w.current)===null||y===void 0||y.dispose(),F)m&&we.set(s,v.current.saveViewState());else{var j;(j=v.current.getModel())===null||j===void 0||j.dispose()}v.current.dispose()}return a.createElement(ft,{width:x,height:C,isEditorReady:b,loading:u,_ref:V,className:E,wrapperProps:B})}Re.propTypes={defaultValue:i.string,defaultPath:i.string,defaultLanguage:i.string,value:i.string,language:i.string,path:i.string,theme:i.string,line:i.number,loading:i.oneOfType([i.element,i.string]),options:i.object,overrideServices:i.object,saveViewState:i.bool,keepCurrentModel:i.bool,width:i.oneOfType([i.number,i.string]),height:i.oneOfType([i.number,i.string]),className:i.string,wrapperProps:i.object,beforeMount:i.func,onMount:i.func,onChange:i.func,onValidate:i.func};Re.defaultProps={theme:"light",loading:"Loading...",options:{},overrideServices:{},saveViewState:!0,keepCurrentModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:ie,onMount:ie,onValidate:ie};var vn=c.exports.memo(Re);const wn=-1,yn=[],ht=({file:e})=>{const t=ue("light","dark"),{t:r}=D(),n=ee();let{pathname:o}=ae();const[s,l]=a.useState("");let f=Oe(!0)(e);const u=()=>{Ce.get(f).then(p=>le(void 0,null,function*(){l(p.data)}))},d=()=>le(void 0,null,function*(){const p=o.substring(0,o.lastIndexOf("/")||1),m=new FormData;m.append("files",new Blob([s]),e.name),m.append("path",p),pe.post("upload",m,{headers:{"Content-Type":"multipart/form-data"}}).then(F=>{const x=F.data;n({title:r(x.message),status:x.code===200?"success":"error",duration:3e3,isClosable:!0})})});return a.useEffect(()=>{u()},[]),a.createElement(z,null,a.createElement(vn,{height:"70vh",value:s,path:localStorage.getItem("DEPLOY_PATH")+e.name,theme:t==="light"?"light":"vs-dark",onChange:p=>l(p)}),a.createElement(de,{m:"2"},a.createElement(Ot,null),a.createElement(fe,{mt:"5",onClick:d},r("Save"))))};var Xn=Object.freeze(Object.defineProperty({__proto__:null,type:wn,exts:yn,default:ht},Symbol.toStringTag,{value:"Module"}));const bn=5,xn=[],vt=({file:e,readme:t})=>{const[r,n]=a.useState(""),[o,s]=a.useState(""),{getSetting:l,loggedIn:f}=c.exports.useContext(A);let u=Oe(!0)(e);const d=e.name.endsWith(".html"),[p,m]=a.useState("preview"),F=()=>{t&&e.type===-1&&(u=e.url),Ce.get(u,{responseType:"blob"}).then(x=>le(void 0,null,function*(){const C=x.data;let E=yield C.text();E.includes("\uFFFD")&&(E=new TextDecoder("gbk").decode(yield C.arrayBuffer())),d&&s(E),e.name.endsWith(".md")?n(E):n("```"+e.name.split(".").pop()+`
`+E+"\n```")}))};return c.exports.useEffect(()=>(F(),()=>{n("")}),[]),r?a.createElement(z,{w:"full"},a.createElement(W,null,d&&a.createElement(Ue,{display:"flex",alignItems:"center",width:"auto",m:"1"},a.createElement(Ve,{htmlFor:"render",mb:"0"},"Render?"),a.createElement(qe,{id:"render",isChecked:p==="render",onChange:()=>{m(p==="render"?"preview":"render")}})),!t&&f&&a.createElement(Ue,{display:"flex",alignItems:"center",width:"auto",m:"1"},a.createElement(Ve,{htmlFor:"render",mb:"0"},"Edit?"),a.createElement(qe,{id:"edit",isChecked:p==="edit",onChange:()=>{m(p==="edit"?"preview":"edit")}}))),p==="render"?a.createElement("iframe",{srcDoc:o,style:{width:"100%",borderRadius:"0.75rem",boxShadow:"#00000031 0px 1px 10px 5px",minHeight:"70vh"}}):p==="edit"?a.createElement(ht,{file:e}):a.createElement(z,{className:"markdown-body"},a.createElement(Ut,null,r))):a.createElement(X,{w:"full"},a.createElement(te,{color:l("icon color"),size:"xl"}))};var Zn=Object.freeze(Object.defineProperty({__proto__:null,type:bn,exts:xn,default:vt},Symbol.toStringTag,{value:"Module"}));const En={"dmg,ipa,plist":Zt,"exe,msi":Qt,"zip,gz,rar,7z,tar,jar,xz":er,apk:tr,db:rr,md:nr,epub:ar,iso:or,m3u8:We},Sn=(e,t)=>{if(e!==1){for(const[r,n]of Object.entries(En))if(r.split(",").includes(t.toLowerCase()))return n}switch(e){case 1:return fr;case 2:return t==="doc"||t==="docx"?Yt:t==="xls"||t==="xlsx"?Gt:t==="ppt"||t==="pptx"?Jt:Xt;case 3:return We;case 4:return Kt;case 5:return Wt;case 6:return qt;default:return Vt}},Mn=e=>{const{getSetting:t}=c.exports.useContext(A);return a.createElement(z,{w:"full"},a.createElement(Y,{placement:"bottom-start",label:Xe(e.path,e.name)},a.createElement(kt,{className:"result",p:"2",w:"full",rounded:"lg",transition:"all 0.3s",_hover:{transform:"scale(1.01)",bgColor:"rgba(132,133,141,0.18)"}},a.createElement(Pt,{as:J,to:encodeURI(Xe(e.path,e.name))},a.createElement(W,{spacing:2},a.createElement(de,{className:"result-name",align:"center",w:{base:3/4,md:"50%"}},a.createElement(G,{color:t("icon color"),boxSize:6,as:Sn(e.type,e.name.split(".").pop()||""),mr:2}),a.createElement(re,{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:"md"},e.name)),a.createElement(re,{className:"result-size",w:{base:1/4,md:1/6},textAlign:"right"},Je(e.size)),a.createElement(re,{className:"result-path",w:{base:0,md:1/3},display:{base:"none",md:"unset"},textAlign:"right"},e.path))))))},Cn=()=>{const e=Me(),[t,r]=c.exports.useState(!0),{getSetting:n}=c.exports.useContext(A),o=ee(),[s,l]=c.exports.useState([]),f=()=>{const d=new URLSearchParams(e.search),p=e.pathname,m=d.get("s");!m||(r(!0),pe.post("search",{path:p,keyword:m}).then(F=>{r(!1);const x=F.data;x.code===200?l(x.data):o({title:x.message,status:"error",duration:3e3,isClosable:!0})}))};c.exports.useEffect(()=>{f()},[e.search]);const{t:u}=D();return t?a.createElement(X,{w:"full",py:"4"},a.createElement(te,{color:n("icon color")||"#1890ff",size:"xl"})):a.createElement(Se,{className:"results-box",w:"full"},a.createElement(W,{className:"results-title",w:"full",p:"2"},[{name:"name",base:2/3,md:"50%",textAlign:"left"},{name:"size",base:1/3,md:1/6,textAlign:"right"},{name:"path",base:0,md:1/3,textAlign:"right"}].map(d=>a.createElement(de,{w:{base:d.base,md:d.md},key:d.name,align:"center"},a.createElement(re,{w:"full",className:`results-title-${d.name}`,fontSize:"sm",fontWeight:"bold",color:"gray.500",textAlign:d.textAlign,cursor:"pointer",display:d.name==="path"?{base:"none",md:"unset"}:"unset"},u(d.name))))),s.map(d=>a.createElement(Mn,$({key:d.name},d))))},Fn=c.exports.lazy(()=>Ke(()=>import(""+(window.__dynamicImportHandler__||function(e){return e})("./index.57e1888f.js")+""),(window.__dynamicImportPreload__ || function(importer) { return importer; })([localStorage.getItem("DEPLOY_PATH")+"assets/index.57e1888f.js",localStorage.getItem("DEPLOY_PATH")+"assets/index.884c354a.css",localStorage.getItem("DEPLOY_PATH")+"assets/vendor.36e124e7.js",localStorage.getItem("DEPLOY_PATH")+"assets/index.esm.875bdfba.js",localStorage.getItem("DEPLOY_PATH")+"assets/index.esm.5483c5f7.css",localStorage.getItem("DEPLOY_PATH")+"assets/index.2c144d5b.js",localStorage.getItem("DEPLOY_PATH")+"assets/clsx.m.bd4dd579.js",localStorage.getItem("DEPLOY_PATH")+"assets/usePath.dec5b771.js",localStorage.getItem("DEPLOY_PATH")+"assets/copy-clip.08e8f9de.js"]))),On=c.exports.lazy(()=>Ke(()=>import(""+(window.__dynamicImportHandler__||function(e){return e})("./file.3dd1f9a2.js")+""),(window.__dynamicImportPreload__ || function(importer) { return importer; })([localStorage.getItem("DEPLOY_PATH")+"assets/file.3dd1f9a2.js",localStorage.getItem("DEPLOY_PATH")+"assets/file.450b80be.css",localStorage.getItem("DEPLOY_PATH")+"assets/vendor.36e124e7.js",localStorage.getItem("DEPLOY_PATH")+"assets/clsx.m.bd4dd579.js",localStorage.getItem("DEPLOY_PATH")+"assets/index.esm.875bdfba.js",localStorage.getItem("DEPLOY_PATH")+"assets/index.esm.5483c5f7.css",localStorage.getItem("DEPLOY_PATH")+"assets/index.2c144d5b.js",localStorage.getItem("DEPLOY_PATH")+"assets/usePath.dec5b771.js",localStorage.getItem("DEPLOY_PATH")+"assets/useTitle.f8227ffe.js",localStorage.getItem("DEPLOY_PATH")+"assets/copy-clip.08e8f9de.js"]))),kn=()=>{const e=ue("white","gray.700");D();const{getSetting:t,setPassword:r,password:n,settingLoaded:o,type:s,msg:l,files:f,meta:u}=c.exports.useContext(A),d=c.exports.useMemo(()=>{if(s==="file")return;const p={name:"README.md",size:0,type:-1,driver:"local",updated_at:"",thumbnail:"",url:u.readme};if(u.readme)return p;const m=f.find(F=>F.name.toLowerCase()==="readme.md");if(m)return m;if(t("global readme url"))return p.url=t("global readme url"),p},[f,s,o]);return a.createElement(X,{className:"index-box",w:"full"},a.createElement(sr,{list:!0}),a.createElement(Se,{className:"root-box",w:{base:"95%",lg:"980px"}},a.createElement(br,null),a.createElement(Er,null),a.createElement(z,{className:"main-box",rounded:"xl",shadow:"lg",bgColor:e,w:"full"},s==="loading"?a.createElement(X,{w:"full",py:"4"},a.createElement(te,{color:t("icon color")||"#1890ff",size:"xl"})):a.createElement(z,{className:"content-box",w:"full",p:"2"},a.createElement(c.exports.Suspense,{fallback:a.createElement(X,{h:"full"},a.createElement(te,{color:t("icon color")||"#1890ff",size:"xl"}))},s==="folder"||s==="nexting"?a.createElement(Fn,null):s==="file"?a.createElement(On,null):s==="search"?a.createElement(Cn,null):a.createElement(Sr,{msg:l})))),s==="folder"&&d&&a.createElement(z,{className:"readme-box",rounded:"xl",shadow:"lg",bgColor:e,w:"full",p:"4"},a.createElement(vt,{file:d,readme:!0})),a.createElement(xr,null)))};const Pn=(e,t)=>{const r=c.exports.useRef(!1);c.exports.useEffect(()=>{r.current?e():r.current=!0},t)},_n=e=>{const[t,r]=c.exports.useState({current:!1}),n=c.exports.useCallback(()=>{r({current:!0})},[t]);return c.exports.useEffect(()=>{t.current===!0&&r({current:!1})},[t]),c.exports.useEffect(()=>{t.current&&e()}),n};let Be=!1,ye=!1;const jn=e=>{const{type:t,setType:r,setSelectFiles:n,setFiles:o,setLastFiles:s,files:l,setMsg:f,sort:u,password:d,setPassword:p,setMeta:m,getSetting:F,setPage:x,page:C,settingLoaded:E}=c.exports.useContext(A),{t:B}=D(),O=De(),g=Me(),k=ee(),{path:R,cancelPath:b}=ur(),P=_n(()=>{let h=localStorage.getItem("netdisk_path");if(h){localStorage.setItem("netdisk_path",""),O.push(g.pathname+h);return}if(!E||v())return;b(),console.log("refresh"),console.log(C);const I=F("load type");t==="folder"&&s(l),C.page_num===1||I==="all"||I==="pagination"?(r("loading"),n([]),o([])):r("nexting"),R().then(q=>{const _=q.data;f(_.message),_.code===200?(_.data.type==="file"?o(_.data.files):C.page_num===1||I==="all"||I==="pagination"?o(M(_.data.files)):o([...l,..._.data.files]),m(_.data.meta),r(_.data.type)):(_.code===401&&ye&&(k({title:B(_.message),status:"error",duration:3e3,isClosable:!0}),ye=!1),_.code===1001&&(k({title:B(_.message),status:"warning",duration:3e3,isClosable:!0}),O.push(localStorage.getItem("DEPLOY_PATH")+"@manage")),_.code===401?r("unauthorized"):r("error"))})}),M=h=>{const{orderBy:I,reverse:q}=u;return I?h.sort((_,y)=>_[I]<y[I]?q?1:-1:_[I]>y[I]?q?-1:1:0):h},U=()=>{if(Be){Be=!1;return}P()},S=()=>{C.page_num!==1&&(Be=!0,x({page_num:1,page_size:C.page_size})),P()};c.exports.useEffect(()=>{const h=M(l);o([...h])},[u]),c.exports.useEffect(()=>(S(),ke.on("refresh",S),()=>{ke.off("refresh",S)}),[g.pathname]),Pn(()=>{U()},[C]);const v=()=>new URLSearchParams(g.search).get("s")?(r("search"),!0):!1;c.exports.useEffect(()=>{v()||S()},[g.search]);const{isOpen:V,onClose:H,onOpen:Z}=Le(),w=a.useRef();return c.exports.useEffect(()=>{t==="unauthorized"&&Z()},[t]),a.createElement(a.Fragment,null,a.createElement(a.Fragment,$({},e)),a.createElement(_t,{initialFocusRef:w,isOpen:V,onClose:()=>{H()}},a.createElement(jt,null),a.createElement(It,null,a.createElement(Rt,null,B("Input password")),a.createElement(Bt,null),a.createElement(Tt,{pb:6},a.createElement(xe,{type:"password",ref:w,value:d,onChange:h=>{p(h.target.value)},onKeyUp:h=>{h.key==="Enter"&&(localStorage.setItem("password",d),ye=!0,P(),H())}})),a.createElement(At,null,a.createElement(fe,{onClick:()=>{localStorage.setItem("password",d),ye=!0,P(),H()},mr:3},B("Ok")),a.createElement(fe,{colorScheme:"gray",onClick:()=>{O.goBack(),H()}},B("Cancel"))))))},In=()=>a.createElement(cr,null,a.createElement(jn,null,a.createElement(kn,null)));var Qn=Object.freeze(Object.defineProperty({__proto__:null,default:In},Symbol.toStringTag,{value:"Module"}));export{Wn as F,fr as I,Xn as _,mr as a,ur as b,ke as c,Gn as d,Oe as e,Jn as f,Yn as g,Un as h,Nn as i,Vn as j,Kn as k,Hn as l,Ge as m,qn as n,$n as o,Xe as p,Sn as q,Je as r,Zn as s,Qn as t,pr as u};
