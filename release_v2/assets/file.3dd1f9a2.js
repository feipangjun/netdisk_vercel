var Vh=Object.defineProperty,Kh=Object.defineProperties;var Hh=Object.getOwnPropertyDescriptors;var fu=Object.getOwnPropertySymbols;var $h=Object.prototype.hasOwnProperty,Gh=Object.prototype.propertyIsEnumerable;var du=(s,e,r)=>e in s?Vh(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,yt=(s,e)=>{for(var r in e||(e={}))$h.call(e,r)&&du(s,r,e[r]);if(fu)for(var r of fu(e))Gh.call(e,r)&&du(s,r,e[r]);return s},Ot=(s,e)=>Kh(s,Hh(e));var yr=(s,e,r)=>new Promise((i,t)=>{var n=l=>{try{o(r.next(l))}catch(v){t(v)}},a=l=>{try{o(r.throw(l))}catch(v){t(v)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(n,a);o((r=r.apply(s,e)).next())});import{ae as Wt,r as Ye,ad as kn,an as Eo,ao as cu,R as q,J as se,k as Yh,h as Nn,am as hu,l as Xi,C as Zi,H as Ca,q as Fn,ap as zr,s as Xh,t as Zh,V as _o,o as pu,G as Er,x as xo,aq as Qh,a8 as Jh,ar as qh,af as bo,n as ep,a4 as tp,a5 as rp,E as ip,a6 as np,a7 as ap,L as sp,as as op,aj as Qi}from"./vendor.36e124e7.js";import{a as lp}from"./clsx.m.bd4dd579.js";import{I as ei,R as up,i as fp,S as dp}from"./index.esm.875bdfba.js";import{e as ui,q as Pa,u as cp,_ as hp,s as pp}from"./index.b9e96780.js";import{u as vp}from"./usePath.dec5b771.js";import{u as gp}from"./useTitle.f8227ffe.js";import"./index.2c144d5b.js";import"./copy-clip.08e8f9de.js";var Ji={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(s){(function(){var e={}.hasOwnProperty;function r(){for(var i=[],t=0;t<arguments.length;t++){var n=arguments[t];if(!!n){var a=typeof n;if(a==="string"||a==="number")i.push(n);else if(Array.isArray(n)){if(n.length){var o=r.apply(null,n);o&&i.push(o)}}else if(a==="object")if(n.toString===Object.prototype.toString)for(var l in n)e.call(n,l)&&n[l]&&i.push(l);else i.push(n.toString())}}return i.join(" ")}s.exports?(r.default=r,s.exports=r):window.classNames=r})()})(Ji);var Ft=Ji.exports,vu={exports:{}};(function(s,e){(function(r,i){s.exports=i()})(Wt,function(){return function r(i,t,n){var a=window,o="application/octet-stream",l=n||o,v=i,h=!t&&!n&&v,f=document.createElement("a"),d=function(b){return String(b)},g=a.Blob||a.MozBlob||a.WebKitBlob||d,E=t||"download",S,x;if(g=g.call?g.bind(a):Blob,String(this)==="true"&&(v=[v,l],l=v[0],v=v[1]),h&&h.length<2048&&(E=h.split("/").pop().split("?")[0],f.href=h,f.href.indexOf(h)!==-1)){var m=new XMLHttpRequest;return m.open("GET",h,!0),m.responseType="blob",m.onload=function(b){r(b.target.response,E,o)},setTimeout(function(){m.send()},0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(v))if(v.length>1024*1024*1.999&&g!==d)v=u(v),l=v.type||o;else return navigator.msSaveBlob?navigator.msSaveBlob(u(v),E):_(v);else if(/([\x80-\xff])/.test(v)){var c=0,p=new Uint8Array(v.length),y=p.length;for(c;c<y;++c)p[c]=v.charCodeAt(c);v=new g([p],{type:l})}S=v instanceof g?v:new g([v],{type:l});function u(b){var T=b.split(/[:;,]/),A=T[1],L=T[2]=="base64"?atob:decodeURIComponent,R=L(T.pop()),w=R.length,O=0,I=new Uint8Array(w);for(O;O<w;++O)I[O]=R.charCodeAt(O);return new g([I],{type:A})}function _(b,T){if("download"in f)return f.href=b,f.setAttribute("download",E),f.className="download-js-link",f.innerHTML="downloading...",f.style.display="none",document.body.appendChild(f),setTimeout(function(){f.click(),document.body.removeChild(f),T===!0&&setTimeout(function(){a.URL.revokeObjectURL(f.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(b)&&(b="data:"+b.replace(/^data:([\w\/\-\+]+)/,o)),window.open(b)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=b),!0;var A=document.createElement("iframe");document.body.appendChild(A),!T&&/^data:/.test(b)&&(b="data:"+b.replace(/^data:([\w\/\-\+]+)/,o)),A.src=b,setTimeout(function(){document.body.removeChild(A)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(S,E);if(a.URL)_(a.URL.createObjectURL(S),!0);else{if(typeof S=="string"||S.constructor===d)try{return _("data:"+l+";base64,"+a.btoa(S))}catch(b){return _("data:"+l+","+encodeURIComponent(S))}x=new FileReader,x.onload=function(b){_(this.result)},x.readAsDataURL(S)}return!0}})})(vu);var gu=vu.exports,Ma={exports:{}};Ma.exports=So;Ma.exports.isMobile=So;Ma.exports.default=So;var mp=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,yp=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function So(s){s||(s={});var e=s.ua;if(!e&&typeof navigator!="undefined"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var r=s.tablet?yp.test(e):mp.test(e);return!r&&s.tablet&&s.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(r=!0),r}var Ep=Ma.exports,To={},Ao={exports:{}},ka={exports:{}};(function(s){function e(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?(s.exports=e=function(t){return typeof t},s.exports.default=s.exports,s.exports.__esModule=!0):(s.exports=e=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s.exports.default=s.exports,s.exports.__esModule=!0),e(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(ka);(function(s){var e=ka.exports.default;function r(t){if(typeof WeakMap!="function")return null;var n=new WeakMap,a=new WeakMap;return(r=function(l){return l?a:n})(t)}function i(t,n){if(!n&&t&&t.__esModule)return t;if(t===null||e(t)!=="object"&&typeof t!="function")return{default:t};var a=r(n);if(a&&a.has(t))return a.get(t);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in t)if(v!=="default"&&Object.prototype.hasOwnProperty.call(t,v)){var h=l?Object.getOwnPropertyDescriptor(t,v):null;h&&(h.get||h.set)?Object.defineProperty(o,v,h):o[v]=t[v]}return o.default=t,a&&a.set(t,o),o}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(Ao);var fi={exports:{}};(function(s){function e(r){return r&&r.__esModule?r:{default:r}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(fi);var Ti={exports:{}},Ai={exports:{}};(function(s){function e(r,i,t){return i in r?Object.defineProperty(r,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[i]=t,r}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Ai);(function(s){var e=Ai.exports;function r(t,n){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),a.push.apply(a,o)}return a}function i(t){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?r(Object(a),!0).forEach(function(o){e(t,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(a,o))})}return t}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(Ti);var Na={exports:{}};(function(s){function e(r,i){if(!(r instanceof i))throw new TypeError("Cannot call a class as a function")}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Na);var Fa={exports:{}};(function(s){function e(i,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}function r(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Fa);var Ba={exports:{}},mu={exports:{}};(function(s){function e(r,i){return s.exports=e=Object.setPrototypeOf||function(n,a){return n.__proto__=a,n},s.exports.default=s.exports,s.exports.__esModule=!0,e(r,i)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(mu);(function(s){var e=mu.exports;function r(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&e(i,t)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Ba);var Ua={exports:{}},ja={exports:{}};(function(s){function e(r){return s.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},s.exports.default=s.exports,s.exports.__esModule=!0,e(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(ja);var yu={exports:{}};(function(s){function e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(yu);var Eu={exports:{}},_u={exports:{}};(function(s){function e(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(_u);(function(s){var e=ka.exports.default,r=_u.exports;function i(t,n){if(n&&(e(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(t)}s.exports=i,s.exports.default=s.exports,s.exports.__esModule=!0})(Eu);(function(s){var e=ja.exports,r=yu.exports,i=Eu.exports;function t(n){var a=r();return function(){var l=e(n),v;if(a){var h=e(this).constructor;v=Reflect.construct(l,arguments,h)}else v=l.apply(this,arguments);return i(this,v)}}s.exports=t,s.exports.default=s.exports,s.exports.__esModule=!0})(Ua);var _r={};Object.defineProperty(_r,"__esModule",{value:!0});_r.warning=xu;_r.note=bu;_r.resetWarned=_p;_r.call=Oo;_r.warningOnce=Su;_r.noteOnce=xp;_r.default=void 0;var wo={};function xu(s,e){}function bu(s,e){}function _p(){wo={}}function Oo(s,e,r){!e&&!wo[r]&&(s(!1,r),wo[r]=!0)}function Su(s,e){Oo(xu,s,e)}function xp(s,e){Oo(bu,s,e)}var bp=Su;_r.default=bp;var Wa={},Lo=fi.exports;Object.defineProperty(Wa,"__esModule",{value:!0});Wa.default=void 0;var Tu=Lo(Ti.exports),qi=Lo(Ai.exports),Sp=Lo(Ye.exports),Tp=function(e){var r,i,t=e.className,n=e.included,a=e.vertical,o=e.style,l=e.length,v=e.offset,h=e.reverse;l<0&&(h=!h,l=Math.abs(l),v=100-v);var f=a?(r={},(0,qi.default)(r,h?"top":"bottom","".concat(v,"%")),(0,qi.default)(r,h?"bottom":"top","auto"),(0,qi.default)(r,"height","".concat(l,"%")),r):(i={},(0,qi.default)(i,h?"right":"left","".concat(v,"%")),(0,qi.default)(i,h?"left":"right","auto"),(0,qi.default)(i,"width","".concat(l,"%")),i),d=(0,Tu.default)((0,Tu.default)({},o),f);return n?Sp.default.createElement("div",{className:t,style:d}):null},Ap=Tp;Wa.default=Ap;var Io={},Ro={exports:{}};(function(s){function e(){return s.exports=e=Object.assign||function(r){for(var i=1;i<arguments.length;i++){var t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},s.exports.default=s.exports,s.exports.__esModule=!0,e.apply(this,arguments)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Ro);var Do={exports:{}},Au={exports:{}};(function(s){function e(r,i){if(r==null)return{};var t={},n=Object.keys(r),a,o;for(o=0;o<n.length;o++)a=n[o],!(i.indexOf(a)>=0)&&(t[a]=r[a]);return t}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Au);(function(s){var e=Au.exports;function r(i,t){if(i==null)return{};var n=e(i,t),a,o;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(i);for(o=0;o<l.length;o++)a=l[o],!(t.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,a)||(n[a]=i[a]))}return n}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Do);var Co={exports:{}},wu={exports:{}},Po={exports:{}};(function(s){function e(r,i){(i==null||i>r.length)&&(i=r.length);for(var t=0,n=new Array(i);t<i;t++)n[t]=r[t];return n}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Po);(function(s){var e=Po.exports;function r(i){if(Array.isArray(i))return e(i)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(wu);var Ou={exports:{}};(function(s){function e(r){if(typeof Symbol!="undefined"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Ou);var Lu={exports:{}};(function(s){var e=Po.exports;function r(i,t){if(!!i){if(typeof i=="string")return e(i,t);var n=Object.prototype.toString.call(i).slice(8,-1);if(n==="Object"&&i.constructor&&(n=i.constructor.name),n==="Map"||n==="Set")return Array.from(i);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(i,t)}}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Lu);var Iu={exports:{}};(function(s){function e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Iu);(function(s){var e=wu.exports,r=Ou.exports,i=Lu.exports,t=Iu.exports;function n(a){return e(a)||r(a)||i(a)||t()}s.exports=n,s.exports.default=s.exports,s.exports.__esModule=!0})(Co);var Ru={exports:{}},Du={exports:{}};(function(s){var e=ja.exports;function r(i,t){for(;!Object.prototype.hasOwnProperty.call(i,t)&&(i=e(i),i!==null););return i}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Du);(function(s){var e=Du.exports;function r(i,t,n){return typeof Reflect!="undefined"&&Reflect.get?(s.exports=r=Reflect.get,s.exports.default=s.exports,s.exports.__esModule=!0):(s.exports=r=function(o,l,v){var h=e(o,l);if(!!h){var f=Object.getOwnPropertyDescriptor(h,l);return f.get?f.get.call(v):f.value}},s.exports.default=s.exports,s.exports.__esModule=!0),r(i,t,n||i)}s.exports=r,s.exports.default=s.exports,s.exports.__esModule=!0})(Ru);var za={},Cu={exports:{}};(function(s){function e(r){return r&&r.__esModule?r:{default:r}}s.exports=e,s.exports.default=s.exports,s.exports.__esModule=!0})(Cu);var wp=Cu.exports;Object.defineProperty(za,"__esModule",{value:!0});za.default=Op;var Pu=wp(kn.exports);function Op(s,e,r,i){var t=Pu.default.unstable_batchedUpdates?function(a){Pu.default.unstable_batchedUpdates(r,a)}:r;return s.addEventListener&&s.addEventListener(e,t,i),{remove:function(){s.removeEventListener&&s.removeEventListener(e,t)}}}var Va={},Bn=fi.exports;Object.defineProperty(Va,"__esModule",{value:!0});Va.default=void 0;var Un=Bn(Ai.exports),en=Bn(Ti.exports),Mu=Bn(Ye.exports),Lp=Bn(Ji.exports),Ip=Bn(_r),Rp=function(e,r,i,t,n,a){(0,Ip.default)(i?t>0:!0,"`Slider[step]` should be a positive number in order to make Slider[dots] work.");var o=Object.keys(r).map(parseFloat).sort(function(v,h){return v-h});if(i&&t)for(var l=n;l<=a;l+=t)o.indexOf(l)===-1&&o.push(l);return o},Dp=function(e){var r=e.prefixCls,i=e.vertical,t=e.reverse,n=e.marks,a=e.dots,o=e.step,l=e.included,v=e.lowerBound,h=e.upperBound,f=e.max,d=e.min,g=e.dotStyle,E=e.activeDotStyle,S=f-d,x=Rp(i,n,a,o,d,f).map(function(m){var c,p="".concat(Math.abs(m-d)/S*100,"%"),y=!l&&m===h||l&&m<=h&&m>=v,u=i?(0,en.default)((0,en.default)({},g),{},(0,Un.default)({},t?"top":"bottom",p)):(0,en.default)((0,en.default)({},g),{},(0,Un.default)({},t?"right":"left",p));y&&(u=(0,en.default)((0,en.default)({},u),E));var _=(0,Lp.default)((c={},(0,Un.default)(c,"".concat(r,"-dot"),!0),(0,Un.default)(c,"".concat(r,"-dot-active"),y),(0,Un.default)(c,"".concat(r,"-dot-reverse"),t),c));return Mu.default.createElement("span",{className:_,style:u,key:m})});return Mu.default.createElement("div",{className:"".concat(r,"-step")},x)},Cp=Dp;Va.default=Cp;var Ka={},jn=fi.exports;Object.defineProperty(Ka,"__esModule",{value:!0});Ka.default=void 0;var ku=jn(Ti.exports),Ha=jn(Ai.exports),Pp=jn(ka.exports),Mo=jn(Ye.exports),Mp=jn(Ji.exports),kp=function(e){var r=e.className,i=e.vertical,t=e.reverse,n=e.marks,a=e.included,o=e.upperBound,l=e.lowerBound,v=e.max,h=e.min,f=e.onClickLabel,d=Object.keys(n),g=v-h,E=d.map(parseFloat).sort(function(S,x){return S-x}).map(function(S){var x,m=n[S],c=(0,Pp.default)(m)==="object"&&!Mo.default.isValidElement(m),p=c?m.label:m;if(!p&&p!==0)return null;var y=!a&&S===o||a&&S<=o&&S>=l,u=(0,Mp.default)((x={},(0,Ha.default)(x,"".concat(r,"-text"),!0),(0,Ha.default)(x,"".concat(r,"-text-active"),y),x)),_=(0,Ha.default)({marginBottom:"-50%"},t?"top":"bottom","".concat((S-h)/g*100,"%")),b=(0,Ha.default)({transform:"translateX(".concat(t?"50%":"-50%",")"),msTransform:"translateX(".concat(t?"50%":"-50%",")")},t?"right":"left","".concat((S-h)/g*100,"%")),T=i?_:b,A=c?(0,ku.default)((0,ku.default)({},T),m.style):T;return Mo.default.createElement("span",{className:u,style:A,key:S,onMouseDown:function(R){return f(R,S)},onTouchStart:function(R){return f(R,S)}},p)});return Mo.default.createElement("div",{className:r},E)},Np=kp;Ka.default=Np;var $a={},Cr=fi.exports;Object.defineProperty($a,"__esModule",{value:!0});$a.default=void 0;var Fp=Cr(Ro.exports),Nu=Cr(Ti.exports),wi=Cr(Ai.exports),Bp=Cr(Do.exports),Up=Cr(Na.exports),jp=Cr(Fa.exports),Wp=Cr(Ba.exports),zp=Cr(Ua.exports),Fu=Cr(Ye.exports),Vp=Cr(Ji.exports),Kp=Cr(za),Hp=["prefixCls","vertical","reverse","offset","style","disabled","min","max","value","tabIndex","ariaLabel","ariaLabelledBy","ariaValueTextFormatter"],$p=function(s){(0,Wp.default)(r,s);var e=(0,zp.default)(r);function r(){var i;(0,Up.default)(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),i.state={clickFocused:!1},i.onMouseUpListener=void 0,i.handle=void 0,i.setHandleRef=function(o){i.handle=o},i.handleMouseUp=function(){document.activeElement===i.handle&&i.setClickFocus(!0)},i.handleMouseDown=function(o){o.preventDefault(),i.focus()},i.handleBlur=function(){i.setClickFocus(!1)},i.handleKeyDown=function(){i.setClickFocus(!1)},i}return(0,jp.default)(r,[{key:"componentDidMount",value:function(){this.onMouseUpListener=(0,Kp.default)(document,"mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"setClickFocus",value:function(t){this.setState({clickFocused:t})}},{key:"clickFocus",value:function(){this.setClickFocus(!0),this.focus()}},{key:"focus",value:function(){this.handle.focus()}},{key:"blur",value:function(){this.handle.blur()}},{key:"render",value:function(){var t,n,a=this.props,o=a.prefixCls,l=a.vertical,v=a.reverse,h=a.offset,f=a.style,d=a.disabled,g=a.min,E=a.max,S=a.value,x=a.tabIndex,m=a.ariaLabel,c=a.ariaLabelledBy,p=a.ariaValueTextFormatter,y=(0,Bp.default)(a,Hp),u=(0,Vp.default)(this.props.className,(0,wi.default)({},"".concat(o,"-handle-click-focused"),this.state.clickFocused)),_=l?(t={},(0,wi.default)(t,v?"top":"bottom","".concat(h,"%")),(0,wi.default)(t,v?"bottom":"top","auto"),(0,wi.default)(t,"transform",v?null:"translateY(+50%)"),t):(n={},(0,wi.default)(n,v?"right":"left","".concat(h,"%")),(0,wi.default)(n,v?"left":"right","auto"),(0,wi.default)(n,"transform","translateX(".concat(v?"+":"-","50%)")),n),b=(0,Nu.default)((0,Nu.default)({},f),_),T=x||0;(d||x===null)&&(T=null);var A;return p&&(A=p(S)),Fu.default.createElement("div",(0,Fp.default)({ref:this.setHandleRef,tabIndex:T},y,{className:u,style:b,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onMouseDown:this.handleMouseDown,role:"slider","aria-valuemin":g,"aria-valuemax":E,"aria-valuenow":S,"aria-disabled":!!d,"aria-label":m,"aria-labelledby":c,"aria-valuetext":A}))}}]),r}(Fu.default.Component);$a.default=$p;var zt={},Ga={};Object.defineProperty(Ga,"__esModule",{value:!0});Ga.default=void 0;var Ze={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var r=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||r>=Ze.F1&&r<=Ze.F12)return!1;switch(r){case Ze.ALT:case Ze.CAPS_LOCK:case Ze.CONTEXT_MENU:case Ze.CTRL:case Ze.DOWN:case Ze.END:case Ze.ESC:case Ze.HOME:case Ze.INSERT:case Ze.LEFT:case Ze.MAC_FF_META:case Ze.META:case Ze.NUMLOCK:case Ze.NUM_CENTER:case Ze.PAGE_DOWN:case Ze.PAGE_UP:case Ze.PAUSE:case Ze.PRINT_SCREEN:case Ze.RIGHT:case Ze.SHIFT:case Ze.UP:case Ze.WIN_KEY:case Ze.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Ze.ZERO&&e<=Ze.NINE||e>=Ze.NUM_ZERO&&e<=Ze.NUM_MULTIPLY||e>=Ze.A&&e<=Ze.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case Ze.SPACE:case Ze.QUESTION_MARK:case Ze.NUM_PLUS:case Ze.NUM_MINUS:case Ze.NUM_PERIOD:case Ze.NUM_DIVISION:case Ze.SEMICOLON:case Ze.DASH:case Ze.EQUALS:case Ze.COMMA:case Ze.PERIOD:case Ze.SLASH:case Ze.APOSTROPHE:case Ze.SINGLE_QUOTE:case Ze.OPEN_SQUARE_BRACKET:case Ze.BACKSLASH:case Ze.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Gp=Ze;Ga.default=Gp;var Bu=fi.exports;Object.defineProperty(zt,"__esModule",{value:!0});zt.calculateNextValue=Uu;zt.ensureValueInRange=rv;zt.ensureValuePrecision=iv;zt.getClosestPoint=ko;zt.getHandleCenterPosition=tv;zt.getKeyboardValueMutator=av;zt.getMousePosition=qp;zt.getPrecision=No;zt.getTouchPosition=ev;zt.isEventFromHandle=Zp;zt.isNotTouchEvent=Jp;zt.isValueOutOfRange=Qp;zt.pauseEvent=nv;var Yp=Bu(Co.exports),Xp=kn.exports,di=Bu(Ga);function Zp(s,e){try{return Object.keys(e).some(function(r){return s.target===(0,Xp.findDOMNode)(e[r])})}catch(r){return!1}}function Qp(s,e){var r=e.min,i=e.max;return s<r||s>i}function Jp(s){return s.touches.length>1||s.type.toLowerCase()==="touchend"&&s.touches.length>0}function ko(s,e){var r=e.marks,i=e.step,t=e.min,n=e.max,a=Object.keys(r).map(parseFloat);if(i!==null){var o=Math.pow(10,No(i)),l=Math.floor((n*o-t*o)/(i*o)),v=Math.min((s-t)/i,l),h=Math.round(v)*i+t;a.push(h)}var f=a.map(function(d){return Math.abs(s-d)});return a[f.indexOf(Math.min.apply(Math,(0,Yp.default)(f)))]}function No(s){var e=s.toString(),r=0;return e.indexOf(".")>=0&&(r=e.length-e.indexOf(".")-1),r}function qp(s,e){return s?e.clientY:e.pageX}function ev(s,e){return s?e.touches[0].clientY:e.touches[0].pageX}function tv(s,e){var r=e.getBoundingClientRect();return s?r.top+r.height*.5:window.pageXOffset+r.left+r.width*.5}function rv(s,e){var r=e.max,i=e.min;return s<=i?i:s>=r?r:s}function iv(s,e){var r=e.step,i=isFinite(ko(s,e))?ko(s,e):0;return r===null?i:parseFloat(i.toFixed(No(r)))}function nv(s){s.stopPropagation(),s.preventDefault()}function Uu(s,e,r){var i={increase:function(o,l){return o+l},decrease:function(o,l){return o-l}},t=i[s](Object.keys(r.marks).indexOf(JSON.stringify(e)),1),n=Object.keys(r.marks)[t];return r.step?i[s](e,r.step):!!Object.keys(r.marks).length&&!!r.marks[n]?r.marks[n]:e}function av(s,e,r){var i="increase",t="decrease",n=i;switch(s.keyCode){case di.default.UP:n=e&&r?t:i;break;case di.default.RIGHT:n=!e&&r?t:i;break;case di.default.DOWN:n=e&&r?i:t;break;case di.default.LEFT:n=!e&&r?i:t;break;case di.default.END:return function(a,o){return o.max};case di.default.HOME:return function(a,o){return o.min};case di.default.PAGE_UP:return function(a,o){return a+o.step*2};case di.default.PAGE_DOWN:return function(a,o){return a-o.step*2};default:return}return function(a,o){return Uu(n,a,o)}}var Mt=fi.exports,sv=Ao.exports;Object.defineProperty(Io,"__esModule",{value:!0});Io.default=_v;var ov=Mt(Ro.exports),lv=Mt(Do.exports),Ya=Mt(Ti.exports),Xa=Mt(Ai.exports),uv=Mt(Co.exports),fv=Mt(Na.exports),dv=Mt(Fa.exports),Fo=Mt(Ru.exports),Bo=Mt(ja.exports),cv=Mt(Ba.exports),hv=Mt(Ua.exports),Wn=Mt(Ye.exports),Za=Mt(za),pv=Mt(Ji.exports),vv=Mt(_r),gv=Mt(Va),mv=Mt(Ka),yv=Mt($a),ar=sv(zt),Ev=["index"];function Vr(){}function _v(s){var e,r;return r=e=function(i){(0,cv.default)(n,i);var t=(0,hv.default)(n);function n(a){var o;(0,fv.default)(this,n),o=t.call(this,a),o.handlesRefs=void 0,o.sliderRef=void 0,o.document=void 0,o.dragOffset=void 0,o.prevMovedHandleIndex=void 0,o.onTouchMoveListener=void 0,o.onTouchUpListener=void 0,o.onMouseMoveListener=void 0,o.onMouseUpListener=void 0,o.dragTrack=void 0,o.startBounds=void 0,o.onDown=function(d,g){var E=g,S=o.props,x=S.draggableTrack,m=S.vertical,c=o.state.bounds,p=x&&o.positionGetValue?o.positionGetValue(E)||[]:[],y=ar.isEventFromHandle(d,o.handlesRefs);if(o.dragTrack=x&&c.length>=2&&!y&&!p.map(function(_,b){var T=b?!0:_>=c[b];return b===p.length-1?_<=c[b]:T}).some(function(_){return!_}),o.dragTrack)o.dragOffset=E,o.startBounds=(0,uv.default)(c);else{if(!y)o.dragOffset=0;else{var u=ar.getHandleCenterPosition(m,d.target);o.dragOffset=E-u,E=u}o.onStart(E)}},o.onMouseDown=function(d){if(d.button===0){o.removeDocumentEvents();var g=o.props.vertical,E=ar.getMousePosition(g,d);o.onDown(d,E),o.addDocumentMouseEvents()}},o.onTouchStart=function(d){if(!ar.isNotTouchEvent(d)){var g=o.props.vertical,E=ar.getTouchPosition(g,d);o.onDown(d,E),o.addDocumentTouchEvents(),ar.pauseEvent(d)}},o.onFocus=function(d){var g=o.props,E=g.onFocus,S=g.vertical;if(ar.isEventFromHandle(d,o.handlesRefs)&&!o.dragTrack){var x=ar.getHandleCenterPosition(S,d.target);o.dragOffset=0,o.onStart(x),ar.pauseEvent(d),E&&E(d)}},o.onBlur=function(d){var g=o.props.onBlur;o.dragTrack||o.onEnd(),g&&g(d)},o.onMouseUp=function(){o.handlesRefs[o.prevMovedHandleIndex]&&o.handlesRefs[o.prevMovedHandleIndex].clickFocus()},o.onMouseMove=function(d){if(!o.sliderRef){o.onEnd();return}var g=ar.getMousePosition(o.props.vertical,d);o.onMove(d,g-o.dragOffset,o.dragTrack,o.startBounds)},o.onTouchMove=function(d){if(ar.isNotTouchEvent(d)||!o.sliderRef){o.onEnd();return}var g=ar.getTouchPosition(o.props.vertical,d);o.onMove(d,g-o.dragOffset,o.dragTrack,o.startBounds)},o.onKeyDown=function(d){o.sliderRef&&ar.isEventFromHandle(d,o.handlesRefs)&&o.onKeyboard(d)},o.onClickMarkLabel=function(d,g){d.stopPropagation(),o.onChange({value:g}),o.setState({value:g},function(){return o.onEnd(!0)})},o.saveSlider=function(d){o.sliderRef=d};var l=a.step,v=a.max,h=a.min,f=isFinite(v-h)?(v-h)%l==0:!0;return(0,vv.default)(l&&Math.floor(l)===l?f:!0,"Slider[max] - Slider[min] (".concat(v-h,") should be a multiple of Slider[step] (").concat(l,")")),o.handlesRefs={},o}return(0,dv.default)(n,[{key:"componentDidMount",value:function(){this.document=this.sliderRef&&this.sliderRef.ownerDocument;var o=this.props,l=o.autoFocus,v=o.disabled;l&&!v&&this.focus()}},{key:"componentWillUnmount",value:function(){(0,Fo.default)((0,Bo.default)(n.prototype),"componentWillUnmount",this)&&(0,Fo.default)((0,Bo.default)(n.prototype),"componentWillUnmount",this).call(this),this.removeDocumentEvents()}},{key:"getSliderStart",value:function(){var o=this.sliderRef,l=this.props,v=l.vertical,h=l.reverse,f=o.getBoundingClientRect();return v?h?f.bottom:f.top:window.pageXOffset+(h?f.right:f.left)}},{key:"getSliderLength",value:function(){var o=this.sliderRef;if(!o)return 0;var l=o.getBoundingClientRect();return this.props.vertical?l.height:l.width}},{key:"addDocumentTouchEvents",value:function(){this.onTouchMoveListener=(0,Za.default)(this.document,"touchmove",this.onTouchMove),this.onTouchUpListener=(0,Za.default)(this.document,"touchend",this.onEnd)}},{key:"addDocumentMouseEvents",value:function(){this.onMouseMoveListener=(0,Za.default)(this.document,"mousemove",this.onMouseMove),this.onMouseUpListener=(0,Za.default)(this.document,"mouseup",this.onEnd)}},{key:"removeDocumentEvents",value:function(){this.onTouchMoveListener&&this.onTouchMoveListener.remove(),this.onTouchUpListener&&this.onTouchUpListener.remove(),this.onMouseMoveListener&&this.onMouseMoveListener.remove(),this.onMouseUpListener&&this.onMouseUpListener.remove()}},{key:"focus",value:function(){var o;this.props.disabled||(o=this.handlesRefs[0])===null||o===void 0||o.focus()}},{key:"blur",value:function(){var o=this;this.props.disabled||Object.keys(this.handlesRefs).forEach(function(l){var v,h;(v=o.handlesRefs[l])===null||v===void 0||(h=v.blur)===null||h===void 0||h.call(v)})}},{key:"calcValue",value:function(o){var l=this.props,v=l.vertical,h=l.min,f=l.max,d=Math.abs(Math.max(o,0)/this.getSliderLength()),g=v?(1-d)*(f-h)+h:d*(f-h)+h;return g}},{key:"calcValueByPos",value:function(o){var l=this.props.reverse?-1:1,v=l*(o-this.getSliderStart()),h=this.trimAlignValue(this.calcValue(v));return h}},{key:"calcOffset",value:function(o){var l=this.props,v=l.min,h=l.max,f=(o-v)/(h-v);return Math.max(0,f*100)}},{key:"saveHandle",value:function(o,l){this.handlesRefs[o]=l}},{key:"render",value:function(){var o,l=this.props,v=l.prefixCls,h=l.className,f=l.marks,d=l.dots,g=l.step,E=l.included,S=l.disabled,x=l.vertical,m=l.reverse,c=l.min,p=l.max,y=l.children,u=l.maximumTrackStyle,_=l.style,b=l.railStyle,T=l.dotStyle,A=l.activeDotStyle,L=(0,Fo.default)((0,Bo.default)(n.prototype),"render",this).call(this),R=L.tracks,w=L.handles,O=(0,pv.default)(v,(o={},(0,Xa.default)(o,"".concat(v,"-with-marks"),Object.keys(f).length),(0,Xa.default)(o,"".concat(v,"-disabled"),S),(0,Xa.default)(o,"".concat(v,"-vertical"),x),(0,Xa.default)(o,h,h),o));return Wn.default.createElement("div",{ref:this.saveSlider,className:O,onTouchStart:S?Vr:this.onTouchStart,onMouseDown:S?Vr:this.onMouseDown,onMouseUp:S?Vr:this.onMouseUp,onKeyDown:S?Vr:this.onKeyDown,onFocus:S?Vr:this.onFocus,onBlur:S?Vr:this.onBlur,style:_},Wn.default.createElement("div",{className:"".concat(v,"-rail"),style:(0,Ya.default)((0,Ya.default)({},u),b)}),R,Wn.default.createElement(gv.default,{prefixCls:v,vertical:x,reverse:m,marks:f,dots:d,step:g,included:E,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:p,min:c,dotStyle:T,activeDotStyle:A}),w,Wn.default.createElement(mv.default,{className:"".concat(v,"-mark"),onClickLabel:S?Vr:this.onClickMarkLabel,vertical:x,marks:f,included:E,lowerBound:this.getLowerBound(),upperBound:this.getUpperBound(),max:p,min:c,reverse:m}),y)}}]),n}(s),e.displayName="ComponentEnhancer(".concat(s.displayName,")"),e.defaultProps=(0,Ya.default)((0,Ya.default)({},s.defaultProps),{},{prefixCls:"rc-slider",className:"",min:0,max:100,step:1,marks:{},handle:function(t){var n=t.index,a=(0,lv.default)(t,Ev);return delete a.dragging,a.value===null?null:Wn.default.createElement(yv.default,(0,ov.default)({},a,{key:n}))},onBeforeChange:Vr,onChange:Vr,onAfterChange:Vr,included:!0,disabled:!1,dots:!1,vertical:!1,reverse:!1,trackStyle:[{}],handleStyle:[{}],railStyle:{},dotStyle:{},activeDotStyle:{}}),r}var xv=Ao.exports,ti=fi.exports;Object.defineProperty(To,"__esModule",{value:!0});var Uo=To.default=void 0,tn=ti(Ti.exports),bv=ti(Na.exports),Sv=ti(Fa.exports),Tv=ti(Ba.exports),Av=ti(Ua.exports),ju=ti(Ye.exports),Wu=ti(_r),wv=ti(Wa),Ov=ti(Io),rn=xv(zt),Lv=function(s){(0,Tv.default)(r,s);var e=(0,Av.default)(r);function r(i){var t;(0,bv.default)(this,r),t=e.call(this,i),t.positionGetValue=function(o){return[]},t.startValue=void 0,t.startPosition=void 0,t.prevMovedHandleIndex=void 0,t.onEnd=function(o){var l=t.state.dragging;t.removeDocumentEvents(),(l||o)&&t.props.onAfterChange(t.getValue()),t.setState({dragging:!1})};var n=i.defaultValue!==void 0?i.defaultValue:i.min,a=i.value!==void 0?i.value:n;return t.state={value:t.trimAlignValue(a),dragging:!1},(0,Wu.default)(!("minimumTrackStyle"in i),"minimumTrackStyle will be deprecated, please use trackStyle instead."),(0,Wu.default)(!("maximumTrackStyle"in i),"maximumTrackStyle will be deprecated, please use railStyle instead."),t}return(0,Sv.default)(r,[{key:"calcValueByPos",value:function(t){return 0}},{key:"calcOffset",value:function(t){return 0}},{key:"saveHandle",value:function(t,n){}},{key:"removeDocumentEvents",value:function(){}},{key:"componentDidUpdate",value:function(t,n){var a=this.props,o=a.min,l=a.max,v=a.value,h=a.onChange;if("min"in this.props||"max"in this.props){var f=v!==void 0?v:n.value,d=this.trimAlignValue(f,this.props);d!==n.value&&(this.setState({value:d}),!(o===t.min&&l===t.max)&&rn.isValueOutOfRange(f,this.props)&&h(d))}}},{key:"onChange",value:function(t){var n=this.props,a=!("value"in n),o=t.value>this.props.max?(0,tn.default)((0,tn.default)({},t),{},{value:this.props.max}):t;a&&this.setState(o);var l=o.value;n.onChange(l)}},{key:"onStart",value:function(t){this.setState({dragging:!0});var n=this.props,a=this.getValue();n.onBeforeChange(a);var o=this.calcValueByPos(t);this.startValue=o,this.startPosition=t,o!==a&&(this.prevMovedHandleIndex=0,this.onChange({value:o}))}},{key:"onMove",value:function(t,n){rn.pauseEvent(t);var a=this.state.value,o=this.calcValueByPos(n);o!==a&&this.onChange({value:o})}},{key:"onKeyboard",value:function(t){var n=this.props,a=n.reverse,o=n.vertical,l=rn.getKeyboardValueMutator(t,o,a);if(l){rn.pauseEvent(t);var v=this.state,h=v.value,f=l(h,this.props),d=this.trimAlignValue(f);if(d===h)return;this.onChange({value:d}),this.props.onAfterChange(d),this.onEnd()}}},{key:"getValue",value:function(){return this.state.value}},{key:"getLowerBound",value:function(){var t=this.props.startPoint||this.props.min;return this.state.value>t?t:this.state.value}},{key:"getUpperBound",value:function(){return this.state.value<this.props.startPoint?this.props.startPoint:this.state.value}},{key:"trimAlignValue",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t===null)return null;var a=(0,tn.default)((0,tn.default)({},this.props),n),o=rn.ensureValueInRange(t,a);return rn.ensureValuePrecision(o,a)}},{key:"render",value:function(){var t=this,n=this.props,a=n.prefixCls,o=n.vertical,l=n.included,v=n.disabled,h=n.minimumTrackStyle,f=n.trackStyle,d=n.handleStyle,g=n.tabIndex,E=n.ariaLabelForHandle,S=n.ariaLabelledByForHandle,x=n.ariaValueTextFormatterForHandle,m=n.min,c=n.max,p=n.startPoint,y=n.reverse,u=n.handle,_=this.state,b=_.value,T=_.dragging,A=this.calcOffset(b),L=u({className:"".concat(a,"-handle"),prefixCls:a,vertical:o,offset:A,value:b,dragging:T,disabled:v,min:m,max:c,reverse:y,index:0,tabIndex:g,ariaLabel:E,ariaLabelledBy:S,ariaValueTextFormatter:x,style:d[0]||d,ref:function(D){return t.saveHandle(0,D)}}),R=p!==void 0?this.calcOffset(p):0,w=f[0]||f,O=ju.default.createElement(wv.default,{className:"".concat(a,"-track"),vertical:o,included:l,offset:R,reverse:y,length:A-R,style:(0,tn.default)((0,tn.default)({},h),w)});return{tracks:O,handles:L}}}]),r}(ju.default.Component),Iv=(0,Ov.default)(Lv);Uo=To.default=Iv;function zu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function Rv(s){if(Array.isArray(s))return s}function Dv(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(l){n=!0,o=l}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function Vu(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function Cv(s,e){if(!!s){if(typeof s=="string")return Vu(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vu(s,e)}}function Pv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mv(s,e){return Rv(s)||Dv(s,e)||Cv(s,e)||Pv()}function kv(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Nv(s,e){if(s==null)return{};var r=kv(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function Fv(s){if(Array.isArray(s))return s}function Bv(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(l){n=!0,o=l}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function Ku(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function Uv(s,e){if(!!s){if(typeof s=="string")return Ku(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ku(s,e)}}function jv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wv(s,e){return Fv(s)||Bv(s,e)||Uv(s,e)||jv()}function zv(s,e){var r=e||{},i=r.defaultValue,t=r.value,n=r.onChange,a=r.postState,o=Ye.exports.useState(function(){return t!==void 0?t:i!==void 0?typeof i=="function"?i():i:typeof s=="function"?s():s}),l=Wv(o,2),v=l[0],h=l[1],f=t!==void 0?t:v;a&&(f=a(f));function d(E){h(E),f!==E&&n&&n(E,f)}var g=Ye.exports.useRef(!0);return Ye.exports.useEffect(function(){if(g.current){g.current=!1;return}t===void 0&&h(t)},[t]),[f,d]}var Xe={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var r=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||r>=Xe.F1&&r<=Xe.F12)return!1;switch(r){case Xe.ALT:case Xe.CAPS_LOCK:case Xe.CONTEXT_MENU:case Xe.CTRL:case Xe.DOWN:case Xe.END:case Xe.ESC:case Xe.HOME:case Xe.INSERT:case Xe.LEFT:case Xe.MAC_FF_META:case Xe.META:case Xe.NUMLOCK:case Xe.NUM_CENTER:case Xe.PAGE_DOWN:case Xe.PAGE_UP:case Xe.PAUSE:case Xe.PRINT_SCREEN:case Xe.RIGHT:case Xe.SHIFT:case Xe.UP:case Xe.WIN_KEY:case Xe.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=Xe.ZERO&&e<=Xe.NINE||e>=Xe.NUM_ZERO&&e<=Xe.NUM_MULTIPLY||e>=Xe.A&&e<=Xe.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case Xe.SPACE:case Xe.QUESTION_MARK:case Xe.NUM_PLUS:case Xe.NUM_MINUS:case Xe.NUM_PERIOD:case Xe.NUM_DIVISION:case Xe.SEMICOLON:case Xe.DASH:case Xe.EQUALS:case Xe.COMMA:case Xe.PERIOD:case Xe.SLASH:case Xe.APOSTROPHE:case Xe.SINGLE_QUOTE:case Xe.OPEN_SQUARE_BRACKET:case Xe.BACKSLASH:case Xe.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},Hu=Ye.exports.forwardRef(function(s,e){var r,i=s.prefixCls,t=i===void 0?"rc-switch":i,n=s.className,a=s.checked,o=s.defaultChecked,l=s.disabled,v=s.loadingIcon,h=s.checkedChildren,f=s.unCheckedChildren,d=s.onClick,g=s.onChange,E=s.onKeyDown,S=Nv(s,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),x=zv(!1,{value:a,defaultValue:o}),m=Mv(x,2),c=m[0],p=m[1];function y(T,A){var L=c;return l||(L=T,p(L),g==null||g(L,A)),L}function u(T){T.which===Xe.LEFT?y(!1,T):T.which===Xe.RIGHT&&y(!0,T),E==null||E(T)}function _(T){var A=y(!c,T);d==null||d(A,T)}var b=Ft(t,n,(r={},zu(r,"".concat(t,"-checked"),c),zu(r,"".concat(t,"-disabled"),l),r));return Ye.exports.createElement("button",Object.assign({},S,{type:"button",role:"switch","aria-checked":c,disabled:l,className:b,ref:e,onKeyDown:u,onClick:_}),v,Ye.exports.createElement("span",{className:"".concat(t,"-inner")},c?h:f))});Hu.displayName="Switch";var Qa={exports:{}},$u={},Vv=Eo(lp),bt={},Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.findInArray=Kv;Kr.isFunction=Hv;Kr.isNum=$v;Kr.int=Gv;Kr.dontSetMe=Yv;function Kv(s,e){for(var r=0,i=s.length;r<i;r++)if(e.apply(e,[s[r],r,s]))return s[r]}function Hv(s){return typeof s=="function"||Object.prototype.toString.call(s)==="[object Function]"}function $v(s){return typeof s=="number"&&!isNaN(s)}function Gv(s){return parseInt(s,10)}function Yv(s,e,r){if(s[e])return new Error("Invalid prop ".concat(e," passed to ").concat(r," - do not set this, set it on the child."))}var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.getPrefix=Gu;Oi.browserPrefixToKey=Yu;Oi.browserPrefixToStyle=Xv;Oi.default=void 0;var jo=["Moz","Webkit","O","ms"];function Gu(){var s,e,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window=="undefined")return"";var i=(s=window.document)===null||s===void 0||(e=s.documentElement)===null||e===void 0?void 0:e.style;if(!i||r in i)return"";for(var t=0;t<jo.length;t++)if(Yu(r,jo[t])in i)return jo[t];return""}function Yu(s,e){return e?"".concat(e).concat(Zv(s)):s}function Xv(s,e){return e?"-".concat(e.toLowerCase(),"-").concat(s):s}function Zv(s){for(var e="",r=!0,i=0;i<s.length;i++)r?(e+=s[i].toUpperCase(),r=!1):s[i]==="-"?r=!0:e+=s[i];return e}var Qv=Gu();Oi.default=Qv;function Ja(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ja=function(r){return typeof r}:Ja=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ja(s)}Object.defineProperty(bt,"__esModule",{value:!0});bt.matchesSelector=ef;bt.matchesSelectorAndParentsTo=qv;bt.addEvent=eg;bt.removeEvent=tg;bt.outerHeight=rg;bt.outerWidth=ig;bt.innerHeight=ng;bt.innerWidth=ag;bt.offsetXYFromParent=sg;bt.createCSSTransform=og;bt.createSVGTransform=lg;bt.getTranslation=Wo;bt.getTouch=ug;bt.getTouchIdentifier=fg;bt.addUserSelectStyles=dg;bt.removeUserSelectStyles=cg;bt.addClassName=tf;bt.removeClassName=rf;var sr=Kr,Xu=Jv(Oi);function Zu(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Zu=function(t){return t?r:e})(s)}function Jv(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||Ja(s)!=="object"&&typeof s!="function")return{default:s};var r=Zu(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function Qu(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function Ju(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qu(Object(r),!0).forEach(function(i){qu(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Qu(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function qu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var qa="";function ef(s,e){return qa||(qa=(0,sr.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,sr.isFunction)(s[r])})),(0,sr.isFunction)(s[qa])?s[qa](e):!1}function qv(s,e,r){var i=s;do{if(ef(i,e))return!0;if(i===r)return!1;i=i.parentNode}while(i);return!1}function eg(s,e,r,i){if(!!s){var t=Ju({capture:!0},i);s.addEventListener?s.addEventListener(e,r,t):s.attachEvent?s.attachEvent("on"+e,r):s["on"+e]=r}}function tg(s,e,r,i){if(!!s){var t=Ju({capture:!0},i);s.removeEventListener?s.removeEventListener(e,r,t):s.detachEvent?s.detachEvent("on"+e,r):s["on"+e]=null}}function rg(s){var e=s.clientHeight,r=s.ownerDocument.defaultView.getComputedStyle(s);return e+=(0,sr.int)(r.borderTopWidth),e+=(0,sr.int)(r.borderBottomWidth),e}function ig(s){var e=s.clientWidth,r=s.ownerDocument.defaultView.getComputedStyle(s);return e+=(0,sr.int)(r.borderLeftWidth),e+=(0,sr.int)(r.borderRightWidth),e}function ng(s){var e=s.clientHeight,r=s.ownerDocument.defaultView.getComputedStyle(s);return e-=(0,sr.int)(r.paddingTop),e-=(0,sr.int)(r.paddingBottom),e}function ag(s){var e=s.clientWidth,r=s.ownerDocument.defaultView.getComputedStyle(s);return e-=(0,sr.int)(r.paddingLeft),e-=(0,sr.int)(r.paddingRight),e}function sg(s,e,r){var i=e===e.ownerDocument.body,t=i?{left:0,top:0}:e.getBoundingClientRect(),n=(s.clientX+e.scrollLeft-t.left)/r,a=(s.clientY+e.scrollTop-t.top)/r;return{x:n,y:a}}function og(s,e){var r=Wo(s,e,"px");return qu({},(0,Xu.browserPrefixToKey)("transform",Xu.default),r)}function lg(s,e){var r=Wo(s,e,"");return r}function Wo(s,e,r){var i=s.x,t=s.y,n="translate(".concat(i).concat(r,",").concat(t).concat(r,")");if(e){var a="".concat(typeof e.x=="string"?e.x:e.x+r),o="".concat(typeof e.y=="string"?e.y:e.y+r);n="translate(".concat(a,", ").concat(o,")")+n}return n}function ug(s,e){return s.targetTouches&&(0,sr.findInArray)(s.targetTouches,function(r){return e===r.identifier})||s.changedTouches&&(0,sr.findInArray)(s.changedTouches,function(r){return e===r.identifier})}function fg(s){if(s.targetTouches&&s.targetTouches[0])return s.targetTouches[0].identifier;if(s.changedTouches&&s.changedTouches[0])return s.changedTouches[0].identifier}function dg(s){if(!!s){var e=s.getElementById("react-draggable-style-el");e||(e=s.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,s.getElementsByTagName("head")[0].appendChild(e)),s.body&&tf(s.body,"react-draggable-transparent-selection")}}function cg(s){if(!!s)try{if(s.body&&rf(s.body,"react-draggable-transparent-selection"),s.selection)s.selection.empty();else{var e=(s.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch(r){}}function tf(s,e){s.classList?s.classList.add(e):s.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(s.className+=" ".concat(e))}function rf(s,e){s.classList?s.classList.remove(e):s.className=s.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.getBoundPosition=hg;Hr.snapToGrid=pg;Hr.canDragX=vg;Hr.canDragY=gg;Hr.getControlPosition=mg;Hr.createCoreData=yg;Hr.createDraggableData=Eg;var or=Kr,nn=bt;function hg(s,e,r){if(!s.props.bounds)return[e,r];var i=s.props.bounds;i=typeof i=="string"?i:_g(i);var t=zo(s);if(typeof i=="string"){var n=t.ownerDocument,a=n.defaultView,o;if(i==="parent"?o=t.parentNode:o=n.querySelector(i),!(o instanceof a.HTMLElement))throw new Error('Bounds selector "'+i+'" could not find an element.');var l=o,v=a.getComputedStyle(t),h=a.getComputedStyle(l);i={left:-t.offsetLeft+(0,or.int)(h.paddingLeft)+(0,or.int)(v.marginLeft),top:-t.offsetTop+(0,or.int)(h.paddingTop)+(0,or.int)(v.marginTop),right:(0,nn.innerWidth)(l)-(0,nn.outerWidth)(t)-t.offsetLeft+(0,or.int)(h.paddingRight)-(0,or.int)(v.marginRight),bottom:(0,nn.innerHeight)(l)-(0,nn.outerHeight)(t)-t.offsetTop+(0,or.int)(h.paddingBottom)-(0,or.int)(v.marginBottom)}}return(0,or.isNum)(i.right)&&(e=Math.min(e,i.right)),(0,or.isNum)(i.bottom)&&(r=Math.min(r,i.bottom)),(0,or.isNum)(i.left)&&(e=Math.max(e,i.left)),(0,or.isNum)(i.top)&&(r=Math.max(r,i.top)),[e,r]}function pg(s,e,r){var i=Math.round(e/s[0])*s[0],t=Math.round(r/s[1])*s[1];return[i,t]}function vg(s){return s.props.axis==="both"||s.props.axis==="x"}function gg(s){return s.props.axis==="both"||s.props.axis==="y"}function mg(s,e,r){var i=typeof e=="number"?(0,nn.getTouch)(s,e):null;if(typeof e=="number"&&!i)return null;var t=zo(r),n=r.props.offsetParent||t.offsetParent||t.ownerDocument.body;return(0,nn.offsetXYFromParent)(i||s,n,r.props.scale)}function yg(s,e,r){var i=s.state,t=!(0,or.isNum)(i.lastX),n=zo(s);return t?{node:n,deltaX:0,deltaY:0,lastX:e,lastY:r,x:e,y:r}:{node:n,deltaX:e-i.lastX,deltaY:r-i.lastY,lastX:i.lastX,lastY:i.lastY,x:e,y:r}}function Eg(s,e){var r=s.props.scale;return{node:e.node,x:s.state.x+e.deltaX/r,y:s.state.y+e.deltaY/r,deltaX:e.deltaX/r,deltaY:e.deltaY/r,lastX:s.state.x,lastY:s.state.y}}function _g(s){return{left:s.left,top:s.top,right:s.right,bottom:s.bottom}}function zo(s){var e=s.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var es={},ts={};Object.defineProperty(ts,"__esModule",{value:!0});ts.default=xg;function xg(){}function zn(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?zn=function(r){return typeof r}:zn=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},zn(s)}Object.defineProperty(es,"__esModule",{value:!0});es.default=void 0;var Vo=Sg(Ye.exports),lr=Ho(cu.exports),bg=Ho(kn.exports),Vt=bt,Li=Hr,Ko=Kr,Vn=Ho(ts);function Ho(s){return s&&s.__esModule?s:{default:s}}function nf(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(nf=function(t){return t?r:e})(s)}function Sg(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||zn(s)!=="object"&&typeof s!="function")return{default:s};var r=nf(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function Tg(s,e){return Lg(s)||Og(s,e)||wg(s,e)||Ag()}function Ag(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wg(s,e){if(!!s){if(typeof s=="string")return af(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return af(s,e)}}function af(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function Og(s,e){var r=s==null?null:typeof Symbol!="undefined"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var i=[],t=!0,n=!1,a,o;try{for(r=r.call(s);!(t=(a=r.next()).done)&&(i.push(a.value),!(e&&i.length===e));t=!0);}catch(l){n=!0,o=l}finally{try{!t&&r.return!=null&&r.return()}finally{if(n)throw o}}return i}}function Lg(s){if(Array.isArray(s))return s}function Ig(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function sf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function Rg(s,e,r){return e&&sf(s.prototype,e),r&&sf(s,r),s}function Dg(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),e&&$o(s,e)}function $o(s,e){return $o=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},$o(s,e)}function Cg(s){var e=Mg();return function(){var i=rs(s),t;if(e){var n=rs(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return Pg(this,t)}}function Pg(s,e){if(e&&(zn(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kt(s)}function Kt(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Mg(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function rs(s){return rs=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},rs(s)}function xr(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var Pr={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},ci=Pr.mouse,is=function(s){Dg(r,s);var e=Cg(r);function r(){var i;Ig(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),xr(Kt(i),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),xr(Kt(i),"mounted",!1),xr(Kt(i),"handleDragStart",function(o){if(i.props.onMouseDown(o),!i.props.allowAnyClick&&typeof o.button=="number"&&o.button!==0)return!1;var l=i.findDOMNode();if(!l||!l.ownerDocument||!l.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var v=l.ownerDocument;if(!(i.props.disabled||!(o.target instanceof v.defaultView.Node)||i.props.handle&&!(0,Vt.matchesSelectorAndParentsTo)(o.target,i.props.handle,l)||i.props.cancel&&(0,Vt.matchesSelectorAndParentsTo)(o.target,i.props.cancel,l))){o.type==="touchstart"&&o.preventDefault();var h=(0,Vt.getTouchIdentifier)(o);i.setState({touchIdentifier:h});var f=(0,Li.getControlPosition)(o,h,Kt(i));if(f!=null){var d=f.x,g=f.y,E=(0,Li.createCoreData)(Kt(i),d,g);(0,Vn.default)("DraggableCore: handleDragStart: %j",E),(0,Vn.default)("calling",i.props.onStart);var S=i.props.onStart(o,E);S===!1||i.mounted===!1||(i.props.enableUserSelectHack&&(0,Vt.addUserSelectStyles)(v),i.setState({dragging:!0,lastX:d,lastY:g}),(0,Vt.addEvent)(v,ci.move,i.handleDrag),(0,Vt.addEvent)(v,ci.stop,i.handleDragStop))}}}),xr(Kt(i),"handleDrag",function(o){var l=(0,Li.getControlPosition)(o,i.state.touchIdentifier,Kt(i));if(l!=null){var v=l.x,h=l.y;if(Array.isArray(i.props.grid)){var f=v-i.state.lastX,d=h-i.state.lastY,g=(0,Li.snapToGrid)(i.props.grid,f,d),E=Tg(g,2);if(f=E[0],d=E[1],!f&&!d)return;v=i.state.lastX+f,h=i.state.lastY+d}var S=(0,Li.createCoreData)(Kt(i),v,h);(0,Vn.default)("DraggableCore: handleDrag: %j",S);var x=i.props.onDrag(o,S);if(x===!1||i.mounted===!1){try{i.handleDragStop(new MouseEvent("mouseup"))}catch(c){var m=document.createEvent("MouseEvents");m.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.handleDragStop(m)}return}i.setState({lastX:v,lastY:h})}}),xr(Kt(i),"handleDragStop",function(o){if(!!i.state.dragging){var l=(0,Li.getControlPosition)(o,i.state.touchIdentifier,Kt(i));if(l!=null){var v=l.x,h=l.y,f=(0,Li.createCoreData)(Kt(i),v,h),d=i.props.onStop(o,f);if(d===!1||i.mounted===!1)return!1;var g=i.findDOMNode();g&&i.props.enableUserSelectHack&&(0,Vt.removeUserSelectStyles)(g.ownerDocument),(0,Vn.default)("DraggableCore: handleDragStop: %j",f),i.setState({dragging:!1,lastX:NaN,lastY:NaN}),g&&((0,Vn.default)("DraggableCore: Removing handlers"),(0,Vt.removeEvent)(g.ownerDocument,ci.move,i.handleDrag),(0,Vt.removeEvent)(g.ownerDocument,ci.stop,i.handleDragStop))}}}),xr(Kt(i),"onMouseDown",function(o){return ci=Pr.mouse,i.handleDragStart(o)}),xr(Kt(i),"onMouseUp",function(o){return ci=Pr.mouse,i.handleDragStop(o)}),xr(Kt(i),"onTouchStart",function(o){return ci=Pr.touch,i.handleDragStart(o)}),xr(Kt(i),"onTouchEnd",function(o){return ci=Pr.touch,i.handleDragStop(o)}),i}return Rg(r,[{key:"componentDidMount",value:function(){this.mounted=!0;var t=this.findDOMNode();t&&(0,Vt.addEvent)(t,Pr.touch.start,this.onTouchStart,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var t=this.findDOMNode();if(t){var n=t.ownerDocument;(0,Vt.removeEvent)(n,Pr.mouse.move,this.handleDrag),(0,Vt.removeEvent)(n,Pr.touch.move,this.handleDrag),(0,Vt.removeEvent)(n,Pr.mouse.stop,this.handleDragStop),(0,Vt.removeEvent)(n,Pr.touch.stop,this.handleDragStop),(0,Vt.removeEvent)(t,Pr.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,Vt.removeUserSelectStyles)(n)}}},{key:"findDOMNode",value:function(){var t,n,a;return(t=(n=this.props)===null||n===void 0||(a=n.nodeRef)===null||a===void 0?void 0:a.current)!==null&&t!==void 0?t:bg.default.findDOMNode(this)}},{key:"render",value:function(){return Vo.cloneElement(Vo.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}]),r}(Vo.Component);es.default=is;xr(is,"displayName","DraggableCore");xr(is,"propTypes",{allowAnyClick:lr.default.bool,disabled:lr.default.bool,enableUserSelectHack:lr.default.bool,offsetParent:function(e,r){if(e[r]&&e[r].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:lr.default.arrayOf(lr.default.number),handle:lr.default.string,cancel:lr.default.string,nodeRef:lr.default.object,onStart:lr.default.func,onDrag:lr.default.func,onStop:lr.default.func,onMouseDown:lr.default.func,scale:lr.default.number,className:Ko.dontSetMe,style:Ko.dontSetMe,transform:Ko.dontSetMe});xr(is,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(s){function e(F){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(V){return typeof V}:e=function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},e(F)}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"DraggableCore",{enumerable:!0,get:function(){return v.default}}),s.default=void 0;var r=E(Ye.exports),i=d(cu.exports),t=d(kn.exports),n=d(Vv),a=bt,o=Hr,l=Kr,v=d(es),h=d(ts),f=["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"];function d(F){return F&&F.__esModule?F:{default:F}}function g(F){if(typeof WeakMap!="function")return null;var j=new WeakMap,V=new WeakMap;return(g=function(Y){return Y?V:j})(F)}function E(F,j){if(!j&&F&&F.__esModule)return F;if(F===null||e(F)!=="object"&&typeof F!="function")return{default:F};var V=g(j);if(V&&V.has(F))return V.get(F);var G={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in F)if(X!=="default"&&Object.prototype.hasOwnProperty.call(F,X)){var ie=Y?Object.getOwnPropertyDescriptor(F,X):null;ie&&(ie.get||ie.set)?Object.defineProperty(G,X,ie):G[X]=F[X]}return G.default=F,V&&V.set(F,G),G}function S(){return S=Object.assign||function(F){for(var j=1;j<arguments.length;j++){var V=arguments[j];for(var G in V)Object.prototype.hasOwnProperty.call(V,G)&&(F[G]=V[G])}return F},S.apply(this,arguments)}function x(F,j){if(F==null)return{};var V=m(F,j),G,Y;if(Object.getOwnPropertySymbols){var X=Object.getOwnPropertySymbols(F);for(Y=0;Y<X.length;Y++)G=X[Y],!(j.indexOf(G)>=0)&&(!Object.prototype.propertyIsEnumerable.call(F,G)||(V[G]=F[G]))}return V}function m(F,j){if(F==null)return{};var V={},G=Object.keys(F),Y,X;for(X=0;X<G.length;X++)Y=G[X],!(j.indexOf(Y)>=0)&&(V[Y]=F[Y]);return V}function c(F,j){var V=Object.keys(F);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(F);j&&(G=G.filter(function(Y){return Object.getOwnPropertyDescriptor(F,Y).enumerable})),V.push.apply(V,G)}return V}function p(F){for(var j=1;j<arguments.length;j++){var V=arguments[j]!=null?arguments[j]:{};j%2?c(Object(V),!0).forEach(function(G){B(F,G,V[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors(V)):c(Object(V)).forEach(function(G){Object.defineProperty(F,G,Object.getOwnPropertyDescriptor(V,G))})}return F}function y(F,j){return A(F)||T(F,j)||_(F,j)||u()}function u(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _(F,j){if(!!F){if(typeof F=="string")return b(F,j);var V=Object.prototype.toString.call(F).slice(8,-1);if(V==="Object"&&F.constructor&&(V=F.constructor.name),V==="Map"||V==="Set")return Array.from(F);if(V==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(V))return b(F,j)}}function b(F,j){(j==null||j>F.length)&&(j=F.length);for(var V=0,G=new Array(j);V<j;V++)G[V]=F[V];return G}function T(F,j){var V=F==null?null:typeof Symbol!="undefined"&&F[Symbol.iterator]||F["@@iterator"];if(V!=null){var G=[],Y=!0,X=!1,ie,he;try{for(V=V.call(F);!(Y=(ie=V.next()).done)&&(G.push(ie.value),!(j&&G.length===j));Y=!0);}catch(de){X=!0,he=de}finally{try{!Y&&V.return!=null&&V.return()}finally{if(X)throw he}}return G}}function A(F){if(Array.isArray(F))return F}function L(F,j){if(!(F instanceof j))throw new TypeError("Cannot call a class as a function")}function R(F,j){for(var V=0;V<j.length;V++){var G=j[V];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(F,G.key,G)}}function w(F,j,V){return j&&R(F.prototype,j),V&&R(F,V),F}function O(F,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(j&&j.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),j&&I(F,j)}function I(F,j){return I=Object.setPrototypeOf||function(G,Y){return G.__proto__=Y,G},I(F,j)}function D(F){var j=M();return function(){var G=N(F),Y;if(j){var X=N(this).constructor;Y=Reflect.construct(G,arguments,X)}else Y=G.apply(this,arguments);return C(this,Y)}}function C(F,j){if(j&&(e(j)==="object"||typeof j=="function"))return j;if(j!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P(F)}function P(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}function M(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(F){return!1}}function N(F){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(V){return V.__proto__||Object.getPrototypeOf(V)},N(F)}function B(F,j,V){return j in F?Object.defineProperty(F,j,{value:V,enumerable:!0,configurable:!0,writable:!0}):F[j]=V,F}var U=function(F){O(V,F);var j=D(V);function V(G){var Y;return L(this,V),Y=j.call(this,G),B(P(Y),"onDragStart",function(X,ie){(0,h.default)("Draggable: onDragStart: %j",ie);var he=Y.props.onStart(X,(0,o.createDraggableData)(P(Y),ie));if(he===!1)return!1;Y.setState({dragging:!0,dragged:!0})}),B(P(Y),"onDrag",function(X,ie){if(!Y.state.dragging)return!1;(0,h.default)("Draggable: onDrag: %j",ie);var he=(0,o.createDraggableData)(P(Y),ie),de={x:he.x,y:he.y};if(Y.props.bounds){var Ae=de.x,pe=de.y;de.x+=Y.state.slackX,de.y+=Y.state.slackY;var le=(0,o.getBoundPosition)(P(Y),de.x,de.y),Ie=y(le,2),Ce=Ie[0],Ue=Ie[1];de.x=Ce,de.y=Ue,de.slackX=Y.state.slackX+(Ae-de.x),de.slackY=Y.state.slackY+(pe-de.y),he.x=de.x,he.y=de.y,he.deltaX=de.x-Y.state.x,he.deltaY=de.y-Y.state.y}var Me=Y.props.onDrag(X,he);if(Me===!1)return!1;Y.setState(de)}),B(P(Y),"onDragStop",function(X,ie){if(!Y.state.dragging)return!1;var he=Y.props.onStop(X,(0,o.createDraggableData)(P(Y),ie));if(he===!1)return!1;(0,h.default)("Draggable: onDragStop: %j",ie);var de={dragging:!1,slackX:0,slackY:0},Ae=Boolean(Y.props.position);if(Ae){var pe=Y.props.position,le=pe.x,Ie=pe.y;de.x=le,de.y=Ie}Y.setState(de)}),Y.state={dragging:!1,dragged:!1,x:G.position?G.position.x:G.defaultPosition.x,y:G.position?G.position.y:G.defaultPosition.y,prevPropsPosition:p({},G.position),slackX:0,slackY:0,isElementSVG:!1},G.position&&!(G.onDrag||G.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),Y}return w(V,[{key:"componentDidMount",value:function(){typeof window.SVGElement!="undefined"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"findDOMNode",value:function(){var Y,X,ie;return(Y=(X=this.props)===null||X===void 0||(ie=X.nodeRef)===null||ie===void 0?void 0:ie.current)!==null&&Y!==void 0?Y:t.default.findDOMNode(this)}},{key:"render",value:function(){var Y,X=this.props;X.axis,X.bounds;var ie=X.children,he=X.defaultPosition,de=X.defaultClassName,Ae=X.defaultClassNameDragging,pe=X.defaultClassNameDragged,le=X.position,Ie=X.positionOffset;X.scale;var Ce=x(X,f),Ue={},Me=null,ze=Boolean(le),Ge=!ze||this.state.dragging,$e=le||he,Ke={x:(0,o.canDragX)(this)&&Ge?this.state.x:$e.x,y:(0,o.canDragY)(this)&&Ge?this.state.y:$e.y};this.state.isElementSVG?Me=(0,a.createSVGTransform)(Ke,Ie):Ue=(0,a.createCSSTransform)(Ke,Ie);var Ne=(0,n.default)(ie.props.className||"",de,(Y={},B(Y,Ae,this.state.dragging),B(Y,pe,this.state.dragged),Y));return r.createElement(v.default,S({},Ce,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),r.cloneElement(r.Children.only(ie),{className:Ne,style:p(p({},ie.props.style),Ue),transform:Me}))}}],[{key:"getDerivedStateFromProps",value:function(Y,X){var ie=Y.position,he=X.prevPropsPosition;return ie&&(!he||ie.x!==he.x||ie.y!==he.y)?((0,h.default)("Draggable: getDerivedStateFromProps %j",{position:ie,prevPropsPosition:he}),{x:ie.x,y:ie.y,prevPropsPosition:p({},ie)}):null}}]),V}(r.Component);s.default=U,B(U,"displayName","Draggable"),B(U,"propTypes",p(p({},v.default.propTypes),{},{axis:i.default.oneOf(["both","x","y","none"]),bounds:i.default.oneOfType([i.default.shape({left:i.default.number,right:i.default.number,top:i.default.number,bottom:i.default.number}),i.default.string,i.default.oneOf([!1])]),defaultClassName:i.default.string,defaultClassNameDragging:i.default.string,defaultClassNameDragged:i.default.string,defaultPosition:i.default.shape({x:i.default.number,y:i.default.number}),positionOffset:i.default.shape({x:i.default.oneOfType([i.default.number,i.default.string]),y:i.default.oneOfType([i.default.number,i.default.string])}),position:i.default.shape({x:i.default.number,y:i.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe})),B(U,"defaultProps",p(p({},v.default.defaultProps),{},{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1}))})($u);var of=$u,lf=of.default,kg=of.DraggableCore;Qa.exports=lf;Qa.exports.default=lf;Qa.exports.DraggableCore=kg;var uf=Qa.exports;/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ff(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function $r(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ff(Object(r),!0).forEach(function(i){Ng(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):ff(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function ns(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ns=function(e){return typeof e}:ns=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ns(s)}function Ng(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function Gr(){return Gr=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Gr.apply(this,arguments)}function Fg(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Bg(s,e){if(s==null)return{};var r=Fg(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}var Ug="1.14.0";function ri(s){if(typeof window!="undefined"&&window.navigator)return!!navigator.userAgent.match(s)}var ii=ri(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Kn=ri(/Edge/i),df=ri(/firefox/i),Hn=ri(/safari/i)&&!ri(/chrome/i)&&!ri(/android/i),cf=ri(/iP(ad|od|hone)/i),jg=ri(/chrome/i)&&ri(/android/i),hf={capture:!1,passive:!1};function ut(s,e,r){s.addEventListener(e,r,!ii&&hf)}function lt(s,e,r){s.removeEventListener(e,r,!ii&&hf)}function as(s,e){if(!!e){if(e[0]===">"&&(e=e.substring(1)),s)try{if(s.matches)return s.matches(e);if(s.msMatchesSelector)return s.msMatchesSelector(e);if(s.webkitMatchesSelector)return s.webkitMatchesSelector(e)}catch(r){return!1}return!1}}function Wg(s){return s.host&&s!==document&&s.host.nodeType?s.host:s.parentNode}function Yr(s,e,r,i){if(s){r=r||document;do{if(e!=null&&(e[0]===">"?s.parentNode===r&&as(s,e):as(s,e))||i&&s===r)return s;if(s===r)break}while(s=Wg(s))}return null}var pf=/\s+/g;function Ht(s,e,r){if(s&&e)if(s.classList)s.classList[r?"add":"remove"](e);else{var i=(" "+s.className+" ").replace(pf," ").replace(" "+e+" "," ");s.className=(i+(r?" "+e:"")).replace(pf," ")}}function Je(s,e,r){var i=s&&s.style;if(i){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(s,""):s.currentStyle&&(r=s.currentStyle),e===void 0?r:r[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=r+(typeof r=="string"?"":"px")}}function an(s,e){var r="";if(typeof s=="string")r=s;else do{var i=Je(s,"transform");i&&i!=="none"&&(r=i+" "+r)}while(!e&&(s=s.parentNode));var t=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return t&&new t(r)}function vf(s,e,r){if(s){var i=s.getElementsByTagName(e),t=0,n=i.length;if(r)for(;t<n;t++)r(i[t],t);return i}return[]}function Xr(){var s=document.scrollingElement;return s||document.documentElement}function Ct(s,e,r,i,t){if(!(!s.getBoundingClientRect&&s!==window)){var n,a,o,l,v,h,f;if(s!==window&&s.parentNode&&s!==Xr()?(n=s.getBoundingClientRect(),a=n.top,o=n.left,l=n.bottom,v=n.right,h=n.height,f=n.width):(a=0,o=0,l=window.innerHeight,v=window.innerWidth,h=window.innerHeight,f=window.innerWidth),(e||r)&&s!==window&&(t=t||s.parentNode,!ii))do if(t&&t.getBoundingClientRect&&(Je(t,"transform")!=="none"||r&&Je(t,"position")!=="static")){var d=t.getBoundingClientRect();a-=d.top+parseInt(Je(t,"border-top-width")),o-=d.left+parseInt(Je(t,"border-left-width")),l=a+n.height,v=o+n.width;break}while(t=t.parentNode);if(i&&s!==window){var g=an(t||s),E=g&&g.a,S=g&&g.d;g&&(a/=S,o/=E,f/=E,h/=S,l=a+h,v=o+f)}return{top:a,left:o,bottom:l,right:v,width:f,height:h}}}function gf(s,e,r){for(var i=hi(s,!0),t=Ct(s)[e];i;){var n=Ct(i)[r],a=void 0;if(r==="top"||r==="left"?a=t>=n:a=t<=n,!a)return i;if(i===Xr())break;i=hi(i,!1)}return!1}function sn(s,e,r,i){for(var t=0,n=0,a=s.children;n<a.length;){if(a[n].style.display!=="none"&&a[n]!==Qe.ghost&&(i||a[n]!==Qe.dragged)&&Yr(a[n],r.draggable,s,!1)){if(t===e)return a[n];t++}n++}return null}function Go(s,e){for(var r=s.lastElementChild;r&&(r===Qe.ghost||Je(r,"display")==="none"||e&&!as(r,e));)r=r.previousElementSibling;return r||null}function er(s,e){var r=0;if(!s||!s.parentNode)return-1;for(;s=s.previousElementSibling;)s.nodeName.toUpperCase()!=="TEMPLATE"&&s!==Qe.clone&&(!e||as(s,e))&&r++;return r}function mf(s){var e=0,r=0,i=Xr();if(s)do{var t=an(s),n=t.a,a=t.d;e+=s.scrollLeft*n,r+=s.scrollTop*a}while(s!==i&&(s=s.parentNode));return[e,r]}function zg(s,e){for(var r in s)if(!!s.hasOwnProperty(r)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===s[r][i])return Number(r)}return-1}function hi(s,e){if(!s||!s.getBoundingClientRect)return Xr();var r=s,i=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var t=Je(r);if(r.clientWidth<r.scrollWidth&&(t.overflowX=="auto"||t.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(t.overflowY=="auto"||t.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return Xr();if(i||e)return r;i=!0}}while(r=r.parentNode);return Xr()}function Vg(s,e){if(s&&e)for(var r in e)e.hasOwnProperty(r)&&(s[r]=e[r]);return s}function Yo(s,e){return Math.round(s.top)===Math.round(e.top)&&Math.round(s.left)===Math.round(e.left)&&Math.round(s.height)===Math.round(e.height)&&Math.round(s.width)===Math.round(e.width)}var $n;function yf(s,e){return function(){if(!$n){var r=arguments,i=this;r.length===1?s.call(i,r[0]):s.apply(i,r),$n=setTimeout(function(){$n=void 0},e)}}}function Kg(){clearTimeout($n),$n=void 0}function Ef(s,e,r){s.scrollLeft+=e,s.scrollTop+=r}function _f(s){var e=window.Polymer,r=window.jQuery||window.Zepto;return e&&e.dom?e.dom(s).cloneNode(!0):r?r(s).clone(!0)[0]:s.cloneNode(!0)}var ur="Sortable"+new Date().getTime();function Hg(){var s=[],e;return{captureAnimationState:function(){if(s=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(t){if(!(Je(t,"display")==="none"||t===Qe.ghost)){s.push({target:t,rect:Ct(t)});var n=$r({},s[s.length-1].rect);if(t.thisAnimationDuration){var a=an(t,!0);a&&(n.top-=a.f,n.left-=a.e)}t.fromRect=n}})}},addAnimationState:function(i){s.push(i)},removeAnimationState:function(i){s.splice(zg(s,{target:i}),1)},animateAll:function(i){var t=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var n=!1,a=0;s.forEach(function(o){var l=0,v=o.target,h=v.fromRect,f=Ct(v),d=v.prevFromRect,g=v.prevToRect,E=o.rect,S=an(v,!0);S&&(f.top-=S.f,f.left-=S.e),v.toRect=f,v.thisAnimationDuration&&Yo(d,f)&&!Yo(h,f)&&(E.top-f.top)/(E.left-f.left)==(h.top-f.top)/(h.left-f.left)&&(l=Gg(E,d,g,t.options)),Yo(f,h)||(v.prevFromRect=h,v.prevToRect=f,l||(l=t.options.animation),t.animate(v,E,f,l)),l&&(n=!0,a=Math.max(a,l),clearTimeout(v.animationResetTimer),v.animationResetTimer=setTimeout(function(){v.animationTime=0,v.prevFromRect=null,v.fromRect=null,v.prevToRect=null,v.thisAnimationDuration=null},l),v.thisAnimationDuration=l)}),clearTimeout(e),n?e=setTimeout(function(){typeof i=="function"&&i()},a):typeof i=="function"&&i(),s=[]},animate:function(i,t,n,a){if(a){Je(i,"transition",""),Je(i,"transform","");var o=an(this.el),l=o&&o.a,v=o&&o.d,h=(t.left-n.left)/(l||1),f=(t.top-n.top)/(v||1);i.animatingX=!!h,i.animatingY=!!f,Je(i,"transform","translate3d("+h+"px,"+f+"px,0)"),this.forRepaintDummy=$g(i),Je(i,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),Je(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){Je(i,"transition",""),Je(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},a)}}}}function $g(s){return s.offsetWidth}function Gg(s,e,r,i){return Math.sqrt(Math.pow(e.top-s.top,2)+Math.pow(e.left-s.left,2))/Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))*i.animation}var on=[],Xo={initializeByDefault:!0},Gn={mount:function(e){for(var r in Xo)Xo.hasOwnProperty(r)&&!(r in e)&&(e[r]=Xo[r]);on.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),on.push(e)},pluginEvent:function(e,r,i){var t=this;this.eventCanceled=!1,i.cancel=function(){t.eventCanceled=!0};var n=e+"Global";on.forEach(function(a){!r[a.pluginName]||(r[a.pluginName][n]&&r[a.pluginName][n]($r({sortable:r},i)),r.options[a.pluginName]&&r[a.pluginName][e]&&r[a.pluginName][e]($r({sortable:r},i)))})},initializePlugins:function(e,r,i,t){on.forEach(function(o){var l=o.pluginName;if(!(!e.options[l]&&!o.initializeByDefault)){var v=new o(e,r,e.options);v.sortable=e,v.options=e.options,e[l]=v,Gr(i,v.defaults)}});for(var n in e.options)if(!!e.options.hasOwnProperty(n)){var a=this.modifyOption(e,n,e.options[n]);typeof a!="undefined"&&(e.options[n]=a)}},getEventProperties:function(e,r){var i={};return on.forEach(function(t){typeof t.eventProperties=="function"&&Gr(i,t.eventProperties.call(r[t.pluginName],e))}),i},modifyOption:function(e,r,i){var t;return on.forEach(function(n){!e[n.pluginName]||n.optionListeners&&typeof n.optionListeners[r]=="function"&&(t=n.optionListeners[r].call(e[n.pluginName],i))}),t}};function Yg(s){var e=s.sortable,r=s.rootEl,i=s.name,t=s.targetEl,n=s.cloneEl,a=s.toEl,o=s.fromEl,l=s.oldIndex,v=s.newIndex,h=s.oldDraggableIndex,f=s.newDraggableIndex,d=s.originalEvent,g=s.putSortable,E=s.extraEventProperties;if(e=e||r&&r[ur],!!e){var S,x=e.options,m="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!ii&&!Kn?S=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(S=document.createEvent("Event"),S.initEvent(i,!0,!0)),S.to=a||r,S.from=o||r,S.item=t||r,S.clone=n,S.oldIndex=l,S.newIndex=v,S.oldDraggableIndex=h,S.newDraggableIndex=f,S.originalEvent=d,S.pullMode=g?g.lastPutMode:void 0;var c=$r($r({},E),Gn.getEventProperties(i,e));for(var p in c)S[p]=c[p];r&&r.dispatchEvent(S),x[m]&&x[m].call(e,S)}}var Xg=["evt"],tr=function(e,r){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=i.evt,n=Bg(i,Xg);Gn.pluginEvent.bind(Qe)(e,r,$r({dragEl:Pe,parentEl:St,ghostEl:tt,rootEl:gt,nextEl:Ii,lastDownEl:ss,cloneEl:Tt,cloneHidden:pi,dragStarted:Xn,putSortable:Bt,activeSortable:Qe.active,originalEvent:t,oldIndex:ln,oldDraggableIndex:Yn,newIndex:fr,newDraggableIndex:vi,hideGhostForTarget:Of,unhideGhostForTarget:Lf,cloneNowHidden:function(){pi=!0},cloneNowShown:function(){pi=!1},dispatchSortableEvent:function(o){Zt({sortable:r,name:o,originalEvent:t})}},n))};function Zt(s){Yg($r({putSortable:Bt,cloneEl:Tt,targetEl:Pe,rootEl:gt,oldIndex:ln,oldDraggableIndex:Yn,newIndex:fr,newDraggableIndex:vi},s))}var Pe,St,tt,gt,Ii,ss,Tt,pi,ln,fr,Yn,vi,os,Bt,un=!1,ls=!1,us=[],Ri,Mr,Zo,Qo,xf,bf,Xn,fn,Zn,Qn=!1,fs=!1,ds,$t,Jo=[],qo=!1,cs=[],hs=typeof document!="undefined",ps=cf,Sf=Kn||ii?"cssFloat":"float",Zg=hs&&!jg&&!cf&&"draggable"in document.createElement("div"),Tf=function(){if(!!hs){if(ii)return!1;var s=document.createElement("x");return s.style.cssText="pointer-events:auto",s.style.pointerEvents==="auto"}}(),Af=function(e,r){var i=Je(e),t=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=sn(e,0,r),a=sn(e,1,r),o=n&&Je(n),l=a&&Je(a),v=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Ct(n).width,h=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Ct(a).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&o.float&&o.float!=="none"){var f=o.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return n&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||v>=t&&i[Sf]==="none"||a&&i[Sf]==="none"&&v+h>t)?"vertical":"horizontal"},Qg=function(e,r,i){var t=i?e.left:e.top,n=i?e.right:e.bottom,a=i?e.width:e.height,o=i?r.left:r.top,l=i?r.right:r.bottom,v=i?r.width:r.height;return t===o||n===l||t+a/2===o+v/2},Jg=function(e,r){var i;return us.some(function(t){var n=t[ur].options.emptyInsertThreshold;if(!(!n||Go(t))){var a=Ct(t),o=e>=a.left-n&&e<=a.right+n,l=r>=a.top-n&&r<=a.bottom+n;if(o&&l)return i=t}}),i},wf=function(e){function r(n,a){return function(o,l,v,h){var f=o.options.group.name&&l.options.group.name&&o.options.group.name===l.options.group.name;if(n==null&&(a||f))return!0;if(n==null||n===!1)return!1;if(a&&n==="clone")return n;if(typeof n=="function")return r(n(o,l,v,h),a)(o,l,v,h);var d=(a?o:l).options.group.name;return n===!0||typeof n=="string"&&n===d||n.join&&n.indexOf(d)>-1}}var i={},t=e.group;(!t||ns(t)!="object")&&(t={name:t}),i.name=t.name,i.checkPull=r(t.pull,!0),i.checkPut=r(t.put),i.revertClone=t.revertClone,e.group=i},Of=function(){!Tf&&tt&&Je(tt,"display","none")},Lf=function(){!Tf&&tt&&Je(tt,"display","")};hs&&document.addEventListener("click",function(s){if(ls)return s.preventDefault(),s.stopPropagation&&s.stopPropagation(),s.stopImmediatePropagation&&s.stopImmediatePropagation(),ls=!1,!1},!0);var Di=function(e){if(Pe){e=e.touches?e.touches[0]:e;var r=Jg(e.clientX,e.clientY);if(r){var i={};for(var t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);i.target=i.rootEl=r,i.preventDefault=void 0,i.stopPropagation=void 0,r[ur]._onDragOver(i)}}},qg=function(e){Pe&&Pe.parentNode[ur]._isOutsideThisEl(e.target)};function Qe(s,e){if(!(s&&s.nodeType&&s.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(s));this.el=s,this.options=e=Gr({},e),s[ur]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(s.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Af(s,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Qe.supportPointer!==!1&&"PointerEvent"in window&&!Hn,emptyInsertThreshold:5};Gn.initializePlugins(this,s,r);for(var i in r)!(i in e)&&(e[i]=r[i]);wf(e);for(var t in this)t.charAt(0)==="_"&&typeof this[t]=="function"&&(this[t]=this[t].bind(this));this.nativeDraggable=e.forceFallback?!1:Zg,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?ut(s,"pointerdown",this._onTapStart):(ut(s,"mousedown",this._onTapStart),ut(s,"touchstart",this._onTapStart)),this.nativeDraggable&&(ut(s,"dragover",this),ut(s,"dragenter",this)),us.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Gr(this,Hg())}Qe.prototype={constructor:Qe,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(fn=null)},_getDirection:function(e,r){return typeof this.options.direction=="function"?this.options.direction.call(this,e,r,Pe):this.options.direction},_onTapStart:function(e){if(!!e.cancelable){var r=this,i=this.el,t=this.options,n=t.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(o||e).target,v=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,h=t.filter;if(om(i),!Pe&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||t.disabled)&&!v.isContentEditable&&!(!this.nativeDraggable&&Hn&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Yr(l,t.draggable,i,!1),!(l&&l.animated)&&ss!==l)){if(ln=er(l),Yn=er(l,t.draggable),typeof h=="function"){if(h.call(this,e,l,this)){Zt({sortable:r,rootEl:v,name:"filter",targetEl:l,toEl:i,fromEl:i}),tr("filter",r,{evt:e}),n&&e.cancelable&&e.preventDefault();return}}else if(h&&(h=h.split(",").some(function(f){if(f=Yr(v,f.trim(),i,!1),f)return Zt({sortable:r,rootEl:f,name:"filter",targetEl:l,fromEl:i,toEl:i}),tr("filter",r,{evt:e}),!0}),h)){n&&e.cancelable&&e.preventDefault();return}t.handle&&!Yr(v,t.handle,i,!1)||this._prepareDragStart(e,o,l)}}},_prepareDragStart:function(e,r,i){var t=this,n=t.el,a=t.options,o=n.ownerDocument,l;if(i&&!Pe&&i.parentNode===n){var v=Ct(i);if(gt=n,Pe=i,St=Pe.parentNode,Ii=Pe.nextSibling,ss=i,os=a.group,Qe.dragged=Pe,Ri={target:Pe,clientX:(r||e).clientX,clientY:(r||e).clientY},xf=Ri.clientX-v.left,bf=Ri.clientY-v.top,this._lastX=(r||e).clientX,this._lastY=(r||e).clientY,Pe.style["will-change"]="all",l=function(){if(tr("delayEnded",t,{evt:e}),Qe.eventCanceled){t._onDrop();return}t._disableDelayedDragEvents(),!df&&t.nativeDraggable&&(Pe.draggable=!0),t._triggerDragStart(e,r),Zt({sortable:t,name:"choose",originalEvent:e}),Ht(Pe,a.chosenClass,!0)},a.ignore.split(",").forEach(function(h){vf(Pe,h.trim(),el)}),ut(o,"dragover",Di),ut(o,"mousemove",Di),ut(o,"touchmove",Di),ut(o,"mouseup",t._onDrop),ut(o,"touchend",t._onDrop),ut(o,"touchcancel",t._onDrop),df&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Pe.draggable=!0),tr("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(Kn||ii))){if(Qe.eventCanceled){this._onDrop();return}ut(o,"mouseup",t._disableDelayedDrag),ut(o,"touchend",t._disableDelayedDrag),ut(o,"touchcancel",t._disableDelayedDrag),ut(o,"mousemove",t._delayedDragTouchMoveHandler),ut(o,"touchmove",t._delayedDragTouchMoveHandler),a.supportPointer&&ut(o,"pointermove",t._delayedDragTouchMoveHandler),t._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var r=e.touches?e.touches[0]:e;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Pe&&el(Pe),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;lt(e,"mouseup",this._disableDelayedDrag),lt(e,"touchend",this._disableDelayedDrag),lt(e,"touchcancel",this._disableDelayedDrag),lt(e,"mousemove",this._delayedDragTouchMoveHandler),lt(e,"touchmove",this._delayedDragTouchMoveHandler),lt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,r){r=r||e.pointerType=="touch"&&e,!this.nativeDraggable||r?this.options.supportPointer?ut(document,"pointermove",this._onTouchMove):r?ut(document,"touchmove",this._onTouchMove):ut(document,"mousemove",this._onTouchMove):(ut(Pe,"dragend",this),ut(gt,"dragstart",this._onDragStart));try{document.selection?gs(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(i){}},_dragStarted:function(e,r){if(un=!1,gt&&Pe){tr("dragStarted",this,{evt:r}),this.nativeDraggable&&ut(document,"dragover",qg);var i=this.options;!e&&Ht(Pe,i.dragClass,!1),Ht(Pe,i.ghostClass,!0),Qe.active=this,e&&this._appendGhost(),Zt({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(Mr){this._lastX=Mr.clientX,this._lastY=Mr.clientY,Of();for(var e=document.elementFromPoint(Mr.clientX,Mr.clientY),r=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Mr.clientX,Mr.clientY),e!==r);)r=e;if(Pe.parentNode[ur]._isOutsideThisEl(e),r)do{if(r[ur]){var i=void 0;if(i=r[ur]._onDragOver({clientX:Mr.clientX,clientY:Mr.clientY,target:e,rootEl:r}),i&&!this.options.dragoverBubble)break}e=r}while(r=r.parentNode);Lf()}},_onTouchMove:function(e){if(Ri){var r=this.options,i=r.fallbackTolerance,t=r.fallbackOffset,n=e.touches?e.touches[0]:e,a=tt&&an(tt,!0),o=tt&&a&&a.a,l=tt&&a&&a.d,v=ps&&$t&&mf($t),h=(n.clientX-Ri.clientX+t.x)/(o||1)+(v?v[0]-Jo[0]:0)/(o||1),f=(n.clientY-Ri.clientY+t.y)/(l||1)+(v?v[1]-Jo[1]:0)/(l||1);if(!Qe.active&&!un){if(i&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(tt){a?(a.e+=h-(Zo||0),a.f+=f-(Qo||0)):a={a:1,b:0,c:0,d:1,e:h,f};var d="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");Je(tt,"webkitTransform",d),Je(tt,"mozTransform",d),Je(tt,"msTransform",d),Je(tt,"transform",d),Zo=h,Qo=f,Mr=n}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!tt){var e=this.options.fallbackOnBody?document.body:gt,r=Ct(Pe,!0,ps,!0,e),i=this.options;if(ps){for($t=e;Je($t,"position")==="static"&&Je($t,"transform")==="none"&&$t!==document;)$t=$t.parentNode;$t!==document.body&&$t!==document.documentElement?($t===document&&($t=Xr()),r.top+=$t.scrollTop,r.left+=$t.scrollLeft):$t=Xr(),Jo=mf($t)}tt=Pe.cloneNode(!0),Ht(tt,i.ghostClass,!1),Ht(tt,i.fallbackClass,!0),Ht(tt,i.dragClass,!0),Je(tt,"transition",""),Je(tt,"transform",""),Je(tt,"box-sizing","border-box"),Je(tt,"margin",0),Je(tt,"top",r.top),Je(tt,"left",r.left),Je(tt,"width",r.width),Je(tt,"height",r.height),Je(tt,"opacity","0.8"),Je(tt,"position",ps?"absolute":"fixed"),Je(tt,"zIndex","100000"),Je(tt,"pointerEvents","none"),Qe.ghost=tt,e.appendChild(tt),Je(tt,"transform-origin",xf/parseInt(tt.style.width)*100+"% "+bf/parseInt(tt.style.height)*100+"%")}},_onDragStart:function(e,r){var i=this,t=e.dataTransfer,n=i.options;if(tr("dragStart",this,{evt:e}),Qe.eventCanceled){this._onDrop();return}tr("setupClone",this),Qe.eventCanceled||(Tt=_f(Pe),Tt.draggable=!1,Tt.style["will-change"]="",this._hideClone(),Ht(Tt,this.options.chosenClass,!1),Qe.clone=Tt),i.cloneId=gs(function(){tr("clone",i),!Qe.eventCanceled&&(i.options.removeCloneOnHide||gt.insertBefore(Tt,Pe),i._hideClone(),Zt({sortable:i,name:"clone"}))}),!r&&Ht(Pe,n.dragClass,!0),r?(ls=!0,i._loopId=setInterval(i._emulateDragOver,50)):(lt(document,"mouseup",i._onDrop),lt(document,"touchend",i._onDrop),lt(document,"touchcancel",i._onDrop),t&&(t.effectAllowed="move",n.setData&&n.setData.call(i,t,Pe)),ut(document,"drop",i),Je(Pe,"transform","translateZ(0)")),un=!0,i._dragStartId=gs(i._dragStarted.bind(i,r,e)),ut(document,"selectstart",i),Xn=!0,Hn&&Je(document.body,"user-select","none")},_onDragOver:function(e){var r=this.el,i=e.target,t,n,a,o=this.options,l=o.group,v=Qe.active,h=os===l,f=o.sort,d=Bt||v,g,E=this,S=!1;if(qo)return;function x(M,N){tr(M,E,$r({evt:e,isOwner:h,axis:g?"vertical":"horizontal",revert:a,dragRect:t,targetRect:n,canSort:f,fromSortable:d,target:i,completed:c,onMove:function(U,F){return vs(gt,r,Pe,t,U,Ct(U),e,F)},changed:p},N))}function m(){x("dragOverAnimationCapture"),E.captureAnimationState(),E!==d&&d.captureAnimationState()}function c(M){return x("dragOverCompleted",{insertion:M}),M&&(h?v._hideClone():v._showClone(E),E!==d&&(Ht(Pe,Bt?Bt.options.ghostClass:v.options.ghostClass,!1),Ht(Pe,o.ghostClass,!0)),Bt!==E&&E!==Qe.active?Bt=E:E===Qe.active&&Bt&&(Bt=null),d===E&&(E._ignoreWhileAnimating=i),E.animateAll(function(){x("dragOverAnimationComplete"),E._ignoreWhileAnimating=null}),E!==d&&(d.animateAll(),d._ignoreWhileAnimating=null)),(i===Pe&&!Pe.animated||i===r&&!i.animated)&&(fn=null),!o.dragoverBubble&&!e.rootEl&&i!==document&&(Pe.parentNode[ur]._isOutsideThisEl(e.target),!M&&Di(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),S=!0}function p(){fr=er(Pe),vi=er(Pe,o.draggable),Zt({sortable:E,name:"change",toEl:r,newIndex:fr,newDraggableIndex:vi,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=Yr(i,o.draggable,r,!0),x("dragOver"),Qe.eventCanceled)return S;if(Pe.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||E._ignoreWhileAnimating===i)return c(!1);if(ls=!1,v&&!o.disabled&&(h?f||(a=St!==gt):Bt===this||(this.lastPutMode=os.checkPull(this,v,Pe,e))&&l.checkPut(this,v,Pe,e))){if(g=this._getDirection(e,i)==="vertical",t=Ct(Pe),x("dragOverValid"),Qe.eventCanceled)return S;if(a)return St=gt,m(),this._hideClone(),x("revert"),Qe.eventCanceled||(Ii?gt.insertBefore(Pe,Ii):gt.appendChild(Pe)),c(!0);var y=Go(r,o.draggable);if(!y||im(e,g,this)&&!y.animated){if(y===Pe)return c(!1);if(y&&r===e.target&&(i=y),i&&(n=Ct(i)),vs(gt,r,Pe,t,i,n,e,!!i)!==!1)return m(),r.appendChild(Pe),St=r,p(),c(!0)}else if(y&&rm(e,g,this)){var u=sn(r,0,o,!0);if(u===Pe)return c(!1);if(i=u,n=Ct(i),vs(gt,r,Pe,t,i,n,e,!1)!==!1)return m(),r.insertBefore(Pe,u),St=r,p(),c(!0)}else if(i.parentNode===r){n=Ct(i);var _=0,b,T=Pe.parentNode!==r,A=!Qg(Pe.animated&&Pe.toRect||t,i.animated&&i.toRect||n,g),L=g?"top":"left",R=gf(i,"top","top")||gf(Pe,"top","top"),w=R?R.scrollTop:void 0;fn!==i&&(b=n[L],Qn=!1,fs=!A&&o.invertSwap||T),_=nm(e,i,n,g,A?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,fs,fn===i);var O;if(_!==0){var I=er(Pe);do I-=_,O=St.children[I];while(O&&(Je(O,"display")==="none"||O===tt))}if(_===0||O===i)return c(!1);fn=i,Zn=_;var D=i.nextElementSibling,C=!1;C=_===1;var P=vs(gt,r,Pe,t,i,n,e,C);if(P!==!1)return(P===1||P===-1)&&(C=P===1),qo=!0,setTimeout(tm,30),m(),C&&!D?r.appendChild(Pe):i.parentNode.insertBefore(Pe,C?D:i),R&&Ef(R,0,w-R.scrollTop),St=Pe.parentNode,b!==void 0&&!fs&&(ds=Math.abs(b-Ct(i)[L])),p(),c(!0)}if(r.contains(Pe))return c(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){lt(document,"mousemove",this._onTouchMove),lt(document,"touchmove",this._onTouchMove),lt(document,"pointermove",this._onTouchMove),lt(document,"dragover",Di),lt(document,"mousemove",Di),lt(document,"touchmove",Di)},_offUpEvents:function(){var e=this.el.ownerDocument;lt(e,"mouseup",this._onDrop),lt(e,"touchend",this._onDrop),lt(e,"pointerup",this._onDrop),lt(e,"touchcancel",this._onDrop),lt(document,"selectstart",this)},_onDrop:function(e){var r=this.el,i=this.options;if(fr=er(Pe),vi=er(Pe,i.draggable),tr("drop",this,{evt:e}),St=Pe&&Pe.parentNode,fr=er(Pe),vi=er(Pe,i.draggable),Qe.eventCanceled){this._nulling();return}un=!1,fs=!1,Qn=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),tl(this.cloneId),tl(this._dragStartId),this.nativeDraggable&&(lt(document,"drop",this),lt(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Hn&&Je(document.body,"user-select",""),Je(Pe,"transform",""),e&&(Xn&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),tt&&tt.parentNode&&tt.parentNode.removeChild(tt),(gt===St||Bt&&Bt.lastPutMode!=="clone")&&Tt&&Tt.parentNode&&Tt.parentNode.removeChild(Tt),Pe&&(this.nativeDraggable&&lt(Pe,"dragend",this),el(Pe),Pe.style["will-change"]="",Xn&&!un&&Ht(Pe,Bt?Bt.options.ghostClass:this.options.ghostClass,!1),Ht(Pe,this.options.chosenClass,!1),Zt({sortable:this,name:"unchoose",toEl:St,newIndex:null,newDraggableIndex:null,originalEvent:e}),gt!==St?(fr>=0&&(Zt({rootEl:St,name:"add",toEl:St,fromEl:gt,originalEvent:e}),Zt({sortable:this,name:"remove",toEl:St,originalEvent:e}),Zt({rootEl:St,name:"sort",toEl:St,fromEl:gt,originalEvent:e}),Zt({sortable:this,name:"sort",toEl:St,originalEvent:e})),Bt&&Bt.save()):fr!==ln&&fr>=0&&(Zt({sortable:this,name:"update",toEl:St,originalEvent:e}),Zt({sortable:this,name:"sort",toEl:St,originalEvent:e})),Qe.active&&((fr==null||fr===-1)&&(fr=ln,vi=Yn),Zt({sortable:this,name:"end",toEl:St,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){tr("nulling",this),gt=Pe=St=tt=Ii=Tt=ss=pi=Ri=Mr=Xn=fr=vi=ln=Yn=fn=Zn=Bt=os=Qe.dragged=Qe.ghost=Qe.clone=Qe.active=null,cs.forEach(function(e){e.checked=!0}),cs.length=Zo=Qo=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Pe&&(this._onDragOver(e),em(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],r,i=this.el.children,t=0,n=i.length,a=this.options;t<n;t++)r=i[t],Yr(r,a.draggable,this.el,!1)&&e.push(r.getAttribute(a.dataIdAttr)||sm(r));return e},sort:function(e,r){var i={},t=this.el;this.toArray().forEach(function(n,a){var o=t.children[a];Yr(o,this.options.draggable,t,!1)&&(i[n]=o)},this),r&&this.captureAnimationState(),e.forEach(function(n){i[n]&&(t.removeChild(i[n]),t.appendChild(i[n]))}),r&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,r){return Yr(e,r||this.options.draggable,this.el,!1)},option:function(e,r){var i=this.options;if(r===void 0)return i[e];var t=Gn.modifyOption(this,e,r);typeof t!="undefined"?i[e]=t:i[e]=r,e==="group"&&wf(i)},destroy:function(){tr("destroy",this);var e=this.el;e[ur]=null,lt(e,"mousedown",this._onTapStart),lt(e,"touchstart",this._onTapStart),lt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(lt(e,"dragover",this),lt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),us.splice(us.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!pi){if(tr("hideClone",this),Qe.eventCanceled)return;Je(Tt,"display","none"),this.options.removeCloneOnHide&&Tt.parentNode&&Tt.parentNode.removeChild(Tt),pi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(pi){if(tr("showClone",this),Qe.eventCanceled)return;Pe.parentNode==gt&&!this.options.group.revertClone?gt.insertBefore(Tt,Pe):Ii?gt.insertBefore(Tt,Ii):gt.appendChild(Tt),this.options.group.revertClone&&this.animate(Pe,Tt),Je(Tt,"display",""),pi=!1}}};function em(s){s.dataTransfer&&(s.dataTransfer.dropEffect="move"),s.cancelable&&s.preventDefault()}function vs(s,e,r,i,t,n,a,o){var l,v=s[ur],h=v.options.onMove,f;return window.CustomEvent&&!ii&&!Kn?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=s,l.dragged=r,l.draggedRect=i,l.related=t||e,l.relatedRect=n||Ct(e),l.willInsertAfter=o,l.originalEvent=a,s.dispatchEvent(l),h&&(f=h.call(v,l,a)),f}function el(s){s.draggable=!1}function tm(){qo=!1}function rm(s,e,r){var i=Ct(sn(r.el,0,r.options,!0)),t=10;return e?s.clientX<i.left-t||s.clientY<i.top&&s.clientX<i.right:s.clientY<i.top-t||s.clientY<i.bottom&&s.clientX<i.left}function im(s,e,r){var i=Ct(Go(r.el,r.options.draggable)),t=10;return e?s.clientX>i.right+t||s.clientX<=i.right&&s.clientY>i.bottom&&s.clientX>=i.left:s.clientX>i.right&&s.clientY>i.top||s.clientX<=i.right&&s.clientY>i.bottom+t}function nm(s,e,r,i,t,n,a,o){var l=i?s.clientY:s.clientX,v=i?r.height:r.width,h=i?r.top:r.left,f=i?r.bottom:r.right,d=!1;if(!a){if(o&&ds<v*t){if(!Qn&&(Zn===1?l>h+v*n/2:l<f-v*n/2)&&(Qn=!0),Qn)d=!0;else if(Zn===1?l<h+ds:l>f-ds)return-Zn}else if(l>h+v*(1-t)/2&&l<f-v*(1-t)/2)return am(e)}return d=d||a,d&&(l<h+v*n/2||l>f-v*n/2)?l>h+v/2?1:-1:0}function am(s){return er(Pe)<er(s)?1:-1}function sm(s){for(var e=s.tagName+s.className+s.src+s.href+s.textContent,r=e.length,i=0;r--;)i+=e.charCodeAt(r);return i.toString(36)}function om(s){cs.length=0;for(var e=s.getElementsByTagName("input"),r=e.length;r--;){var i=e[r];i.checked&&cs.push(i)}}function gs(s){return setTimeout(s,0)}function tl(s){return clearTimeout(s)}hs&&ut(document,"touchmove",function(s){(Qe.active||un)&&s.cancelable&&s.preventDefault()});Qe.utils={on:ut,off:lt,css:Je,find:vf,is:function(e,r){return!!Yr(e,r,e,!1)},extend:Vg,throttle:yf,closest:Yr,toggleClass:Ht,clone:_f,index:er,nextTick:gs,cancelNextTick:tl,detectDirection:Af,getChild:sn};Qe.get=function(s){return s[ur]};Qe.mount=function(){for(var s=arguments.length,e=new Array(s),r=0;r<s;r++)e[r]=arguments[r];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(Qe.utils=$r($r({},Qe.utils),i.utils)),Gn.mount(i)})};Qe.create=function(s,e){return new Qe(s,e)};Qe.version=Ug;var Rt=[],Jn,rl,il=!1,nl,al,ms,qn;function lm(){function s(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return s.prototype={dragStarted:function(r){var i=r.originalEvent;this.sortable.nativeDraggable?ut(document,"dragover",this._handleAutoScroll):this.options.supportPointer?ut(document,"pointermove",this._handleFallbackAutoScroll):i.touches?ut(document,"touchmove",this._handleFallbackAutoScroll):ut(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var i=r.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?lt(document,"dragover",this._handleAutoScroll):(lt(document,"pointermove",this._handleFallbackAutoScroll),lt(document,"touchmove",this._handleFallbackAutoScroll),lt(document,"mousemove",this._handleFallbackAutoScroll)),If(),ys(),Kg()},nulling:function(){ms=rl=Jn=il=qn=nl=al=null,Rt.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,i){var t=this,n=(r.touches?r.touches[0]:r).clientX,a=(r.touches?r.touches[0]:r).clientY,o=document.elementFromPoint(n,a);if(ms=r,i||this.options.forceAutoScrollFallback||Kn||ii||Hn){sl(r,this.options,o,i);var l=hi(o,!0);il&&(!qn||n!==nl||a!==al)&&(qn&&If(),qn=setInterval(function(){var v=hi(document.elementFromPoint(n,a),!0);v!==l&&(l=v,ys()),sl(r,t.options,v,i)},10),nl=n,al=a)}else{if(!this.options.bubbleScroll||hi(o,!0)===Xr()){ys();return}sl(r,this.options,hi(o,!1),!1)}}},Gr(s,{pluginName:"scroll",initializeByDefault:!0})}function ys(){Rt.forEach(function(s){clearInterval(s.pid)}),Rt=[]}function If(){clearInterval(qn)}var sl=yf(function(s,e,r,i){if(!!e.scroll){var t=(s.touches?s.touches[0]:s).clientX,n=(s.touches?s.touches[0]:s).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,l=Xr(),v=!1,h;rl!==r&&(rl=r,ys(),Jn=e.scroll,h=e.scrollFn,Jn===!0&&(Jn=hi(r,!0)));var f=0,d=Jn;do{var g=d,E=Ct(g),S=E.top,x=E.bottom,m=E.left,c=E.right,p=E.width,y=E.height,u=void 0,_=void 0,b=g.scrollWidth,T=g.scrollHeight,A=Je(g),L=g.scrollLeft,R=g.scrollTop;g===l?(u=p<b&&(A.overflowX==="auto"||A.overflowX==="scroll"||A.overflowX==="visible"),_=y<T&&(A.overflowY==="auto"||A.overflowY==="scroll"||A.overflowY==="visible")):(u=p<b&&(A.overflowX==="auto"||A.overflowX==="scroll"),_=y<T&&(A.overflowY==="auto"||A.overflowY==="scroll"));var w=u&&(Math.abs(c-t)<=a&&L+p<b)-(Math.abs(m-t)<=a&&!!L),O=_&&(Math.abs(x-n)<=a&&R+y<T)-(Math.abs(S-n)<=a&&!!R);if(!Rt[f])for(var I=0;I<=f;I++)Rt[I]||(Rt[I]={});(Rt[f].vx!=w||Rt[f].vy!=O||Rt[f].el!==g)&&(Rt[f].el=g,Rt[f].vx=w,Rt[f].vy=O,clearInterval(Rt[f].pid),(w!=0||O!=0)&&(v=!0,Rt[f].pid=setInterval(function(){i&&this.layer===0&&Qe.active._onTouchMove(ms);var D=Rt[this.layer].vy?Rt[this.layer].vy*o:0,C=Rt[this.layer].vx?Rt[this.layer].vx*o:0;typeof h=="function"&&h.call(Qe.dragged.parentNode[ur],C,D,s,ms,Rt[this.layer].el)!=="continue"||Ef(Rt[this.layer].el,C,D)}.bind({layer:f}),24))),f++}while(e.bubbleScroll&&d!==l&&(d=hi(d,!1)));il=v}},30),Rf=function(e){var r=e.originalEvent,i=e.putSortable,t=e.dragEl,n=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(!!r){var v=i||n;o();var h=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,f=document.elementFromPoint(h.clientX,h.clientY);l(),v&&!v.el.contains(f)&&(a("spill"),this.onSpill({dragEl:t,putSortable:i}))}};function ol(){}ol.prototype={startIndex:null,dragStart:function(e){var r=e.oldDraggableIndex;this.startIndex=r},onSpill:function(e){var r=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var t=sn(this.sortable.el,this.startIndex,this.options);t?this.sortable.el.insertBefore(r,t):this.sortable.el.appendChild(r),this.sortable.animateAll(),i&&i.animateAll()},drop:Rf};Gr(ol,{pluginName:"revertOnSpill"});function ll(){}ll.prototype={onSpill:function(e){var r=e.dragEl,i=e.putSortable,t=i||this.sortable;t.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),t.animateAll()},drop:Rf};Gr(ll,{pluginName:"removeOnSpill"});var br;function um(){function s(){this.defaults={swapClass:"sortable-swap-highlight"}}return s.prototype={dragStart:function(r){var i=r.dragEl;br=i},dragOverValid:function(r){var i=r.completed,t=r.target,n=r.onMove,a=r.activeSortable,o=r.changed,l=r.cancel;if(!!a.options.swap){var v=this.sortable.el,h=this.options;if(t&&t!==v){var f=br;n(t)!==!1?(Ht(t,h.swapClass,!0),br=t):br=null,f&&f!==br&&Ht(f,h.swapClass,!1)}o(),i(!0),l()}},drop:function(r){var i=r.activeSortable,t=r.putSortable,n=r.dragEl,a=t||this.sortable,o=this.options;br&&Ht(br,o.swapClass,!1),br&&(o.swap||t&&t.options.swap)&&n!==br&&(a.captureAnimationState(),a!==i&&i.captureAnimationState(),fm(n,br),a.animateAll(),a!==i&&i.animateAll())},nulling:function(){br=null}},Gr(s,{pluginName:"swap",eventProperties:function(){return{swapItem:br}}})}function fm(s,e){var r=s.parentNode,i=e.parentNode,t,n;!r||!i||r.isEqualNode(e)||i.isEqualNode(s)||(t=er(s),n=er(e),r.isEqualNode(i)&&t<n&&n++,r.insertBefore(e,r.children[t]),i.insertBefore(s,i.children[n]))}Qe.mount(new lm);Qe.mount(ll,ol);var ea=0,dm=1,cm=-1,mt="__PLAYER_KEY__",ul={selector:"audio-lists-panel-content-wrap",swapClass:"audio-lists-panel-sortable-highlight-bg",swap:!0,animation:100,easing:"cubic-bezier(0.43, -0.1, 0.16, 1.1)"},hm=function(e){var r=e.audioLists,i=e.onCancel,t=e.onDelete,n=e.onPlay,a=e.playId,o=e.loading,l=e.panelToggleAnimate,v=e.glassBg,h=e.remove,f=e.removeId,d=e.isMobile,g=e.locale,E=e.icon,S=e.playing;return q.createElement("div",{className:Ft("audio-lists-panel",l,{"audio-lists-panel-mobile":d,"glass-bg":v})},q.createElement("div",{className:"audio-lists-panel-header"},q.createElement("h2",{className:"audio-lists-panel-header-title"},q.createElement("span",null,g.playListsText," / "),q.createElement("span",{className:"audio-lists-panel-header-num"},r.length),q.createElement("span",{className:"audio-lists-panel-header-actions"},h&&q.createElement(q.Fragment,null,q.createElement("span",{className:"audio-lists-panel-header-delete-btn",title:g.removeAudioListsText,onClick:t()},E.delete),q.createElement("span",{className:"audio-lists-panel-header-line"})),q.createElement("span",{className:"audio-lists-panel-header-close-btn",title:g.closeText,onClick:i},d?E.packUpPanelMobile:E.close)))),q.createElement("div",{className:Ft("audio-lists-panel-content",{"no-content":r.length<1})},r.length>=1?q.createElement("ul",{className:ul.selector},r.map(function(x){var m=x.name,c=x.singer,p=x[mt],y=a===p;return q.createElement("li",{key:p,title:S&&y?g.clickToPauseText:g.clickToPlayText,className:Ft("audio-item",{playing:y},{pause:!S},{remove:f===p}),onClick:function(){return n(p)}},q.createElement("span",{className:"group player-status"},q.createElement("span",{className:"player-icons"},y&&o?E.loading:y?S?E.pause:E.play:void 0)),q.createElement("span",{className:"group player-name",title:m},m),q.createElement("span",{className:"group player-singer",title:c},c),h&&q.createElement("span",{className:"group player-delete",title:g.clickToDeleteText(m),onClick:t(p)},E.close))})):q.createElement(q.Fragment,null,q.createElement("span",null,E.empty),q.createElement("span",{className:"no-data"},g.emptyText||g.notContentText))))},pm=Ye.exports.memo(hm),vm=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.progress,i=r===void 0?0:r,t=e.r,n=t===void 0?40:t,a=i.toFixed(2),o=Math.PI*2*n,l="".concat(Math.floor(o*a)," ").concat(Math.floor(o*(1-a)));return q.createElement("svg",{className:"audio-circle-process-bar"},q.createElement("circle",{cx:n,cy:n,r:n-1,fill:"none",className:"stroke",strokeDasharray:l}),q.createElement("circle",{cx:n,cy:n,r:n-1,fill:"none",className:"bg",strokeDasharray:"0 1000"}))},gm=Ye.exports.memo(vm),mm=[{id:"fa",name:"Font Awesome",projectUrl:"https://fontawesome.com/",license:"CC BY 4.0 License",licenseUrl:"https://creativecommons.org/licenses/by/4.0/"},{id:"io",name:"Ionicons 4",projectUrl:"https://ionicons.com/",license:"MIT",licenseUrl:"https://github.com/ionic-team/ionicons/blob/master/LICENSE"},{id:"io5",name:"Ionicons 5",projectUrl:"https://ionicons.com/",license:"MIT",licenseUrl:"https://github.com/ionic-team/ionicons/blob/master/LICENSE"},{id:"md",name:"Material Design icons",projectUrl:"http://google.github.io/material-design-icons/",license:"Apache License Version 2.0",licenseUrl:"https://github.com/google/material-design-icons/blob/master/LICENSE"},{id:"ti",name:"Typicons",projectUrl:"http://s-ings.com/typicons/",license:"CC BY-SA 3.0",licenseUrl:"https://creativecommons.org/licenses/by-sa/3.0/"},{id:"go",name:"Github Octicons icons",projectUrl:"https://octicons.github.com/",license:"MIT",licenseUrl:"https://github.com/primer/octicons/blob/master/LICENSE"},{id:"fi",name:"Feather",projectUrl:"https://feathericons.com/",license:"MIT",licenseUrl:"https://github.com/feathericons/feather/blob/master/LICENSE"},{id:"gi",name:"Game Icons",projectUrl:"https://game-icons.net/",license:"CC BY 3.0",licenseUrl:"https://creativecommons.org/licenses/by/3.0/"},{id:"wi",name:"Weather Icons",projectUrl:"https://erikflowers.github.io/weather-icons/",license:"SIL OFL 1.1",licenseUrl:"http://scripts.sil.org/OFL"},{id:"di",name:"Devicons",projectUrl:"https://vorillaz.github.io/devicons/",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"ai",name:"Ant Design Icons",projectUrl:"https://github.com/ant-design/ant-design-icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"bs",name:"Bootstrap Icons",projectUrl:"https://github.com/twbs/icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"ri",name:"Remix Icon",projectUrl:"https://github.com/Remix-Design/RemixIcon",license:"Apache License Version 2.0",licenseUrl:"http://www.apache.org/licenses/"},{id:"fc",name:"Flat Color Icons",projectUrl:"https://github.com/icons8/flat-color-icons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"gr",name:"Grommet-Icons",projectUrl:"https://github.com/grommet/grommet-icons",license:"Apache License Version 2.0",licenseUrl:"http://www.apache.org/licenses/"},{id:"hi",name:"Heroicons",projectUrl:"https://github.com/refactoringui/heroicons",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"si",name:"Simple Icons",projectUrl:"https://simpleicons.org/",license:"CC0 1.0 Universal",licenseUrl:"https://creativecommons.org/publicdomain/zero/1.0/"},{id:"im",name:"IcoMoon Free",projectUrl:"https://github.com/Keyamoon/IcoMoon-Free",license:"CC BY 4.0 License"},{id:"bi",name:"BoxIcons",projectUrl:"https://github.com/atisawd/boxicons",license:"CC BY 4.0 License"},{id:"cg",name:"css.gg",projectUrl:"https://github.com/astrit/css.gg",license:"MIT",licenseUrl:"https://opensource.org/licenses/MIT"},{id:"vsc",name:"VS Code Icons",projectUrl:"https://github.com/microsoft/vscode-codicons",license:"CC BY 4.0",licenseUrl:"https://creativecommons.org/licenses/by/4.0/"}],fl={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},dl=q.createContext&&q.createContext(fl),gi=globalThis&&globalThis.__assign||function(){return gi=Object.assign||function(s){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])}return s},gi.apply(this,arguments)},ym=globalThis&&globalThis.__rest||function(s,e){var r={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(r[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,i=Object.getOwnPropertySymbols(s);t<i.length;t++)e.indexOf(i[t])<0&&Object.prototype.propertyIsEnumerable.call(s,i[t])&&(r[i[t]]=s[i[t]]);return r};function Df(s){return s&&s.map(function(e,r){return q.createElement(e.tag,gi({key:r},e.attr),Df(e.child))})}function Em(s){return function(e){return q.createElement(Cf,gi({attr:gi({},s.attr)},e),Df(s.child))}}function Cf(s){var e=function(r){var i=s.attr,t=s.size,n=s.title,a=ym(s,["attr","size","title"]),o=t||r.size||"1em",l;return r.className&&(l=r.className),s.className&&(l=(l?l+" ":"")+s.className),q.createElement("svg",gi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:gi(gi({color:s.color||r.color},r.style),s.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),n&&q.createElement("title",null,n),s.children)};return dl!==void 0?q.createElement(dl.Consumer,null,function(r){return e(r)}):e(fl)}var _m=Object.freeze(Object.defineProperty({__proto__:null,IconsManifest:mm,GenIcon:Em,IconBase:Cf,DefaultContext:fl,IconContext:dl},Symbol.toStringTag,{value:"Module"})),Lt=Eo(_m),xm=Lt.GenIcon,bm=function(e){return xm({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm-16 328c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16v160zm112 0c0 8.8-7.2 16-16 16h-48c-8.8 0-16-7.2-16-16V176c0-8.8 7.2-16 16-16h48c8.8 0 16 7.2 16 16v160z"}}]})(e)},Sm=Lt.GenIcon,Tm=function(e){return Sm({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z"}}]})(e)},Am=Lt.GenIcon,wm=function(e){return Am({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"}}]})(e)},Om=Lt.GenIcon,Pf=function(e){return Om({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.52 32 0 146.496 0 288v48a32 32 0 0 0 17.689 28.622l14.383 7.191C34.083 431.903 83.421 480 144 480h24c13.255 0 24-10.745 24-24V280c0-13.255-10.745-24-24-24h-24c-31.342 0-59.671 12.879-80 33.627V288c0-105.869 86.131-192 192-192s192 86.131 192 192v1.627C427.671 268.879 399.342 256 368 256h-24c-13.255 0-24 10.745-24 24v176c0 13.255 10.745 24 24 24h24c60.579 0 109.917-48.098 111.928-108.187l14.382-7.191A32 32 0 0 0 512 336v-48c0-141.479-114.496-256-256-256z"}}]})(e)},Lm=Lt.GenIcon,Im=function(e){return Lm({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M108 284c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h232c6.6 0 12 5.4 12 12v32c0 6.6-5.4 12-12 12H108zM448 80v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V80c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zm-48 346V86c0-3.3-2.7-6-6-6H54c-3.3 0-6 2.7-6 6v340c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"}}]})(e)},Rm=Lt.GenIcon,Dm=function(e){return Rm({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"}}]})(e)},Cm=Lt.GenIcon,Pm=function(e){return Cm({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"}}]})(e)},Mm=Lt.GenIcon,km=function(e){return Mm({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"7 13 12 18 17 13"}},{tag:"polyline",attr:{points:"7 6 12 11 17 6"}}]})(e)},Nm=Lt.GenIcon,Fm=function(e){return Nm({tag:"svg",attr:{viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"}}]})(e)},Bm=Lt.GenIcon,Um=function(e){return Bm({tag:"svg",attr:{viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12 8.02c0 1.09-.45 2.09-1.17 2.83l-.67-.67c.55-.56.89-1.31.89-2.16 0-.85-.34-1.61-.89-2.16l.67-.67A3.99 3.99 0 0 1 12 8.02zM7.72 2.28L4 6H2c-.55 0-1 .45-1 1v2c0 .55.45 1 1 1h2l3.72 3.72c.47.47 1.28.14 1.28-.53V2.81c0-.67-.81-1-1.28-.53zm5.94.08l-.67.67a6.996 6.996 0 0 1 2.06 4.98c0 1.94-.78 3.7-2.06 4.98l.67.67A7.973 7.973 0 0 0 16 8c0-2.22-.89-4.22-2.34-5.66v.02zm-1.41 1.41l-.69.67a5.05 5.05 0 0 1 1.48 3.58c0 1.39-.56 2.66-1.48 3.56l.69.67A5.971 5.971 0 0 0 14 8.02c0-1.65-.67-3.16-1.75-4.25z"}}]})(e)},jm=Lt.GenIcon,Mf=function(e){return jm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}}]})(e)},Wm=Lt.GenIcon,zm=function(e){return Wm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 5h-3v5.5c0 1.38-1.12 2.5-2.5 2.5S10 13.88 10 12.5s1.12-2.5 2.5-2.5c.57 0 1.08.19 1.5.51V5h4v2zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6z"}}]})(e)},Vm=Lt.GenIcon,Km=function(e){return Vm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"}}]})(e)},Hm=Lt.GenIcon,$m=function(e){return Hm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4zm-4-2V9h-1l-2 1v1h1.5v4H13z"}}]})(e)},Gm=Lt.GenIcon,Ym=function(e){return Gm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"}}]})(e)},Xm=Lt.GenIcon,Zm=function(e){return Xm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"}}]})(e)},Qm=Lt.GenIcon,Jm=function(e){return Qm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"}}]})(e)},qm=Lt.GenIcon,e0=function(e){return qm({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M17 6h5v2h-2v13a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V8H2V6h5V3a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v3zm1 2H6v12h12V8zm-9 3h2v6H9v-6zm4 0h2v6h-2v-6zM9 4v2h6V4H9z"}}]}]})(e)},t0=Lt.GenIcon,r0=function(e){return t0({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{fill:"none",d:"M0 0H24V24H0z"}},{tag:"path",attr:{d:"M22 18v2H2v-2h20zM2 3.5l8 5-8 5v-10zM22 11v2H12v-2h10zm0-7v2H12V4h10z"}}]}]})(e)},i0=Lt.GenIcon,n0=function(e){return i0({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M4 9h3.5c.736 0 1.393.391 1.851 1.001.325-.604.729-1.163 1.191-1.662-.803-.823-1.866-1.339-3.042-1.339h-3.5c-.553 0-1 .448-1 1s.447 1 1 1zM11.685 12.111c.551-1.657 2.256-3.111 3.649-3.111h1.838l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707c-.391-.391-1.023-.391-1.414 0s-.391 1.023 0 1.414l1.293 1.293h-1.838c-2.274 0-4.711 1.967-5.547 4.479l-.472 1.411c-.641 1.926-2.072 3.11-2.815 3.11h-2.5c-.553 0-1 .448-1 1s.447 1 1 1h2.5c1.837 0 3.863-1.925 4.713-4.479l.472-1.41zM15.879 13.293c-.391.391-.391 1.023 0 1.414l1.293 1.293h-2.338c-1.268 0-2.33-.891-2.691-2.108-.256.75-.627 1.499-1.09 2.185.886 1.162 2.243 1.923 3.781 1.923h2.338l-1.293 1.293c-.391.391-.391 1.023 0 1.414.195.195.451.293.707.293s.512-.098.707-.293l3.707-3.707-3.707-3.707c-.391-.391-1.023-.391-1.414 0z"}}]})(e)},a0=Lt.GenIcon,s0=function(e){return a0({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16.707 7.404c-.189-.188-.448-.283-.707-.283s-.518.095-.707.283l-2.293 2.293v-6.697c0-.552-.448-1-1-1s-1 .448-1 1v6.697l-2.293-2.293c-.189-.188-.44-.293-.707-.293s-.518.105-.707.293c-.39.39-.39 1.024 0 1.414l4.707 4.682 4.709-4.684c.388-.387.388-1.022-.002-1.412zM20.987 16c0-.105-.004-.211-.039-.316l-2-6c-.136-.409-.517-.684-.948-.684h-.219c-.094.188-.21.368-.367.525l-1.482 1.475h1.348l1.667 5h-13.893l1.667-5h1.348l-1.483-1.475c-.157-.157-.274-.337-.367-.525h-.219c-.431 0-.812.275-.948.684l-2 6c-.035.105-.039.211-.039.316-.013 0-.013 5-.013 5 0 .553.447 1 1 1h16c.553 0 1-.447 1-1 0 0 0-5-.013-5z"}}]})(e)},o0=function(){return q.createElement(Tm,{className:"react-jinke-music-player-play-icon"})},l0=function(){return q.createElement(bm,{className:"react-jinke-music-player-pause-icon"})},u0=function(e){var r=e.prefix,i=e.visible,t=e.title,n=e.text;return q.createElement("div",{className:Ft("".concat(r,"-play-model-tip"),{show:i})},q.createElement("span",{className:"".concat(r,"-play-model-tip-title")},t),q.createElement("span",{className:"".concat(r,"-play-model-tip-text")},n))},f0=Ye.exports.memo(u0),dr="react-jinke-music-player-mobile",kf=function(e){var r=e.name,i=e.cover,t=e.singer,n=e.playing,a=e.duration,o=e.currentTime,l=e.loading,v=e.themeSwitch,h=e.progressBar,f=e.openAudioListsPanel,d=e.audioPrevPlay,g=e.audioNextPlay,E=e.playMode,S=e.onClose,x=e.playModeTipVisible,m=e.currentPlayModeName,c=e.extendsContent,p=e.onPlay,y=e.glassBg,u=e.onCoverClick,_=e.autoHiddenCover,b=e.icon,T=e.locale,A=e.toggleMode,L=e.renderAudioTitle,R=e.shouldShowPlayIcon,w=e.isResetCoverRotate;return q.createElement("div",{className:Ft(dr,{"default-bg":!y,"glass-bg":y})},q.createElement(f0,{prefix:dr,visible:x,title:E,text:m}),q.createElement("div",{className:"".concat(dr,"-header group")},q.createElement("div",{className:"".concat(dr,"-header-title"),title:r},L()),A&&q.createElement("div",{className:"".concat(dr,"-header-right"),onClick:S},b.close)),q.createElement("div",{className:"".concat(dr,"-singer text-center group")},q.createElement("span",{className:"".concat(dr,"-singer-name"),title:t},t)),q.createElement("div",{className:"".concat(dr,"-switch text-center group")},v),(!_||_&&i)&&q.createElement("div",{className:"".concat(dr,"-cover text-center"),onClick:function(){return u()}},q.createElement("img",{src:i,alt:"cover",className:Ft("cover",{"img-rotate-pause":!n||!i,"img-rotate-reset":w})})),q.createElement("div",{className:"".concat(dr,"-progress group")},q.createElement("span",{className:"current-time"},l?"--":o),q.createElement("span",{className:"".concat(dr,"-progress-bar")},h),q.createElement("span",{className:"duration text-right"},l?"--":a)),q.createElement("div",{className:"".concat(dr,"-toggle text-center group")},q.createElement("span",{className:"group prev-audio",title:T.previousTrackText,onClick:d},b.prev),l?q.createElement("span",{className:"group loading-icon"},b.loading):q.createElement("span",{className:"group play-btn",title:R?T.clickToPlayText:T.clickToPauseText,onClick:p},R?b.play:b.pause),q.createElement("span",{className:"group next-audio",title:T.nextTrackText,onClick:g},b.next)),q.createElement("div",{className:"".concat(dr,"-operation group")},q.createElement("ul",{className:"items"},[E,b.download,b.reload,b.lyric].filter(Ye.exports.isValidElement).map(function(O){return q.createElement("li",{className:"item",key:O.props.className},O)}),c,q.createElement("li",{className:"item",onClick:f},b.playLists))))};kf.defaultProps={icon:{},renderAudioTitle:function(){}};var d0=Ye.exports.memo(kf),c0=function(e){var r=e.visible,i=e.value;return q.createElement("div",{className:Ft("play-mode-title",{"play-mode-title-visible":r})},i)},h0=Ye.exports.memo(c0),p0=350,v0=32,ta={en_US:"en_US",zh_CN:"zh_CN"},Nf={MOBILE:"(max-width: 768px) and (orientation : portrait)",DARK_THEME:"screen and (prefers-color-scheme: dark)",LIGHT_THEME:"screen and (prefers-color-scheme: light)"},Sr={FULL:"full",MINI:"mini"},Ff={NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3,NETWORK_READY_SUCCESS_STATE:4},g0={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},Et={order:"order",orderLoop:"orderLoop",singleLoop:"singleLoop",shufflePlay:"shufflePlay"},Tr={LIGHT:"light",DARK:"dark",AUTO:"auto"},Bf=se.oneOf(["order","orderLoop","singleLoop","shufflePlay"]),m0={audioLists:se.array.isRequired,locale:se.oneOfType([se.object,se.oneOf(Object.values(ta))]),theme:se.oneOf(Object.values(Tr)),mode:se.oneOf(Object.values(Sr)),defaultPlayMode:Bf,playMode:Bf,drag:se.bool,seeked:se.bool,autoPlay:se.bool,clearPriorAudioLists:se.bool,autoPlayInitLoadPlayList:se.bool,playModeText:se.object,panelTitle:se.string,closeText:se.oneOfType([se.string,se.object]),openText:se.oneOfType([se.string,se.object]),clickToPlayText:se.oneOfType([se.string,se.object]),clickToPauseText:se.oneOfType([se.string,se.object]),nextTrackText:se.oneOfType([se.string,se.object]),previousTrackText:se.oneOfType([se.string,se.object]),reloadText:se.oneOfType([se.string,se.object]),volumeText:se.oneOfType([se.string,se.object]),playListsText:se.oneOfType([se.string,se.object]),toggleLyricText:se.oneOfType([se.string,se.object]),toggleMiniModeText:se.oneOfType([se.string,se.object]),destroyText:se.oneOfType([se.string,se.object]),downloadText:se.oneOfType([se.string,se.object]),emptyText:se.oneOfType([se.string,se.object]),controllerTitle:se.oneOfType([se.string,se.object]),defaultPosition:se.shape({top:se.oneOfType([se.number,se.string]),left:se.oneOfType([se.number,se.string]),right:se.oneOfType([se.number,se.string]),bottom:se.oneOfType([se.number,se.string])}),onAudioPlay:se.func,onAudioPause:se.func,onAudioEnded:se.func,onAudioAbort:se.func,onAudioVolumeChange:se.func,onAudioError:se.func,onAudioProgress:se.func,onAudioSeeked:se.func,onAudioDownload:se.func,onAudioReload:se.func,onThemeChange:se.func,onAudioListsChange:se.func,onPlayModeChange:se.func,onModeChange:se.func,onAudioListsPanelChange:se.func,onAudioPlayTrackChange:se.func,onAudioListsSortEnd:se.func,onAudioLyricChange:se.func,showDownload:se.bool,showPlay:se.bool,showReload:se.bool,showPlayMode:se.bool,showThemeSwitch:se.bool,showMiniModeCover:se.bool,toggleMode:se.bool,once:se.bool,extendsContent:se.oneOfType([se.array,se.bool,se.object,se.node,se.element,se.string]),checkedText:se.oneOfType([se.string,se.object]),unCheckedText:se.oneOfType([se.string,se.object]),defaultVolume:se.number,playModeShowTime:se.number,bounds:se.oneOfType([se.string,se.object]),showMiniProcessBar:se.bool,loadAudioErrorPlayNext:se.bool,preload:se.oneOfType([se.bool,se.oneOf(["auto","metadata","none"])]),glassBg:se.bool,remember:se.bool,remove:se.bool,defaultPlayIndex:se.number,playIndex:se.number,lyricClassName:se.string,emptyLyricText:se.oneOfType([se.string,se.object]),showLyric:se.bool,getContainer:se.func,getAudioInstance:se.func,onBeforeAudioDownload:se.func,autoHiddenCover:se.bool,spaceBar:se.bool,showDestroy:se.bool,onBeforeDestroy:se.func,onDestroyed:se.func,customDownloader:se.func,audioTitle:se.oneOfType([se.string,se.func]),responsive:se.bool,quietUpdate:se.bool,renderAudioTitle:se.func,mobileMediaQuery:se.string,volumeFade:se.shape({fadeIn:se.number,fadeOut:se.number}),sortableOptions:se.object},y0={min:0,step:1},E0={min:0,max:1,step:.01},kr={IN:"in",OUT:"out",NONE:"none"},_0={playModeText:{order:"Play in order",orderLoop:"List loop",singleLoop:"Single loop",shufflePlay:"Shuffle playback"},openText:"Open",closeText:"Close",emptyText:"No music",clickToPlayText:"Click to play",clickToPauseText:"Click to pause",nextTrackText:"Next track",previousTrackText:"Previous track",reloadText:"Reload",volumeText:"Volume",playListsText:"Playlists",toggleLyricText:"Toggle lyric",toggleMiniModeText:"Minimize",destroyText:"Destroy",downloadText:"Download",lightThemeText:"L",darkThemeText:"D",switchThemeText:"Dark/Light mode",removeAudioListsText:"Delete audio lists",clickToDeleteText:function(e){return"Click to delete ".concat(e)},controllerTitle:q.createElement(Pf,null),emptyLyricText:"No lyric",loadingText:"Loading"},x0={playModeText:{order:"\u987A\u5E8F\u64AD\u653E",orderLoop:"\u5217\u8868\u5FAA\u73AF",singleLoop:"\u5355\u66F2\u5FAA\u73AF",shufflePlay:"\u968F\u673A\u64AD\u653E"},openText:"\u6253\u5F00",closeText:"\u5173\u95ED",emptyText:"\u97F3\u4E50\u64AD\u653E\u5217\u8868\u4E3A\u7A7A",clickToPlayText:"\u70B9\u51FB\u64AD\u653E",clickToPauseText:"\u70B9\u51FB\u6682\u505C",nextTrackText:"\u4E0B\u4E00\u9996",previousTrackText:"\u4E0A\u4E00\u9996",reloadText:"\u91CD\u65B0\u64AD\u653E",volumeText:"\u97F3\u91CF",playListsText:"\u64AD\u653E\u5217\u8868",toggleLyricText:"\u663E\u793A/\u9690\u85CF \u6B4C\u8BCD",toggleMiniModeText:"\u5207\u6362\u81F3\u8FF7\u4F60\u6A21\u5F0F",destroyText:"\u79FB\u9664\u64AD\u653E\u5668",downloadText:"\u4E0B\u8F7D",lightThemeText:"\u4EAE",darkThemeText:"\u6697",switchThemeText:"\u6697\u9ED1/\u660E\u4EAE \u4E3B\u9898",removeAudioListsText:"\u6E05\u7A7A\u64AD\u653E\u5217\u8868",clickToDeleteText:function(e){return"\u70B9\u51FB\u5220\u9664 ".concat(e)},controllerTitle:q.createElement(Pf,null),emptyLyricText:"\u6682\u65E0\u6B4C\u8BCD",loadingText:"\u52A0\u8F7D\u4E2D"},Es;function Uf(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var b0=(Es={},Uf(Es,ta.en_US,_0),Uf(Es,ta.zh_CN,x0),Es),jf=b0;function S0(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function Wf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function T0(s,e,r){return e&&Wf(s.prototype,e),r&&Wf(s,r),s}var zf=/\[(\d{2,}):(\d{2})(?:\.(\d{2,3}))?]/g,Vf=0,_s=1,Kf={title:"ti",artist:"ar",album:"al",offset:"offset",by:"by"},A0=function(){function s(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};S0(this,s),this.lrc=e,this.tags={},this.lines=[],this.handler=r,this.state=Vf,this.curLine=0,this._init()}return T0(s,[{key:"_init",value:function(){this._initTag(),this._initLines()}},{key:"_initTag",value:function(){for(var r in Kf){var i=this.lrc.match(new RegExp("\\[".concat(Kf[r],":([^\\]]*)]"),"i"));this.tags[r]=i&&i[1]||""}}},{key:"_initLines",value:function(){for(var r=this.lrc.split(`
`),i=parseInt(this.tags.offset,10)||0,t=0;t<r.length;t++){var n=r[t],a=zf.exec(n);if(a){var o=n.replace(zf,"").trim();o&&this.lines.push({time:a[1]*60*1e3+a[2]*1e3+(a[3]||0)*10+i,txt:o})}}this.lines.sort(function(l,v){return l.time-v.time})}},{key:"_findCurNum",value:function(r){for(var i=0;i<this.lines.length;i++)if(r<=this.lines[i].time)return i;return this.lines.length-1}},{key:"_callHandler",value:function(r){r<0||this.handler({txt:this.lines[r].txt,lineNum:r})}},{key:"_playRest",value:function(){var r=this,i=this.lines[this.curNum],t=i.time-(+new Date-this.startStamp);this.timer=setTimeout(function(){r._callHandler(r.curNum++),r.curNum<r.lines.length&&r.state===_s&&r._playRest()},t)}},{key:"play",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;!this.lines.length||(this.state=_s,this.curNum=this._findCurNum(r),this.startStamp=+new Date-r,i||this._callHandler(this.curNum-1),this.curNum<this.lines.length&&(clearTimeout(this.timer),this._playRest()))}},{key:"togglePlay",value:function(){var r=+new Date;this.state===_s?(this.stop(),this.pauseStamp=r):(this.state=_s,this.play((this.pauseStamp||r)-(this.startStamp||r),!0),this.pauseStamp=0)}},{key:"stop",value:function(){this.state=Vf,clearTimeout(this.timer)}},{key:"seek",value:function(r){this.play(r)}}]),s}();function Hf(s){var e=0,r=0,i=parseInt(s);i>=60&&(e=parseInt(i/60),i=parseInt(i%60),e>=60&&(r=parseInt(e/60),e=parseInt(e%60)));var t=function(a){return a>>0<10?"0".concat(a):a};return r>0?[t(r),t(e),t(i)].join(":"):[t(e),t(i)].join(":")}function w0(s,e){return parseInt(Math.random()*(e-s+1)+s,10)}var O0=function(e){return function(r){return JSON.stringify(e)===JSON.stringify(r)}},mi=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},$f=function(){return"".concat(mi()+mi(),"-").concat(mi(),"-").concat(mi(),"-").concat(mi(),"-").concat(mi()).concat(mi()).concat(mi())},L0=function(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)};function I0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function R0(s){return .5-Math.cos(s*Math.PI)/2}function Gf(s,e,r){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},t=i.duration,n=t===void 0?1e3:t,a=i.easing,o=a===void 0?R0:a,l=i.interval,v=l===void 0?13:l,h=arguments.length>4?arguments[4]:void 0,f=r-e;if(!f||!n||!o||!v||I0())return s.volume=r,h(),{fadeInterval:void 0,updateIntervalEndVolume:void 0};var d=Math.floor(n/v),g=1,E=function(m){r=m},S=setInterval(function(){var x=r-e;x!==f&&(f=x),s.volume=e+o(g/d)*f,++g>=d&&(s.volume=r,clearInterval(S),h())},v);return{fadeInterval:S,updateIntervalEndVolume:E}}function dn(){return dn=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},dn.apply(this,arguments)}function D0(s,e){if(s==null)return{};var r=C0(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function C0(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}function Yf(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function ht(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Yf(Object(r),!0).forEach(function(i){ge(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Yf(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function cn(s){return N0(s)||k0(s)||M0(s)||P0()}function P0(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M0(s,e){if(!!s){if(typeof s=="string")return cl(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cl(s,e)}}function k0(s){if(typeof Symbol!="undefined"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function N0(s){if(Array.isArray(s))return cl(s)}function cl(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=s[r];return i}function yi(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yi=function(r){return typeof r}:yi=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yi(s)}function F0(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function Xf(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function B0(s,e,r){return e&&Xf(s.prototype,e),r&&Xf(s,r),s}function U0(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),e&&hl(s,e)}function hl(s,e){return hl=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},hl(s,e)}function j0(s){var e=z0();return function(){var i=xs(s),t;if(e){var n=xs(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return W0(this,t)}}function W0(s,e){return e&&(yi(e)==="object"||typeof e=="function")?e:ye(s)}function ye(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function z0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function xs(s){return xs=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},xs(s)}function ge(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}Qe.mount(new um);var pl=Ep(),Zf={pause:q.createElement(l0,null),play:q.createElement(o0,null),destroy:q.createElement(Mf,null),close:q.createElement(Mf,null),delete:q.createElement(e0,{size:24}),download:q.createElement(s0,{size:26}),toggle:q.createElement(Im,null),lyric:q.createElement(wm,null),volume:q.createElement(Um,{size:26}),mute:q.createElement(Fm,{size:26}),next:q.createElement(Jm,null),prev:q.createElement(Ym,null),playLists:q.createElement(r0,null),reload:q.createElement(Pm,{size:22}),loop:q.createElement($m,{size:26}),order:q.createElement(Zm,{size:26}),orderLoop:q.createElement(Km,{size:26}),shuffle:q.createElement(n0,{size:26}),loading:q.createElement(Dm,null),packUpPanelMobile:q.createElement(km,{size:26}),empty:q.createElement(zm,null)},vl=function(s){U0(r,s);var e=j0(r);function r(i){var t;return F0(this,r),t=e.call(this,i),ge(ye(t),"isDrag",!1),ge(ye(t),"initPlayId",""),ge(ye(t),"state",{audioLists:[],playId:t.initPlayId,name:"",cover:"",singer:"",musicSrc:"",lyric:"",currentLyric:"",isMobile:pl,toggle:t.props.mode===Sr.FULL,playing:!1,currentTime:0,soundValue:dm,moveX:0,moveY:0,loading:!1,audioListsPanelVisible:!1,playModelNameVisible:!1,theme:t.props.theme||t.darkThemeName,playMode:t.props.playMode||t.props.defaultPlayMode||"",currentAudioVolume:0,initAnimate:!1,isInitAutoPlay:t.props.autoPlay,isInitRemember:!1,loadedProgress:0,removeId:cm,isNeedMobileHack:pl,audioLyricVisible:!1,isAutoPlayWhenUserClicked:!1,playIndex:t.props.playIndex||t.props.defaultPlayIndex||ea,canPlay:!1,currentVolumeFade:kr.NONE,currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0,isAudioSeeking:!1,isResetCoverRotate:!1}),ge(ye(t),"getPlayIndex",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.state.playIndex,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t.state.audioLists;return Math.max(ea,Math.min(a.length-1,n))}),ge(ye(t),"onCoverClick",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Sr.FULL,a=t.props.showMiniModeCover,o=t.state.cover;!a&&n===Sr.MINI||t.props.onCoverClick&&o&&t.props.onCoverClick(n,t.state.audioLists,t.getBaseAudioInfo())}),ge(ye(t),"getAudioTitle",function(){var n=t.locale||{},a=n.audioTitle,o=t.state,l=o.name,v=o.singer;return typeof a=="function"&&t.audio?a(t.getBaseAudioInfo()):a||"".concat(l).concat(v?" - ".concat(v):"")}),ge(ye(t),"renderAudioTitle",function(){var n=t.state,a=n.isMobile,o=n.name;return t.props.renderAudioTitle?t.props.renderAudioTitle(t.getBaseAudioInfo(),a):a?o:t.getAudioTitle()}),ge(ye(t),"toggleAudioLyric",function(){t.setState({audioLyricVisible:!t.state.audioLyricVisible})}),ge(ye(t),"togglePlayMode",function(){var n=t._PLAY_MODE_.findIndex(function(o){return o===t.state.playMode}),a=n===t._PLAY_MODE_LENGTH_-1?t._PLAY_MODE_[0]:t._PLAY_MODE_[++n];t.setState({playMode:a,playModelNameVisible:!0,playModeTipVisible:!0}),t.props.onPlayModeChange&&t.props.onPlayModeChange(a),clearTimeout(t.playModelTimer),t.playModelTimer=setTimeout(function(){t.setState({playModelNameVisible:!1,playModeTipVisible:!1})},t.props.playModeShowTime)}),ge(ye(t),"renderPlayModeIcon",function(n){var a={className:"react-jinke-music-player-mode-icon"},o=null;switch(n){case Et.order:o=Ye.exports.cloneElement(t.iconMap.order,a);break;case Et.orderLoop:o=Ye.exports.cloneElement(t.iconMap.orderLoop,a);break;case Et.singleLoop:o=Ye.exports.cloneElement(t.iconMap.loop,a);break;case Et.shufflePlay:o=Ye.exports.cloneElement(t.iconMap.shuffle,a);break;default:o=Ye.exports.cloneElement(t.iconMap.order,a)}return o}),ge(ye(t),"audioListsPlay",function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.state,l=o.playId,v=o.playing,h=o.audioLists,f=o.loading,d=o.canPlay;if(Array.isArray(h)&&h.length===0)return console.warn("Warning: Your playlist has no songs. and cannot play !");if(!(f&&n===l)){var g=h.findIndex(function(_){return _[mt]===n}),E=h[g]||{},S=E.name,x=E.cover,m=E.musicSrc,c=E.singer,p=E.lyric,y=p===void 0?"":p,u=function(b){t.setState({name:S,cover:x,musicSrc:b,singer:c,playId:n,lyric:y,currentTime:0,playing:!1,loading:!0,canPlay:!1,loadedProgress:0,playIndex:g,isAutoPlayWhenUserClicked:!0},function(){t.lyric&&t.lyric.stop(),t.audio.load(),t.updateMediaSessionMetadata(),setTimeout(function(){t.initLyricParser()},0)})};if(n===l&&!a){if(t.setState({playing:!v}),!v){if(d){t.play();return}return u(m)}return t.audio.pause()}switch(t.props.onAudioPlayTrackChange&&t.props.onAudioPlayTrackChange(n,h,t.getBaseAudioInfo()),t.props.onPlayIndexChange&&t.props.onPlayIndexChange(g),yi(m)){case"function":m().then(u,t.onAudioError);break;default:u(m)}}}),ge(ye(t),"resetAudioStatus",function(){t.audio.pause(),t.lyric&&t.lyric.stop(),t.initPlayInfo([]),t.resetAudioPlayStatus(),t.resetAudioPlayId()}),ge(ye(t),"resetAudioPlayId",function(){t.setState({playId:t.initPlayId})}),ge(ye(t),"clearAudioLists",function(){t.props.onAudioListsChange&&t.props.onAudioListsChange("",[],{}),t.resetAudioStatus()}),ge(ye(t),"onDeleteAudioLists",function(n){return function(a){a.stopPropagation();var o=t.state,l=o.audioLists,v=o.playId;if(!(l.length<1)){if(t.lyric&&t.lyric.stop(),!n){t.clearAudioLists();return}var h=cn(l).filter(function(f){return f[mt]!==n});t.setState({removeId:n}),setTimeout(function(){t.setState({audioLists:h,removeId:-1},function(){if(!h.length)return t.resetAudioStatus();n===v&&t.handlePlay(Et.orderLoop)})},p0),t.props.onAudioListsChange&&t.props.onAudioListsChange(v,h,t.getBaseAudioInfo())}}}),ge(ye(t),"openAudioListsPanel",function(){t.setState(function(n){var a=n.audioListsPanelVisible;return{initAnimate:!0,audioListsPanelVisible:!a}}),t.props.onAudioListsPanelChange&&t.props.onAudioListsPanelChange(!t.state.audioListsPanelVisible)}),ge(ye(t),"closeAudioListsPanel",function(n){n.stopPropagation(),t._closeAudioListsPanel()}),ge(ye(t),"_closeAudioListsPanel",function(){var n=t.state.audioListsPanelVisible;t.setState({audioListsPanelVisible:!1}),n&&t.props.onAudioListsPanelChange&&t.props.onAudioListsPanelChange(!1)}),ge(ye(t),"themeChange",function(n){var a=n?Tr.LIGHT:Tr.DARK;t.setState({theme:a}),t.props.onThemeChange&&t.props.onThemeChange(a)}),ge(ye(t),"onAudioDownload",function(){var n=t.state.musicSrc;if(t.state.musicSrc){var a=t.props.customDownloader,o=t.getBaseAudioInfo(),l=t.props.onBeforeAudioDownload(o),v={};l&&l.then?l.then(function(h){var f=h.src,d=h.filename,g=h.mimeType;v=h,a?a(h):gu(f,d,g)}):a?a({src:n}):gu(n),t.props.onAudioDownload&&t.props.onAudioDownload(o,v)}}),ge(ye(t),"onControllerDrag",function(n,a){var o=a.x,l=a.y,v=t.state,h=v.moveX,f=v.moveY;t.isDrag=!0,h===o&&f===l&&(t.isDrag=!1)}),ge(ye(t),"onControllerDragStart",function(n,a){var o=a.x,l=a.y;t.isDrag=!1,t.setState({moveX:o,moveY:l})}),ge(ye(t),"onControllerDragStop",function(n,a){var o=a.x,l=a.y;if(t.props.showDestroy&&t.destroyBtn&&t.destroyBtn.current&&t.destroyBtn.current.contains(n.target)){t.onDestroyPlayer();return}t.isDrag||(t.state.isNeedMobileHack&&(t.loadAndPlayAudio(),t.setState({isNeedMobileHack:!1})),t.onOpenPanel()),t.setState({moveX:o,moveY:l})}),ge(ye(t),"onResetVolume",function(){var n=t.state.currentAudioVolume;t.setAudioVolume(t.getVolumeBarValue(n||.1))}),ge(ye(t),"setAudioVolume",function(n){t.audio.volume=t.getListeningVolume(n),t.setState({currentAudioVolume:n,soundValue:n}),t.state.currentVolumeFade===kr.IN&&t.state.updateIntervalEndVolume&&t.state.updateIntervalEndVolume(n)}),ge(ye(t),"stopAll",function(n){n.stopPropagation(),n.preventDefault()}),ge(ye(t),"getBoundingClientRect",function(n){var a=n.getBoundingClientRect(),o=a.left,l=a.top;return{left:o,top:l}}),ge(ye(t),"getListeningVolume",function(n){return Math.pow(n,2)}),ge(ye(t),"getVolumeBarValue",function(n){return Math.sqrt(n)}),ge(ye(t),"onAudioReload",function(){t.props.audioLists.length&&(t.handlePlay(Et.singleLoop),t.props.onAudioReload&&t.props.onAudioReload(t.getBaseAudioInfo()))}),ge(ye(t),"onOpenPanel",function(){var n=t.props,a=n.toggleMode,o=n.spaceBar;a&&(t.setState({toggle:!0}),t.props.onModeChange&&t.props.onModeChange(Sr.FULL),o&&t.player.current&&t.player.current.focus({preventScroll:!0})),t.onCoverClick(Sr.MINI)}),ge(ye(t),"onHidePanel",function(){t.setState({toggle:!1,audioListsPanelVisible:!1}),t.props.onModeChange&&t.props.onModeChange(Sr.MINI)}),ge(ye(t),"onDestroyPlayer",function(){if(t.props.onBeforeDestroy){var n=Promise.resolve(t.props.onBeforeDestroy(t.state.playId,t.state.audioLists,t.getBaseAudioInfo()));n&&n.then&&n.then(function(){t._onDestroyPlayer()}).catch(function(){});return}t._onDestroyPlayer()}),ge(ye(t),"_onDestroyPlayer",function(){t.unInstallPlayer()}),ge(ye(t),"_onDestroyed",function(){t.setState({isPlayDestroyed:!0}),t.props.onDestroyed&&t.props.onDestroyed(t.state.playId,t.state.audioLists,t.getBaseAudioInfo())}),ge(ye(t),"getCurrentPlayIndex",function(){return t.state.audioLists.findIndex(function(n){return n[mt]===t.state.playId})}),ge(ye(t),"resetAudioPlayStatus",function(){return new Promise(function(n){t.setState({currentTime:0,loading:!1,playing:!1,canPlay:!1,lyric:"",currentLyric:"",loadedProgress:0,playIndex:ea},n)})}),ge(ye(t),"onTogglePlay",function(){if(t.setState({isAudioSeeking:!1}),t.state.audioLists.length>=1){var n=t.props.volumeFade||{},a=n.fadeIn,o=n.fadeOut,l=t.state,v=l.currentVolumeFade,h=l.currentVolumeFadeInterval,f=v===kr.IN||v===kr.OUT;if(f&&(clearInterval(h),t.setState({currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0})),!f&&t.state.playing||v===kr.IN){t.setState({currentVolumeFade:kr.OUT});var d=Gf(t.audio,t.audio.volume,0,{duration:o},function(){t.audio.pause(),t.setState({currentVolumeFade:kr.NONE,currentVolumeFadeInterval:void 0,playing:!1,updateIntervalEndVolume:void 0}),t.audio.volume=t.getListeningVolume(t.state.soundValue)}),g=d.fadeInterval,E=d.updateIntervalEndVolume;t.setState({currentVolumeFadeInterval:g,updateIntervalEndVolume:E})}else{t.setState({currentVolumeFade:kr.IN});var S=f?t.audio.volume:0,x=t.getListeningVolume(t.state.soundValue),m=Gf(t.audio,S,x,{duration:a},function(){t.setState({currentVolumeFade:kr.NONE,currentVolumeFadeInterval:void 0,updateIntervalEndVolume:void 0}),t.audio.volume=t.getListeningVolume(t.state.soundValue)}),c=m.fadeInterval,p=m.updateIntervalEndVolume;t.setState({currentVolumeFadeInterval:c,updateIntervalEndVolume:p,isAutoPlayWhenUserClicked:!0},function(){c&&(t.audio.volume=S),t.loadAndPlayAudio()})}}}),ge(ye(t),"playAudio",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;(t.isAudioCanPlay||n)&&(n&&t.setAudioLoaded(),t.loadAndPlayAudio(n))}),ge(ye(t),"setAudioLoaded",function(){t.setState({loading:!1,playing:!1})}),ge(ye(t),"onAudioPause",function(){t.setState({playing:!1}),t.props.onAudioPause&&t.props.onAudioPause(t.getBaseAudioInfo()),t.state.lyric&&t.lyric&&t.lyric.togglePlay()}),ge(ye(t),"onAudioPlay",function(){t.state.isAudioSeeking||(t.setState({playing:!0,loading:!1}),t.props.onAudioPlay&&t.props.onAudioPlay(t.getBaseAudioInfo()),t.state.lyric&&t.lyric&&t.lyric.togglePlay())}),ge(ye(t),"onSetAudioLoadedProgress",function(){var n=t.audio,a=n.buffered,o=n.duration;if(a.length&&a.end){var l=a.end(a.length-1)/o*100;t.setState({loadedProgress:l})}}),ge(ye(t),"loadAndPlayAudio",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=t.props.remember,o=t.state,l=o.isInitRemember,v=o.musicSrc,h=t.audio,f=h.networkState,d=h.readyState;if(!!v){if(f===Ff.NETWORK_NO_SOURCE||f===Ff.NETWORK_EMPTY)return t.onAudioError({reason:`
          [loadAndPlayAudio]: Failed to load because no supported source was found.
          current network status is `.concat(f,`.
        `)});if(t.setState({playing:!1,loading:!0,isAudioSeeking:!1,isResetCoverRotate:!1}),n||d>=g0.HAVE_FUTURE_DATA){var g=t.getLastPlayStatus(),E=g.playing,S=a&&!l&&!E,x=a?!S:t.isAudioCanPlay;t.setState({playing:x,loading:!1},function(){x&&t.play(),t.setState({isInitAutoPlay:!0,isInitRemember:!0,isAutoPlayWhenUserClicked:!1})})}else t.audio.load()}}),ge(ye(t),"onAudioError",function(n){var a=t.state,o=a.playMode,l=a.audioLists,v=a.playId,h=a.musicSrc,f=t.props.loadAudioErrorPlayNext,d=o===Et.singleLoop,g=d?Et.order:o;if(t.lyric&&t.lyric.stop(),h){if(f&&l.length){var E=(o===Et.order||o===Et.orderLoop)&&v===l[l.length-1][mt];E||t.handlePlay(g,!0)}t.props.onAudioError&&t.props.onAudioError(t.audio.error||n&&n.reason||null,v,l,t.getBaseAudioInfo())}}),ge(ye(t),"handlePlay",function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=t.state,l=o.playId,v=o.audioLists,h=v.length;if(!!h){var f=t.getCurrentPlayIndex();switch(n){case Et.order:if(f===h-1){t.audio.pause();return}t.audioListsPlay(a?v[f+1][mt]:v[f-1][mt]);break;case Et.orderLoop:if(a){if(f===h-1)return t.audioListsPlay(v[0][mt]);t.audioListsPlay(v[f+1][mt])}else{if(f===0)return t.audioListsPlay(v[h-1][mt]);t.audioListsPlay(v[f-1][mt])}break;case Et.singleLoop:t.audio.currentTime=0,t.audioListsPlay(l,!0);break;case Et.shufflePlay:{var d=w0(0,h-1);d===t.getCurrentPlayIndex()&&(d=t.getPlayIndex(d+1));var g=(v[d]||{})[mt];t.audioListsPlay(g,!0)}break}}}),ge(ye(t),"onAudioEnd",function(){t.props.onAudioEnded&&t.props.onAudioEnded(t.state.playId,t.state.audioLists,t.getBaseAudioInfo()),t.handlePlay(t.state.playMode)}),ge(ye(t),"audioPrevAndNextBasePlayHandle",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,a=t.state.playMode,o="";switch(a){case Et.shufflePlay:o=a;break;default:o=Et.orderLoop;break}t.handlePlay(o,n)}),ge(ye(t),"onPlayPrevAudio",function(){var n=t.props.restartCurrentOnPrev;if(n&&t.audio.currentTime>1){t.audio.currentTime=0;return}t.audioPrevAndNextBasePlayHandle(!1)}),ge(ye(t),"onPlayNextAudio",function(){t.audioPrevAndNextBasePlayHandle(!0)}),ge(ye(t),"audioTimeUpdate",function(){var n=t.audio.currentTime;t.setState({currentTime:n}),t.props.remember&&t.saveLastPlayStatus(),t.props.onAudioProgress&&t.props.onAudioProgress(t.getBaseAudioInfo())}),ge(ye(t),"onAudioSoundChange",function(n){t.setAudioVolume(n)}),ge(ye(t),"onAudioVolumeChange",function(){var n=t.audio.volume,a=t.state,o=a.currentVolumeFade,l=a.currentAudioVolume;if(!(o!==kr.NONE||l===n)){var v=t.getVolumeBarValue(n);if(t.setState({soundValue:v}),t.props.onAudioVolumeChange){var h=parseFloat(n.toFixed(4));t.props.onAudioVolumeChange(h)}}}),ge(ye(t),"onProgressChange",function(n){t.audio&&(t.audio.currentTime=n),t.setState({currentTime:n,isAudioSeeking:!0})}),ge(ye(t),"onAudioSeeked",function(n){t.setState({isAudioSeeking:!0}),!!t.state.audioLists.length&&(t.lyric&&t.lyric.seek(n*1e3),t.state.playing||t.lyric&&t.lyric.stop(),t.audio&&(t.audio.currentTime=n),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo()),setTimeout(function(){t.setState({isAudioSeeking:!1})},500))}),ge(ye(t),"onAudioMute",function(){t.setState({soundValue:0,currentAudioVolume:t.audio.volume},function(){t.audio.volume=0})}),ge(ye(t),"onAudioAbort",function(n){var a=t.state,o=a.audioLists,l=a.playId,v=t.getBaseAudioInfo(),h=ht(ht({},n),v);t.props.onAudioAbort&&t.props.onAudioAbort(l,o,h)}),ge(ye(t),"toggleMode",function(n){n===Sr.FULL&&t.setState({toggle:!0})}),ge(ye(t),"toggleTheme",function(n){t.setState({theme:n})}),ge(ye(t),"onAudioListsSortEnd",function(n){var a=n.oldIndex,o=n.newIndex;if(a!==o){var l=t.state,v=l.playId,h=l.audioLists,f=cn(h),d=f.splice(a,1)[0];f.splice(o,0,d);var g=a===v?o:v;t.setState({audioLists:f,playId:g}),t.props.onAudioListsSortEnd&&t.props.onAudioListsSortEnd(a,o),t.props.onAudioListsChange&&t.props.onAudioListsChange(g,f,t.getBaseAudioInfo()),t.props.onAudioListsDragEnd&&(console.warn("[Deprecated] onAudioListsDragEnd is deprecated. please use onAudioListsSortEnd(oldIndex, newIndex){}"),t.props.onAudioListsDragEnd(a,o))}}),ge(ye(t),"saveLastPlayStatus",function(){var n=t.state,a=n.currentTime,o=n.playId,l=n.theme,v=n.soundValue,h=n.playMode,f=n.name,d=n.cover,g=n.singer,E=n.musicSrc,S=JSON.stringify({currentTime:a,playId:o,theme:l,playMode:h,soundValue:v,name:f,cover:d,singer:g,musicSrc:E});localStorage.setItem("lastPlayStatus",S)}),ge(ye(t),"getLastPlayStatus",function(){var n=t.props,a=n.theme,o=n.defaultPlayMode,l=n.playMode,v=n.defaultPlayIndex,h=n.playIndex,f={currentTime:0,playMode:l||o||Et.order,name:"",cover:"",singer:"",musicSrc:"",lyric:"",playId:t.getDefaultPlayId(),theme:a,playing:!0,playIndex:h||v||0};try{return JSON.parse(localStorage.getItem("lastPlayStatus"))||f}catch(d){return f}}),ge(ye(t),"checkCurrentPlayingAudioIsInUpdatedAudioLists",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props,a=t.state,o=a.playId,l=a.musicSrc;return!n.quietUpdate||!Array.isArray(n.audioLists)?!1:o&&n.audioLists.some(function(v){return v[mt]===o||v.musicSrc===l})}),ge(ye(t),"play",function(){var n=t.audio.play();n&&n.then&&n.then(function(){t.setState({loading:!1,playing:!0})}).catch(function(){t.setState({loading:!1,playing:!1})})}),ge(ye(t),"mockAutoPlayForMobile",function(){t.props.autoPlay&&!t.state.playing&&(t.audio.load(),t.play())}),ge(ye(t),"bindMobileAutoPlayEvents",function(){document.addEventListener("touchstart",function(){t.mockAutoPlayForMobile()},{once:!0}),document.addEventListener("WeixinJSBridgeReady",function(){t.mockAutoPlayForMobile()})}),ge(ye(t),"bindSafariAutoPlayEvents",function(){document.addEventListener("click",function(){t.mockAutoPlayForMobile()},{once:!0})}),ge(ye(t),"unBindEvents",function(){var n;(n=t).bindEvents.apply(n,arguments)}),ge(ye(t),"bindEvents",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.audio,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{waiting:t.loadAndPlayAudio,canplay:t.onAudioCanPlay,error:t.onAudioError,ended:t.onAudioEnd,pause:t.onAudioPause,play:t.onAudioPlay,timeupdate:t.audioTimeUpdate,volumechange:t.onAudioVolumeChange,abort:t.onAudioAbort,progress:t.onSetAudioLoadedProgress},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=t.props.once;for(var v in a){var h=a[v];n&&(o?n.addEventListener(v,h,{once:!!(l&&v==="play")}):n.removeEventListener(v,h))}}),ge(ye(t),"getPlayId",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.state.audioLists,a=t.getPlayIndex(void 0,n),o=t.state.playId||n[a]&&n[a][mt];return o}),ge(ye(t),"_getPlayInfo",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=t.getPlayId(n),o=n.find(function(c){return c[mt]===a})||{},l=o.name,v=l===void 0?"":l,h=o.cover,f=h===void 0?"":h,d=o.singer,g=d===void 0?"":d,E=o.musicSrc,S=E===void 0?"":E,x=o.lyric,m=x===void 0?"":x;return{name:v,cover:f,singer:g,musicSrc:S,lyric:m,audioLists:n,playId:a}}),ge(ye(t),"getPlayInfo",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=n.filter(function(v){return!v[mt]}),o=n.filter(function(v){return v[mt]}),l=[].concat(cn(o),cn(a.map(function(v){return ht(ht({},v),{},ge({},mt,$f()))})));return t._getPlayInfo(l)}),ge(ye(t),"getPlayInfoOfNewList",function(n){var a=n.audioLists,o=a===void 0?[]:a,l=o.map(function(v){var h=n.quietUpdate&&t.state.audioLists.find(function(f){var d=f.musicSrc;return d===v.musicSrc})||{};return ht(ht({},v),{},ge({},mt,h[mt]||$f()))});return t._getPlayInfo(l)}),ge(ye(t),"initPlayInfo",function(n,a){var o=t.getPlayInfo(n);switch(yi(o.musicSrc)){case"function":o.musicSrc().then(function(l){t.setState(ht(ht({},o),{},{musicSrc:l}),a)},t.onAudioError);break;default:t.setState(o,a)}}),ge(ye(t),"addMatchMediaListener",function(n,a){var o=window.matchMedia(n);return a(o),"addEventListener"in o?o.addEventListener("change",a):o.addListener(a),o}),ge(ye(t),"removeMatchMediaListener",function(n,a){n&&("removeEventListener"in n?n.removeEventListener("change",a):n.removeListener&&n.removeListener(a))}),ge(ye(t),"addMobileListener",function(){t.mobileMedia=t.addMatchMediaListener(t.props.mobileMediaQuery,t.mobileMediaHandler)}),ge(ye(t),"removeMobileListener",function(){t.removeMatchMediaListener(t.mobileMedia,t.mobileMediaHandler)}),ge(ye(t),"addSystemThemeListener",function(){t.systemThemeMedia=t.addMatchMediaListener(Nf.DARK_THEME,t.systemThemeMediaHandler)}),ge(ye(t),"removeSystemThemeListener",function(){t.removeMatchMediaListener(t.systemThemeMedia,t.systemThemeMediaHandler)}),ge(ye(t),"mobileMediaHandler",function(n){var a=n.matches;t.setState({isMobile:!!a})}),ge(ye(t),"systemThemeMediaHandler",function(n){var a=n.matches;if(t.props.theme===Tr.AUTO){var o=a?Tr.DARK:Tr.LIGHT;t.updateTheme(o)}}),ge(ye(t),"setDefaultAudioVolume",function(){var n=t.props,a=n.defaultVolume,o=n.remember;t.defaultVolume=Math.max(0,Math.min(a,1));var l=t.getLastPlayStatus(),v=l.soundValue,h=v===void 0?t.defaultVolume:v;t.setAudioVolume(o?h:t.defaultVolume)}),ge(ye(t),"getDefaultPlayId",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props.audioLists,a=t.getPlayIndex();return n[a]&&n[a][mt]}),ge(ye(t),"initLyricParser",function(){t.lyric=new A0(t.state.lyric,t.onLyricChange),t.setState({currentLyric:t.lyric.lines[0]&&t.lyric.lines[0].text})}),ge(ye(t),"onLyricChange",function(n){var a=n.lineNum,o=n.txt;t.setState({currentLyric:o}),t.props.onAudioLyricChange&&t.props.onAudioLyricChange(a,o)}),ge(ye(t),"updateTheme",function(n){n&&n!==t.props.theme&&Object.values(Tr).includes(n)&&t.setState({theme:n})}),ge(ye(t),"updateMode",function(n){n&&n!==t.props.mode&&Object.values(Sr).includes(n)&&(t.setState({toggle:n===Sr.FULL}),n===Sr.MINI&&t._closeAudioListsPanel())}),ge(ye(t),"updatePlayMode",function(n){!Object.values(Et).includes(n)||n!==t.props.playMode&&t.setState({playMode:n})}),ge(ye(t),"updateAudioLists",function(n){var a=[].concat(cn(t.state.audioLists),cn(n.filter(function(o){return t.state.audioLists.findIndex(function(l){return l.musicSrc===o.musicSrc})===-1})));t.initPlayInfo(a),t.bindEvents(t.audio),t.props.onAudioListsChange&&t.props.onAudioListsChange(t.state.playId,n,t.getBaseAudioInfo())}),ge(ye(t),"loadNewAudioLists",function(n){var a=n.audioLists,o=n.remember,l=n.playMode,v=n.theme,h=n.autoPlayInitLoadPlayList,f=n.playIndex;if(!(!Array.isArray(a)||!a.length)){var d=t.getPlayInfoOfNewList(n),g=o?t.getLastPlayStatus():{playMode:l||Et.order,playIndex:f||ea};v!==Tr.AUTO&&(g.theme=v);var E=ht(ht(ht({},d),g),{},{isInitAutoPlay:h,playing:t.isAudioCanPlay});if(t.checkCurrentPlayingAudioIsInUpdatedAudioLists(n)){t.setState({audioLists:d.audioLists});return}switch(yi(d.musicSrc)){case"function":d.musicSrc().then(function(S){t.setState(ht(ht({},E),{},{musicSrc:S}))},t.onAudioError);break;default:t.setState(E)}}}),ge(ye(t),"resetPlayId",function(){return new Promise(function(n){t.setState({playId:t.initPlayId},n)})}),ge(ye(t),"changeAudioLists",function(n){t.checkCurrentPlayingAudioIsInUpdatedAudioLists(n)||t.resetAudioStatus(),t.resetPlayId().then(function(){t.loadNewAudioLists(n),t.props.onAudioListsChange&&t.props.onAudioListsChange(t.state.playId,n.audioLists,t.getBaseAudioInfo())})}),ge(ye(t),"updatePlayIndex",function(n){var a=t.getCurrentPlayIndex();n!==void 0&&a!==n&&t.resetAudioPlayStatus().then(function(){var o=t.state.audioLists[t.getPlayIndex(n)];o&&o[mt]&&t.audioListsPlay(o[mt],!0)})}),ge(ye(t),"playByIndex",function(n){t.updatePlayIndex(n)}),ge(ye(t),"getEnhanceAudio",function(){var n=ye(t),a=n.audio;return[{name:"destroy",value:t.onDestroyPlayer},{name:"updatePlayIndex",value:t.updatePlayIndex},{name:"playByIndex",value:t.playByIndex},{name:"playNext",value:t.onPlayNextAudio},{name:"playPrev",value:t.onPlayPrevAudio},{name:"togglePlay",value:t.onTogglePlay},{name:"clear",value:t.clearAudioLists},{name:"sortable",value:t.sortable}].forEach(function(o){var l=o.name,v=o.value;Object.defineProperty(a,l,{value:v,writable:!1})}),a}),ge(ye(t),"onGetAudioInstance",function(){t.props.getAudioInstance&&t.props.getAudioInstance(t.getEnhanceAudio())}),ge(ye(t),"updateMediaSessionMetadata",function(){if("mediaSession"in navigator&&t.props.showMediaSession){var n=t.state,a=n.name,o=n.cover,l=n.singer,v={title:a,artist:l,album:a};o&&(v.artwork=["96x96","128x128","192x192","256x256","384x384","512x512"].map(function(h){return{src:o,sizes:h,type:"image/png"}})),navigator.mediaSession.metadata=new MediaMetadata(v),t.updateMediaSessionPositionState()}}),ge(ye(t),"updateMediaSessionPositionState",function(){if("setPositionState"in navigator.mediaSession)try{var n=ye(t),a=n.audio;navigator.mediaSession.setPositionState({duration:t.audioDuration,playbackRate:a.playbackRate||1,position:a.currentTime||0})}catch(o){console.error("Update media session position state failed: ",o)}}),ge(ye(t),"onAddMediaSession",function(){if("mediaSession"in navigator&&t.props.showMediaSession){var n=10;navigator.mediaSession.setActionHandler("play",t.onTogglePlay),navigator.mediaSession.setActionHandler("pause",t.onTogglePlay),navigator.mediaSession.setActionHandler("seekbackward",function(a){var o=a.seekOffset||n;t.audio.currentTime=Math.max(t.audio.currentTime-o,0),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo())}),navigator.mediaSession.setActionHandler("seekforward",function(a){var o=a.seekOffset||n;t.audio.currentTime=Math.min(t.audio.currentTime+o,t.audioDuration),t.props.onAudioSeeked&&t.props.onAudioSeeked(t.getBaseAudioInfo())}),navigator.mediaSession.setActionHandler("previoustrack",t.onPlayPrevAudio),navigator.mediaSession.setActionHandler("nexttrack",t.onPlayNextAudio),setTimeout(function(){t.updateMediaSessionMetadata()},0);try{navigator.mediaSession.setActionHandler("seekto",function(a){if(a.fastSeek&&"fastSeek"in t.audio){t.audio.fastSeek(a.seekTime);return}t.audio.currentTime=a.seekTime,t.updateMediaSessionPositionState()})}catch(a){console.warn('Warning! The "seekto" media session action is not supported.')}}}),ge(ye(t),"bindUnhandledRejection",function(){window.addEventListener("unhandledrejection",t.onAudioError)}),ge(ye(t),"unBindUnhandledRejection",function(){window.removeEventListener("unhandledrejection",t.onAudioError)}),ge(ye(t),"bindKeyDownEvents",function(){t.props.spaceBar&&t.player.current&&(t.player.current.addEventListener("keydown",t.onKeyDown,!1),t.player.current.focus({preventScroll:!0}))}),ge(ye(t),"unBindKeyDownEvents",function(){t.player.current&&t.player.current.removeEventListener("keydown",t.onKeyDown,!1)}),ge(ye(t),"onKeyDown",function(n){var a=t.props.spaceBar;a&&n.keyCode===v0&&t.onTogglePlay()}),ge(ye(t),"initPlayer",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.props.audioLists,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;o&&t.setDefaultAudioVolume(),!(!Array.isArray(n)||!n.length)&&(t.bindUnhandledRejection(),t.bindEvents(t.audio),t.initLyricParser(),t.onAddMediaSession(),pl?t.bindMobileAutoPlayEvents():(a&&t.bindKeyDownEvents(),L0()&&t.bindSafariAutoPlayEvents()))}),ge(ye(t),"removeLyric",function(){t.lyric&&(t.lyric.stop(),t.lyric=void 0)}),ge(ye(t),"unInstallPlayer",function(){t.unBindEvents(t.audio,void 0,!1),t.unBindUnhandledRejection(),t.unBindKeyDownEvents(),t.removeMobileListener(),t.removeLyric(),t._onDestroyed(),t.sortable&&t.sortable.destroy()}),ge(ye(t),"onAudioCanPlay",function(){t.state.isAudioSeeking||t.setState({canPlay:!0},function(){t.playAudio(!0)})}),ge(ye(t),"initSortableAudioLists",function(){var n=t.props,a=n.audioLists,o=n.sortableOptions,l=ul.selector,v=D0(ul,["selector"]),h=document.querySelector(".".concat(l));Array.isArray(a)&&!a.length||!h||(t.sortable&&t.sortable.destroy(),t.sortable=new Qe(h,ht(ht({onEnd:t.onAudioListsSortEnd},v),o)))}),t.audio=null,t.targetId="music-player-controller",t._PLAY_MODE_=Object.values(Et),t._PLAY_MODE_LENGTH_=t._PLAY_MODE_.length,t.player=Ye.exports.createRef(),t.destroyBtn=Ye.exports.createRef(),t}return B0(r,[{key:"locale",get:function(){var t=this.props.locale;return typeof t=="string"?jf[this.props.locale]:t?ht(ht({},jf[ta.en_US]),t):{}}},{key:"audioDuration",get:function(){var t=this.state,n=t.audioLists,a=t.playId;if(!n.length||!this.audio)return 0;var o=n.find(function(v){return v[mt]===a})||{},l=o.duration;return Math.max(Number(l)||this.audio.duration||0,0)}},{key:"isAudioCanPlay",get:function(){var t=this.props.autoPlay,n=this.state,a=n.isInitAutoPlay,o=n.isAutoPlayWhenUserClicked,l=n.canPlay;return l&&(a||t||o)}},{key:"iconMap",get:function(){var t=this,n=function(){return q.createElement("span",{className:"loading group"},t.props.icon.loading)};return ht(ht(ht({},Zf),this.props.icon),{},{loading:q.createElement(n,null)})}},{key:"render",value:function(){var t=this,n=this.props,a=n.className,o=n.drag,l=n.style,v=n.showDownload,h=n.showPlay,f=n.showReload,d=n.showPlayMode,g=n.showThemeSwitch,E=n.toggleMode,S=n.showMiniModeCover,x=n.extendsContent,m=n.defaultPlayMode,c=n.seeked,p=n.showProgressLoadBar,y=n.bounds,u=n.defaultPosition,_=n.showMiniProcessBar,b=n.preload,T=n.glassBg,A=n.remove,L=n.lyricClassName,R=n.showLyric,w=n.getContainer,O=n.autoHiddenCover,I=n.showDestroy,D=n.responsive,C=this.locale,P=this.state,M=P.toggle,N=P.playing,B=P.currentTime,U=P.soundValue,F=P.moveX,j=P.moveY,V=P.loading,G=P.audioListsPanelVisible,Y=P.theme,X=P.name,ie=P.cover,he=P.singer,de=P.musicSrc,Ae=P.playId,pe=P.isMobile,le=P.playMode,Ie=P.playModeTipVisible,Ce=P.playModelNameVisible,Ue=P.initAnimate,Me=P.loadedProgress,ze=P.audioLists,Ge=P.removeId,$e=P.currentLyric,Ke=P.audioLyricVisible,Ne=P.isPlayDestroyed,Te=P.isResetCoverRotate,et=b===!1||b==="none"?{}:b===!0?{preload:"auto"}:{preload:b},st=Ue?{show:G,hide:!G}:{show:G},qe=Et[le||m]||Et.order,ot=C.playModeText[qe],nt=S&&!O||O&&ie?{style:{backgroundImage:"url(".concat(ie,")")}}:{},dt=Hf(B),ne=Hf(this.audioDuration),Ee=c?{onChange:this.onProgressChange,onAfterChange:this.onAudioSeeked}:{},xe=q.createElement(q.Fragment,null,p&&q.createElement("div",{className:"progress-load-bar",style:{width:"".concat(Math.min(Me,100),"%")}}),q.createElement(Uo,dn({max:Math.ceil(this.audioDuration),defaultValue:0,value:Math.ceil(B)},Ee,y0))),we=v&&q.createElement("span",{className:"group audio-download",onClick:this.onAudioDownload,title:C.downloadText},this.iconMap.download),be=g&&q.createElement("span",{className:"group theme-switch"},q.createElement(Hu,{className:"theme-switch-container",onChange:this.themeChange,checkedChildren:C.lightThemeText,unCheckedChildren:C.darkThemeText,checked:Y===Tr.LIGHT,title:C.switchThemeText})),je=f&&q.createElement("span",{className:"group reload-btn",onClick:this.onAudioReload,title:C.reloadText},this.iconMap.reload),K=R&&q.createElement("span",{className:Ft("group lyric-btn",{"lyric-btn-active":Ke}),onClick:this.toggleAudioLyric,title:C.toggleLyricText},this.iconMap.lyric),ce=d&&q.createElement("span",{className:Ft("group loop-btn"),onClick:this.togglePlayMode,title:C.playModeText[qe]},this.renderPlayModeIcon(qe)),_e=pe?30:40,Re=I&&q.createElement("span",{title:C.destroyText,className:"group destroy-btn",ref:this.destroyBtn,onClick:!o||M?this.onDestroyPlayer:void 0},this.iconMap.destroy),Z=q.createElement("div",{className:Ft("react-jinke-music-player"),style:u,tabIndex:"-1"},q.createElement("div",{className:Ft("music-player")},_&&q.createElement(gm,{progress:B/this.audioDuration,r:_e}),q.createElement("div",dn({id:this.targetId,className:Ft("scale","music-player-controller",{"music-player-playing":N})},nt,{onClick:o?void 0:this.onOpenPanel}),V?this.iconMap.loading:q.createElement(q.Fragment,null,q.createElement("span",{className:"controller-title"},C.controllerTitle),q.createElement("div",{className:"music-player-controller-setting"},M?C.closeText:C.openText))),Re)),ue=w()||document.body,W=this.getAudioTitle();if(Ne)return null;var me=!N||this.state.currentVolumeFade===kr.OUT;return kn.exports.createPortal(q.createElement("div",{className:Ft("react-jinke-music-player-main",{"light-theme":Y===Tr.LIGHT,"dark-theme":Y===Tr.DARK},a),style:l,ref:this.player,tabIndex:"-1"},M&&pe&&D&&q.createElement(d0,{playing:N,loading:V,name:X,singer:he,cover:ie,themeSwitch:be,duration:ne,currentTime:dt,progressBar:xe,onPlay:this.onTogglePlay,currentPlayModeName:ot,playMode:ce,audioNextPlay:this.onPlayNextAudio,audioPrevPlay:this.onPlayPrevAudio,icon:ht(ht({},this.iconMap),{},{reload:je,download:we,lyric:K}),playModeTipVisible:Ie,openAudioListsPanel:this.openAudioListsPanel,onClose:this.onHidePanel,extendsContent:x,glassBg:T,autoHiddenCover:O,onCoverClick:this.onCoverClick,locale:C,toggleMode:E,renderAudioTitle:this.renderAudioTitle,shouldShowPlayIcon:me,isResetCoverRotate:Te}),M?void 0:o?q.createElement(uf,{bounds:y,position:{x:F,y:j},onDrag:this.onControllerDrag,onStop:this.onControllerDragStop,onStart:this.onControllerDragStart},Z):Z,M&&(!pe||!D)&&q.createElement("div",{className:Ft("music-player-panel","translate",{"glass-bg":T})},q.createElement("section",{className:"panel-content"},(!O||O&&ie)&&q.createElement("div",{className:Ft("img-content","img-rotate",{"img-rotate-pause":!N||!ie,"img-rotate-reset":Te}),style:{backgroundImage:"url(".concat(ie,")")},onClick:function(){return t.onCoverClick()}}),q.createElement("div",{className:"progress-bar-content"},q.createElement("span",{className:"audio-title",title:W},this.renderAudioTitle()),q.createElement("section",{className:"audio-main"},q.createElement("span",{className:"current-time",title:dt},V?"--":dt),q.createElement("div",{className:"progress-bar"},xe),q.createElement("span",{className:"duration",title:ne},V?"--":ne))),q.createElement("div",{className:"player-content"},h?q.createElement("span",{className:"group"},q.createElement("span",{className:"group prev-audio",title:C.previousTrackText,onClick:this.onPlayPrevAudio},this.iconMap.prev),V?q.createElement("span",{className:"group loading-icon",title:C.loadingText},this.iconMap.loading):q.createElement("span",{className:"group play-btn",onClick:this.onTogglePlay,title:me?C.clickToPlayText:C.clickToPauseText},me?this.iconMap.play:this.iconMap.pause),q.createElement("span",{className:"group next-audio",title:C.nextTrackText,onClick:this.onPlayNextAudio},this.iconMap.next)):V&&this.iconMap.loading,je,we,be,x||null,q.createElement("span",{className:"group play-sounds",title:C.volumeText},U===0?q.createElement("span",{className:"sounds-icon",onClick:this.onResetVolume},this.iconMap.mute):q.createElement("span",{className:"sounds-icon",onClick:this.onAudioMute},this.iconMap.volume),q.createElement(Uo,dn({value:U,onChange:this.onAudioSoundChange,className:"sound-operation"},E0))),ce,K,q.createElement("span",{className:"group audio-lists-btn",title:C.playListsText,onClick:this.openAudioListsPanel},q.createElement("span",{className:"audio-lists-icon"},this.iconMap.playLists),q.createElement("span",{className:"audio-lists-num"},ze.length)),E&&q.createElement("span",{className:"group hide-panel",title:C.toggleMiniModeText,onClick:this.onHidePanel},this.iconMap.toggle),Re))),q.createElement(pm,{playing:N,playId:Ae,loading:V,visible:G,audioLists:ze,onPlay:this.audioListsPlay,onCancel:this.closeAudioListsPanel,icon:this.iconMap,isMobile:pe,panelToggleAnimate:st,glassBg:T,cover:ie,remove:A,onDelete:this.onDeleteAudioLists,removeId:Ge,locale:C}),!pe&&q.createElement(h0,{visible:Ce,value:ot}),Ke&&q.createElement(uf,null,q.createElement("div",{className:Ft("music-player-lyric",L)},$e||C.emptyLyricText)),q.createElement("audio",dn({className:"music-player-audio",title:W},et,{src:de,ref:function(k){t.audio=k}}))),ue)}},{key:"getBaseAudioInfo",value:function(){var t=this.state,n=t.cover,a=t.name,o=t.musicSrc,l=t.soundValue,v=t.lyric,h=t.audioLists,f=t.currentLyric,d=this.audio||{},g=d.currentTime,E=d.muted,S=d.networkState,x=d.readyState,m=d.played,c=d.paused,p=d.ended,y=d.startDate,u=this.getCurrentPlayIndex(),_=h[u]||{};return ht(ht({},_),{},{cover:n,name:a,musicSrc:o,volume:l,currentTime:g,duration:this.audioDuration,muted:E,networkState:S,readyState:x,played:m,paused:c,ended:p,startDate:y,lyric:v,currentLyric:f,playIndex:u})}},{key:"componentDidUpdate",value:function(t,n){n.musicSrc!==this.state.musicSrc&&this.setState({isResetCoverRotate:!0})}},{key:"UNSAFE_componentWillReceiveProps",value:function(t){var n=this,a=t.audioLists,o=t.playIndex,l=t.theme,v=t.mode,h=t.playMode,f=t.clearPriorAudioLists,d=O0(a)(this.props.audioLists);d||(f?this.changeAudioLists(t):this.updateAudioLists(a),this.checkCurrentPlayingAudioIsInUpdatedAudioLists(t)||this.initPlayer(a,!1,!1),setTimeout(function(){return n.initSortableAudioLists()},200)),this.updatePlayIndex(!d&&f?ea:o),this.updateTheme(l),this.updateMode(v),this.updatePlayMode(h)}},{key:"UNSAFE_componentWillMount",value:function(){var t=this,n=this.props,a=n.audioLists,o=n.remember;if(Array.isArray(a)&&a.length>=1){var l=this.getPlayInfo(a),v=o?this.getLastPlayStatus():{};switch(yi(l.musicSrc)){case"function":l.musicSrc().then(function(h){t.setState(ht(ht({},l),{},{musicSrc:h},v))},this.onAudioError);break;default:this.setState(ht(ht({},l),v))}}}},{key:"componentWillUnmount",value:function(){this.unInstallPlayer()}},{key:"componentDidMount",value:function(){this.addMobileListener(),this.addSystemThemeListener(),this.initPlayer(),this.initSortableAudioLists(),this.onGetAudioInstance()}}]),r}(Ye.exports.PureComponent);ge(vl,"defaultProps",{audioLists:[],theme:Tr.DARK,mode:Sr.MINI,defaultPlayMode:Et.order,defaultPosition:{left:0,top:0},once:!1,drag:!0,toggleMode:!0,showMiniModeCover:!0,showDownload:!0,showPlay:!0,showReload:!0,showPlayMode:!0,showThemeSwitch:!0,showLyric:!1,playModeTipVisible:!1,autoPlay:!0,defaultVolume:1,showProgressLoadBar:!0,seeked:!0,playModeShowTime:600,bounds:"body",showMiniProcessBar:!1,loadAudioErrorPlayNext:!0,preload:!1,glassBg:!1,remember:!1,remove:!0,defaultPlayIndex:0,getContainer:function(){return document.body},autoHiddenCover:!1,onBeforeAudioDownload:function(){},spaceBar:!1,showDestroy:!1,showMediaSession:!1,locale:ta.en_US,responsive:!0,icon:Zf,quietUpdate:!1,mobileMediaQuery:Nf.MOBILE,volumeFade:{fadeIn:0,fadeOut:0},restartCurrentOnPrev:!1,sortableOptions:{}});ge(vl,"propTypes",m0);const Qf=4,V0=[],K0=({file:s})=>{const{lastFiles:e,getSetting:r}=Ye.exports.useContext(ei),i=Yh("light","dark"),{t,i18n:n}=Nn(),[a,o]=q.useState([]),l=ui(),[v,h]=up("volume",.5),f=hu({base:!0,md:!1}),d=r("music cover")||"https://store.heytapimage.com/cdo-portal/feedback/202110/30/d43c41c5d257c9bc36366e310374fb19.png",g=t("unknown"),[E,S]=q.useState(0);return Ye.exports.useEffect(()=>{const x={name:s.name,musicSrc:l(),cover:d,singer:g};s.thumbnail&&(x.cover=s.thumbnail);const m=e.filter(c=>c.type===Qf).map(c=>{let p=l(c);const y={name:c.name,musicSrc:p,cover:d,singer:g};return c.thumbnail&&(y.cover=c.thumbnail),y});m.length>0?o(m):o([x]),S(m.findIndex(c=>c.name===s.name))},[]),q.createElement(Xi,{className:"audio-box",w:"full"},q.createElement(Zi,{p:"8",w:"full"},q.createElement(Ca,{display:"inline-flex",alignItems:"center"},q.createElement(Fn,{color:r("icon color")||"#1890ff",as:Pa(s.type,"")}),t("Enjoy the music"),"...")),q.createElement(vl,{audioLists:a,theme:i,locale:n.language==="zh"?"zh_CN":"en_US",mode:"full",autoPlay:r("autoplay audio")==="true",defaultPosition:{left:20,bottom:20},playIndex:E,onPlayIndexChange:S,sortableOptions:{disabled:f},defaultVolume:v,onAudioVolumeChange:x=>h(x)}))};var H0=Object.freeze(Object.defineProperty({__proto__:null,type:Qf,exts:V0,default:K0},Symbol.toStringTag,{value:"Module"})),gl={},bs={},ml={exports:{}},$0="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",G0=$0,Y0=G0;function Jf(){}function qf(){}qf.resetWarningCache=Jf;var X0=function(){function s(i,t,n,a,o,l){if(l!==Y0){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}s.isRequired=s;function e(){return s}var r={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:e,element:s,elementType:s,instanceOf:e,node:s,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:qf,resetWarningCache:Jf};return r.PropTypes=r,r};ml.exports=X0();var ed={},ra={},Ar={exports:{}},td={exports:{}},Z0=void 0,rd=function(s){return s!==Z0&&s!==null},Q0=rd,J0={object:!0,function:!0,undefined:!0},q0=function(s){return Q0(s)?hasOwnProperty.call(J0,typeof s):!1},ey=q0,ty=function(s){if(!ey(s))return!1;try{return s.constructor?s.constructor.prototype===s:!1}catch(e){return!1}},ry=ty,iy=function(s){if(typeof s!="function"||!hasOwnProperty.call(s,"length"))return!1;try{if(typeof s.length!="number"||typeof s.call!="function"||typeof s.apply!="function")return!1}catch(e){return!1}return!ry(s)},ny=iy,ay=/^\s*class[\s{/}]/,sy=Function.prototype.toString,oy=function(s){return!(!ny(s)||ay.test(sy.call(s)))},ly=function(){var s=Object.assign,e;return typeof s!="function"?!1:(e={foo:"raz"},s(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},uy=function(){try{return Object.keys("primitive"),!0}catch(s){return!1}},fy=function(){},dy=fy(),yl=function(s){return s!==dy&&s!==null},cy=yl,hy=Object.keys,py=function(s){return hy(cy(s)?Object(s):s)},vy=uy()?Object.keys:py,gy=yl,my=function(s){if(!gy(s))throw new TypeError("Cannot use null or undefined");return s},yy=vy,Ey=my,_y=Math.max,xy=function(s,e){var r,i,t=_y(arguments.length,2),n;for(s=Object(Ey(s)),n=function(a){try{s[a]=e[a]}catch(o){r||(r=o)}},i=1;i<t;++i)e=arguments[i],yy(e).forEach(n);if(r!==void 0)throw r;return s},by=ly()?Object.assign:xy,Sy=yl,Ty=Array.prototype.forEach,Ay=Object.create,wy=function(s,e){var r;for(r in s)e[r]=s[r]},Oy=function(s){var e=Ay(null);return Ty.call(arguments,function(r){!Sy(r)||wy(Object(r),e)}),e},El="razdwatrzy",Ly=function(){return typeof El.contains!="function"?!1:El.contains("dwa")===!0&&El.contains("foo")===!1},Iy=String.prototype.indexOf,Ry=function(s){return Iy.call(this,s,arguments[1])>-1},Dy=Ly()?String.prototype.contains:Ry,Ss=rd,id=oy,nd=by,ad=Oy,ia=Dy,Cy=td.exports=function(s,e){var r,i,t,n,a;return arguments.length<2||typeof s!="string"?(n=e,e=s,s=null):n=arguments[2],Ss(s)?(r=ia.call(s,"c"),i=ia.call(s,"e"),t=ia.call(s,"w")):(r=t=!0,i=!1),a={value:e,configurable:r,enumerable:i,writable:t},n?nd(ad(n),a):a};Cy.gs=function(s,e,r){var i,t,n,a;return typeof s!="string"?(n=r,r=e,e=s,s=null):n=arguments[3],Ss(e)?id(e)?Ss(r)?id(r)||(n=r,r=void 0):r=void 0:(n=e,e=r=void 0):e=void 0,Ss(s)?(i=ia.call(s,"c"),t=ia.call(s,"e")):(i=!0,t=!1),a={get:e,set:r,configurable:i,enumerable:t},n?nd(ad(n),a):a};var Py=function(s){if(typeof s!="function")throw new TypeError(s+" is not a function");return s};(function(s,e){var r=td.exports,i=Py,t=Function.prototype.apply,n=Function.prototype.call,a=Object.create,o=Object.defineProperty,l=Object.defineProperties,v=Object.prototype.hasOwnProperty,h={configurable:!0,enumerable:!1,writable:!0},f,d,g,E,S,x,m;f=function(c,p){var y;return i(p),v.call(this,"__ee__")?y=this.__ee__:(y=h.value=a(null),o(this,"__ee__",h),h.value=null),y[c]?typeof y[c]=="object"?y[c].push(p):y[c]=[y[c],p]:y[c]=p,this},d=function(c,p){var y,u;return i(p),u=this,f.call(this,c,y=function(){g.call(u,c,y),t.call(p,this,arguments)}),y.__eeOnceListener__=p,this},g=function(c,p){var y,u,_,b;if(i(p),!v.call(this,"__ee__"))return this;if(y=this.__ee__,!y[c])return this;if(u=y[c],typeof u=="object")for(b=0;_=u[b];++b)(_===p||_.__eeOnceListener__===p)&&(u.length===2?y[c]=u[b?0:1]:u.splice(b,1));else(u===p||u.__eeOnceListener__===p)&&delete y[c];return this},E=function(c){var p,y,u,_,b;if(!!v.call(this,"__ee__")&&(_=this.__ee__[c],!!_))if(typeof _=="object"){for(y=arguments.length,b=new Array(y-1),p=1;p<y;++p)b[p-1]=arguments[p];for(_=_.slice(),p=0;u=_[p];++p)t.call(u,this,b)}else switch(arguments.length){case 1:n.call(_,this);break;case 2:n.call(_,this,arguments[1]);break;case 3:n.call(_,this,arguments[1],arguments[2]);break;default:for(y=arguments.length,b=new Array(y-1),p=1;p<y;++p)b[p-1]=arguments[p];t.call(_,this,b)}},S={on:f,once:d,off:g,emit:E},x={on:r(f),once:r(d),off:r(g),emit:r(E)},m=l({},x),s.exports=e=function(c){return c==null?a(m):l(Object(c),x)},e.methods=S})(Ar,Ar.exports);var Be={},na={},ni={},Ci={};function _l(s,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(s):s}var sd=_l({HTML:"text/html",isHTML:function(s){return s===sd.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),od=_l({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(s){return s===od.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Ci.freeze=_l;Ci.MIME_TYPE=sd;Ci.NAMESPACE=od;var My=Ci,aa=My.NAMESPACE;function ky(s){return s!==""}function Ny(s){return s?s.split(/[\t\n\f\r ]+/).filter(ky):[]}function Fy(s,e){return s.hasOwnProperty(e)||(s[e]=!0),s}function ld(s){if(!s)return[];var e=Ny(s);return Object.keys(e.reduce(Fy,{}))}function By(s){return function(e){return s&&s.indexOf(e)!==-1}}function sa(s,e){for(var r in s)e[r]=s[r]}function rr(s,e){var r=s.prototype;if(!(r instanceof e)){let i=function(){};i.prototype=e.prototype,i=new i,sa(r,i),s.prototype=r=i}r.constructor!=s&&(typeof s!="function"&&console.error("unknown Class:"+s),r.constructor=s)}var ir={},Nr=ir.ELEMENT_NODE=1,hn=ir.ATTRIBUTE_NODE=2,Ts=ir.TEXT_NODE=3,ud=ir.CDATA_SECTION_NODE=4,fd=ir.ENTITY_REFERENCE_NODE=5,Uy=ir.ENTITY_NODE=6,dd=ir.PROCESSING_INSTRUCTION_NODE=7,cd=ir.COMMENT_NODE=8,hd=ir.DOCUMENT_NODE=9,pd=ir.DOCUMENT_TYPE_NODE=10,ai=ir.DOCUMENT_FRAGMENT_NODE=11,jy=ir.NOTATION_NODE=12,Gt={},kt={};Gt.INDEX_SIZE_ERR=(kt[1]="Index size error",1);Gt.DOMSTRING_SIZE_ERR=(kt[2]="DOMString size error",2);var Wy=Gt.HIERARCHY_REQUEST_ERR=(kt[3]="Hierarchy request error",3);Gt.WRONG_DOCUMENT_ERR=(kt[4]="Wrong document",4);Gt.INVALID_CHARACTER_ERR=(kt[5]="Invalid character",5);Gt.NO_DATA_ALLOWED_ERR=(kt[6]="No data allowed",6);Gt.NO_MODIFICATION_ALLOWED_ERR=(kt[7]="No modification allowed",7);var zy=Gt.NOT_FOUND_ERR=(kt[8]="Not found",8);Gt.NOT_SUPPORTED_ERR=(kt[9]="Not supported",9);var vd=Gt.INUSE_ATTRIBUTE_ERR=(kt[10]="Attribute in use",10);Gt.INVALID_STATE_ERR=(kt[11]="Invalid state",11);Gt.SYNTAX_ERR=(kt[12]="Syntax error",12);Gt.INVALID_MODIFICATION_ERR=(kt[13]="Invalid modification",13);Gt.NAMESPACE_ERR=(kt[14]="Invalid namespace",14);Gt.INVALID_ACCESS_ERR=(kt[15]="Invalid access",15);function Pi(s,e){if(e instanceof Error)var r=e;else r=this,Error.call(this,kt[s]),this.message=kt[s],Error.captureStackTrace&&Error.captureStackTrace(this,Pi);return r.code=s,e&&(this.message=this.message+": "+e),r}Pi.prototype=Error.prototype;sa(Gt,Pi);function si(){}si.prototype={length:0,item:function(s){return this[s]||null},toString:function(s,e){for(var r=[],i=0;i<this.length;i++)vn(this[i],r,s,e);return r.join("")}};function pn(s,e){this._node=s,this._refresh=e,xl(this)}function xl(s){var e=s._node._inc||s._node.ownerDocument._inc;if(s._inc!=e){var r=s._refresh(s._node);Rd(s,"length",r.length),sa(r,s),s._inc=e}}pn.prototype.item=function(s){return xl(this),this[s]};rr(pn,si);function As(){}function gd(s,e){for(var r=s.length;r--;)if(s[r]===e)return r}function md(s,e,r,i){if(i?e[gd(e,i)]=r:e[e.length++]=r,s){r.ownerElement=s;var t=s.ownerDocument;t&&(i&&xd(t,s,i),Vy(t,s,r))}}function yd(s,e,r){var i=gd(e,r);if(i>=0){for(var t=e.length-1;i<t;)e[i]=e[++i];if(e.length=t,s){var n=s.ownerDocument;n&&(xd(n,s,r),r.ownerElement=null)}}else throw Pi(zy,new Error(s.tagName+"@"+r))}As.prototype={length:0,item:si.prototype.item,getNamedItem:function(s){for(var e=this.length;e--;){var r=this[e];if(r.nodeName==s)return r}},setNamedItem:function(s){var e=s.ownerElement;if(e&&e!=this._ownerElement)throw new Pi(vd);var r=this.getNamedItem(s.nodeName);return md(this._ownerElement,this,s,r),r},setNamedItemNS:function(s){var e=s.ownerElement,r;if(e&&e!=this._ownerElement)throw new Pi(vd);return r=this.getNamedItemNS(s.namespaceURI,s.localName),md(this._ownerElement,this,s,r),r},removeNamedItem:function(s){var e=this.getNamedItem(s);return yd(this._ownerElement,this,e),e},removeNamedItemNS:function(s,e){var r=this.getNamedItemNS(s,e);return yd(this._ownerElement,this,r),r},getNamedItemNS:function(s,e){for(var r=this.length;r--;){var i=this[r];if(i.localName==e&&i.namespaceURI==s)return i}return null}};function Ed(){}Ed.prototype={hasFeature:function(s,e){return!0},createDocument:function(s,e,r){var i=new la;if(i.implementation=this,i.childNodes=new si,i.doctype=r||null,r&&i.appendChild(r),e){var t=i.createElementNS(s,e);i.appendChild(t)}return i},createDocumentType:function(s,e,r){var i=new Os;return i.name=s,i.nodeName=s,i.publicId=e||"",i.systemId=r||"",i}};function Yt(){}Yt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(s,e){return Sd(this,s,e)},replaceChild:function(s,e){this.insertBefore(s,e),e&&this.removeChild(e)},removeChild:function(s){return bd(this,s)},appendChild:function(s){return this.insertBefore(s,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(s){return Il(this.ownerDocument||this,this,s)},normalize:function(){for(var s=this.firstChild;s;){var e=s.nextSibling;e&&e.nodeType==Ts&&s.nodeType==Ts?(this.removeChild(e),s.appendData(e.data)):(s.normalize(),s=e)}},isSupported:function(s,e){return this.ownerDocument.implementation.hasFeature(s,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(s){for(var e=this;e;){var r=e._nsMap;if(r){for(var i in r)if(r[i]==s)return i}e=e.nodeType==hn?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(s){for(var e=this;e;){var r=e._nsMap;if(r&&s in r)return r[s];e=e.nodeType==hn?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(s){var e=this.lookupPrefix(s);return e==null}};function _d(s){return s=="<"&&"&lt;"||s==">"&&"&gt;"||s=="&"&&"&amp;"||s=='"'&&"&quot;"||"&#"+s.charCodeAt()+";"}sa(ir,Yt);sa(ir,Yt.prototype);function oa(s,e){if(e(s))return!0;if(s=s.firstChild)do if(oa(s,e))return!0;while(s=s.nextSibling)}function la(){}function Vy(s,e,r){s&&s._inc++;var i=r.namespaceURI;i===aa.XMLNS&&(e._nsMap[r.prefix?r.localName:""]=r.value)}function xd(s,e,r,i){s&&s._inc++;var t=r.namespaceURI;t===aa.XMLNS&&delete e._nsMap[r.prefix?r.localName:""]}function bl(s,e,r){if(s&&s._inc){s._inc++;var i=e.childNodes;if(r)i[i.length++]=r;else{for(var t=e.firstChild,n=0;t;)i[n++]=t,t=t.nextSibling;i.length=n}}}function bd(s,e){var r=e.previousSibling,i=e.nextSibling;return r?r.nextSibling=i:s.firstChild=i,i?i.previousSibling=r:s.lastChild=r,bl(s.ownerDocument,s),e}function Sd(s,e,r){var i=e.parentNode;if(i&&i.removeChild(e),e.nodeType===ai){var t=e.firstChild;if(t==null)return e;var n=e.lastChild}else t=n=e;var a=r?r.previousSibling:s.lastChild;t.previousSibling=a,n.nextSibling=r,a?a.nextSibling=t:s.firstChild=t,r==null?s.lastChild=n:r.previousSibling=n;do t.parentNode=s;while(t!==n&&(t=t.nextSibling));return bl(s.ownerDocument||s,s),e.nodeType==ai&&(e.firstChild=e.lastChild=null),e}function Ky(s,e){var r=e.parentNode;if(r){var i=s.lastChild;r.removeChild(e);var i=s.lastChild}var i=s.lastChild;return e.parentNode=s,e.previousSibling=i,e.nextSibling=null,i?i.nextSibling=e:s.firstChild=e,s.lastChild=e,bl(s.ownerDocument,s,e),e}la.prototype={nodeName:"#document",nodeType:hd,doctype:null,documentElement:null,_inc:1,insertBefore:function(s,e){if(s.nodeType==ai){for(var r=s.firstChild;r;){var i=r.nextSibling;this.insertBefore(r,e),r=i}return s}return this.documentElement==null&&s.nodeType==Nr&&(this.documentElement=s),Sd(this,s,e),s.ownerDocument=this,s},removeChild:function(s){return this.documentElement==s&&(this.documentElement=null),bd(this,s)},importNode:function(s,e){return Id(this,s,e)},getElementById:function(s){var e=null;return oa(this.documentElement,function(r){if(r.nodeType==Nr&&r.getAttribute("id")==s)return e=r,!0}),e},getElementsByClassName:function(s){var e=ld(s);return new pn(this,function(r){var i=[];return e.length>0&&oa(r.documentElement,function(t){if(t!==r&&t.nodeType===Nr){var n=t.getAttribute("class");if(n){var a=s===n;if(!a){var o=ld(n);a=e.every(By(o))}a&&i.push(t)}}}),i})},createElement:function(s){var e=new Mi;e.ownerDocument=this,e.nodeName=s,e.tagName=s,e.localName=s,e.childNodes=new si;var r=e.attributes=new As;return r._ownerElement=e,e},createDocumentFragment:function(){var s=new Ls;return s.ownerDocument=this,s.childNodes=new si,s},createTextNode:function(s){var e=new Sl;return e.ownerDocument=this,e.appendData(s),e},createComment:function(s){var e=new Tl;return e.ownerDocument=this,e.appendData(s),e},createCDATASection:function(s){var e=new Al;return e.ownerDocument=this,e.appendData(s),e},createProcessingInstruction:function(s,e){var r=new Ol;return r.ownerDocument=this,r.tagName=r.target=s,r.nodeValue=r.data=e,r},createAttribute:function(s){var e=new ws;return e.ownerDocument=this,e.name=s,e.nodeName=s,e.localName=s,e.specified=!0,e},createEntityReference:function(s){var e=new wl;return e.ownerDocument=this,e.nodeName=s,e},createElementNS:function(s,e){var r=new Mi,i=e.split(":"),t=r.attributes=new As;return r.childNodes=new si,r.ownerDocument=this,r.nodeName=e,r.tagName=e,r.namespaceURI=s,i.length==2?(r.prefix=i[0],r.localName=i[1]):r.localName=e,t._ownerElement=r,r},createAttributeNS:function(s,e){var r=new ws,i=e.split(":");return r.ownerDocument=this,r.nodeName=e,r.name=e,r.namespaceURI=s,r.specified=!0,i.length==2?(r.prefix=i[0],r.localName=i[1]):r.localName=e,r}};rr(la,Yt);function Mi(){this._nsMap={}}Mi.prototype={nodeType:Nr,hasAttribute:function(s){return this.getAttributeNode(s)!=null},getAttribute:function(s){var e=this.getAttributeNode(s);return e&&e.value||""},getAttributeNode:function(s){return this.attributes.getNamedItem(s)},setAttribute:function(s,e){var r=this.ownerDocument.createAttribute(s);r.value=r.nodeValue=""+e,this.setAttributeNode(r)},removeAttribute:function(s){var e=this.getAttributeNode(s);e&&this.removeAttributeNode(e)},appendChild:function(s){return s.nodeType===ai?this.insertBefore(s,null):Ky(this,s)},setAttributeNode:function(s){return this.attributes.setNamedItem(s)},setAttributeNodeNS:function(s){return this.attributes.setNamedItemNS(s)},removeAttributeNode:function(s){return this.attributes.removeNamedItem(s.nodeName)},removeAttributeNS:function(s,e){var r=this.getAttributeNodeNS(s,e);r&&this.removeAttributeNode(r)},hasAttributeNS:function(s,e){return this.getAttributeNodeNS(s,e)!=null},getAttributeNS:function(s,e){var r=this.getAttributeNodeNS(s,e);return r&&r.value||""},setAttributeNS:function(s,e,r){var i=this.ownerDocument.createAttributeNS(s,e);i.value=i.nodeValue=""+r,this.setAttributeNode(i)},getAttributeNodeNS:function(s,e){return this.attributes.getNamedItemNS(s,e)},getElementsByTagName:function(s){return new pn(this,function(e){var r=[];return oa(e,function(i){i!==e&&i.nodeType==Nr&&(s==="*"||i.tagName==s)&&r.push(i)}),r})},getElementsByTagNameNS:function(s,e){return new pn(this,function(r){var i=[];return oa(r,function(t){t!==r&&t.nodeType===Nr&&(s==="*"||t.namespaceURI===s)&&(e==="*"||t.localName==e)&&i.push(t)}),i})}};la.prototype.getElementsByTagName=Mi.prototype.getElementsByTagName;la.prototype.getElementsByTagNameNS=Mi.prototype.getElementsByTagNameNS;rr(Mi,Yt);function ws(){}ws.prototype.nodeType=hn;rr(ws,Yt);function ua(){}ua.prototype={data:"",substringData:function(s,e){return this.data.substring(s,s+e)},appendData:function(s){s=this.data+s,this.nodeValue=this.data=s,this.length=s.length},insertData:function(s,e){this.replaceData(s,0,e)},appendChild:function(s){throw new Error(kt[Wy])},deleteData:function(s,e){this.replaceData(s,e,"")},replaceData:function(s,e,r){var i=this.data.substring(0,s),t=this.data.substring(s+e);r=i+r+t,this.nodeValue=this.data=r,this.length=r.length}};rr(ua,Yt);function Sl(){}Sl.prototype={nodeName:"#text",nodeType:Ts,splitText:function(s){var e=this.data,r=e.substring(s);e=e.substring(0,s),this.data=this.nodeValue=e,this.length=e.length;var i=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};rr(Sl,ua);function Tl(){}Tl.prototype={nodeName:"#comment",nodeType:cd};rr(Tl,ua);function Al(){}Al.prototype={nodeName:"#cdata-section",nodeType:ud};rr(Al,ua);function Os(){}Os.prototype.nodeType=pd;rr(Os,Yt);function Td(){}Td.prototype.nodeType=jy;rr(Td,Yt);function Ad(){}Ad.prototype.nodeType=Uy;rr(Ad,Yt);function wl(){}wl.prototype.nodeType=fd;rr(wl,Yt);function Ls(){}Ls.prototype.nodeName="#document-fragment";Ls.prototype.nodeType=ai;rr(Ls,Yt);function Ol(){}Ol.prototype.nodeType=dd;rr(Ol,Yt);function wd(){}wd.prototype.serializeToString=function(s,e,r){return Od.call(s,e,r)};Yt.prototype.toString=Od;function Od(s,e){var r=[],i=this.nodeType==9&&this.documentElement||this,t=i.prefix,n=i.namespaceURI;if(n&&t==null){var t=i.lookupPrefix(n);if(t==null)var a=[{namespace:n,prefix:null}]}return vn(this,r,s,e,a),r.join("")}function Ld(s,e,r){var i=s.prefix||"",t=s.namespaceURI;if(!t||i==="xml"&&t===aa.XML||t===aa.XMLNS)return!1;for(var n=r.length;n--;){var a=r[n];if(a.prefix===i)return a.namespace!==t}return!0}function Ll(s,e,r){s.push(" ",e,'="',r.replace(/[<&"]/g,_d),'"')}function vn(s,e,r,i,t){if(t||(t=[]),i)if(s=i(s),s){if(typeof s=="string"){e.push(s);return}}else return;switch(s.nodeType){case Nr:var n=s.attributes,a=n.length,o=s.firstChild,l=s.tagName;r=aa.isHTML(s.namespaceURI)||r;var v=l;if(!r&&!s.prefix&&s.namespaceURI){for(var h,f=0;f<n.length;f++)if(n.item(f).name==="xmlns"){h=n.item(f).value;break}if(!h)for(var d=t.length-1;d>=0;d--){var g=t[d];if(g.prefix===""&&g.namespace===s.namespaceURI){h=g.namespace;break}}if(h!==s.namespaceURI)for(var d=t.length-1;d>=0;d--){var g=t[d];if(g.namespace===s.namespaceURI){g.prefix&&(v=g.prefix+":"+l);break}}}e.push("<",v);for(var E=0;E<a;E++){var S=n.item(E);S.prefix=="xmlns"?t.push({prefix:S.localName,namespace:S.value}):S.nodeName=="xmlns"&&t.push({prefix:"",namespace:S.value})}for(var E=0;E<a;E++){var S=n.item(E);if(Ld(S,r,t)){var x=S.prefix||"",m=S.namespaceURI;Ll(e,x?"xmlns:"+x:"xmlns",m),t.push({prefix:x,namespace:m})}vn(S,e,r,i,t)}if(l===v&&Ld(s,r,t)){var x=s.prefix||"",m=s.namespaceURI;Ll(e,x?"xmlns:"+x:"xmlns",m),t.push({prefix:x,namespace:m})}if(o||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(e.push(">"),r&&/^script$/i.test(l))for(;o;)o.data?e.push(o.data):vn(o,e,r,i,t.slice()),o=o.nextSibling;else for(;o;)vn(o,e,r,i,t.slice()),o=o.nextSibling;e.push("</",v,">")}else e.push("/>");return;case hd:case ai:for(var o=s.firstChild;o;)vn(o,e,r,i,t.slice()),o=o.nextSibling;return;case hn:return Ll(e,s.name,s.value);case Ts:return e.push(s.data.replace(/[<&]/g,_d).replace(/]]>/g,"]]&gt;"));case ud:return e.push("<![CDATA[",s.data,"]]>");case cd:return e.push("<!--",s.data,"-->");case pd:var c=s.publicId,p=s.systemId;if(e.push("<!DOCTYPE ",s.name),c)e.push(" PUBLIC ",c),p&&p!="."&&e.push(" ",p),e.push(">");else if(p&&p!=".")e.push(" SYSTEM ",p,">");else{var y=s.internalSubset;y&&e.push(" [",y,"]"),e.push(">")}return;case dd:return e.push("<?",s.target," ",s.data,"?>");case fd:return e.push("&",s.nodeName,";");default:e.push("??",s.nodeName)}}function Id(s,e,r){var i;switch(e.nodeType){case Nr:i=e.cloneNode(!1),i.ownerDocument=s;case ai:break;case hn:r=!0;break}if(i||(i=e.cloneNode(!1)),i.ownerDocument=s,i.parentNode=null,r)for(var t=e.firstChild;t;)i.appendChild(Id(s,t,r)),t=t.nextSibling;return i}function Il(s,e,r){var i=new e.constructor;for(var t in e){var n=e[t];typeof n!="object"&&n!=i[t]&&(i[t]=n)}switch(e.childNodes&&(i.childNodes=new si),i.ownerDocument=s,i.nodeType){case Nr:var a=e.attributes,o=i.attributes=new As,l=a.length;o._ownerElement=i;for(var v=0;v<l;v++)i.setAttributeNode(Il(s,a.item(v),!0));break;case hn:r=!0}if(r)for(var h=e.firstChild;h;)i.appendChild(Il(s,h,r)),h=h.nextSibling;return i}function Rd(s,e,r){s[e]=r}try{if(Object.defineProperty){let s=function(e){switch(e.nodeType){case Nr:case ai:var r=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&r.push(s(e)),e=e.nextSibling;return r.join("");default:return e.nodeValue}};Object.defineProperty(pn.prototype,"length",{get:function(){return xl(this),this.$$length}}),Object.defineProperty(Yt.prototype,"textContent",{get:function(){return s(this)},set:function(e){switch(this.nodeType){case Nr:case ai:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),Rd=function(e,r,i){e["$$"+r]=i}}}catch(s){}ni.DocumentType=Os;ni.DOMException=Pi;ni.DOMImplementation=Ed;ni.Element=Mi;ni.Node=Yt;ni.NodeList=si;ni.XMLSerializer=wd;var fa={},Dd={};(function(s){var e=Ci.freeze;s.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),s.HTML_ENTITIES=e({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",times:"\xD7",divide:"\xF7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",euro:"\u20AC",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}),s.entityMap=s.HTML_ENTITIES})(Dd);var Rl={},da=Ci.NAMESPACE,Dl=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Cd=new RegExp("[\\-\\.0-9"+Dl.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Pd=new RegExp("^"+Dl.source+Cd.source+"*(?::"+Dl.source+Cd.source+"*)?$"),ca=0,Ei=1,gn=2,ha=3,mn=4,yn=5,pa=6,Is=7;function En(s,e){this.message=s,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,En)}En.prototype=new Error;En.prototype.name=En.name;function Md(){}Md.prototype={parse:function(s,e,r){var i=this.domBuilder;i.startDocument(),Fd(e,e={}),Hy(s,e,r,i,this.errorHandler),i.endDocument()}};function Hy(s,e,r,i,t){function n(C){if(C>65535){C-=65536;var P=55296+(C>>10),M=56320+(C&1023);return String.fromCharCode(P,M)}else return String.fromCharCode(C)}function a(C){var P=C.slice(1,-1);return P in r?r[P]:P.charAt(0)==="#"?n(parseInt(P.substr(1).replace("x","0x"))):(t.error("entity not found:"+C),C)}function o(C){if(C>S){var P=s.substring(S,C).replace(/&#?\w+;/g,a);d&&l(S),i.characters(P,0,C-S),S=C}}function l(C,P){for(;C>=h&&(P=f.exec(s));)v=P.index,h=v+P[0].length,d.lineNumber++;d.columnNumber=C-v+1}for(var v=0,h=0,f=/.*(?:\r\n?|\n)|.*$/g,d=i.locator,g=[{currentNSMap:e}],E={},S=0;;){try{var x=s.indexOf("<",S);if(x<0){if(!s.substr(S).match(/^\s*$/)){var m=i.doc,c=m.createTextNode(s.substr(S));m.appendChild(c),i.currentElement=c}return}switch(x>S&&o(x),s.charAt(x+1)){case"/":var p=s.indexOf(">",x+3),y=s.substring(x+2,p).replace(/[ \t\n\r]+$/g,""),u=g.pop();p<0?(y=s.substring(x+2).replace(/[\s<].*/,""),t.error("end tag name: "+y+" is not complete:"+u.tagName),p=x+1+y.length):y.match(/\s</)&&(y=y.replace(/[\s<].*/,""),t.error("end tag name: "+y+" maybe not complete"),p=x+1+y.length);var _=u.localNSMap,b=u.tagName==y,T=b||u.tagName&&u.tagName.toLowerCase()==y.toLowerCase();if(T){if(i.endElement(u.uri,u.localName,y),_)for(var A in _)i.endPrefixMapping(A);b||t.fatalError("end tag name: "+y+" is not match the current start tagName:"+u.tagName)}else g.push(u);p++;break;case"?":d&&l(x),p=Zy(s,x,i);break;case"!":d&&l(x),p=Xy(s,x,i,t);break;default:d&&l(x);var L=new Bd,R=g[g.length-1].currentNSMap,p=$y(s,x,L,R,a,t),w=L.length;if(!L.closed&&Yy(s,p,L.tagName,E)&&(L.closed=!0,r.nbsp||t.warning("unclosed xml attribute")),d&&w){for(var O=kd(d,{}),I=0;I<w;I++){var D=L[I];l(D.offset),D.locator=kd(d,{})}i.locator=O,Nd(L,i,R)&&g.push(L),i.locator=d}else Nd(L,i,R)&&g.push(L);da.isHTML(L.uri)&&!L.closed?p=Gy(s,p,L.tagName,a,i):p++}}catch(C){if(C instanceof En)throw C;t.error("element parse error: "+C),p=-1}p>S?S=p:o(Math.max(x,S)+1)}}function kd(s,e){return e.lineNumber=s.lineNumber,e.columnNumber=s.columnNumber,e}function $y(s,e,r,i,t,n){function a(d,g,E){r.attributeNames.hasOwnProperty(d)&&n.fatalError("Attribute "+d+" redefined"),r.addValue(d,g,E)}for(var o,l,v=++e,h=ca;;){var f=s.charAt(v);switch(f){case"=":if(h===Ei)o=s.slice(e,v),h=ha;else if(h===gn)h=ha;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(h===ha||h===Ei)if(h===Ei&&(n.warning('attribute value must after "="'),o=s.slice(e,v)),e=v+1,v=s.indexOf(f,e),v>0)l=s.slice(e,v).replace(/&#?\w+;/g,t),a(o,l,e-1),h=yn;else throw new Error("attribute value no end '"+f+"' match");else if(h==mn)l=s.slice(e,v).replace(/&#?\w+;/g,t),a(o,l,e),n.warning('attribute "'+o+'" missed start quot('+f+")!!"),e=v+1,h=yn;else throw new Error('attribute value must after "="');break;case"/":switch(h){case ca:r.setTagName(s.slice(e,v));case yn:case pa:case Is:h=Is,r.closed=!0;case mn:case Ei:case gn:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return n.error("unexpected end of input"),h==ca&&r.setTagName(s.slice(e,v)),v;case">":switch(h){case ca:r.setTagName(s.slice(e,v));case yn:case pa:case Is:break;case mn:case Ei:l=s.slice(e,v),l.slice(-1)==="/"&&(r.closed=!0,l=l.slice(0,-1));case gn:h===gn&&(l=o),h==mn?(n.warning('attribute "'+l+'" missed quot(")!'),a(o,l.replace(/&#?\w+;/g,t),e)):((!da.isHTML(i[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),a(l,l,e));break;case ha:throw new Error("attribute value missed!!")}return v;case"\x80":f=" ";default:if(f<=" ")switch(h){case ca:r.setTagName(s.slice(e,v)),h=pa;break;case Ei:o=s.slice(e,v),h=gn;break;case mn:var l=s.slice(e,v).replace(/&#?\w+;/g,t);n.warning('attribute "'+l+'" missed quot(")!!'),a(o,l,e);case yn:h=pa;break}else switch(h){case gn:r.tagName,(!da.isHTML(i[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&n.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,e),e=v,h=Ei;break;case yn:n.warning('attribute space is required"'+o+'"!!');case pa:h=Ei,e=v;break;case ha:h=mn,e=v;break;case Is:throw new Error("elements closed character '/' and '>' must be connected to")}}v++}}function Nd(s,e,r){for(var i=s.tagName,t=null,n=s.length;n--;){var a=s[n],o=a.qName,l=a.value,d=o.indexOf(":");if(d>0)var v=a.prefix=o.slice(0,d),h=o.slice(d+1),f=v==="xmlns"&&h;else h=o,v=null,f=o==="xmlns"&&"";a.localName=h,f!==!1&&(t==null&&(t={},Fd(r,r={})),r[f]=t[f]=l,a.uri=da.XMLNS,e.startPrefixMapping(f,l))}for(var n=s.length;n--;){a=s[n];var v=a.prefix;v&&(v==="xml"&&(a.uri=da.XML),v!=="xmlns"&&(a.uri=r[v||""]))}var d=i.indexOf(":");d>0?(v=s.prefix=i.slice(0,d),h=s.localName=i.slice(d+1)):(v=null,h=s.localName=i);var g=s.uri=r[v||""];if(e.startElement(g,h,i,s),s.closed){if(e.endElement(g,h,i),t)for(v in t)e.endPrefixMapping(v)}else return s.currentNSMap=r,s.localNSMap=t,!0}function Gy(s,e,r,i,t){if(/^(?:script|textarea)$/i.test(r)){var n=s.indexOf("</"+r+">",e),a=s.substring(e+1,n);if(/[&<]/.test(a))return/^script$/i.test(r)?(t.characters(a,0,a.length),n):(a=a.replace(/&#?\w+;/g,i),t.characters(a,0,a.length),n)}return e+1}function Yy(s,e,r,i){var t=i[r];return t==null&&(t=s.lastIndexOf("</"+r+">"),t<e&&(t=s.lastIndexOf("</"+r)),i[r]=t),t<e}function Fd(s,e){for(var r in s)e[r]=s[r]}function Xy(s,e,r,i){var t=s.charAt(e+2);switch(t){case"-":if(s.charAt(e+3)==="-"){var n=s.indexOf("-->",e+4);return n>e?(r.comment(s,e+4,n-e-4),n+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(s.substr(e+3,6)=="CDATA["){var n=s.indexOf("]]>",e+9);return r.startCDATA(),r.characters(s,e+9,n-e-9),r.endCDATA(),n+3}var a=Qy(s,e),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var l=a[1][0],v=!1,h=!1;o>3&&(/^public$/i.test(a[2][0])?(v=a[3][0],h=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(h=a[3][0]));var f=a[o-1];return r.startDTD(l,v,h),r.endDTD(),f.index+f[0].length}}return-1}function Zy(s,e,r){var i=s.indexOf("?>",e);if(i){var t=s.substring(e,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return t?(t[0].length,r.processingInstruction(t[1],t[2]),i+2):-1}return-1}function Bd(){this.attributeNames={}}Bd.prototype={setTagName:function(s){if(!Pd.test(s))throw new Error("invalid tagName:"+s);this.tagName=s},addValue:function(s,e,r){if(!Pd.test(s))throw new Error("invalid attribute:"+s);this.attributeNames[s]=this.length,this[this.length++]={qName:s,value:e,offset:r}},length:0,getLocalName:function(s){return this[s].localName},getLocator:function(s){return this[s].locator},getQName:function(s){return this[s].qName},getURI:function(s){return this[s].uri},getValue:function(s){return this[s].value}};function Qy(s,e){var r,i=[],t=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(t.lastIndex=e,t.exec(s);r=t.exec(s);)if(i.push(r),r[1])return i}Rl.XMLReader=Md;Rl.ParseError=En;var Jy=Ci,Cl=ni,Ud=Dd,jd=Rl,qy=Cl.DOMImplementation,Wd=Jy.NAMESPACE,eE=jd.ParseError,tE=jd.XMLReader;function zd(s){this.options=s||{locator:{}}}zd.prototype.parseFromString=function(s,e){var r=this.options,i=new tE,t=r.domBuilder||new va,n=r.errorHandler,a=r.locator,o=r.xmlns||{},l=/\/x?html?$/.test(e),v=l?Ud.HTML_ENTITIES:Ud.XML_ENTITIES;return a&&t.setDocumentLocator(a),i.errorHandler=rE(n,t,a),i.domBuilder=r.domBuilder||t,l&&(o[""]=Wd.HTML),o.xml=o.xml||Wd.XML,s&&typeof s=="string"?i.parse(s,o,v):i.errorHandler.error("invalid doc source"),t.doc};function rE(s,e,r){if(!s){if(e instanceof va)return e;s=e}var i={},t=s instanceof Function;r=r||{};function n(a){var o=s[a];!o&&t&&(o=s.length==2?function(l){s(a,l)}:s),i[a]=o&&function(l){o("[xmldom "+a+"]	"+l+Pl(r))}||function(){}}return n("warning"),n("error"),n("fatalError"),i}function va(){this.cdata=!1}function _n(s,e){e.lineNumber=s.lineNumber,e.columnNumber=s.columnNumber}va.prototype={startDocument:function(){this.doc=new qy().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(s,e,r,i){var t=this.doc,n=t.createElementNS(s,r||e),a=i.length;Rs(this,n),this.currentElement=n,this.locator&&_n(this.locator,n);for(var o=0;o<a;o++){var s=i.getURI(o),l=i.getValue(o),r=i.getQName(o),v=t.createAttributeNS(s,r);this.locator&&_n(i.getLocator(o),v),v.value=v.nodeValue=l,n.setAttributeNode(v)}},endElement:function(s,e,r){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(s,e){},endPrefixMapping:function(s){},processingInstruction:function(s,e){var r=this.doc.createProcessingInstruction(s,e);this.locator&&_n(this.locator,r),Rs(this,r)},ignorableWhitespace:function(s,e,r){},characters:function(s,e,r){if(s=Vd.apply(this,arguments),s){if(this.cdata)var i=this.doc.createCDATASection(s);else var i=this.doc.createTextNode(s);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(s)&&this.doc.appendChild(i),this.locator&&_n(this.locator,i)}},skippedEntity:function(s){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(s){(this.locator=s)&&(s.lineNumber=0)},comment:function(s,e,r){s=Vd.apply(this,arguments);var i=this.doc.createComment(s);this.locator&&_n(this.locator,i),Rs(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(s,e,r){var i=this.doc.implementation;if(i&&i.createDocumentType){var t=i.createDocumentType(s,e,r);this.locator&&_n(this.locator,t),Rs(this,t),this.doc.doctype=t}},warning:function(s){console.warn("[xmldom warning]	"+s,Pl(this.locator))},error:function(s){console.error("[xmldom error]	"+s,Pl(this.locator))},fatalError:function(s){throw new eE(s,this.locator)}};function Pl(s){if(s)return`
@`+(s.systemId||"")+"#[line:"+s.lineNumber+",col:"+s.columnNumber+"]"}function Vd(s,e,r){return typeof s=="string"?s.substr(e,r):s.length>=e+r||e?new java.lang.String(s,e,r)+"":s}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(s){va.prototype[s]=function(){return null}});function Rs(s,e){s.currentElement?s.currentElement.appendChild(e):s.doc.appendChild(e)}fa.__DOMHandler=va;fa.DOMParser=zd;fa.DOMImplementation=Cl.DOMImplementation;fa.XMLSerializer=Cl.XMLSerializer;var Kd=ni;na.DOMImplementation=Kd.DOMImplementation;na.XMLSerializer=Kd.XMLSerializer;na.DOMParser=fa.DOMParser;Object.defineProperty(Be,"__esModule",{value:!0});Be.RangeObject=void 0;Be.blob2base64=IE;Be.borders=vE;Be.bounds=pE;Be.createBase64Url=SE;Be.createBlob=Yd;Be.createBlobUrl=xE;Be.defaults=dE;Be.defer=RE;Be.documentHeight=oE;Be.extend=cE;Be.filterChildren=PE;Be.findChildren=CE;Be.getParentByTagName=ME;Be.indexOfElementNode=EE;Be.indexOfNode=kl;Be.indexOfSorted=Ml;Be.indexOfTextNode=yE;Be.insert=hE;Be.isElement=lE;Be.isFloat=uE;Be.isNumber=Gd;Be.isXml=_E;Be.locationOf=Ds;Be.nodeBounds=gE;Be.parents=Fl;Be.parse=AE;Be.prefixed=fE;Be.qs=wE;Be.qsa=Xd;Be.qsp=OE;Be.querySelectorByType=DE;Be.requestAnimationFrame=void 0;Be.revokeBlobUrl=bE;Be.sprint=LE;Be.treeWalker=Zd;Be.type=TE;Be.uuid=$d;Be.walk=Nl;Be.windowBounds=mE;var iE=na;const nE=typeof window!="undefined"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1;Be.requestAnimationFrame=nE;const aE=1,sE=3,Hd=typeof URL!="undefined"?URL:typeof window!="undefined"?window.URL||window.webkitURL||window.mozURL:void 0;function $d(){var s=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var i=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(r=="x"?i:i&7|8).toString(16)});return e}function oE(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function lE(s){return!!(s&&s.nodeType==1)}function Gd(s){return!isNaN(parseFloat(s))&&isFinite(s)}function uE(s){let e=parseFloat(s);return Gd(s)===!1?!1:typeof s=="string"&&s.indexOf(".")>-1?!0:Math.floor(e)!==e}function fE(s){var e=["Webkit","webkit","Moz","O","ms"],r=["-webkit-","-webkit-","-moz-","-o-","-ms-"],i=s.toLowerCase(),t=e.length;if(typeof document=="undefined"||typeof document.body.style[i]!="undefined")return s;for(var n=0;n<t;n++)if(typeof document.body.style[r[n]+i]!="undefined")return r[n]+i;return s}function dE(s){for(var e=1,r=arguments.length;e<r;e++){var i=arguments[e];for(var t in i)s[t]===void 0&&(s[t]=i[t])}return s}function cE(s){var e=[].slice.call(arguments,1);return e.forEach(function(r){!r||Object.getOwnPropertyNames(r).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}),s}function hE(s,e,r){var i=Ds(s,e,r);return e.splice(i,0,s),i}function Ds(s,e,r,i,t){var n=i||0,a=t||e.length,o=parseInt(n+(a-n)/2),l;return r||(r=function(v,h){if(v>h)return 1;if(v<h)return-1;if(v==h)return 0}),a-n<=0?o:(l=r(e[o],s),a-n==1?l>=0?o:o+1:l===0?o:l===-1?Ds(s,e,r,o,a):Ds(s,e,r,n,o))}function Ml(s,e,r,i,t){var n=i||0,a=t||e.length,o=parseInt(n+(a-n)/2),l;return r||(r=function(v,h){if(v>h)return 1;if(v<h)return-1;if(v==h)return 0}),a-n<=0?-1:(l=r(e[o],s),a-n==1?l===0?o:-1:l===0?o:l===-1?Ml(s,e,r,o,a):Ml(s,e,r,n,o))}function pE(s){var e=window.getComputedStyle(s),r=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],t=0,n=0;return r.forEach(function(a){t+=parseFloat(e[a])||0}),i.forEach(function(a){n+=parseFloat(e[a])||0}),{height:n,width:t}}function vE(s){var e=window.getComputedStyle(s),r=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],t=0,n=0;return r.forEach(function(a){t+=parseFloat(e[a])||0}),i.forEach(function(a){n+=parseFloat(e[a])||0}),{height:n,width:t}}function gE(s){let e,r=s.ownerDocument;if(s.nodeType==Node.TEXT_NODE){let i=r.createRange();i.selectNodeContents(s),e=i.getBoundingClientRect()}else e=s.getBoundingClientRect();return e}function mE(){var s=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:s,bottom:e,width:s,height:e}}function kl(s,e){for(var r=s.parentNode,i=r.childNodes,t,n=-1,a=0;a<i.length&&(t=i[a],t.nodeType===e&&n++,t!=s);a++);return n}function yE(s){return kl(s,sE)}function EE(s){return kl(s,aE)}function _E(s){return["xml","opf","ncx"].indexOf(s)>-1}function Yd(s,e){return new Blob([s],{type:e})}function xE(s,e){var r,i=Yd(s,e);return r=Hd.createObjectURL(i),r}function bE(s){return Hd.revokeObjectURL(s)}function SE(s,e){var r,i;if(typeof s=="string")return r=btoa(s),i="data:"+e+";base64,"+r,i}function TE(s){return Object.prototype.toString.call(s).slice(8,-1)}function AE(s,e,r){var i,t;return typeof DOMParser=="undefined"||r?t=iE.DOMParser:t=DOMParser,s.charCodeAt(0)===65279&&(s=s.slice(1)),i=new t().parseFromString(s,e),i}function wE(s,e){var r;if(!s)throw new Error("No Element Provided");if(typeof s.querySelector!="undefined")return s.querySelector(e);if(r=s.getElementsByTagName(e),r.length)return r[0]}function Xd(s,e){return typeof s.querySelector!="undefined"?s.querySelectorAll(e):s.getElementsByTagName(e)}function OE(s,e,r){var i,t;if(typeof s.querySelector!="undefined"){e+="[";for(var n in r)e+=n+"~='"+r[n]+"'";return e+="]",s.querySelector(e)}else if(i=s.getElementsByTagName(e),t=Array.prototype.slice.call(i,0).filter(function(a){for(var o in r)if(a.getAttribute(o)===r[o])return!0;return!1}),t)return t[0]}function LE(s,e){var r=s.ownerDocument||s;typeof r.createTreeWalker!="undefined"?Zd(s,e,NodeFilter.SHOW_TEXT):Nl(s,function(i){i&&i.nodeType===3&&e(i)})}function Zd(s,e,r){var i=document.createTreeWalker(s,r,null,!1);let t;for(;t=i.nextNode();)e(t)}function Nl(s,e){if(e(s))return!0;if(s=s.firstChild,s)do{if(Nl(s,e))return!0;s=s.nextSibling}while(s)}function IE(s){return new Promise(function(e,r){var i=new FileReader;i.readAsDataURL(s),i.onloadend=function(){e(i.result)}})}function RE(){this.resolve=null,this.reject=null,this.id=$d(),this.promise=new Promise((s,e)=>{this.resolve=s,this.reject=e}),Object.freeze(this)}function DE(s,e,r){var i;if(typeof s.querySelector!="undefined"&&(i=s.querySelector(`${e}[*|type="${r}"]`)),!i||i.length===0){i=Xd(s,e);for(var t=0;t<i.length;t++)if(i[t].getAttributeNS("http://www.idpf.org/2007/ops","type")===r||i[t].getAttribute("epub:type")===r)return i[t]}else return i}function CE(s){for(var e=[],r=s.childNodes,i=0;i<r.length;i++){let t=r[i];t.nodeType===1&&e.push(t)}return e}function Fl(s){for(var e=[s];s;s=s.parentNode)e.unshift(s);return e}function PE(s,e,r){for(var i=[],t=s.childNodes,n=0;n<t.length;n++){let a=t[n];if(a.nodeType===1&&a.nodeName.toLowerCase()===e){if(r)return a;i.push(a)}}if(!r)return i}function ME(s,e){let r;if(!(s===null||e===""))for(r=s.parentNode;r.nodeType===1;){if(r.tagName.toLowerCase()===e)return r;r=r.parentNode}}class kE{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,r){this.startContainer=e,this.startOffset=r,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,r){this.endContainer=e,this.endOffset=r,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let r=e.parentNode,i=Array.prototype.indexOf.call(r.childNodes,e);this.setStart(r,i),this.setEnd(r,i+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let r=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,r)}_commonAncestorContainer(e,r){var i=Fl(e||this.startContainer),t=Fl(r||this.endContainer);if(i[0]==t[0]){for(var n=0;n<i.length;n++)if(i[n]!=t[n])return i[n-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}Be.RangeObject=kE;var ki={},Zr={};if(!Qd)var Qd={cwd:function(){return"/"}};function Qr(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+s)}function Jd(s,e){for(var r="",i=-1,t=0,n,a=0;a<=s.length;++a){if(a<s.length)n=s.charCodeAt(a);else{if(n===47)break;n=47}if(n===47){if(!(i===a-1||t===1))if(i!==a-1&&t===2){if(r.length<2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){for(var o=r.length-1,l=o;l>=0&&r.charCodeAt(l)!==47;--l);if(l!==o){l===-1?r="":r=r.slice(0,l),i=a,t=0;continue}}else if(r.length===2||r.length===1){r="",i=a,t=0;continue}}e&&(r.length>0?r+="/..":r="..")}else r.length>0?r+="/"+s.slice(i+1,a):r=s.slice(i+1,a);i=a,t=0}else n===46&&t!==-1?++t:t=-1}return r}function NE(s,e){var r=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+i:r+s+i:i}var Cs={resolve:function(){for(var e="",r=!1,i,t=arguments.length-1;t>=-1&&!r;t--){var n;t>=0?n=arguments[t]:(i===void 0&&(i=Qd.cwd()),n=i),Qr(n),n.length!==0&&(e=n+"/"+e,r=n.charCodeAt(0)===47)}return e=Jd(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Qr(e),e.length===0)return".";var r=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;return e=Jd(e,!r),e.length===0&&!r&&(e="."),e.length>0&&i&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return Qr(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var i=arguments[r];Qr(i),i.length>0&&(e===void 0?e=i:e+="/"+i)}return e===void 0?".":Cs.normalize(e)},relative:function(e,r){if(Qr(e),Qr(r),e===r||(e=Cs.resolve(e),r=Cs.resolve(r),e===r))return"";for(var i=1;i<e.length&&e.charCodeAt(i)===47;++i);for(var t=e.length,n=t-i,a=1;a<r.length&&r.charCodeAt(a)===47;++a);for(var o=r.length,l=o-a,v=n<l?n:l,h=-1,f=0;f<=v;++f){if(f===v){if(l>v){if(r.charCodeAt(a+f)===47)return r.slice(a+f+1);if(f===0)return r.slice(a+f)}else n>v&&(e.charCodeAt(i+f)===47?h=f:f===0&&(h=0));break}var d=e.charCodeAt(i+f),g=r.charCodeAt(a+f);if(d!==g)break;d===47&&(h=f)}var E="";for(f=i+h+1;f<=t;++f)(f===t||e.charCodeAt(f)===47)&&(E.length===0?E+="..":E+="/..");return E.length>0?E+r.slice(a+h):(a+=h,r.charCodeAt(a)===47&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(Qr(e),e.length===0)return".";for(var r=e.charCodeAt(0),i=r===47,t=-1,n=!0,a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!n){t=a;break}}else n=!1;return t===-1?i?"/":".":i&&t===1?"//":e.slice(0,t)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');Qr(e);var i=0,t=-1,n=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var o=r.length-1,l=-1;for(a=e.length-1;a>=0;--a){var v=e.charCodeAt(a);if(v===47){if(!n){i=a+1;break}}else l===-1&&(n=!1,l=a+1),o>=0&&(v===r.charCodeAt(o)?--o==-1&&(t=a):(o=-1,t=l))}return i===t?t=l:t===-1&&(t=e.length),e.slice(i,t)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!n){i=a+1;break}}else t===-1&&(n=!1,t=a+1);return t===-1?"":e.slice(i,t)}},extname:function(e){Qr(e);for(var r=-1,i=0,t=-1,n=!0,a=0,o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(l===47){if(!n){i=o+1;break}continue}t===-1&&(n=!1,t=o+1),l===46?r===-1?r=o:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||t===-1||a===0||a===1&&r===t-1&&r===i+1?"":e.slice(r,t)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return NE("/",e)},parse:function(e){Qr(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var i=e.charCodeAt(0),t=i===47,n;t?(r.root="/",n=1):n=0;for(var a=-1,o=0,l=-1,v=!0,h=e.length-1,f=0;h>=n;--h){if(i=e.charCodeAt(h),i===47){if(!v){o=h+1;break}continue}l===-1&&(v=!1,l=h+1),i===46?a===-1?a=h:f!==1&&(f=1):a!==-1&&(f=-1)}return a===-1||l===-1||f===0||f===1&&a===l-1&&a===o+1?l!==-1&&(o===0&&t?r.base=r.name=e.slice(1,l):r.base=r.name=e.slice(o,l)):(o===0&&t?(r.name=e.slice(1,a),r.base=e.slice(1,l)):(r.name=e.slice(o,a),r.base=e.slice(o,l)),r.ext=e.slice(a,l)),o>0?r.dir=e.slice(0,o-1):t&&(r.dir="/"),r},sep:"/",delimiter:":",posix:null},Ps=Cs;Object.defineProperty(Zr,"__esModule",{value:!0});Zr.default=void 0;var Ms=FE(Ps);function FE(s){return s&&s.__esModule?s:{default:s}}class BE{constructor(e){var r,i;r=e.indexOf("://"),r>-1&&(e=new URL(e).pathname),i=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=i.dir+"/",this.filename=i.base,this.extension=i.ext.slice(1)}parse(e){return Ms.default.parse(e)}isAbsolute(e){return Ms.default.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return Ms.default.resolve(this.directory,e)}relative(e){var r=e&&e.indexOf("://")>-1;return r?e:Ms.default.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}var UE=BE;Zr.default=UE;Object.defineProperty(ki,"__esModule",{value:!0});ki.default=void 0;var qd=tc(Zr),ec=tc(Ps);function tc(s){return s&&s.__esModule?s:{default:s}}class jE{constructor(e,r){var i=e.indexOf("://")>-1,t=e,n;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=r,!i&&r!==!1&&typeof r!="string"&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,t=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(a){this.Url=void 0,this.base&&(n=new qd.default(this.base),t=n.resolve(t))}this.Path=new qd.default(t),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var r=e.indexOf("://")>-1,i;return r?e:(i=ec.default.resolve(this.directory,e),this.origin+i)}relative(e){return ec.default.relative(e,this.directory)}toString(){return this.href}}var WE=jE;ki.default=WE;var ks={},Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.default=void 0;var _i=Be;const xn=1,wr=3,zE=9;class Ni{constructor(e,r,i){var t;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Ni))return new Ni(e,r,i);if(typeof r=="string"?this.base=this.parseComponent(r):typeof r=="object"&&r.steps&&(this.base=r),t=this.checkType(e),t==="string")return this.str=e,(0,_i.extend)(this,this.parse(e));if(t==="range")return(0,_i.extend)(this,this.fromRange(e,this.base,i));if(t==="node")return(0,_i.extend)(this,this.fromNode(e,this.base,i));if(t==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&((0,_i.type)(e)==="Range"||typeof e.startContainer!="undefined")?"range":e&&typeof e=="object"&&typeof e.nodeType!="undefined"?"node":e&&typeof e=="object"&&e instanceof Ni?"EpubCFI":!1}parse(e){var r={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},i,t,n;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),i=this.getChapterComponent(e),i?(r.base=this.parseComponent(i),t=this.getPathComponent(e),r.path=this.parseComponent(t),n=this.getRange(e),n&&(r.range=!0,r.start=this.parseComponent(n[0]),r.end=this.parseComponent(n[1])),r.spinePos=r.base.steps[1].index,r):{spinePos:-1})}parseComponent(e){var r={steps:[],terminal:{offset:null,assertion:null}},i=e.split(":"),t=i[0].split("/"),n;return i.length>1&&(n=i[1],r.terminal=this.parseTerminal(n)),t[0]===""&&t.shift(),r.steps=t.map(function(a){return this.parseStep(a)}.bind(this)),r}parseStep(e){var r,i,t,n,a;if(n=e.match(/\[(.*)\]/),n&&n[1]&&(a=n[1]),i=parseInt(e),!isNaN(i))return i%2==0?(r="element",t=i/2-1):(r="text",t=(i-1)/2),{type:r,index:t,id:a||null}}parseTerminal(e){var r,i,t=e.match(/\[(.*)\]/);return t&&t[1]?(r=parseInt(e.split("[")[0]),i=t[1]):r=parseInt(e),(0,_i.isNumber)(r)||(r=null),{offset:r,assertion:i}}getChapterComponent(e){var r=e.split("!");return r[0]}getPathComponent(e){var r=e.split("!");if(r[1])return r[1].split(",")[0]}getRange(e){var r=e.split(",");return r.length===3?[r[1],r[2]]:!1}getCharecterOffsetComponent(e){var r=e.split(":");return r[1]||""}joinSteps(e){return e?e.map(function(r){var i="";return r.type==="element"&&(i+=(r.index+1)*2),r.type==="text"&&(i+=1+2*r.index),r.id&&(i+="["+r.id+"]"),i}).join("/"):""}segmentString(e){var r="/";return r+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(r+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(r+="["+e.terminal.assertion+"]"),r}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,r){var i,t,n,a;if(typeof e=="string"&&(e=new Ni(e)),typeof r=="string"&&(r=new Ni(r)),e.spinePos>r.spinePos)return 1;if(e.spinePos<r.spinePos)return-1;e.range?(i=e.path.steps.concat(e.start.steps),n=e.start.terminal):(i=e.path.steps,n=e.path.terminal),r.range?(t=r.path.steps.concat(r.start.steps),a=r.start.terminal):(t=r.path.steps,a=r.path.terminal);for(var o=0;o<i.length;o++){if(!i[o])return-1;if(!t[o]||i[o].index>t[o].index)return 1;if(i[o].index<t[o].index)return-1}return i.length<t.length?-1:n.offset>a.offset?1:n.offset<a.offset?-1:0}step(e){var r=e.nodeType===wr?"text":"element";return{id:e.id,tagName:e.tagName,type:r,index:this.position(e)}}filteredStep(e,r){var i=this.filter(e,r),t;if(!!i)return t=i.nodeType===wr?"text":"element",{id:i.id,tagName:i.tagName,type:t,index:this.filteredPosition(i,r)}}pathTo(e,r,i){for(var t={steps:[],terminal:{offset:null,assertion:null}},n=e,a;n&&n.parentNode&&n.parentNode.nodeType!=zE;)i?a=this.filteredStep(n,i):a=this.step(n),a&&t.steps.unshift(a),n=n.parentNode;return r!=null&&r>=0&&(t.terminal.offset=r,t.steps[t.steps.length-1].type!="text"&&t.steps.push({type:"text",index:0})),t}equalStep(e,r){return!e||!r?!1:e.index===r.index&&e.id===r.id&&e.type===r.type}fromRange(e,r,i){var t={range:!1,base:{},path:{},start:null,end:null},n=e.startContainer,a=e.endContainer,o=e.startOffset,l=e.endOffset,v=!1;if(i&&(v=n.ownerDocument.querySelector("."+i)!=null),typeof r=="string"?(t.base=this.parseComponent(r),t.spinePos=t.base.steps[1].index):typeof r=="object"&&(t.base=r),e.collapsed)v&&(o=this.patchOffset(n,o,i)),t.path=this.pathTo(n,o,i);else{t.range=!0,v&&(o=this.patchOffset(n,o,i)),t.start=this.pathTo(n,o,i),v&&(l=this.patchOffset(a,l,i)),t.end=this.pathTo(a,l,i),t.path={steps:[],terminal:null};var h=t.start.steps.length,f;for(f=0;f<h&&this.equalStep(t.start.steps[f],t.end.steps[f]);f++)f===h-1?t.start.terminal===t.end.terminal&&(t.path.steps.push(t.start.steps[f]),t.range=!1):t.path.steps.push(t.start.steps[f]);t.start.steps=t.start.steps.slice(t.path.steps.length),t.end.steps=t.end.steps.slice(t.path.steps.length)}return t}fromNode(e,r,i){var t={range:!1,base:{},path:{},start:null,end:null};return typeof r=="string"?(t.base=this.parseComponent(r),t.spinePos=t.base.steps[1].index):typeof r=="object"&&(t.base=r),t.path=this.pathTo(e,null,i),t}filter(e,r){var i,t,n,a,o,l=!1;return e.nodeType===wr?(l=!0,n=e.parentNode,i=e.parentNode.classList.contains(r)):(l=!1,i=e.classList.contains(r)),i&&l?(a=n.previousSibling,o=n.nextSibling,a&&a.nodeType===wr?t=a:o&&o.nodeType===wr&&(t=o),t||e):i&&!l?!1:e}patchOffset(e,r,i){if(e.nodeType!=wr)throw new Error("Anchor must be a text node");var t=e,n=r;for(e.parentNode.classList.contains(i)&&(t=e.parentNode);t.previousSibling;){if(t.previousSibling.nodeType===xn)if(t.previousSibling.classList.contains(i))n+=t.previousSibling.textContent.length;else break;else n+=t.previousSibling.textContent.length;t=t.previousSibling}return n}normalizedMap(e,r,i){var t={},n=-1,a,o=e.length,l,v;for(a=0;a<o;a++)l=e[a].nodeType,l===xn&&e[a].classList.contains(i)&&(l=wr),a>0&&l===wr&&v===wr?t[a]=n:r===l&&(n=n+1,t[a]=n),v=l;return t}position(e){var r,i;return e.nodeType===xn?(r=e.parentNode.children,r||(r=(0,_i.findChildren)(e.parentNode)),i=Array.prototype.indexOf.call(r,e)):(r=this.textNodes(e.parentNode),i=r.indexOf(e)),i}filteredPosition(e,r){var i,t,n;return e.nodeType===xn?(i=e.parentNode.children,n=this.normalizedMap(i,xn,r)):(i=e.parentNode.childNodes,e.parentNode.classList.contains(r)&&(e=e.parentNode,i=e.parentNode.childNodes),n=this.normalizedMap(i,wr,r)),t=Array.prototype.indexOf.call(i,e),n[t]}stepsToXpath(e){var r=[".","*"];return e.forEach(function(i){var t=i.index+1;i.id?r.push("*[position()="+t+" and @id='"+i.id+"']"):i.type==="text"?r.push("text()["+t+"]"):r.push("*["+t+"]")}),r.join("/")}stepsToQuerySelector(e){var r=["html"];return e.forEach(function(i){var t=i.index+1;i.id?r.push("#"+i.id):i.type==="text"||r.push("*:nth-child("+t+")")}),r.join(">")}textNodes(e,r){return Array.prototype.slice.call(e.childNodes).filter(function(i){return i.nodeType===wr?!0:!!(r&&i.classList.contains(r))})}walkToNode(e,r,i){var t=r||document,n=t.documentElement,a,o,l=e.length,v;for(v=0;v<l&&(o=e[v],o.type==="element"?o.id?n=t.getElementById(o.id):(a=n.children||(0,_i.findChildren)(n),n=a[o.index]):o.type==="text"&&(n=this.textNodes(n,i)[o.index]),!!n);v++);return n}findNode(e,r,i){var t=r||document,n,a;return!i&&typeof t.evaluate!="undefined"?(a=this.stepsToXpath(e),n=t.evaluate(a,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):i?n=this.walkToNode(e,t,i):n=this.walkToNode(e,t),n}fixMiss(e,r,i,t){var n=this.findNode(e.slice(0,-1),i,t),a=n.childNodes,o=this.normalizedMap(a,wr,t),l,v,h=e[e.length-1].index;for(let f in o){if(!o.hasOwnProperty(f))return;if(o[f]===h)if(l=a[f],v=l.textContent.length,r>v)r=r-v;else{l.nodeType===xn?n=l.childNodes[0]:n=l;break}}return{container:n,offset:r}}toRange(e,r){var i=e||document,t,n,a,o,l,v=this,h,f,d=r?i.querySelector("."+r)!=null:!1,g;if(typeof i.createRange!="undefined"?t=i.createRange():t=new _i.RangeObject,v.range?(n=v.start,h=v.path.steps.concat(n.steps),o=this.findNode(h,i,d?r:null),a=v.end,f=v.path.steps.concat(a.steps),l=this.findNode(f,i,d?r:null)):(n=v.path,h=v.path.steps,o=this.findNode(v.path.steps,i,d?r:null)),o)try{n.terminal.offset!=null?t.setStart(o,n.terminal.offset):t.setStart(o,0)}catch(E){g=this.fixMiss(h,n.terminal.offset,i,d?r:null),t.setStart(g.container,g.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{a.terminal.offset!=null?t.setEnd(l,a.terminal.offset):t.setEnd(l,0)}catch(E){g=this.fixMiss(f,v.end.terminal.offset,i,d?r:null),t.setEnd(g.container,g.offset)}return t}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,r,i){var t=parseInt(r),n=(e+1)*2,a="/"+n+"/";return a+=(t+1)*2,i&&(a+="["+i+"]"),a}collapse(e){!this.range||(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}var VE=Ni;Qt.default=VE;var bn={};Object.defineProperty(bn,"__esModule",{value:!0});bn.default=void 0;class KE{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var r=0;r<arguments[e].length;++r)this.hooks.push(arguments[e][r])}deregister(e){let r;for(let i=0;i<this.hooks.length;i++)if(r=this.hooks[i],r===e){this.hooks.splice(i,1);break}}trigger(){var e=arguments,r=this.context,i=[];return this.hooks.forEach(function(t){try{var n=t.apply(r,e)}catch(a){console.log(a)}n&&typeof n.then=="function"&&i.push(n)}),Promise.all(i)}list(){return this.hooks}clear(){return this.hooks=[]}}var HE=KE;bn.default=HE;var Ns={},Jr={};Object.defineProperty(Jr,"__esModule",{value:!0});Jr.replaceBase=GE;Jr.replaceCanonical=YE;Jr.replaceLinks=ZE;Jr.replaceMeta=XE;Jr.substitute=QE;var Fi=Be,$E=rc(ki);rc(Zr);function rc(s){return s&&s.__esModule?s:{default:s}}function GE(s,e){var r,i,t=e.url,n=t.indexOf("://")>-1;!s||(i=(0,Fi.qs)(s,"head"),r=(0,Fi.qs)(i,"base"),r||(r=s.createElement("base"),i.insertBefore(r,i.firstChild)),!n&&window&&window.location&&(t=window.location.origin+t),r.setAttribute("href",t))}function YE(s,e){var r,i,t=e.canonical;!s||(r=(0,Fi.qs)(s,"head"),i=(0,Fi.qs)(r,"link[rel='canonical']"),i?i.setAttribute("href",t):(i=s.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",t),r.appendChild(i)))}function XE(s,e){var r,i,t=e.idref;!s||(r=(0,Fi.qs)(s,"head"),i=(0,Fi.qs)(r,"link[property='dc.identifier']"),i?i.setAttribute("content",t):(i=s.createElement("meta"),i.setAttribute("name","dc.identifier"),i.setAttribute("content",t),r.appendChild(i)))}function ZE(s,e){var r=s.querySelectorAll("a[href]");if(!!r.length)for(var i=(0,Fi.qs)(s.ownerDocument,"base"),t=i?i.getAttribute("href"):void 0,n=function(o){var l=o.getAttribute("href");if(l.indexOf("mailto:")!==0){var v=l.indexOf("://")>-1;if(v)o.setAttribute("target","_blank");else{var h;try{h=new $E.default(l,t)}catch(f){}o.onclick=function(){return h&&h.hash?e(h.Path.path+h.hash):e(h?h.Path.path:l),!1}}}}.bind(this),a=0;a<r.length;a++)n(r[a])}function QE(s,e,r){return e.forEach(function(i,t){i&&r[t]&&(i=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),s=s.replace(new RegExp(i,"g"),r[t]))}),s}var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.default=void 0;var Sn=Be,JE=qE(Zr);function qE(s){return s&&s.__esModule?s:{default:s}}function e_(s,e,r,i){var t=typeof window!="undefined"?window.URL:!1,n=t?"blob":"arraybuffer",a=new Sn.defer,o=new XMLHttpRequest,l=XMLHttpRequest.prototype,v;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),r&&(o.withCredentials=!0),o.onreadystatechange=f,o.onerror=h,o.open("GET",s,!0);for(v in i)o.setRequestHeader(v,i[v]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new JE.default(s).extension),e=="blob"&&(o.responseType=n),(0,Sn.isXml)(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function h(d){a.reject(d)}function f(){if(this.readyState===XMLHttpRequest.DONE){var d=!1;if((this.responseType===""||this.responseType==="document")&&(d=this.responseXML),this.status===200||this.status===0||d){var g;if(!this.response&&!d)return a.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),a.promise;if(this.status===403)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),a.promise;d?g=this.responseXML:(0,Sn.isXml)(e)?g=(0,Sn.parse)(this.response,"text/xml"):e=="xhtml"?g=(0,Sn.parse)(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?g=(0,Sn.parse)(this.response,"text/html"):e=="json"?g=JSON.parse(this.response):e=="blob"?t?g=this.response:g=new Blob([this.response]):g=this.response,a.resolve(g)}else a.reject({status:this.status,message:this.response,stack:new Error().stack})}}return a.promise}var t_=e_;Bi.default=t_;Object.defineProperty(Ns,"__esModule",{value:!0});Ns.default=void 0;var Bl=Be,ic=Ul(Qt),nc=Ul(bn),r_=Jr,i_=Ul(Bi),n_=na;function Ul(s){return s&&s.__esModule?s:{default:s}}class a_{constructor(e,r){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,r?this.hooks=r:(this.hooks={},this.hooks.serialize=new nc.default(this),this.hooks.content=new nc.default(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var r=e||this.request||i_.default,i=new Bl.defer,t=i.promise;return this.contents?i.resolve(this.contents):r(this.url).then(function(n){return this.document=n,this.contents=n.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){i.resolve(this.contents)}.bind(this)).catch(function(n){i.reject(n)}),t}base(){return(0,r_.replaceBase)(this.document,this)}render(e){var r=new Bl.defer,i=r.promise;return this.output,this.load(e).then(function(t){var n=typeof navigator!="undefined"&&navigator.userAgent||"",a=n.indexOf("Trident")>=0,o;typeof XMLSerializer=="undefined"||a?o=n_.DOMParser:o=XMLSerializer;var l=new o;return this.output=l.serializeToString(t),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){r.resolve(this.output)}.bind(this)).catch(function(t){r.reject(t)}),i}find(e){var r=this,i=[],t=e.toLowerCase(),n=function(a){for(var o=a.textContent.toLowerCase(),l=r.document.createRange(),v,h,f=-1,d,g=150;h!=-1;)h=o.indexOf(t,f+1),h!=-1&&(l=r.document.createRange(),l.setStart(a,h),l.setEnd(a,h+t.length),v=r.cfiFromRange(l),a.textContent.length<g?d=a.textContent:(d=a.textContent.substring(h-g/2,h+g/2),d="..."+d+"..."),i.push({cfi:v,excerpt:d})),f=h};return(0,Bl.sprint)(r.document,function(a){n(a)}),i}search(e,r=5){if(typeof document.createTreeWalker=="undefined")return this.find(e);let i=[];const t=150,n=this,a=e.toLowerCase(),o=function(f){const E=f.reduce((S,x)=>S+x.textContent,"").toLowerCase().indexOf(a);if(E!=-1){const S=0,x=E+a.length;let m=0,c=0;if(E<f[S].length){let p;for(;m<f.length-1&&(c+=f[m].length,!(x<=c));)m+=1;let y=f[S],u=f[m],_=n.document.createRange();_.setStart(y,E);let b=f.slice(0,m).reduce((A,L)=>A+L.textContent.length,0);_.setEnd(u,b>x?x:x-b),p=n.cfiFromRange(_);let T=f.slice(0,m+1).reduce((A,L)=>A+L.textContent,"");T.length>t&&(T=T.substring(E-t/2,E+t/2),T="..."+T+"..."),i.push({cfi:p,excerpt:T})}}},l=document.createTreeWalker(n.document,NodeFilter.SHOW_TEXT,null,!1);let v,h=[];for(;v=l.nextNode();)h.push(v),h.length==r&&(o(h.slice(0,r)),h=h.slice(1,r));return h.length>0&&o(h),i}reconcileLayoutSettings(e){var r={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(i){var t=i.replace("rendition:",""),n=t.indexOf("-"),a,o;n!=-1&&(a=t.slice(0,n),o=t.slice(n+1),r[a]=o)}),r}cfiFromRange(e){return new ic.default(e,this.cfiBase).toString()}cfiFromElement(e){return new ic.default(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}var s_=a_;Ns.default=s_;Object.defineProperty(ks,"__esModule",{value:!0});ks.default=void 0;var ac=Wl(Qt),sc=Wl(bn),o_=Wl(Ns),jl=Jr;function Wl(s){return s&&s.__esModule?s:{default:s}}class l_{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new sc.default,this.hooks.content=new sc.default,this.hooks.content.register(jl.replaceBase),this.hooks.content.register(jl.replaceCanonical),this.hooks.content.register(jl.replaceMeta),this.epubcfi=new ac.default,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,r,i){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((t,n)=>{var a=this.manifest[t.idref],o;t.index=n,t.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,t.index,t.id),t.href&&(t.url=r(t.href,!0),t.canonical=i(t.href)),a&&(t.href=a.href,t.url=r(t.href,!0),t.canonical=i(t.href),a.properties.length&&t.properties.push.apply(t.properties,a.properties)),t.linear==="yes"?(t.prev=function(){let l=t.index;for(;l>0;){let v=this.get(l-1);if(v&&v.linear)return v;l-=1}}.bind(this),t.next=function(){let l=t.index;for(;l<this.spineItems.length-1;){let v=this.get(l+1);if(v&&v.linear)return v;l+=1}}.bind(this)):(t.prev=function(){},t.next=function(){}),o=new o_.default(t,this.hooks),this.append(o)}),this.loaded=!0}get(e){var r=0;if(typeof e=="undefined")for(;r<this.spineItems.length;){let i=this.spineItems[r];if(i&&i.linear)break;r+=1}else this.epubcfi.isCfiString(e)?r=new ac.default(e).spinePos:typeof e=="number"||isNaN(e)===!1?r=e:typeof e=="string"&&e.indexOf("#")===0?r=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],r=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[r]||null}append(e){var r=this.spineItems.length;return e.index=r,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=r,this.spineByHref[encodeURI(e.href)]=r,this.spineByHref[e.href]=r,this.spineById[e.idref]=r,r}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(r,i){r.index=i}),0}remove(e){var r=this.spineItems.indexOf(e);if(r>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(r,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let r=this.get(e);if(r&&r.linear)return r;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let r=this.get(e);if(r&&r.linear)return r;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}var u_=l_;ks.default=u_;var Fs={},xi={};Object.defineProperty(xi,"__esModule",{value:!0});xi.default=xi.Task=void 0;var Bs=Be;class f_{constructor(e){this._q=[],this.context=e,this.tick=Bs.requestAnimationFrame,this.running=!1,this.paused=!1}enqueue(){var e,r,i,t=[].shift.call(arguments),n=arguments;if(!t)throw new Error("No Task Provided");return typeof t=="function"?(e=new Bs.defer,r=e.promise,i={task:t,args:n,deferred:e,promise:r}):i={promise:t},this._q.push(i),this.paused==!1&&!this.running&&this.run(),i.promise}dequeue(){var e,r,i;if(this._q.length&&!this.paused){if(e=this._q.shift(),r=e.task,r)return i=r.apply(this.context,e.args),i&&typeof i.then=="function"?i.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,i),e.promise);if(e.promise)return e.promise}else return e=new Bs.defer,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Bs.defer),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}class d_{constructor(e,r,i){return function(){var t=arguments||[];return new Promise((n,a)=>{var o=function(l,v){!l&&v?a(v):n(l)};t.push(o),e.apply(i||this,t)})}}}xi.Task=d_;var c_=f_;xi.default=c_;var Nt={};Object.defineProperty(Nt,"__esModule",{value:!0});Nt.EVENTS=Nt.EPUBJS_VERSION=Nt.DOM_EVENTS=void 0;const h_="0.3";Nt.EPUBJS_VERSION=h_;const p_=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"];Nt.DOM_EVENTS=p_;const v_={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};Nt.EVENTS=v_;Object.defineProperty(Fs,"__esModule",{value:!0});Fs.default=void 0;var Ui=Be,g_=zl(xi),bi=zl(Qt),m_=Nt,y_=zl(Ar.exports);function zl(s){return s&&s.__esModule?s:{default:s}}class oc{constructor(e,r,i){this.spine=e,this.request=r,this.pause=i||100,this.q=new g_.default(this),this.epubcfi=new bi.default,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(r){r.linear&&this.q.enqueue(this.process.bind(this),r)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(r){var i=new Ui.defer,t=this.parse(r,e.cfiBase);return this._locations=this._locations.concat(t),e.unload(),this.processingTimeout=setTimeout(()=>i.resolve(t),this.pause),i.promise}.bind(this))}parse(e,r,i){var t=[],n,a=e.ownerDocument,o=(0,Ui.qs)(a,"body"),l=0,v,h=i||this.break,f=function(d){var g=d.length,E,S=0;if(d.textContent.trim().length===0)return!1;for(l==0&&(n=this.createRange(),n.startContainer=d,n.startOffset=0),E=h-l,E>g&&(l+=g,S=g);S<g;)if(E=h-l,l===0&&(S+=1,n=this.createRange(),n.startContainer=d,n.startOffset=S),S+E>=g)l+=g-S,S=g;else{S+=E,n.endContainer=d,n.endOffset=S;let x=new bi.default(n,r).toString();t.push(x),l=0}v=d};if((0,Ui.sprint)(o,f.bind(this)),n&&n.startContainer&&v){n.endContainer=v,n.endOffset=v.length;let d=new bi.default(n,r).toString();t.push(d),l=0}return t}generateFromWords(e,r,i){var t=e?new bi.default(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(n){n.linear&&(t?n.index>=t.spinePos&&this.q.enqueue(this.processWords.bind(this),n,r,t,i):this.q.enqueue(this.processWords.bind(this),n,r,t,i))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,r,i,t){return t&&this._locationsWords.length>=t?Promise.resolve():e.load(this.request).then(function(n){var a=new Ui.defer,o=this.parseWords(n,e,r,i),l=t-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=t?o.slice(0,l):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}.bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,r,i,t){var n=r.cfiBase,a=[],o=e.ownerDocument,l=(0,Ui.qs)(o,"body"),v=i,h=t?t.spinePos!==r.index:!0,f;t&&r.index===t.spinePos&&(f=t.findNode(t.range?t.path.steps.concat(t.start.steps):t.path.steps,e.ownerDocument));var d=function(g){if(!h)if(g===f)h=!0;else return!1;if(g.textContent.length<10&&g.textContent.trim().length===0)return!1;var E=this.countWords(g.textContent),S,x=0;if(E===0)return!1;for(S=v-this._wordCounter,S>E&&(this._wordCounter+=E,x=E);x<E;)if(S=v-this._wordCounter,x+S>=E)this._wordCounter+=E-x,x=E;else{x+=S;let m=new bi.default(g,n);a.push({cfi:m.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return(0,Ui.sprint)(l,d.bind(this)),a}locationFromCfi(e){let r;return bi.default.prototype.isCfiString(e)&&(e=new bi.default(e)),this._locations.length===0?-1:(r=(0,Ui.locationOf)(e,this._locations,this.epubcfi.compare),r>this.total?this.total:r)}percentageFromCfi(e){if(this._locations.length===0)return null;var r=this.locationFromCfi(e);return this.percentageFromLocation(r)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var r=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(r=this._locations[e]),r}cfiFromPercentage(e){let r;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let i=new bi.default(this._locations[this.total]);return i.collapse(),i.toString()}return r=Math.ceil(this.total*e),this.cfiFromLocation(r)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var r;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(r=this.locationFromCfi(e),this._current=r):r=e,this.emit(m_.EVENTS.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(r)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}(0,y_.default)(oc.prototype);var E_=oc;Fs.default=E_;var Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.default=void 0;var __=b_(Ps),x_=Be;function b_(s){return s&&s.__esModule?s:{default:s}}class S_{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var r;if(!e)throw new Error("Container File Not Found");if(r=(0,x_.qs)(e,"rootfile"),!r)throw new Error("No RootFile Found");this.packagePath=r.getAttribute("full-path"),this.directory=__.default.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}var T_=S_;Us.default=T_;var js={};Object.defineProperty(js,"__esModule",{value:!0});js.default=void 0;var Or=Be;class A_{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var r,i,t;if(!e)throw new Error("Package File Not Found");if(r=(0,Or.qs)(e,"metadata"),!r)throw new Error("No Metadata Found");if(i=(0,Or.qs)(e,"manifest"),!i)throw new Error("No Manifest Found");if(t=(0,Or.qs)(e,"spine"),!t)throw new Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,t),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=(0,Or.indexOfElementNode)(t),this.spine=this.parseSpine(t,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(r),this.metadata.direction=t.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var r={};return r.title=this.getElementText(e,"title"),r.creator=this.getElementText(e,"creator"),r.description=this.getElementText(e,"description"),r.pubdate=this.getElementText(e,"date"),r.publisher=this.getElementText(e,"publisher"),r.identifier=this.getElementText(e,"identifier"),r.language=this.getElementText(e,"language"),r.rights=this.getElementText(e,"rights"),r.modified_date=this.getPropertyText(e,"dcterms:modified"),r.layout=this.getPropertyText(e,"rendition:layout"),r.orientation=this.getPropertyText(e,"rendition:orientation"),r.flow=this.getPropertyText(e,"rendition:flow"),r.viewport=this.getPropertyText(e,"rendition:viewport"),r.media_active_class=this.getPropertyText(e,"media:active-class"),r.spread=this.getPropertyText(e,"rendition:spread"),r}parseManifest(e){var r={},i=(0,Or.qsa)(e,"item"),t=Array.prototype.slice.call(i);return t.forEach(function(n){var a=n.getAttribute("id"),o=n.getAttribute("href")||"",l=n.getAttribute("media-type")||"",v=n.getAttribute("media-overlay")||"",h=n.getAttribute("properties")||"";r[a]={href:o,type:l,overlay:v,properties:h.length?h.split(" "):[]}}),r}parseSpine(e,r){var i=[],t=(0,Or.qsa)(e,"itemref"),n=Array.prototype.slice.call(t);return n.forEach(function(a,o){var l=a.getAttribute("idref"),v=a.getAttribute("properties")||"",h=v.length?v.split(" "):[],f={id:a.getAttribute("id"),idref:l,linear:a.getAttribute("linear")||"yes",properties:h,index:o};i.push(f)}),i}findUniqueIdentifier(e){var r=e.documentElement.getAttribute("unique-identifier");if(!r)return"";var i=e.getElementById(r);return i&&i.localName==="identifier"&&i.namespaceURI==="http://purl.org/dc/elements/1.1/"&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}findNavPath(e){var r=(0,Or.qsp)(e,"item",{properties:"nav"});return r?r.getAttribute("href"):!1}findNcxPath(e,r){var i=(0,Or.qsp)(e,"item",{"media-type":"application/x-dtbncx+xml"}),t;return i||(t=r.getAttribute("toc"),t&&(i=e.querySelector(`#${t}`))),i?i.getAttribute("href"):!1}findCoverPath(e){var r=(0,Or.qs)(e,"package");r.getAttribute("version");var i=(0,Or.qsp)(e,"item",{properties:"cover-image"});if(i)return i.getAttribute("href");var t=(0,Or.qsp)(e,"meta",{name:"cover"});if(t){var n=t.getAttribute("content"),a=e.getElementById(n);return a?a.getAttribute("href"):""}else return!1}getElementText(e,r){var i=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",r),t;return!i||i.length===0?"":(t=i[0],t.childNodes.length?t.childNodes[0].nodeValue:"")}getPropertyText(e,r){var i=(0,Or.qsp)(e,"meta",{property:r});return i&&i.childNodes.length?i.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let r=e.readingOrder||e.spine;return this.spine=r.map((i,t)=>(i.index=t,i.linear=i.linear||"yes",i)),e.resources.forEach((i,t)=>{this.manifest[t]=i,i.rel&&i.rel[0]==="cover"&&(this.coverPath=i.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((i,t)=>(i.label=i.title,i)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}var w_=A_;js.default=w_;var Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.default=void 0;var cr=Be;class O_{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let r=e.nodeType,i,t;r&&(i=(0,cr.qs)(e,"html"),t=(0,cr.qs)(e,"ncx")),r?i?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):t&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var r,i=0;i<e.length;i++)r=e[i],r.href&&(this.tocByHref[r.href]=i),r.id&&(this.tocById[r.id]=i),this.length++,r.subitems.length&&this.unpack(r.subitems)}get(e){var r;return e?(e.indexOf("#")===0?r=this.tocById[e.substring(1)]:e in this.tocByHref&&(r=this.tocByHref[e]),this.getByIndex(e,r,this.toc)):this.toc}getByIndex(e,r,i){if(i.length===0)return;const t=i[r];if(t&&(e===t.id||e===t.href))return t;{let n;for(let a=0;a<i.length&&(n=this.getByIndex(e,r,i[a].subitems),!n);++a);return n}}landmark(e){var r;return e?(r=this.landmarksByType[e],this.landmarks[r]):this.landmarks}parseNav(e){var r=(0,cr.querySelectorByType)(e,"nav","toc"),i=[];if(!r)return i;let t=(0,cr.filterChildren)(r,"ol",!0);return t&&(i=this.parseNavList(t)),i}parseNavList(e,r){const i=[];if(!e||!e.children)return i;for(let t=0;t<e.children.length;t++){const n=this.navItem(e.children[t],r);n&&i.push(n)}return i}navItem(e,r){let i=e.getAttribute("id")||void 0,t=(0,cr.filterChildren)(e,"a",!0)||(0,cr.filterChildren)(e,"span",!0);if(!t)return;let n=t.getAttribute("href")||"";i||(i=n);let a=t.textContent||"",o=[],l=(0,cr.filterChildren)(e,"ol",!0);return l&&(o=this.parseNavList(l,i)),{id:i,href:n,label:a,subitems:o,parent:r}}parseLandmarks(e){var r=(0,cr.querySelectorByType)(e,"nav","landmarks"),i=r?(0,cr.qsa)(r,"li"):[],t=i.length,n,a=[],o;if(!i||t===0)return a;for(n=0;n<t;++n)o=this.landmarkItem(i[n]),o&&(a.push(o),this.landmarksByType[o.type]=n);return a}landmarkItem(e){let r=(0,cr.filterChildren)(e,"a",!0);if(!r)return;let i=r.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,t=r.getAttribute("href")||"",n=r.textContent||"";return{href:t,label:n,type:i}}parseNcx(e){var r=(0,cr.qsa)(e,"navPoint"),i=r.length,t,n={},a=[],o,l;if(!r||i===0)return a;for(t=0;t<i;++t)o=this.ncxItem(r[t]),n[o.id]=o,o.parent?(l=n[o.parent],l.subitems.push(o)):a.push(o);return a}ncxItem(e){var r=e.getAttribute("id")||!1,i=(0,cr.qs)(e,"content"),t=i.getAttribute("src"),n=(0,cr.qs)(e,"navLabel"),a=n.textContent?n.textContent:"",o=[],l=e.parentNode,v;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(v=l.getAttribute("id")),{id:r,href:t,label:a,subitems:o,parent:v}}load(e){return e.map(r=>(r.label=r.title,r.subitems=r.children?this.load(r.children):[],r))}forEach(e){return this.toc.forEach(e)}}var L_=O_;Ws.default=L_;var zs={},Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.default=void 0;var ga={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},I_=function(){var s,e,r,i,t={};for(s in ga)if(ga.hasOwnProperty(s)){for(e in ga[s])if(ga[s].hasOwnProperty(e))if(r=ga[s][e],typeof r=="string")t[r]=s+"/"+e;else for(i=0;i<r.length;i++)t[r[i]]=s+"/"+e}return t}(),R_="text/plain";function D_(s){return s&&I_[s.split(".").pop().toLowerCase()]||R_}var C_={lookup:D_};Tn.default=C_;Object.defineProperty(zs,"__esModule",{value:!0});zs.default=void 0;var lc=Jr,ma=Be,P_=Vs(ki),M_=Vs(Tn),uc=Vs(Zr),k_=Vs(Ps);function Vs(s){return s&&s.__esModule?s:{default:s}}class N_{constructor(e,r){this.settings={replacements:r&&r.replacements||"base64",archive:r&&r.archive,resolver:r&&r.resolver,request:r&&r.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(r){return e[r]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var r=new P_.default(e),i=M_.default.lookup(r.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(t=>(0,ma.blob2base64)(t)).then(t=>(0,ma.createBase64Url)(t,i)):this.settings.request(e,"blob").then(t=>(0,ma.createBlobUrl)(t,i))}replacements(){if(this.settings.replacements==="none")return new Promise(function(r){r(this.urls)}.bind(this));var e=this.urls.map(r=>{var i=this.settings.resolver(r);return this.createUrl(i).catch(t=>(console.error(t),null))});return Promise.all(e).then(r=>(this.replacementUrls=r.filter(i=>typeof i=="string"),r))}replaceCss(e,r){var i=[];return e=e||this.settings.archive,r=r||this.settings.resolver,this.cssUrls.forEach(function(t){var n=this.createCssFile(t,e,r).then(function(a){var o=this.urls.indexOf(t);o>-1&&(this.replacementUrls[o]=a)}.bind(this));i.push(n)}.bind(this)),Promise.all(i)}createCssFile(e){var r;if(k_.default.isAbsolute(e))return new Promise(function(a){a()});var i=this.settings.resolver(e),t;this.settings.archive?t=this.settings.archive.getText(i):t=this.settings.request(i,"text");var n=this.urls.map(a=>{var o=this.settings.resolver(a),l=new uc.default(i).relative(o);return l});return t?t.then(a=>(a=(0,lc.substitute)(a,n,this.replacementUrls),this.settings.replacements==="base64"?r=(0,ma.createBase64Url)(a,"text/css"):r=(0,ma.createBlobUrl)(a,"text/css"),r),a=>new Promise(function(o){o()})):new Promise(function(a){a()})}relativeTo(e,r){return r=r||this.settings.resolver,this.urls.map(function(i){var t=r(i),n=new uc.default(e).relative(t);return n}.bind(this))}get(e){var r=this.urls.indexOf(e);if(r!==-1)return this.replacementUrls.length?new Promise(function(i,t){i(this.replacementUrls[r])}.bind(this)):this.createUrl(e)}substitute(e,r){var i;return r?i=this.relativeTo(r):i=this.urls,(0,lc.substitute)(e,i,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}var F_=N_;zs.default=F_;var Ks={};Object.defineProperty(Ks,"__esModule",{value:!0});Ks.default=void 0;var B_=U_(Qt),Lr=Be;function U_(s){return s&&s.__esModule?s:{default:s}}class j_{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new B_.default,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var r=(0,Lr.qs)(e,"html"),i=(0,Lr.qs)(e,"ncx");if(r)return this.parseNav(e);if(i)return this.parseNcx(e)}parseNav(e){var r=(0,Lr.querySelectorByType)(e,"nav","page-list"),i=r?(0,Lr.qsa)(r,"li"):[],t=i.length,n,a=[],o;if(!i||t===0)return a;for(n=0;n<t;++n)o=this.item(i[n]),a.push(o);return a}parseNcx(e){var r=[],i=0,t,n,a,o=0;if(n=(0,Lr.qs)(e,"pageList"),!n||(a=(0,Lr.qsa)(n,"pageTarget"),o=a.length,!a||a.length===0))return r;for(i=0;i<o;++i)t=this.ncxItem(a[i]),r.push(t);return r}ncxItem(e){var r=(0,Lr.qs)(e,"navLabel"),i=(0,Lr.qs)(r,"text"),t=i.textContent,n=(0,Lr.qs)(e,"content"),a=n.getAttribute("src"),o=parseInt(t,10);return{href:a,page:o}}item(e){var r=(0,Lr.qs)(e,"a"),i=r.getAttribute("href")||"",t=r.textContent||"",n=parseInt(t),a=i.indexOf("epubcfi"),o,l,v;return a!=-1?(o=i.split("#"),l=o[0],v=o.length>1?o[1]:!1,{cfi:v,href:i,packageUrl:l,page:n}):{href:i,page:n}}process(e){e.forEach(function(r){this.pages.push(r.page),r.cfi&&this.locations.push(r.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var r=-1;if(this.locations.length===0)return-1;var i=(0,Lr.indexOfSorted)(e,this.locations,this.epubcfi.compare);return i!=-1?r=this.pages[i]:(i=(0,Lr.locationOf)(e,this.locations,this.epubcfi.compare),r=i-1>=0?this.pages[i-1]:this.pages[0],r!==void 0||(r=-1)),r}cfiFromPage(e){var r=-1;typeof e!="number"&&(e=parseInt(e));var i=this.pages.indexOf(e);return i!=-1&&(r=this.locations[i]),r}pageFromPercentage(e){var r=Math.round(this.totalPages*e);return r}percentageFromPage(e){var r=(e-this.firstPage)/this.totalPages;return Math.round(r*1e3)/1e3}percentageFromCfi(e){var r=this.pageFromCfi(e),i=this.percentageFromPage(r);return i}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}var W_=j_;Ks.default=W_;var An={},ya={};Object.defineProperty(ya,"__esModule",{value:!0});ya.default=void 0;var z_=Be,V_=Nt,K_=H_(Ar.exports);function H_(s){return s&&s.__esModule?s:{default:s}}class fc{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e!="undefined"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,r){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),r>=0&&(this._minSpreadWidth=r),this._spread}calculate(e,r,i){var t=1,n=i||0,a=e,o=r,l=Math.floor(a/12),v,h,f,d;this._spread&&a>=this._minSpreadWidth?t=2:t=1,this.name==="reflowable"&&this._flow==="paginated"&&!(i>=0)&&(n=l%2==0?l:l-1),this.name==="pre-paginated"&&(n=0),t>1?(v=a/t-n,f=v+n):(v=a,f=a),this.name==="pre-paginated"&&t>1&&(a=v),h=v*t+n,d=a,this.width=a,this.height=o,this.spreadWidth=h,this.pageWidth=f,this.delta=d,this.columnWidth=v,this.gap=n,this.divisor=t,this.update({width:a,height:o,spreadWidth:h,pageWidth:f,delta:d,columnWidth:v,gap:n,divisor:t})}format(e,r,i){var t;return this.name==="pre-paginated"?t=e.fit(this.columnWidth,this.height,r):this._flow==="paginated"?t=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):i&&i==="horizontal"?t=e.size(null,this.height):t=e.size(this.width,null),t}count(e,r){let i,t;return this.name==="pre-paginated"?(i=1,t=1):this._flow==="paginated"?(r=r||this.delta,i=Math.ceil(e/r),t=i*this.divisor):(r=r||this.height,i=Math.ceil(e/r),t=i),{spreads:i,pages:t}}update(e){if(Object.keys(e).forEach(r=>{this.props[r]===e[r]&&delete e[r]}),Object.keys(e).length>0){let r=(0,z_.extend)(this.props,e);this.emit(V_.EVENTS.LAYOUT.UPDATED,r,e)}}}(0,K_.default)(fc.prototype);var $_=fc;ya.default=$_;var Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});Hs.default=void 0;var G_=Y_(ki);function Y_(s){return s&&s.__esModule?s:{default:s}}class X_{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(!!e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var r in e)e.hasOwnProperty(r)&&(typeof e[r]=="string"?this.registerUrl(r,e[r]):this.registerRules(r,e[r]))}registerCss(e,r){this._themes[e]={serialized:r},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,r){var i=new G_.default(r);this._themes[e]={url:i.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,r){this._themes[e]={rules:r},(this._injected[e]||e=="default")&&this.update(e)}select(e){var r=this._current,i;this._current=e,this.update(e),i=this.rendition.getContents(),i.forEach(t=>{t.removeClass(r),t.addClass(e)})}update(e){var r=this.rendition.getContents();r.forEach(i=>{this.add(e,i)})}inject(e){var r=[],i=this._themes,t;for(var n in i)i.hasOwnProperty(n)&&(n===this._current||n==="default")&&(t=i[n],(t.rules&&Object.keys(t.rules).length>0||t.url&&r.indexOf(t.url)===-1)&&this.add(n,e),this._injected.push(n));this._current!="default"&&e.addClass(this._current)}add(e,r){var i=this._themes[e];!i||!r||(i.url?r.addStylesheet(i.url):i.serialized?(r.addStylesheetCss(i.serialized,e),i.injected=!0):i.rules&&(r.addStylesheetRules(i.rules,e),i.injected=!0))}override(e,r,i){var t=this.rendition.getContents();this._overrides[e]={value:r,priority:i===!0},t.forEach(n=>{n.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var r=this.rendition.getContents();delete this._overrides[e],r.forEach(i=>{i.css(e)})}overrides(e){var r=this._overrides;for(var i in r)r.hasOwnProperty(i)&&e.css(i,r[i].value,r[i].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}var Z_=X_;Hs.default=Z_;var ji={},Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.default=void 0;var $s=Q_(Qt),dc=Be;function Q_(s){return s&&s.__esModule?s:{default:s}}class J_{constructor(e,r,i,t=!1){this.layout=e,this.horizontal=i==="horizontal",this.direction=r||"ltr",this._dev=t}section(e){var r=this.findRanges(e),i=this.rangeListToCfiList(e.section.cfiBase,r);return i}page(e,r,i,t){var n=e&&e.document?e.document.body:!1,a;if(!!n){if(a=this.rangePairToCfiPair(r,{start:this.findStart(n,i,t),end:this.findEnd(n,i,t)}),this._dev===!0){let o=e.document,l=new $s.default(a.start).toRange(o),v=new $s.default(a.end).toRange(o),h=o.defaultView.getSelection(),f=o.createRange();h.removeAllRanges(),f.setStart(l.startContainer,l.startOffset),f.setEnd(v.endContainer,v.endOffset),h.addRange(f)}return a}}walk(e,r){if(!(e&&e.nodeType===Node.TEXT_NODE)){var i={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},t=i.acceptNode;t.acceptNode=i.acceptNode;for(var n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,t,!1),a,o;(a=n.nextNode())&&(o=r(a),!o););return o}}findRanges(e){for(var r=[],i=e.contents.scrollWidth(),t=Math.ceil(i/this.layout.spreadWidth),n=t*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,l,v,h=0;h<n.pages;h++)l=(a+o)*h,v=a*(h+1)+o*h,r.push({start:this.findStart(e.document.body,l,v),end:this.findEnd(e.document.body,l,v)});return r}findStart(e,r,i){for(var t=[e],n,a,o=e;t.length;)if(n=t.shift(),a=this.walk(n,l=>{var v,h,f,d,g;if(g=(0,dc.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(v=this.horizontal?g.left:g.top,h=this.horizontal?g.right:g.bottom,v>=r&&v<=i)return l;if(h>r)return l;o=l,t.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(v=g.left,h=g.right,h<=i&&h>=r)return l;if(v<i)return l;o=l,t.push(l)}else{if(f=g.top,d=g.bottom,f>=r&&f<=i)return l;if(d>r)return l;o=l,t.push(l)}}),a)return this.findTextStartRange(a,r,i);return this.findTextStartRange(o,r,i)}findEnd(e,r,i){for(var t=[e],n,a=e,o;t.length;)if(n=t.shift(),o=this.walk(n,l=>{var v,h,f,d,g;if(g=(0,dc.nodeBounds)(l),this.horizontal&&this.direction==="ltr"){if(v=Math.round(g.left),h=Math.round(g.right),v>i&&a)return a;if(h>i)return l;a=l,t.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(v=Math.round(this.horizontal?g.left:g.top),h=Math.round(this.horizontal?g.right:g.bottom),h<r&&a)return a;if(v<r)return l;a=l,t.push(l)}else{if(f=Math.round(g.top),d=Math.round(g.bottom),f>i&&a)return a;if(d>i)return l;a=l,t.push(l)}}),o)return this.findTextEndRange(o,r,i);return this.findTextEndRange(a,r,i)}findTextStartRange(e,r,i){for(var t=this.splitTextNodeIntoRanges(e),n,a,o,l,v,h=0;h<t.length;h++)if(n=t[h],a=n.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=a.left,o>=r)return n}else if(this.horizontal&&this.direction==="rtl"){if(v=a.right,v<=i)return n}else if(l=a.top,l>=r)return n;return t[0]}findTextEndRange(e,r,i){for(var t=this.splitTextNodeIntoRanges(e),n,a,o,l,v,h,f,d=0;d<t.length;d++){if(a=t[d],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=o.left,v=o.right,l>i&&n)return n;if(v>i)return a}else if(this.horizontal&&this.direction==="rtl"){if(l=o.left,v=o.right,v<r&&n)return n;if(l<r)return a}else{if(h=o.top,f=o.bottom,h>i&&n)return n;if(f>i)return a}n=a}return t[t.length-1]}splitTextNodeIntoRanges(e,r){var i=[],t=e.textContent||"",n=t.trim(),a,o=e.ownerDocument,l=r||" ",v=n.indexOf(l);if(v===-1||e.nodeType!=Node.TEXT_NODE)return a=o.createRange(),a.selectNodeContents(e),[a];for(a=o.createRange(),a.setStart(e,0),a.setEnd(e,v),i.push(a),a=!1;v!=-1;)v=n.indexOf(l,v+1),v>0&&(a&&(a.setEnd(e,v),i.push(a)),a=o.createRange(),a.setStart(e,v+1));return a&&(a.setEnd(e,n.length),i.push(a)),i}rangePairToCfiPair(e,r){var i=r.start,t=r.end;i.collapse(!0),t.collapse(!1);let n=new $s.default(i,e).toString(),a=new $s.default(t,e).toString();return{start:n,end:a}}rangeListToCfiList(e,r){for(var i=[],t,n=0;n<r.length;n++)t=this.rangePairToCfiPair(e,r[n]),i.push(t);return i}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}var q_=J_;Ea.default=q_;Object.defineProperty(ji,"__esModule",{value:!0});ji.default=void 0;var ex=Vl(Ar.exports),Fr=Be,wn=Vl(Qt),cc=Vl(Ea),tx=Jr,oi=Nt;function Vl(s){return s&&s.__esModule?s:{default:s}}const hc=typeof navigator!="undefined",rx=hc&&/Chrome/.test(navigator.userAgent),pc=hc&&!rx&&/AppleWebKit/.test(navigator.userAgent),ix=1;class vc{constructor(e,r,i,t){this.epubcfi=new wn.default,this.document=e,this.documentElement=this.document.documentElement,this.content=r||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=t||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",oi.EPUBJS_VERSION),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return oi.DOM_EVENTS}width(e){var r=this.content;return e&&(0,Fr.isNumber)(e)&&(e=e+"px"),e&&(r.style.width=e),parseInt(this.window.getComputedStyle(r).width)}height(e){var r=this.content;return e&&(0,Fr.isNumber)(e)&&(e=e+"px"),e&&(r.style.height=e),parseInt(this.window.getComputedStyle(r).height)}contentWidth(e){var r=this.content||this.document.body;return e&&(0,Fr.isNumber)(e)&&(e=e+"px"),e&&(r.style.width=e),parseInt(this.window.getComputedStyle(r).width)}contentHeight(e){var r=this.content||this.document.body;return e&&(0,Fr.isNumber)(e)&&(e=e+"px"),e&&(r.style.height=e),parseInt(this.window.getComputedStyle(r).height)}textWidth(){let e,r,i=this.document.createRange(),t=this.content||this.document.body,n=(0,Fr.borders)(t);return i.selectNodeContents(t),e=i.getBoundingClientRect(),r=e.width,n&&n.width&&(r+=n.width),Math.round(r)}textHeight(){let e,r,i=this.document.createRange(),t=this.content||this.document.body;return i.selectNodeContents(t),e=i.getBoundingClientRect(),r=e.bottom,Math.round(r)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,r,i){var t=this.content||this.document.body;return r?t.style.setProperty(e,r,i?"important":""):t.style.removeProperty(e),this.window.getComputedStyle(t)[e]}viewport(e){var r=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},t=[],n={};if(r&&r.hasAttribute("content")){let a=r.getAttribute("content"),o=a.match(/width\s*=\s*([^,]*)/),l=a.match(/height\s*=\s*([^,]*)/),v=a.match(/initial-scale\s*=\s*([^,]*)/),h=a.match(/minimum-scale\s*=\s*([^,]*)/),f=a.match(/maximum-scale\s*=\s*([^,]*)/),d=a.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]!="undefined"&&(i.width=o[1]),l&&l.length&&typeof l[1]!="undefined"&&(i.height=l[1]),v&&v.length&&typeof v[1]!="undefined"&&(i.scale=v[1]),h&&h.length&&typeof h[1]!="undefined"&&(i.minimum=h[1]),f&&f.length&&typeof f[1]!="undefined"&&(i.maximum=f[1]),d&&d.length&&typeof d[1]!="undefined"&&(i.scalable=d[1])}return n=(0,Fr.defaults)(e||{},i),e&&(n.width&&t.push("width="+n.width),n.height&&t.push("height="+n.height),n.scale&&t.push("initial-scale="+n.scale),n.scalable==="no"?(t.push("minimum-scale="+n.scale),t.push("maximum-scale="+n.scale),t.push("user-scalable="+n.scalable)):(n.scalable&&t.push("user-scalable="+n.scalable),n.minimum&&t.push("minimum-scale="+n.minimum),n.maximum&&t.push("minimum-scale="+n.maximum)),r||(r=this.document.createElement("meta"),r.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(r)),r.setAttribute("content",t.join(", ")),this.window.scrollTo(0,0)),n}expand(){this.emit(oi.EVENTS.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver=="undefined"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),r=this.textHeight();(e!=this._size.width||r!=this._size.height)&&(this._size={width:e,height:r},this.onResize&&this.onResize(this._size),this.emit(oi.EVENTS.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,r=function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),i=0;i<e.length;i+=1){var t;try{t=e[i].cssRules}catch(o){return}if(!t)return;for(var n=0;n<t.length;n+=1)if(t[n].media){var a=this.window.matchMedia(t[n].media.mediaText);a.addListener(r)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(r=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),r,i=0;i<e.length;i++)r=e[i],typeof r.naturalWidth!="undefined"&&r.naturalWidth===0&&(r.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,r){var i,t={left:0,top:0};if(!this.document)return t;if(this.epubcfi.isCfiString(e)){let n=new wn.default(e).toRange(this.document,r);if(n){try{if(!n.endContainer||n.startContainer==n.endContainer&&n.startOffset==n.endOffset){let a=n.startContainer.textContent.indexOf(" ",n.startOffset);a==-1&&(a=n.startContainer.textContent.length),n.setEnd(n.startContainer,a)}}catch(a){console.error("setting end offset to start container length failed",a)}if(n.startContainer.nodeType===Node.ELEMENT_NODE)i=n.startContainer.getBoundingClientRect(),t.left=i.left,t.top=i.top;else if(pc){let a=n.startContainer,o=new Range;try{a.nodeType===ix?i=a.getBoundingClientRect():n.startOffset+2<a.length?(o.setStart(a,n.startOffset),o.setEnd(a,n.startOffset+2),i=o.getBoundingClientRect()):n.startOffset-2>0?(o.setStart(a,n.startOffset-2),o.setEnd(a,n.startOffset),i=o.getBoundingClientRect()):i=a.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else i=n.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let n=e.substring(e.indexOf("#")+1),a=this.document.getElementById(n);if(a)if(pc){let o=new Range;o.selectNode(a),i=o.getBoundingClientRect()}else i=a.getBoundingClientRect()}return i&&(t.left=i.left,t.top=i.top),t}addStylesheet(e){return new Promise(function(r,i){var t,n=!1;if(!this.document){r(!1);return}if(t=this.document.querySelector("link[href='"+e+"']"),t){r(!0);return}t=this.document.createElement("link"),t.type="text/css",t.rel="stylesheet",t.href=e,t.onload=t.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(()=>{r(!0)},1))},this.document.head.appendChild(t)}.bind(this))}_getStylesheetNode(e){var r;return e="epubjs-inserted-css-"+(e||""),this.document?(r=this.document.getElementById(e),r||(r=this.document.createElement("style"),r.id=e,this.document.head.appendChild(r)),r):!1}addStylesheetCss(e,r){if(!this.document||!e)return!1;var i;return i=this._getStylesheetNode(r),i.innerHTML=e,!0}addStylesheetRules(e,r){var i;if(!(!this.document||!e||e.length===0))if(i=this._getStylesheetNode(r).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var t=0,n=e.length;t<n;t++){var a=1,o=e[t],l=e[t][0],v="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],a=0);for(var h=o.length;a<h;a++){var f=o[a];v+=f[0]+":"+f[1]+(f[2]?" !important":"")+`;
`}i.insertRule(l+"{"+v+"}",i.cssRules.length)}else Object.keys(e).forEach(g=>{const E=e[g];if(Array.isArray(E))E.forEach(S=>{const m=Object.keys(S).map(c=>`${c}:${S[c]}`).join(";");i.insertRule(`${g}{${m}}`,i.cssRules.length)});else{const x=Object.keys(E).map(m=>`${m}:${E[m]}`).join(";");i.insertRule(`${g}{${x}}`,i.cssRules.length)}})}addScript(e){return new Promise(function(r,i){var t,n=!1;if(!this.document){r(!1);return}t=this.document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=e,t.onload=t.onreadystatechange=function(){!n&&(!this.readyState||this.readyState=="complete")&&(n=!0,setTimeout(function(){r(!0)},1))},this.document.head.appendChild(t)}.bind(this))}addClass(e){var r;!this.document||(r=this.content||this.document.body,r&&r.classList.add(e))}removeClass(e){var r;!this.document||(r=this.content||this.document.body,r&&r.classList.remove(e))}addEventListeners(){!this.document||(this._triggerEvent=this.triggerEvent.bind(this),oi.DOM_EVENTS.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){!this.document||(oi.DOM_EVENTS.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){!this.document||(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){!this.document||(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var r=this.window.getSelection();this.triggerSelectedEvent(r)}.bind(this),250)}triggerSelectedEvent(e){var r,i;e&&e.rangeCount>0&&(r=e.getRangeAt(0),r.collapsed||(i=new wn.default(r,this.cfiBase).toString(),this.emit(oi.EVENTS.CONTENTS.SELECTED,i),this.emit(oi.EVENTS.CONTENTS.SELECTED_RANGE,r)))}range(e,r){var i=new wn.default(e);return i.toRange(this.document,r)}cfiFromRange(e,r){return new wn.default(e,this.cfiBase,r).toString()}cfiFromNode(e,r){return new wn.default(e,this.cfiBase,r).toString()}map(e){var r=new cc.default(e);return r.section()}size(e,r){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),i.width=e,this.css("padding","0 "+e/12+"px")),r>=0&&(this.height(r),i.height=r),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i)}columns(e,r,i,t,n){let a=(0,Fr.prefixed)("column-axis"),o=(0,Fr.prefixed)("column-gap"),l=(0,Fr.prefixed)("column-width"),v=(0,Fr.prefixed)("column-fill"),f=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),n==="rtl"&&f==="horizontal"&&this.direction(n),this.width(e),this.height(r),this.viewport({width:e,height:r,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),f==="vertical"?(this.css("padding-top",t/2+"px",!0),this.css("padding-bottom",t/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",t/2+"px",!0),this.css("padding-right",t/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(v,"auto"),this.css(o,t+"px"),this.css(l,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,r,i){var t="scale("+e+")",n="";this.css("transform-origin","top left"),(r>=0||i>=0)&&(n=" translate("+(r||0)+"px, "+(i||0)+"px )"),this.css("transform",t+n)}fit(e,r,i){var t=this.viewport(),n=parseInt(t.width),a=parseInt(t.height),o=e/n,l=r/a,v=o<l?o:l;if(this.layoutStyle("paginated"),this.width(n),this.height(a),this.overflow("hidden"),this.scaler(v,0,0),this.css("background-size",n*v+"px "+a*v+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var h=e-n*v;this.css("margin-left",h+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,r,i,t,n){var a=new cc.default(r,n);return a.page(this,e,i,t)}linksHandler(){(0,tx.replaceLinks)(this.content,e=>{this.emit(oi.EVENTS.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let r=(0,Fr.prefixed)("writing-mode");return e&&this.documentElement&&(this.documentElement.style[r]=e),this.window.getComputedStyle(this.documentElement)[r]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,r){return navigator.epubReadingSystem={name:e,version:r,layoutStyle:this.layoutStyle(),hasFeature:function(i){switch(i){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}(0,ex.default)(vc.prototype);var nx=vc;ji.default=nx;var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.default=void 0;var ax=mc(Ar.exports),sx=mc(Qt),gc=Nt;function mc(s){return s&&s.__esModule?s:{default:s}}class ox{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,r,i,t,n,a){let o=encodeURI(r+e),v=new sx.default(r).spinePos,h=new yc({type:e,cfiRange:r,data:i,sectionIndex:v,cb:t,className:n,styles:a});return this._annotations[o]=h,v in this._annotationsBySectionIndex?this._annotationsBySectionIndex[v].push(o):this._annotationsBySectionIndex[v]=[o],this.rendition.views().forEach(d=>{h.sectionIndex===d.index&&h.attach(d)}),h}remove(e,r){let i=encodeURI(e+r);if(i in this._annotations){let t=this._annotations[i];if(r&&t.type!==r)return;this.rendition.views().forEach(a=>{this._removeFromAnnotationBySectionIndex(t.sectionIndex,i),t.sectionIndex===a.index&&t.detach(a)}),delete this._annotations[i]}}_removeFromAnnotationBySectionIndex(e,r){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(i=>i!==r)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,r,i,t,n){return this.add("highlight",e,r,i,t,n)}underline(e,r,i,t,n){return this.add("underline",e,r,i,t,n)}mark(e,r,i){return this.add("mark",e,r,i)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let r=e.index;r in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[r].forEach(t=>{this._annotations[t].attach(e)})}clear(e){let r=e.index;r in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[r].forEach(t=>{this._annotations[t].detach(e)})}show(){}hide(){}}class yc{constructor({type:e,cfiRange:r,data:i,sectionIndex:t,cb:n,className:a,styles:o}){this.type=e,this.cfiRange=r,this.data=i,this.sectionIndex=t,this.mark=void 0,this.cb=n,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:r,data:i,type:t,mark:n,cb:a,className:o,styles:l}=this,v;return t==="highlight"?v=e.highlight(r,i,a,o,l):t==="underline"?v=e.underline(r,i,a,o,l):t==="mark"&&(v=e.mark(r,i,a)),this.mark=v,this.emit(gc.EVENTS.ANNOTATION.ATTACH,v),v}detach(e){let{cfiRange:r,type:i}=this,t;return e&&(i==="highlight"?t=e.unhighlight(r):i==="underline"?t=e.ununderline(r):i==="mark"&&(t=e.unmark(r))),this.mark=void 0,this.emit(gc.EVENTS.ANNOTATION.DETACH,t),t}text(){}}(0,ax.default)(yc.prototype);var lx=ox;Gs.default=lx;var _a={},qr={},Ys={};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.createElement=Ec;function Ec(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}Ys.default={createElement:Ec};var xa={};Object.defineProperty(xa,"__esModule",{value:!0});xa.proxyMouse=_c;xa.clone=xc;xa.default={proxyMouse:_c};function _c(s,e){function r(a){for(var o=e.length-1;o>=0;o--){var l=e[o],v=a.clientX,h=a.clientY;if(a.touches&&a.touches.length&&(v=a.touches[0].clientX,h=a.touches[0].clientY),!!ux(l,s,v,h)){l.dispatchEvent(xc(a));break}}}if(s.nodeName==="iframe"||s.nodeName==="IFRAME")try{this.target=s.contentDocument}catch(a){this.target=s}else this.target=s;for(var i=["mouseup","mousedown","click","touchstart"],t=0;t<i.length;t++){var n=i[t];this.target.addEventListener(n,function(a){return r(a)},!1)}}function xc(s){var e=Object.assign({},s,{bubbles:!1});try{return new MouseEvent(s.type,e)}catch(i){var r=document.createEvent("MouseEvents");return r.initMouseEvent(s.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),r}}function ux(s,e,r,i){var t=e.getBoundingClientRect();function n(h,f,d){var g=h.top-t.top,E=h.left-t.left,S=g+h.height,x=E+h.width;return g<=d&&E<=f&&S>d&&x>f}var a=s.getBoundingClientRect();if(!n(a,r,i))return!1;for(var o=s.getClientRects(),l=0,v=o.length;l<v;l++)if(n(o[l],r,i))return!0;return!1}Object.defineProperty(qr,"__esModule",{value:!0});qr.Underline=qr.Highlight=qr.Mark=qr.Pane=void 0;var fx=function s(e,r,i){e===null&&(e=Function.prototype);var t=Object.getOwnPropertyDescriptor(e,r);if(t===void 0){var n=Object.getPrototypeOf(e);return n===null?void 0:s(n,r,i)}else{if("value"in t)return t.value;var a=t.get;return a===void 0?void 0:a.call(i)}},Xs=function(){function s(e,r){for(var i=0;i<r.length;i++){var t=r[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(e,r,i){return r&&s(e.prototype,r),i&&s(e,i),e}}(),dx=Ys,ba=bc(dx),cx=xa,hx=bc(cx);function bc(s){return s&&s.__esModule?s:{default:s}}function Sc(s,e){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:s}function Tc(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):s.__proto__=e)}function Zs(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}qr.Pane=function(){function s(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;Zs(this,s),this.target=e,this.element=ba.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),hx.default.proxyMouse(this.target,this.marks),this.container=r,this.container.appendChild(this.element),this.render()}return Xs(s,[{key:"addMark",value:function(r){var i=ba.default.createElement("g");return this.element.appendChild(i),r.bind(i,this.container),this.marks.push(r),r.render(),r}},{key:"removeMark",value:function(r){var i=this.marks.indexOf(r);if(i!==-1){var t=r.unbind();this.element.removeChild(t),this.marks.splice(i,1)}}},{key:"render",value:function(){mx(this.element,gx(this.target,this.container));var r=!0,i=!1,t=void 0;try{for(var n=this.marks[Symbol.iterator](),a;!(r=(a=n.next()).done);r=!0){var o=a.value;o.render()}}catch(l){i=!0,t=l}finally{try{!r&&n.return&&n.return()}finally{if(i)throw t}}}}]),s}();var px=qr.Mark=function(){function s(){Zs(this,s),this.element=null}return Xs(s,[{key:"bind",value:function(r,i){this.element=r,this.container=i}},{key:"unbind",value:function(){var r=this.element;return this.element=null,r}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(r){!this.element||this.element.dispatchEvent(r)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var r=[],i=this.element.firstChild;i;)r.push(i.getBoundingClientRect()),i=i.nextSibling;return r}},{key:"filteredRanges",value:function(){var r=Array.from(this.range.getClientRects());return r.filter(function(i){for(var t=0;t<r.length;t++){if(r[t]===i)return!0;var n=yx(r[t],i);if(n)return!1}return!0})}}]),s}(),vx=qr.Highlight=function(s){Tc(e,s);function e(r,i,t,n){Zs(this,e);var a=Sc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.range=r,a.className=i,a.data=t||{},a.attributes=n||{},a}return Xs(e,[{key:"bind",value:function(i,t){fx(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,i,t);for(var n in this.data)this.data.hasOwnProperty(n)&&(this.element.dataset[n]=this.data[n]);for(var n in this.attributes)this.attributes.hasOwnProperty(n)&&this.element.setAttribute(n,this.attributes[n]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=t.length;o<l;o++){var v=t[o],h=ba.default.createElement("rect");h.setAttribute("x",v.left-n.left+a.left),h.setAttribute("y",v.top-n.top+a.top),h.setAttribute("height",v.height),h.setAttribute("width",v.width),i.appendChild(h)}this.element.appendChild(i)}}]),e}(px);qr.Underline=function(s){Tc(e,s);function e(r,i,t,n){return Zs(this,e),Sc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,r,i,t,n))}return Xs(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=t.length;o<l;o++){var v=t[o],h=ba.default.createElement("rect");h.setAttribute("x",v.left-n.left+a.left),h.setAttribute("y",v.top-n.top+a.top),h.setAttribute("height",v.height),h.setAttribute("width",v.width),h.setAttribute("fill","none");var f=ba.default.createElement("line");f.setAttribute("x1",v.left-n.left+a.left),f.setAttribute("x2",v.left-n.left+a.left+v.width),f.setAttribute("y1",v.top-n.top+a.top+v.height-1),f.setAttribute("y2",v.top-n.top+a.top+v.height-1),f.setAttribute("stroke-width",1),f.setAttribute("stroke","black"),f.setAttribute("stroke-linecap","square"),i.appendChild(h),i.appendChild(f)}this.element.appendChild(i)}}]),e}(vx);function gx(s,e){var r=e.getBoundingClientRect(),i=s.getBoundingClientRect();return{top:i.top-r.top,left:i.left-r.left,height:s.scrollHeight,width:s.scrollWidth}}function mx(s,e){s.style.setProperty("top",e.top+"px","important"),s.style.setProperty("left",e.left+"px","important"),s.style.setProperty("height",e.height+"px","important"),s.style.setProperty("width",e.width+"px","important")}function yx(s,e){return e.right<=s.right&&e.left>=s.left&&e.top>=s.top&&e.bottom<=s.bottom}Object.defineProperty(_a,"__esModule",{value:!0});_a.default=void 0;var Ex=Kl(Ar.exports),Ut=Be,_x=Kl(Qt),xx=Kl(ji),hr=Nt,Qs=qr;function Kl(s){return s&&s.__esModule?s:{default:s}}class Ac{constructor(e,r){this.settings=(0,Ut.extend)({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},r||{}),this.id="epubjs-view-"+(0,Ut.uuid)(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new _x.default,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var r=document.createElement("div");return r.classList.add("epub-view"),r.style.height="0px",r.style.width="0px",r.style.overflow="hidden",r.style.position="relative",r.style.display="block",e&&e=="horizontal"?r.style.flex="none":r.style.flex="initial",r}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=(0,Ut.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,r){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then(function(i){return this.load(i)}.bind(this)).then(function(){let i=this.contents.writingMode(),t;return this.settings.flow==="scrolled"?t=i.indexOf("vertical")===0?"horizontal":"vertical":t=i.indexOf("vertical")===0?"vertical":"horizontal",i.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(t),this.emit(hr.EVENTS.VIEWS.AXIS,t),this.setWritingMode(i),this.emit(hr.EVENTS.VIEWS.WRITING_MODE,i),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((n,a)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),n()})}.bind(this),function(i){return this.emit(hr.EVENTS.VIEWS.LOAD_ERROR,i),new Promise((t,n)=>{n(i)})}.bind(this)).then(function(){this.emit(hr.EVENTS.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,r){var i=e||this.settings.width,t=r||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",i,t):this.settings.axis==="horizontal"?this.lock("height",i,t):this.lock("width",i,t),this.settings.width=i,this.settings.height=t}lock(e,r,i){var t=(0,Ut.borders)(this.element),n;this.iframe?n=(0,Ut.borders)(this.iframe):n={width:0,height:0},e=="width"&&(0,Ut.isNumber)(r)&&(this.lockedWidth=r-t.width-n.width),e=="height"&&(0,Ut.isNumber)(i)&&(this.lockedHeight=i-t.height-n.height),e==="both"&&(0,Ut.isNumber)(r)&&(0,Ut.isNumber)(i)&&(this.lockedWidth=r-t.width-n.width,this.lockedHeight=i-t.height-n.height),this.displayed&&this.iframe&&this.expand()}expand(e){var r=this.lockedWidth,i=this.lockedHeight,t;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(r=this.layout.columnWidth,i=this.layout.height):this.settings.axis==="horizontal"?(r=this.contents.textWidth(),r%this.layout.pageWidth>0&&(r=Math.ceil(r/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(t=r/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&t%2>0&&(r+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(i=this.contents.textHeight(),this.settings.flow==="paginated"&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||r!=this._width||i!=this._height)&&this.reframe(r,i),this._expanding=!1)}reframe(e,r){var i;(0,Ut.isNumber)(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),(0,Ut.isNumber)(r)&&(this.element.style.height=r+"px",this.iframe.style.height=r+"px",this._height=r);let t=this.prevBounds?e-this.prevBounds.width:e,n=this.prevBounds?r-this.prevBounds.height:r;i={width:e,height:r,widthDelta:t,heightDelta:n},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let a;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(a=this.marks[o],this.placeMark(a.element,a.range))}),this.onResize(this,i),this.emit(hr.EVENTS.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=(0,Ut.bounds)(this.element)}load(e){var r=new Ut.defer,i=r.promise;if(!this.iframe)return r.reject(new Error("No Iframe Available")),i;if(this.iframe.onload=function(n){this.onLoad(n,r)}.bind(this),this.settings.method==="blobUrl")this.blobUrl=(0,Ut.createBlobUrl)(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return r.reject(new Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var t=this;MSApp.execUnsafeLocalFunction(function(){t.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return i}onLoad(e,r){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new xx.default(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):(i=this.document.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(hr.EVENTS.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(hr.EVENTS.CONTENTS.RESIZE,t=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),r.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var r=new Ut.defer;return this.displayed?r.resolve(this):this.render(e).then(function(){this.emit(hr.EVENTS.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,r.resolve(this)}.bind(this),function(i){r.reject(i,this)}),r.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(hr.EVENTS.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(hr.EVENTS.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var r=this.contents.locationOf(e,this.settings.ignoreClass);return{left:r.left,top:r.top}}onDisplayed(e){}onResize(e,r){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=(0,Ut.bounds)(this.element)),this.elementBounds}highlight(e,r={},i,t="epubjs-hl",n={}){if(!this.contents)return;const a=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(e),l=()=>{this.emit(hr.EVENTS.VIEWS.MARK_CLICKED,e,r)};r.epubcfi=e,this.pane||(this.pane=new Qs.Pane(this.iframe,this.element));let v=new Qs.Highlight(o,t,r,a),h=this.pane.addMark(v);return this.highlights[e]={mark:h,element:h.element,listeners:[l,i]},h.element.setAttribute("ref",t),h.element.addEventListener("click",l),h.element.addEventListener("touchstart",l),i&&(h.element.addEventListener("click",i),h.element.addEventListener("touchstart",i)),h}underline(e,r={},i,t="epubjs-ul",n={}){if(!this.contents)return;const a=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},n);let o=this.contents.range(e),l=()=>{this.emit(hr.EVENTS.VIEWS.MARK_CLICKED,e,r)};r.epubcfi=e,this.pane||(this.pane=new Qs.Pane(this.iframe,this.element));let v=new Qs.Underline(o,t,r,a),h=this.pane.addMark(v);return this.underlines[e]={mark:h,element:h.element,listeners:[l,i]},h.element.setAttribute("ref",t),h.element.addEventListener("click",l),h.element.addEventListener("touchstart",l),i&&(h.element.addEventListener("click",i),h.element.addEventListener("touchstart",i)),h}mark(e,r={},i){if(!this.contents)return;if(e in this.marks)return this.marks[e];let t=this.contents.range(e);if(!t)return;let n=t.commonAncestorContainer,a=n.nodeType===1?n:n.parentNode,o=v=>{this.emit(hr.EVENTS.VIEWS.MARK_CLICKED,e,r)};t.collapsed&&n.nodeType===1?(t=new Range,t.selectNodeContents(n)):t.collapsed&&(t=new Range,t.selectNodeContents(a));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,r&&Object.keys(r).forEach(v=>{l.dataset[v]=r[v]}),i&&(l.addEventListener("click",i),l.addEventListener("touchstart",i)),l.addEventListener("click",o),l.addEventListener("touchstart",o),this.placeMark(l,t),this.element.appendChild(l),this.marks[e]={element:l,range:t,listeners:[o,i]},a}placeMark(e,r){let i,t,n;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=r.getBoundingClientRect();i=o.top,t=o.right}else{let o=r.getClientRects(),l;for(var a=0;a!=o.length;a++)l=o[a],(!n||l.left<n)&&(n=l.left,t=Math.ceil(n/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=l.top)}e.style.top=`${i}px`,e.style.left=`${t}px`}unhighlight(e){let r;e in this.highlights&&(r=this.highlights[e],this.pane.removeMark(r.mark),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.highlights[e])}ununderline(e){let r;e in this.underlines&&(r=this.underlines[e],this.pane.removeMark(r.mark),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.underlines[e])}unmark(e){let r;e in this.marks&&(r=this.marks[e],this.element.removeChild(r.element),r.listeners.forEach(i=>{i&&(r.element.removeEventListener("click",i),r.element.removeEventListener("touchstart",i))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&(0,Ut.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}(0,Ex.default)(Ac.prototype);var bx=Ac;_a.default=bx;var On={},Js={};Object.defineProperty(Js,"__esModule",{value:!0});Js.createDefiner=wc;Js.default=Sx;function Sx(){var s="reverse",e=wc();return document.body.appendChild(e),e.scrollLeft>0?s="default":typeof Element!="undefined"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(s="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(s="negative")),document.body.removeChild(e),s}function wc(){var s=document.createElement("div");s.dir="rtl",s.style.position="fixed",s.style.width="1px",s.style.height="1px",s.style.top="0px",s.style.left="0px",s.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var r=document.createElement("span");r.style.width="1px",r.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",e.appendChild(r),e.appendChild(i),s.appendChild(e),s}var qs={};function Tx(s){var e=typeof s;return s!=null&&(e=="object"||e=="function")}var Hl=Tx,Ax=typeof Wt=="object"&&Wt&&Wt.Object===Object&&Wt,wx=Ax,Ox=wx,Lx=typeof self=="object"&&self&&self.Object===Object&&self,Ix=Ox||Lx||Function("return this")(),Oc=Ix,Rx=Oc,Dx=function(){return Rx.Date.now()},Cx=Dx,Px=/\s/;function Mx(s){for(var e=s.length;e--&&Px.test(s.charAt(e)););return e}var kx=Mx,Nx=kx,Fx=/^\s+/;function Bx(s){return s&&s.slice(0,Nx(s)+1).replace(Fx,"")}var Ux=Bx,jx=Oc,Wx=jx.Symbol,Lc=Wx,Ic=Lc,Rc=Object.prototype,zx=Rc.hasOwnProperty,Vx=Rc.toString,Sa=Ic?Ic.toStringTag:void 0;function Kx(s){var e=zx.call(s,Sa),r=s[Sa];try{s[Sa]=void 0;var i=!0}catch(n){}var t=Vx.call(s);return i&&(e?s[Sa]=r:delete s[Sa]),t}var Hx=Kx,$x=Object.prototype,Gx=$x.toString;function Yx(s){return Gx.call(s)}var Xx=Yx,Dc=Lc,Zx=Hx,Qx=Xx,Jx="[object Null]",qx="[object Undefined]",Cc=Dc?Dc.toStringTag:void 0;function eb(s){return s==null?s===void 0?qx:Jx:Cc&&Cc in Object(s)?Zx(s):Qx(s)}var tb=eb;function rb(s){return s!=null&&typeof s=="object"}var ib=rb,nb=tb,ab=ib,sb="[object Symbol]";function ob(s){return typeof s=="symbol"||ab(s)&&nb(s)==sb}var lb=ob,ub=Ux,Pc=Hl,fb=lb,Mc=0/0,db=/^[-+]0x[0-9a-f]+$/i,cb=/^0b[01]+$/i,hb=/^0o[0-7]+$/i,pb=parseInt;function vb(s){if(typeof s=="number")return s;if(fb(s))return Mc;if(Pc(s)){var e=typeof s.valueOf=="function"?s.valueOf():s;s=Pc(e)?e+"":e}if(typeof s!="string")return s===0?s:+s;s=ub(s);var r=cb.test(s);return r||hb.test(s)?pb(s.slice(2),r?2:8):db.test(s)?Mc:+s}var gb=vb,mb=Hl,$l=Cx,kc=gb,yb="Expected a function",Eb=Math.max,_b=Math.min;function xb(s,e,r){var i,t,n,a,o,l,v=0,h=!1,f=!1,d=!0;if(typeof s!="function")throw new TypeError(yb);e=kc(e)||0,mb(r)&&(h=!!r.leading,f="maxWait"in r,n=f?Eb(kc(r.maxWait)||0,e):n,d="trailing"in r?!!r.trailing:d);function g(_){var b=i,T=t;return i=t=void 0,v=_,a=s.apply(T,b),a}function E(_){return v=_,o=setTimeout(m,e),h?g(_):a}function S(_){var b=_-l,T=_-v,A=e-b;return f?_b(A,n-T):A}function x(_){var b=_-l,T=_-v;return l===void 0||b>=e||b<0||f&&T>=n}function m(){var _=$l();if(x(_))return c(_);o=setTimeout(m,S(_))}function c(_){return o=void 0,d&&i?g(_):(i=t=void 0,a)}function p(){o!==void 0&&clearTimeout(o),v=0,i=l=t=o=void 0}function y(){return o===void 0?a:c($l())}function u(){var _=$l(),b=x(_);if(i=arguments,t=this,l=_,b){if(o===void 0)return E(l);if(f)return clearTimeout(o),o=setTimeout(m,e),g(l)}return o===void 0&&(o=setTimeout(m,e)),a}return u.cancel=p,u.flush=y,u}var Nc=xb,bb=Nc,Sb=Hl,Tb="Expected a function";function Ab(s,e,r){var i=!0,t=!0;if(typeof s!="function")throw new TypeError(Tb);return Sb(r)&&(i="leading"in r?!!r.leading:i,t="trailing"in r?!!r.trailing:t),bb(s,e,{leading:i,maxWait:e,trailing:t})}var wb=Ab;Object.defineProperty(qs,"__esModule",{value:!0});qs.default=void 0;var pr=Be,Ob=Lb(wb);function Lb(s){return s&&s.__esModule?s:{default:s}}class Ib{constructor(e){this.settings=e||{},this.id="epubjs-container-"+(0,pr.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let r=e.height,i=e.width,t=e.overflow||!1,n=e.axis||"vertical",a=e.direction;(0,pr.extend)(this.settings,e),e.height&&(0,pr.isNumber)(e.height)&&(r=e.height+"px"),e.width&&(0,pr.isNumber)(e.width)&&(i=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",n==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),i&&(o.style.width=i),r&&(o.style.height=r),t&&(t==="scroll"&&n==="vertical"?(o.style["overflow-y"]=t,o.style["overflow-x"]="hidden"):t==="scroll"&&n==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=t):o.style.overflow=t),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var r=document.createElement("div");return r.style.visibility="hidden",r.style.overflow="hidden",r.style.width="0",r.style.height="0",r.appendChild(e),r}getElement(e){var r;if((0,pr.isElement)(e)?r=e:typeof e=="string"&&(r=document.getElementById(e)),!r)throw new Error("Not an Element");return r}attachTo(e){var r=this.getElement(e),i;if(!!r)return this.settings.hidden?i=this.wrapper:i=this.container,r.appendChild(i),this.element=r,r}getContainer(){return this.container}onResize(e){(!(0,pr.isNumber)(this.settings.width)||!(0,pr.isNumber)(this.settings.height))&&(this.resizeFunc=(0,Ob.default)(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,r){var i;let t=e||this.settings.width,n=r||this.settings.height;e===null?(i=this.element.getBoundingClientRect(),i.width&&(e=Math.floor(i.width),this.container.style.width=e+"px")):(0,pr.isNumber)(e)?this.container.style.width=e+"px":this.container.style.width=e,r===null?(i=i||this.element.getBoundingClientRect(),i.height&&(r=i.height,this.container.style.height=r+"px")):(0,pr.isNumber)(r)?this.container.style.height=r+"px":this.container.style.height=r,(0,pr.isNumber)(e)||(e=this.container.clientWidth),(0,pr.isNumber)(r)||(r=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=(0,pr.windowBounds)(),o=window.getComputedStyle(document.body),l={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return t||(e=a.width-l.left-l.right),(this.settings.fullsize&&!n||!n)&&(r=a.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:r-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?(0,pr.windowBounds)():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,r){var i="#"+this.id+" ",t="";this.sheet||(this.sheet=this.getSheet()),r.forEach(function(n){for(var a in n)n.hasOwnProperty(a)&&(t+=a+":"+n[a]+";")}),this.sheet.insertRule(i+e+" {"+t+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}var Rb=Ib;qs.default=Rb;var eo={};Object.defineProperty(eo,"__esModule",{value:!0});eo.default=void 0;class Db{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,r){return this._views.splice(r,0,e),this.container&&(r<this.container.children.length?this.container.insertBefore(e.element,this.container.children[r]):this.container.appendChild(e.element)),this.length++,e}remove(e){var r=this._views.indexOf(e);r>-1&&this._views.splice(r,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,r=this.length;if(!!this.length){for(var i=0;i<r;i++)e=this._views[i],this.destroy(e);this._views=[],this.length=0}}find(e){for(var r,i=this.length,t=0;t<i;t++)if(r=this._views[t],r.displayed&&r.section.index==e.index)return r}displayed(){for(var e=[],r,i=this.length,t=0;t<i;t++)r=this._views[t],r.displayed&&e.push(r);return e}show(){for(var e,r=this.length,i=0;i<r;i++)e=this._views[i],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,r=this.length,i=0;i<r;i++)e=this._views[i],e.displayed&&e.hide();this.hidden=!0}}var Cb=Db;eo.default=Cb;Object.defineProperty(On,"__esModule",{value:!0});On.default=void 0;var Pb=In(Ar.exports),Ln=Be,Mb=In(Js),Fc=In(Ea),kb=In(xi),Nb=In(qs),Fb=In(eo),vr=Nt;function In(s){return s&&s.__esModule?s:{default:s}}class Bc{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new kb.default(this),this.settings=(0,Ln.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),(0,Ln.extend)(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,r){let i=e.tagName;typeof this.settings.fullsize=="undefined"&&i&&(i.toLowerCase()=="body"||i.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=r,this.settings.rtlScrollType=(0,Mb.default)(),this.stage=new Nb.default({width:r.width,height:r.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new Fb.default(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",function(r){this.destroy()}.bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:r}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(vr.EVENTS.MANAGERS.ORIENTATION_CHANGE,r)}.bind(this),500)}onResized(e){this.resize()}resize(e,r,i){let t=this.stage.size(e,r);if(this.winBounds=(0,Ln.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===t.width&&this._stageSize.height===t.height||(this._stageSize=t,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(vr.EVENTS.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i))}createView(e,r){return new this.View(e,(0,Ln.extend)(this.viewSettings,{forceRight:r}))}handleNextPrePaginated(e,r,i){let t;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||r.index===0)return;if(t=r.next(),t&&!t.properties.includes("page-spread-left"))return i.call(this,t)}}display(e,r){var i=new Ln.defer,t=i.promise;(r===e.href||(0,Ln.isNumber)(r))&&(r=void 0);var n=this.views.find(e);if(n&&e&&this.layout.name!=="pre-paginated"){let o=n.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let l=n.width();this.scrollTo(o.left+l,o.top,!0)}if(r){let l=n.locationOf(r),v=n.width();this.moveTo(l,v)}return i.resolve(),t}this.clear();let a=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then(function(o){if(r){let l=o.locationOf(r),v=o.width();this.moveTo(l,v)}}.bind(this),o=>{i.reject(o)}).then(function(){return this.handleNextPrePaginated(a,e,this.add)}.bind(this)).then(function(){this.views.show(),i.resolve()}.bind(this)),t}afterDisplayed(e){this.emit(vr.EVENTS.MANAGERS.ADDED,e)}afterResized(e){this.emit(vr.EVENTS.MANAGERS.RESIZE,e.section)}moveTo(e,r){var i=0,t=0;this.isPaginated?(i=Math.floor(e.left/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta),t=Math.floor(e.top/this.layout.delta)*this.layout.delta,t+this.layout.delta>this.container.scrollHeight&&(t=this.container.scrollHeight-this.layout.delta)):t=e.top,this.settings.direction==="rtl"&&(i=i+this.layout.delta,i=i-r),this.scrollTo(i,t,!0)}add(e,r){var i=this.createView(e,r);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(vr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(vr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}append(e,r){var i=this.createView(e,r);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(vr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(vr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}prepend(e,r){var i=this.createView(e,r);return i.on(vr.EVENTS.VIEWS.RESIZED,t=>{this.counter(t)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(vr.EVENTS.VIEWS.AXIS,t=>{this.updateAxis(t)}),i.on(vr.EVENTS.VIEWS.WRITING_MODE,t=>{this.updateWritingMode(t)}),i.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,r;let i=this.settings.direction;if(!!this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,r=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,r<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(r=this.container.scrollLeft,r>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(r=this.container.scrollLeft+this.layout.delta*-1,r>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let t=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(t=!0),this.append(e,t).then(function(){return this.handleNextPrePaginated(t,e,this.append)}.bind(this),n=>n).then(function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}prev(){var e,r;let i=this.settings.direction;if(!!this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,r=this.container.scrollLeft,r>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(r=this.container.scrollLeft+this.container.offsetWidth,r<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(r=this.container.scrollLeft,r<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let t=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(t=!0),this.prepend(e,t).then(function(){var n;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(n=e.prev(),n))return this.prepend(n)}.bind(this),n=>n).then(function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),r=this.container.getBoundingClientRect(),i=r.height<window.innerHeight?r.height:window.innerHeight,t=r.width<window.innerWidth?r.width:window.innerWidth,n=this.settings.axis==="vertical";this.settings.direction;let a=0,o=0;return this.settings.fullsize&&(a=n?window.scrollY:window.scrollX),e.map(v=>{let{index:h,href:f}=v.section,d=v.position(),g=v.width(),E=v.height(),S,x,m,c;n?(S=a+r.top-d.top+o,x=S+i-o,c=this.layout.count(E,i).pages,m=i):(S=a+r.left-d.left+o,x=S+t-o,c=this.layout.count(g,t).pages,m=t);let p=Math.ceil(S/m),y=[],u=Math.ceil(x/m);if(this.settings.direction==="rtl"&&!n){let T=p;p=c-u,u=c-T}y=[];for(var _=p;_<=u;_++){let T=_+1;y.push(T)}let b=this.mapping.page(v.contents,v.section.cfiBase,S,x);return{index:h,href:f,pages:y,totalPages:c,mapping:b}})}paginatedLocation(){let e=this.visible(),r=this.container.getBoundingClientRect(),i=0,t=0;return this.settings.fullsize&&(i=window.scrollX),e.map(a=>{let{index:o,href:l}=a.section,v,h=a.position(),f=a.width(),d,g,E;this.settings.direction==="rtl"?(v=r.right-i,E=Math.min(Math.abs(v-h.left),this.layout.width)-t,g=h.width-(h.right-v)-t,d=g-E):(v=r.left+i,E=Math.min(h.right-v,this.layout.width)-t,d=v-h.left+t,g=d+E),t+=E;let S=this.mapping.page(a.contents,a.section.cfiBase,d,g),x=this.layout.count(f).pages,m=Math.floor(d/this.layout.pageWidth),c=[],p=Math.floor(g/this.layout.pageWidth);if(m<0&&(m=0,p=p+1),this.settings.direction==="rtl"){let u=m;m=x-p,p=x-u}for(var y=m+1;y<=p;y++){let u=y;c.push(u)}return{index:o,href:l,pages:c,totalPages:x,mapping:S}})}isVisible(e,r,i,t){var n=e.position(),a=t||this.bounds();return this.settings.axis==="horizontal"&&n.right>a.left-r&&n.left<a.right+i?!0:this.settings.axis==="vertical"&&n.bottom>a.top-r&&n.top<a.bottom+i}visible(){for(var e=this.bounds(),r=this.views.displayed(),i=r.length,t=[],n,a,o=0;o<i;o++)a=r[o],n=this.isVisible(a,0,0,e),n===!0&&t.push(a);return t}scrollBy(e,r,i){let t=this.settings.direction==="rtl"?-1:1;i&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*t,r*t):(e&&(this.container.scrollLeft+=e*t),r&&(this.container.scrollTop+=r)),this.scrolled=!0}scrollTo(e,r,i){i&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,r):(this.container.scrollLeft=e,this.container.scrollTop=r),this.scrolled=!0}onScroll(){let e,r;this.settings.fullsize?(e=window.scrollY,r=window.scrollX):(e=this.container.scrollTop,r=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=r,this.ignore?this.ignore=!1:(this.emit(vr.EVENTS.MANAGERS.SCROLL,{top:e,left:r}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(vr.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){!this.stage||(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new Fc.default(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(r){r&&r.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,r){!r&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new Fc.default(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,r="auto"){let i=e==="paginated"||e==="auto";this.isPaginated=i,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=i?"hidden":r,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(r){const i=r&&r.contents;i&&e.push(i)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}(0,Pb.default)(Bc.prototype);var Bb=Bc;On.default=Bb;var Ta={},to={};Object.defineProperty(to,"__esModule",{value:!0});to.default=void 0;var Uc=Be,jc=Nt,Ub=jb(Ar.exports);function jb(s){return s&&s.__esModule?s:{default:s}}const Wb=Math.PI/2,zb={easeOutSine:function(s){return Math.sin(s*Wb)},easeInOutSine:function(s){return-.5*(Math.cos(Math.PI*s)-1)},easeInOutQuint:function(s){return(s/=.5)<1?.5*Math.pow(s,5):.5*(Math.pow(s-2,5)+2)},easeInCubic:function(s){return Math.pow(s,3)}};class Wc{constructor(e,r){this.settings=(0,Uc.extend)({duration:80,minVelocity:.2,minDistance:10,easing:zb.easeInCubic},r||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(jc.EVENTS.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(jc.EVENTS.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let r=e.contents;["touchstart","touchmove","touchend"].forEach(i=>{r.on(i,t=>this.triggerViewEvent(t,r))})}triggerViewEvent(e,r){this.emit(e.type,e,r)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:r,screenY:i}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=r,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=r,this.endTouchY=i,this.endTime=this.now()}onTouchMove(e){let{screenX:r,screenY:i}=e.touches[0],t=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&t<10&&(this.element.scrollLeft-=r-this.endTouchX),this.endTouchX=r,this.endTouchY=i,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let r=this.wasSwiped();r!==0?this.snap(r):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,r=this.endTouchX-this.startTouchX,i=Math.abs(r),t=this.endTime-this.startTime,n=r/t,a=this.settings.minVelocity;if(i<=this.settings.minDistance||i>=e)return 0;if(n>a)return-1;if(n<-a)return 1}needsSnap(){let e=this.scrollLeft,r=this.layout.pageWidth*this.layout.divisor;return e%r!=0}snap(e=0){let r=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,t=Math.round(r/i)*i;return e&&(t+=e*i),this.smoothScrollTo(t)}smoothScrollTo(e){const r=new Uc.defer,i=this.scrollLeft,t=this.now(),n=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){const l=this.now(),v=Math.min(1,(l-t)/n);if(a(v),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,r.resolve();return}v<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(i+(e-i)*v,0)):(this.scrollTo(e,0),this.snapping=!1,r.resolve())}return o.call(this),r.promise}scrollTo(e=0,r=0){this.fullsize?window.scroll(e,r):(this.scroller.scrollLeft=e,this.scroller.scrollTop=r)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){!this.scroller||(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}(0,Ub.default)(Wc.prototype);var Vb=Wc;to.default=Vb;Object.defineProperty(Ta,"__esModule",{value:!0});Ta.default=void 0;var Wi=Be,zc=Gl(On),Vc=Gl(to),Ir=Nt,Kb=Gl(Nc);function Gl(s){return s&&s.__esModule?s:{default:s}}class Hb extends zc.default{constructor(e){super(e);this.name="continuous",this.settings=(0,Wi.extend)(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),(0,Wi.extend)(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,r){return zc.default.prototype.display.call(this,e,r).then(function(){return this.fill()}.bind(this))}fill(e){var r=e||new Wi.defer;return this.q.enqueue(()=>this.check()).then(i=>{i?this.fill(r):r.resolve()}),r.promise}moveTo(e){var r=0,i=0;this.isPaginated?(r=Math.floor(e.left/this.layout.delta)*this.layout.delta,r+this.settings.offsetDelta):(i=e.top,e.top+this.settings.offsetDelta),(r>0||i>0)&&this.scrollBy(r,i,!0)}afterResized(e){this.emit(Ir.EVENTS.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var r=this.createView(e);return this.views.append(r),r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),r.onDisplayed=this.afterDisplayed.bind(this),r.onResize=this.afterResized.bind(this),r.display(this.request)}append(e){var r=this.createView(e);return r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.append(r),r.onDisplayed=this.afterDisplayed.bind(this),r}prepend(e){var r=this.createView(e);return r.on(Ir.EVENTS.VIEWS.RESIZED,i=>{this.counter(i),r.expanded=!0}),r.on(Ir.EVENTS.VIEWS.AXIS,i=>{this.updateAxis(i)}),r.on(Ir.EVENTS.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.prepend(r),r.onDisplayed=this.afterDisplayed.bind(this),r}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var r=this.bounds(),i=this.views.all(),t=i.length,n=typeof e!="undefined"?e:this.settings.offset||0,a,o,l=new Wi.defer,v=[],h=0;h<t;h++)if(o=i[h],a=this.isVisible(o,n,n,r),a===!0)if(o.displayed)o.show();else{let f=o.display(this.request).then(function(d){d.show()},d=>{o.hide()});v.push(f)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return v.length?Promise.all(v).catch(f=>{l.reject(f)}):(l.resolve(),l.promise)}check(e,r){var i=new Wi.defer,t=[],n=this.settings.axis==="horizontal",a=this.settings.offset||0;e&&n&&(a=e),r&&!n&&(a=r);var o=this._bounds;let l=n?this.scrollLeft:this.scrollTop,v=n?Math.floor(o.width):o.height,h=n?this.container.scrollWidth:this.container.scrollHeight,f=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",d=this.settings.rtlScrollType,g=this.settings.direction==="rtl";this.settings.fullsize?(n&&g&&d==="negative"||!n&&g&&d==="default")&&(l=l*-1):(g&&d==="default"&&f==="horizontal"&&(l=h-v-l),g&&d==="negative"&&f==="horizontal"&&(l=l*-1));let E=()=>{let p=this.views.first(),y=p&&p.section.prev();y&&t.push(this.prepend(y))},S=()=>{let p=this.views.last(),y=p&&p.section.next();y&&t.push(this.append(y))},x=l+v+a,m=l-a;x>=h&&S(),m<0&&E();let c=t.map(p=>p.display(this.request));return t.length?Promise.all(c).then(()=>this.check()).then(()=>this.update(a),p=>p):(this.q.enqueue(function(){this.update()}.bind(this)),i.resolve(!1),i.promise)}trim(){for(var e=new Wi.defer,r=this.views.displayed(),i=r[0],t=r[r.length-1],n=this.views.indexOf(i),a=this.views.indexOf(t),o=this.views.slice(0,n),l=this.views.slice(a+1),v=0;v<o.length-1;v++)this.erase(o[v],o);for(var h=1;h<l.length;h++)this.erase(l[h]);return e.resolve(),e.promise}erase(e,r){var i,t;this.settings.fullsize?(i=window.scrollY,t=window.scrollX):(i=this.container.scrollTop,t=this.container.scrollLeft);var n=e.bounds();this.views.remove(e),r&&(this.settings.axis==="vertical"?this.scrollTo(0,i-n.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(t+Math.floor(n.width),0,!0):this.scrollTo(t,0,!0):this.scrollTo(t-Math.floor(n.width),0,!0))}addEventListeners(e){window.addEventListener("unload",function(r){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new Vc.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=Wi.requestAnimationFrame;let r=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*r,this.scrollLeft=window.scrollX*r):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=(0,Kb.default)(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,r,i=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*i,r=window.scrollX*i):(e=this.container.scrollTop,r=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=r,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(r-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=r,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(Ir.EVENTS.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Ir.EVENTS.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;!this.views.length||(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;!this.views.length||(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new Vc.default(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}var $b=Hb;Ta.default=$b;Object.defineProperty(An,"__esModule",{value:!0});An.default=void 0;var Gb=Br(Ar.exports),Aa=Be,zi=Br(bn),Kc=Br(Qt),Yb=Br(xi),Xb=Br(ya),Zb=Br(Hs);Br(ji);var Qb=Br(Gs),pt=Nt,Jb=Br(_a),qb=Br(On),eS=Br(Ta);function Br(s){return s&&s.__esModule?s:{default:s}}class Hc{constructor(e,r){this.settings=(0,Aa.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),(0,Aa.extend)(this.settings,r),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new zi.default(this),this.hooks.serialize=new zi.default(this),this.hooks.content=new zi.default(this),this.hooks.unloaded=new zi.default(this),this.hooks.layout=new zi.default(this),this.hooks.render=new zi.default(this),this.hooks.show=new zi.default(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new Zb.default(this),this.annotations=new Qb.default(this),this.epubcfi=new Kc.default,this.q=new Yb.default(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Aa.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var r;return typeof e=="string"&&e==="default"?r=qb.default:typeof e=="string"&&e==="continuous"?r=eS.default:r=e,r}requireView(e){var r;return typeof e=="string"&&e==="iframe"?r=Jb.default:r=e,r}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(pt.EVENTS.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(pt.EVENTS.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(pt.EVENTS.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue(function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(pt.EVENTS.RENDITION.ATTACHED)}.bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(!!this.book){this.epubcfi.isCfiString(e);var r=new Aa.defer,i=r.promise,t;return this.displaying=r,this.book.locations.length()&&(0,Aa.isFloat)(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),t=this.book.spine.get(e),t?(this.manager.display(t,e).then(()=>{r.resolve(t),this.displaying=void 0,this.emit(pt.EVENTS.RENDITION.DISPLAYED,t),this.reportLocation()},n=>{this.emit(pt.EVENTS.RENDITION.DISPLAY_ERROR,n)}),i):(r.reject(new Error("No Section Found")),i)}}afterDisplayed(e){e.on(pt.EVENTS.VIEWS.MARK_CLICKED,(r,i)=>this.triggerMarkEvent(r,i,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(pt.EVENTS.RENDITION.RENDERED,e.section,e)}):this.emit(pt.EVENTS.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(pt.EVENTS.RENDITION.REMOVED,e.section,e)})}onResized(e,r){this.emit(pt.EVENTS.RENDITION.RESIZED,{width:e.width,height:e.height},r),this.location&&this.location.start&&this.display(r||this.location.start.cfi)}onOrientationChange(e){this.emit(pt.EVENTS.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,r,i){e&&(this.settings.width=e),r&&(this.settings.height=r),this.manager.resize(e,r,i)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var r,i=this.settings.layout||e.layout||"reflowable",t=this.settings.spread||e.spread||"auto",n=this.settings.orientation||e.orientation||"auto",a=this.settings.flow||e.flow||"auto",o=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,v=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),r={layout:i,spread:t,orientation:n,flow:a,viewport:o,minSpreadWidth:l,direction:v},r}flow(e){var r=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(r="scrolled"),(e==="auto"||e==="paginated")&&(r="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(r),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(r),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new Xb.default(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(pt.EVENTS.LAYOUT.UPDATED,(r,i)=>{this.emit(pt.EVENTS.RENDITION.LAYOUT,r,i)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,r){this.settings.spread=e,r&&(this.settings.minSpreadWidth=r),this._layout&&this._layout.spread(e,r),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var i=this.manager.currentLocation();if(i&&i.then&&typeof i.then=="function")i.then(function(t){let n=this.located(t);!n||!n.start||!n.end||(this.location=n,this.emit(pt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(pt.EVENTS.RENDITION.RELOCATED,this.location))}.bind(this));else if(i){let t=this.located(i);if(!t||!t.start||!t.end)return;this.location=t,this.emit(pt.EVENTS.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(pt.EVENTS.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then(function(r){return this.located(r)}.bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let r=e[0],i=e[e.length-1],t={start:{index:r.index,href:r.href,cfi:r.mapping.start,displayed:{page:r.pages[0]||1,total:r.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}},n=this.book.locations.locationFromCfi(r.mapping.start),a=this.book.locations.locationFromCfi(i.mapping.end);n!=null&&(t.start.location=n,t.start.percentage=this.book.locations.percentageFromLocation(n)),a!=null&&(t.end.location=a,t.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(r.mapping.start),l=this.book.pageList.pageFromCfi(i.mapping.end);return o!=-1&&(t.start.page=o),l!=-1&&(t.end.page=l),i.index===this.book.spine.last().index&&t.end.displayed.page>=t.end.displayed.total&&(t.atEnd=!0),r.index===this.book.spine.first().index&&t.start.displayed.page===1&&(t.atStart=!0),t}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){pt.DOM_EVENTS.forEach(r=>{e.on(r,i=>this.triggerViewEvent(i,e))}),e.on(pt.EVENTS.CONTENTS.SELECTED,r=>this.triggerSelectedEvent(r,e))}triggerViewEvent(e,r){this.emit(e.type,e,r)}triggerSelectedEvent(e,r){this.emit(pt.EVENTS.RENDITION.SELECTED,e,r)}triggerMarkEvent(e,r,i){this.emit(pt.EVENTS.RENDITION.MARK_CLICKED,e,r,i)}getRange(e,r){var i=new Kc.default(e),t=this.manager.visible().filter(function(n){if(i.spinePos===n.index)return!0});if(t.length)return t[0].contents.range(i,r)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(n){n()});let r=e.window.getComputedStyle(e.content,null),i=(e.content.offsetHeight-(parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)))*.95,t=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-t+"px":"100%")+"!important","max-height":i+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-t+"px":"100%")+"!important","max-height":i+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(n,a){setTimeout(function(){n()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(pt.EVENTS.CONTENTS.LINK_CLICKED,r=>{let i=this.book.path.relative(r);this.display(i)})}injectStylesheet(e,r){let i=e.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(i)}injectScript(e,r){let i=e.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",this.settings.script),i.textContent=" ",e.getElementsByTagName("head")[0].appendChild(i)}injectIdentifier(e,r){let i=this.book.packaging.metadata.identifier,t=e.createElement("meta");t.setAttribute("name","dc.relation.ispartof"),i&&t.setAttribute("content",i),e.getElementsByTagName("head")[0].appendChild(t)}}(0,Gb.default)(Hc.prototype);var tS=Hc;An.default=tS;var ro={},$c={exports:{}};/*!

JSZip v3.9.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/(function(s,e){(function(r){s.exports=r()})(function(){return function r(i,t,n){function a(v,h){if(!t[v]){if(!i[v]){var f=typeof zr=="function"&&zr;if(!h&&f)return f(v,!0);if(o)return o(v,!0);var d=new Error("Cannot find module '"+v+"'");throw d.code="MODULE_NOT_FOUND",d}var g=t[v]={exports:{}};i[v][0].call(g.exports,function(E){var S=i[v][1][E];return a(S||E)},g,g.exports,r,i,t,n)}return t[v].exports}for(var o=typeof zr=="function"&&zr,l=0;l<n.length;l++)a(n[l]);return a}({1:[function(r,i,t){var n=r("./utils"),a=r("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(l){for(var v=[],h,f,d,g,E,S,x,m=0,c=l.length,p=c,y=n.getTypeOf(l)!=="string";m<l.length;)p=c-m,y?(h=l[m++],f=m<c?l[m++]:0,d=m<c?l[m++]:0):(h=l.charCodeAt(m++),f=m<c?l.charCodeAt(m++):0,d=m<c?l.charCodeAt(m++):0),g=h>>2,E=(h&3)<<4|f>>4,S=p>1?(f&15)<<2|d>>6:64,x=p>2?d&63:64,v.push(o.charAt(g)+o.charAt(E)+o.charAt(S)+o.charAt(x));return v.join("")},t.decode=function(l){var v,h,f,d,g,E,S,x=0,m=0,c="data:";if(l.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9\+\/\=]/g,"");var p=l.length*3/4;if(l.charAt(l.length-1)===o.charAt(64)&&p--,l.charAt(l.length-2)===o.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");var y;for(a.uint8array?y=new Uint8Array(p|0):y=new Array(p|0);x<l.length;)d=o.indexOf(l.charAt(x++)),g=o.indexOf(l.charAt(x++)),E=o.indexOf(l.charAt(x++)),S=o.indexOf(l.charAt(x++)),v=d<<2|g>>4,h=(g&15)<<4|E>>2,f=(E&3)<<6|S,y[m++]=v,E!==64&&(y[m++]=h),S!==64&&(y[m++]=f);return y}},{"./support":30,"./utils":32}],2:[function(r,i,t){var n=r("./external"),a=r("./stream/DataWorker"),o=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function v(h,f,d,g,E){this.compressedSize=h,this.uncompressedSize=f,this.crc32=d,this.compression=g,this.compressedContent=E}v.prototype={getContentWorker:function(){var h=new a(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return h.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new a(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},v.createWorkerFrom=function(h,f,d){return h.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},i.exports=v},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,i,t){var n=r("./stream/GenericWorker");t.STORE={magic:"\0\0",compressWorker:function(a){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},t.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,i,t){var n=r("./utils");function a(){for(var h,f=[],d=0;d<256;d++){h=d;for(var g=0;g<8;g++)h=h&1?3988292384^h>>>1:h>>>1;f[d]=h}return f}var o=a();function l(h,f,d,g){var E=o,S=g+d;h=h^-1;for(var x=g;x<S;x++)h=h>>>8^E[(h^f[x])&255];return h^-1}function v(h,f,d,g){var E=o,S=g+d;h=h^-1;for(var x=g;x<S;x++)h=h>>>8^E[(h^f.charCodeAt(x))&255];return h^-1}i.exports=function(f,d){if(typeof f=="undefined"||!f.length)return 0;var g=n.getTypeOf(f)!=="string";return g?l(d|0,f,f.length,0):v(d|0,f,f.length,0)}},{"./utils":32}],5:[function(r,i,t){t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!0,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},{}],6:[function(r,i,t){var n=null;typeof Promise!="undefined"?n=Promise:n=r("lie"),i.exports={Promise:n}},{lie:37}],7:[function(r,i,t){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",a=r("pako"),o=r("./utils"),l=r("./stream/GenericWorker"),v=n?"uint8array":"array";t.magic="\b\0";function h(f,d){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=d,this.meta={}}o.inherits(h,l),h.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(v,f.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(d){f.push({data:d,meta:f.meta})}},t.compressWorker=function(f){return new h("Deflate",f)},t.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,i,t){var n=r("../utils"),a=r("../stream/GenericWorker"),o=r("../utf8"),l=r("../crc32"),v=r("../signature"),h=function(m,c){var p="",y;for(y=0;y<c;y++)p+=String.fromCharCode(m&255),m=m>>>8;return p},f=function(m,c){var p=m;return m||(p=c?16893:33204),(p&65535)<<16},d=function(m,c){return(m||0)&63},g=function(m,c,p,y,u,_){var b=m.file,T=m.compression,A=_!==o.utf8encode,L=n.transformTo("string",_(b.name)),R=n.transformTo("string",o.utf8encode(b.name)),w=b.comment,O=n.transformTo("string",_(w)),I=n.transformTo("string",o.utf8encode(w)),D=R.length!==b.name.length,C=I.length!==w.length,P,M,N="",B="",U="",F=b.dir,j=b.date,V={crc32:0,compressedSize:0,uncompressedSize:0};(!c||p)&&(V.crc32=m.crc32,V.compressedSize=m.compressedSize,V.uncompressedSize=m.uncompressedSize);var G=0;c&&(G|=8),!A&&(D||C)&&(G|=2048);var Y=0,X=0;F&&(Y|=16),u==="UNIX"?(X=798,Y|=f(b.unixPermissions,F)):(X=20,Y|=d(b.dosPermissions)),P=j.getUTCHours(),P=P<<6,P=P|j.getUTCMinutes(),P=P<<5,P=P|j.getUTCSeconds()/2,M=j.getUTCFullYear()-1980,M=M<<4,M=M|j.getUTCMonth()+1,M=M<<5,M=M|j.getUTCDate(),D&&(B=h(1,1)+h(l(L),4)+R,N+="up"+h(B.length,2)+B),C&&(U=h(1,1)+h(l(O),4)+I,N+="uc"+h(U.length,2)+U);var ie="";ie+=`
\0`,ie+=h(G,2),ie+=T.magic,ie+=h(P,2),ie+=h(M,2),ie+=h(V.crc32,4),ie+=h(V.compressedSize,4),ie+=h(V.uncompressedSize,4),ie+=h(L.length,2),ie+=h(N.length,2);var he=v.LOCAL_FILE_HEADER+ie+L+N,de=v.CENTRAL_FILE_HEADER+h(X,2)+ie+h(O.length,2)+"\0\0\0\0"+h(Y,4)+h(y,4)+L+N+O;return{fileRecord:he,dirRecord:de}},E=function(m,c,p,y,u){var _="",b=n.transformTo("string",u(y));return _=v.CENTRAL_DIRECTORY_END+"\0\0\0\0"+h(m,2)+h(m,2)+h(c,4)+h(p,4)+h(b.length,2)+b,_},S=function(m){var c="";return c=v.DATA_DESCRIPTOR+h(m.crc32,4)+h(m.compressedSize,4)+h(m.uncompressedSize,4),c};function x(m,c,p,y){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=c,this.zipPlatform=p,this.encodeFileName=y,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}n.inherits(x,a),x.prototype.push=function(m){var c=m.meta.percent||0,p=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,a.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:p?(c+100*(p-y-1))/p:100}}))},x.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var c=this.streamFiles&&!m.file.dir;if(c){var p=g(m,c,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},x.prototype.closedSource=function(m){this.accumulate=!1;var c=this.streamFiles&&!m.file.dir,p=g(m,c,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),c)this.push({data:S(m),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},x.prototype.flush=function(){for(var m=this.bytesWritten,c=0;c<this.dirRecords.length;c++)this.push({data:this.dirRecords[c],meta:{percent:100}});var p=this.bytesWritten-m,y=E(this.dirRecords.length,p,m,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},x.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},x.prototype.registerPrevious=function(m){this._sources.push(m);var c=this;return m.on("data",function(p){c.processChunk(p)}),m.on("end",function(){c.closedSource(c.previous.streamInfo),c._sources.length?c.prepareNextSource():c.end()}),m.on("error",function(p){c.error(p)}),this},x.prototype.resume=function(){if(!a.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},x.prototype.error=function(m){var c=this._sources;if(!a.prototype.error.call(this,m))return!1;for(var p=0;p<c.length;p++)try{c[p].error(m)}catch(y){}return!0},x.prototype.lock=function(){a.prototype.lock.call(this);for(var m=this._sources,c=0;c<m.length;c++)m[c].lock()},i.exports=x},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,i,t){var n=r("../compressions"),a=r("./ZipFileWorker"),o=function(l,v){var h=l||v,f=n[h];if(!f)throw new Error(h+" is not a valid compression method !");return f};t.generateWorker=function(l,v,h){var f=new a(v.streamFiles,h,v.platform,v.encodeFileName),d=0;try{l.forEach(function(g,E){d++;var S=o(E.options.compression,v.compression),x=E.options.compressionOptions||v.compressionOptions||{},m=E.dir,c=E.date;E._compressWorker(S,x).withStreamInfo("file",{name:g,dir:m,date:c,comment:E.comment||"",unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions}).pipe(f)}),f.entriesCount=d}catch(g){f.error(g)}return f}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,i,t){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new n;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}n.prototype=r("./object"),n.prototype.loadAsync=r("./load"),n.support=r("./support"),n.defaults=r("./defaults"),n.version="3.9.1",n.loadAsync=function(a,o){return new n().loadAsync(a,o)},n.external=r("./external"),i.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,i,t){var n=r("./utils"),a=r("./external"),o=r("./utf8"),l=r("./zipEntries"),v=r("./stream/Crc32Probe"),h=r("./nodejsUtils");function f(d){return new a.Promise(function(g,E){var S=d.decompressed.getContentWorker().pipe(new v);S.on("error",function(x){E(x)}).on("end",function(){S.streamInfo.crc32!==d.decompressed.crc32?E(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}i.exports=function(d,g){var E=this;return g=n.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),h.isNode&&h.isStream(d)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",d,!0,g.optimizedBinaryString,g.base64).then(function(S){var x=new l(g);return x.load(S),x}).then(function(x){var m=[a.Promise.resolve(x)],c=x.files;if(g.checkCRC32)for(var p=0;p<c.length;p++)m.push(f(c[p]));return a.Promise.all(m)}).then(function(x){for(var m=x.shift(),c=m.files,p=0;p<c.length;p++){var y=c[p],u=y.fileNameStr,_=n.resolve(y.fileNameStr);E.file(_,y.decompressed,{binary:!0,optimizedBinaryString:!0,date:y.date,dir:y.dir,comment:y.fileCommentStr.length?y.fileCommentStr:null,unixPermissions:y.unixPermissions,dosPermissions:y.dosPermissions,createFolders:g.createFolders}),y.dir||(E.file(_).unsafeOriginalName=u)}return m.zipComment.length&&(E.comment=m.zipComment),E})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,i,t){var n=r("../utils"),a=r("../stream/GenericWorker");function o(l,v){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(v)}n.inherits(o,a),o.prototype._bindStream=function(l){var v=this;this._stream=l,l.pause(),l.on("data",function(h){v.push({data:h,meta:{percent:0}})}).on("error",function(h){v.isPaused?this.generatedError=h:v.error(h)}).on("end",function(){v.isPaused?v._upstreamEnded=!0:v.end()})},o.prototype.pause=function(){return a.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return a.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,i,t){var n=r("readable-stream").Readable,a=r("../utils");a.inherits(o,n);function o(l,v,h){n.call(this,v),this._helper=l;var f=this;l.on("data",function(d,g){f.push(d)||f._helper.pause(),h&&h(g)}).on("error",function(d){f.emit("error",d)}).on("end",function(){f.push(null)})}o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,i,t){i.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(n,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,a);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,a)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var a=new Buffer(n);return a.fill(0),a},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(r,i,t){var n=r("./utf8"),a=r("./utils"),o=r("./stream/GenericWorker"),l=r("./stream/StreamHelper"),v=r("./defaults"),h=r("./compressedObject"),f=r("./zipObject"),d=r("./generate"),g=r("./nodejsUtils"),E=r("./nodejs/NodejsStreamInputAdapter"),S=function(u,_,b){var T=a.getTypeOf(_),A,L=a.extend(b||{},v);L.date=L.date||new Date,L.compression!==null&&(L.compression=L.compression.toUpperCase()),typeof L.unixPermissions=="string"&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&L.unixPermissions&16384&&(L.dir=!0),L.dosPermissions&&L.dosPermissions&16&&(L.dir=!0),L.dir&&(u=m(u)),L.createFolders&&(A=x(u))&&c.call(this,A,!0);var R=T==="string"&&L.binary===!1&&L.base64===!1;(!b||typeof b.binary=="undefined")&&(L.binary=!R);var w=_ instanceof h&&_.uncompressedSize===0;(w||L.dir||!_||_.length===0)&&(L.base64=!1,L.binary=!0,_="",L.compression="STORE",T="string");var O=null;_ instanceof h||_ instanceof o?O=_:g.isNode&&g.isStream(_)?O=new E(u,_):O=a.prepareContent(u,_,L.binary,L.optimizedBinaryString,L.base64);var I=new f(u,O,L);this.files[u]=I},x=function(u){u.slice(-1)==="/"&&(u=u.substring(0,u.length-1));var _=u.lastIndexOf("/");return _>0?u.substring(0,_):""},m=function(u){return u.slice(-1)!=="/"&&(u+="/"),u},c=function(u,_){return _=typeof _!="undefined"?_:v.createFolders,u=m(u),this.files[u]||S.call(this,u,null,{dir:!0,createFolders:_}),this.files[u]};function p(u){return Object.prototype.toString.call(u)==="[object RegExp]"}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(u){var _,b,T;for(_ in this.files)T=this.files[_],b=_.slice(this.root.length,_.length),b&&_.slice(0,this.root.length)===this.root&&u(b,T)},filter:function(u){var _=[];return this.forEach(function(b,T){u(b,T)&&_.push(T)}),_},file:function(u,_,b){if(arguments.length===1)if(p(u)){var T=u;return this.filter(function(L,R){return!R.dir&&T.test(L)})}else{var A=this.files[this.root+u];return A&&!A.dir?A:null}else u=this.root+u,S.call(this,u,_,b);return this},folder:function(u){if(!u)return this;if(p(u))return this.filter(function(A,L){return L.dir&&u.test(A)});var _=this.root+u,b=c.call(this,_),T=this.clone();return T.root=b.name,T},remove:function(u){u=this.root+u;var _=this.files[u];if(_||(u.slice(-1)!=="/"&&(u+="/"),_=this.files[u]),_&&!_.dir)delete this.files[u];else for(var b=this.filter(function(A,L){return L.name.slice(0,u.length)===u}),T=0;T<b.length;T++)delete this.files[b[T].name];return this},generate:function(u){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(u){var _,b={};try{if(b=a.extend(u||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode}),b.type=b.type.toLowerCase(),b.compression=b.compression.toUpperCase(),b.type==="binarystring"&&(b.type="string"),!b.type)throw new Error("No output type specified.");a.checkSupport(b.type),(b.platform==="darwin"||b.platform==="freebsd"||b.platform==="linux"||b.platform==="sunos")&&(b.platform="UNIX"),b.platform==="win32"&&(b.platform="DOS");var T=b.comment||this.comment||"";_=d.generateWorker(this,b,T)}catch(A){_=new o("error"),_.error(A)}return new l(_,b.type||"string",b.mimeType)},generateAsync:function(u,_){return this.generateInternalStream(u).accumulate(_)},generateNodeStream:function(u,_){return u=u||{},u.type||(u.type="nodebuffer"),this.generateInternalStream(u).toNodejsStream(_)}};i.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,i,t){i.exports=r("stream")},{stream:void 0}],17:[function(r,i,t){var n=r("./DataReader"),a=r("../utils");function o(l){n.call(this,l);for(var v=0;v<this.data.length;v++)l[v]=l[v]&255}a.inherits(o,n),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var v=l.charCodeAt(0),h=l.charCodeAt(1),f=l.charCodeAt(2),d=l.charCodeAt(3),g=this.length-4;g>=0;--g)if(this.data[g]===v&&this.data[g+1]===h&&this.data[g+2]===f&&this.data[g+3]===d)return g-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var v=l.charCodeAt(0),h=l.charCodeAt(1),f=l.charCodeAt(2),d=l.charCodeAt(3),g=this.readData(4);return v===g[0]&&h===g[1]&&f===g[2]&&d===g[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var v=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,v},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,i,t){var n=r("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(o){},readInt:function(o){var l=0,v;for(this.checkOffset(o),v=this.index+o-1;v>=this.index;v--)l=(l<<8)+this.byteAt(v);return this.index+=o,l},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(o){},lastIndexOfSignature:function(o){},readAndCheckSignature:function(o){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},i.exports=a},{"../utils":32}],19:[function(r,i,t){var n=r("./Uint8ArrayReader"),a=r("../utils");function o(l){n.call(this,l)}a.inherits(o,n),o.prototype.readData=function(l){this.checkOffset(l);var v=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,v},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,i,t){var n=r("./DataReader"),a=r("../utils");function o(l){n.call(this,l)}a.inherits(o,n),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){var v=this.readData(4);return l===v},o.prototype.readData=function(l){this.checkOffset(l);var v=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,v},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,i,t){var n=r("./ArrayReader"),a=r("../utils");function o(l){n.call(this,l)}a.inherits(o,n),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var v=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,v},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,i,t){var n=r("../utils"),a=r("../support"),o=r("./ArrayReader"),l=r("./StringReader"),v=r("./NodeBufferReader"),h=r("./Uint8ArrayReader");i.exports=function(f){var d=n.getTypeOf(f);return n.checkSupport(d),d==="string"&&!a.uint8array?new l(f):d==="nodebuffer"?new v(f):a.uint8array?new h(n.transformTo("uint8array",f)):new o(n.transformTo("array",f))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,i,t){t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,i,t){var n=r("./GenericWorker"),a=r("../utils");function o(l){n.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,n),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(r,i,t){var n=r("./GenericWorker"),a=r("../crc32"),o=r("../utils");function l(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(l,n),l.prototype.processChunk=function(v){this.streamInfo.crc32=a(v.data,this.streamInfo.crc32||0),this.push(v)},i.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,i,t){var n=r("../utils"),a=r("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}n.inherits(o,a),o.prototype.processChunk=function(l){if(l){var v=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=v+l.data.length}a.prototype.processChunk.call(this,l)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(r,i,t){var n=r("../utils"),a=r("./GenericWorker"),o=16*1024;function l(v){a.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,v.then(function(f){h.dataIsReady=!0,h.data=f,h.max=f&&f.length||0,h.type=n.getTypeOf(f),h.isPaused||h._tickAndRepeat()},function(f){h.error(f)})}n.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return a.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var v=o,h=null,f=Math.min(this.max,this.index+v);if(this.index>=this.max)return this.end();switch(this.type){case"string":h=this.data.substring(this.index,f);break;case"uint8array":h=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":h=this.data.slice(this.index,f);break}return this.index=f,this.push({data:h,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(r,i,t){function n(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return this.isFinished?!1:(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)!this.extraStreamInfo.hasOwnProperty(a)||(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=n},{}],29:[function(r,i,t){var n=r("../utils"),a=r("./ConvertWorker"),o=r("./GenericWorker"),l=r("../base64"),v=r("../support"),h=r("../external"),f=null;if(v.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch(x){}function d(x,m,c){switch(x){case"blob":return n.newBlob(n.transformTo("arraybuffer",m),c);case"base64":return l.encode(m);default:return n.transformTo(x,m)}}function g(x,m){var c,p=0,y=null,u=0;for(c=0;c<m.length;c++)u+=m[c].length;switch(x){case"string":return m.join("");case"array":return Array.prototype.concat.apply([],m);case"uint8array":for(y=new Uint8Array(u),c=0;c<m.length;c++)y.set(m[c],p),p+=m[c].length;return y;case"nodebuffer":return Buffer.concat(m);default:throw new Error("concat : unsupported type '"+x+"'")}}function E(x,m){return new h.Promise(function(c,p){var y=[],u=x._internalType,_=x._outputType,b=x._mimeType;x.on("data",function(T,A){y.push(T),m&&m(A)}).on("error",function(T){y=[],p(T)}).on("end",function(){try{var T=d(_,g(u,y),b);c(T)}catch(A){p(A)}y=[]}).resume()})}function S(x,m,c){var p=m;switch(m){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string";break}try{this._internalType=p,this._outputType=m,this._mimeType=c,n.checkSupport(p),this._worker=x.pipe(new a(p)),x.lock()}catch(y){this._worker=new o("error"),this._worker.error(y)}}S.prototype={accumulate:function(x){return E(this,x)},on:function(x,m){var c=this;return x==="data"?this._worker.on(x,function(p){m.call(c,p.data,p.meta)}):this._worker.on(x,function(){n.delay(m,arguments,c)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},x)}},i.exports=S},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,i,t){if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",t.nodebuffer=typeof Buffer!="undefined",t.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")t.blob=!1;else{var n=new ArrayBuffer(0);try{t.blob=new Blob([n],{type:"application/zip"}).size===0}catch(l){try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(n),t.blob=o.getBlob("application/zip").size===0}catch(v){t.blob=!1}}}try{t.nodestream=!!r("readable-stream").Readable}catch(l){t.nodestream=!1}},{"readable-stream":16}],31:[function(r,i,t){for(var n=r("./utils"),a=r("./support"),o=r("./nodejsUtils"),l=r("./stream/GenericWorker"),v=new Array(256),h=0;h<256;h++)v[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;v[254]=v[254]=1;var f=function(x){var m,c,p,y,u,_=x.length,b=0;for(y=0;y<_;y++)c=x.charCodeAt(y),(c&64512)==55296&&y+1<_&&(p=x.charCodeAt(y+1),(p&64512)==56320&&(c=65536+(c-55296<<10)+(p-56320),y++)),b+=c<128?1:c<2048?2:c<65536?3:4;for(a.uint8array?m=new Uint8Array(b):m=new Array(b),u=0,y=0;u<b;y++)c=x.charCodeAt(y),(c&64512)==55296&&y+1<_&&(p=x.charCodeAt(y+1),(p&64512)==56320&&(c=65536+(c-55296<<10)+(p-56320),y++)),c<128?m[u++]=c:c<2048?(m[u++]=192|c>>>6,m[u++]=128|c&63):c<65536?(m[u++]=224|c>>>12,m[u++]=128|c>>>6&63,m[u++]=128|c&63):(m[u++]=240|c>>>18,m[u++]=128|c>>>12&63,m[u++]=128|c>>>6&63,m[u++]=128|c&63);return m},d=function(x,m){var c;for(m=m||x.length,m>x.length&&(m=x.length),c=m-1;c>=0&&(x[c]&192)==128;)c--;return c<0||c===0?m:c+v[x[c]]>m?c:m},g=function(x){var m,c,p,y,u=x.length,_=new Array(u*2);for(c=0,m=0;m<u;){if(p=x[m++],p<128){_[c++]=p;continue}if(y=v[p],y>4){_[c++]=65533,m+=y-1;continue}for(p&=y===2?31:y===3?15:7;y>1&&m<u;)p=p<<6|x[m++]&63,y--;if(y>1){_[c++]=65533;continue}p<65536?_[c++]=p:(p-=65536,_[c++]=55296|p>>10&1023,_[c++]=56320|p&1023)}return _.length!==c&&(_.subarray?_=_.subarray(0,c):_.length=c),n.applyFromCharCode(_)};t.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):f(m)},t.utf8decode=function(m){return a.nodebuffer?n.transformTo("nodebuffer",m).toString("utf-8"):(m=n.transformTo(a.uint8array?"uint8array":"array",m),g(m))};function E(){l.call(this,"utf-8 decode"),this.leftOver=null}n.inherits(E,l),E.prototype.processChunk=function(x){var m=n.transformTo(a.uint8array?"uint8array":"array",x.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var c=m;m=new Uint8Array(c.length+this.leftOver.length),m.set(this.leftOver,0),m.set(c,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var p=d(m),y=m;p!==m.length&&(a.uint8array?(y=m.subarray(0,p),this.leftOver=m.subarray(p,m.length)):(y=m.slice(0,p),this.leftOver=m.slice(p,m.length))),this.push({data:t.utf8decode(y),meta:x.meta})},E.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=E;function S(){l.call(this,"utf-8 encode")}n.inherits(S,l),S.prototype.processChunk=function(x){this.push({data:t.utf8encode(x.data),meta:x.meta})},t.Utf8EncodeWorker=S},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,i,t){var n=r("./support"),a=r("./base64"),o=r("./nodejsUtils"),l=r("set-immediate-shim"),v=r("./external");function h(m){var c=null;return n.uint8array?c=new Uint8Array(m.length):c=new Array(m.length),d(m,c)}t.newBlob=function(m,c){t.checkSupport("blob");try{return new Blob([m],{type:c})}catch(u){try{var p=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,y=new p;return y.append(m),y.getBlob(c)}catch(_){throw new Error("Bug : can't construct the Blob.")}}};function f(m){return m}function d(m,c){for(var p=0;p<m.length;++p)c[p]=m.charCodeAt(p)&255;return c}var g={stringifyByChunk:function(m,c,p){var y=[],u=0,_=m.length;if(_<=p)return String.fromCharCode.apply(null,m);for(;u<_;)c==="array"||c==="nodebuffer"?y.push(String.fromCharCode.apply(null,m.slice(u,Math.min(u+p,_)))):y.push(String.fromCharCode.apply(null,m.subarray(u,Math.min(u+p,_)))),u+=p;return y.join("")},stringifyByChar:function(m){for(var c="",p=0;p<m.length;p++)c+=String.fromCharCode(m[p]);return c},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(m){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch(m){return!1}}()}};function E(m){var c=65536,p=t.getTypeOf(m),y=!0;if(p==="uint8array"?y=g.applyCanBeUsed.uint8array:p==="nodebuffer"&&(y=g.applyCanBeUsed.nodebuffer),y)for(;c>1;)try{return g.stringifyByChunk(m,p,c)}catch(u){c=Math.floor(c/2)}return g.stringifyByChar(m)}t.applyFromCharCode=E;function S(m,c){for(var p=0;p<m.length;p++)c[p]=m[p];return c}var x={};x.string={string:f,array:function(m){return d(m,new Array(m.length))},arraybuffer:function(m){return x.string.uint8array(m).buffer},uint8array:function(m){return d(m,new Uint8Array(m.length))},nodebuffer:function(m){return d(m,o.allocBuffer(m.length))}},x.array={string:E,array:f,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return o.newBufferFrom(m)}},x.arraybuffer={string:function(m){return E(new Uint8Array(m))},array:function(m){return S(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:f,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return o.newBufferFrom(new Uint8Array(m))}},x.uint8array={string:E,array:function(m){return S(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:f,nodebuffer:function(m){return o.newBufferFrom(m)}},x.nodebuffer={string:E,array:function(m){return S(m,new Array(m.length))},arraybuffer:function(m){return x.nodebuffer.uint8array(m).buffer},uint8array:function(m){return S(m,new Uint8Array(m.length))},nodebuffer:f},t.transformTo=function(m,c){if(c||(c=""),!m)return c;t.checkSupport(m);var p=t.getTypeOf(c),y=x[p][m](c);return y},t.resolve=function(m){for(var c=m.split("/"),p=[],y=0;y<c.length;y++){var u=c[y];u==="."||u===""&&y!==0&&y!==c.length-1||(u===".."?p.pop():p.push(u))}return p.join("/")},t.getTypeOf=function(m){if(typeof m=="string")return"string";if(Object.prototype.toString.call(m)==="[object Array]")return"array";if(n.nodebuffer&&o.isBuffer(m))return"nodebuffer";if(n.uint8array&&m instanceof Uint8Array)return"uint8array";if(n.arraybuffer&&m instanceof ArrayBuffer)return"arraybuffer"},t.checkSupport=function(m){var c=n[m.toLowerCase()];if(!c)throw new Error(m+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(m){var c="",p,y;for(y=0;y<(m||"").length;y++)p=m.charCodeAt(y),c+="\\x"+(p<16?"0":"")+p.toString(16).toUpperCase();return c},t.delay=function(m,c,p){l(function(){m.apply(p||null,c||[])})},t.inherits=function(m,c){var p=function(){};p.prototype=c.prototype,m.prototype=new p},t.extend=function(){var m={},c,p;for(c=0;c<arguments.length;c++)for(p in arguments[c])arguments[c].hasOwnProperty(p)&&typeof m[p]=="undefined"&&(m[p]=arguments[c][p]);return m},t.prepareContent=function(m,c,p,y,u){var _=v.Promise.resolve(c).then(function(b){var T=n.blob&&(b instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(b))!==-1);return T&&typeof FileReader!="undefined"?new v.Promise(function(A,L){var R=new FileReader;R.onload=function(w){A(w.target.result)},R.onerror=function(w){L(w.target.error)},R.readAsArrayBuffer(b)}):b});return _.then(function(b){var T=t.getTypeOf(b);return T?(T==="arraybuffer"?b=t.transformTo("uint8array",b):T==="string"&&(u?b=a.decode(b):p&&y!==!0&&(b=h(b))),b):v.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(r,i,t){var n=r("./reader/readerFor"),a=r("./utils"),o=r("./signature"),l=r("./zipEntry");r("./utf8");var v=r("./support");function h(f){this.files=[],this.loadOptions=f}h.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(d)+", expected "+a.pretty(f)+")")}},isSignature:function(f,d){var g=this.reader.index;this.reader.setIndex(f);var E=this.reader.readString(4),S=E===d;return this.reader.setIndex(g),S},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),d=v.uint8array?"uint8array":"array",g=a.transformTo(d,f);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f=this.zip64EndOfCentralSize-44,d=0,g,E,S;d<f;)g=this.reader.readInt(2),E=this.reader.readInt(4),S=this.reader.readData(E),this.zip64ExtensibleData[g]={id:g,length:E,value:S}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,d;for(f=0;f<this.files.length;f++)d=this.files[f],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)f=new l({zip64:this.zip64},this.loadOptions),f.readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0){var d=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw d?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(f);var g=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),f<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var E=this.centralDirOffset+this.centralDirSize;this.zip64&&(E+=20,E+=12+this.zip64EndOfCentralSize);var S=g-E;if(S>0)this.isSignature(g,o.CENTRAL_FILE_HEADER)||(this.reader.zero=S);else if(S<0)throw new Error("Corrupted zip: missing "+Math.abs(S)+" bytes.")},prepareReader:function(f){this.reader=n(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(r,i,t){var n=r("./reader/readerFor"),a=r("./utils"),o=r("./compressedObject"),l=r("./crc32"),v=r("./utf8"),h=r("./compressions"),f=r("./support"),d=0,g=3,E=function(x){for(var m in h)if(!!h.hasOwnProperty(m)&&h[m].magic===x)return h[m];return null};function S(x,m){this.options=x,this.loadOptions=m}S.prototype={isEncrypted:function(){return(this.bitFlag&1)==1},useUTF8:function(){return(this.bitFlag&2048)==2048},readLocalPart:function(x){var m,c;if(x.skip(22),this.fileNameLength=x.readInt(2),c=x.readInt(2),this.fileName=x.readData(this.fileNameLength),x.skip(c),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(m=E(this.compressionMethod),m===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,m,x.readData(this.compressedSize))},readCentralPart:function(x){this.versionMadeBy=x.readInt(2),x.skip(2),this.bitFlag=x.readInt(2),this.compressionMethod=x.readString(2),this.date=x.readDate(),this.crc32=x.readInt(4),this.compressedSize=x.readInt(4),this.uncompressedSize=x.readInt(4);var m=x.readInt(2);if(this.extraFieldsLength=x.readInt(2),this.fileCommentLength=x.readInt(2),this.diskNumberStart=x.readInt(2),this.internalFileAttributes=x.readInt(2),this.externalFileAttributes=x.readInt(4),this.localHeaderOffset=x.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");x.skip(m),this.readExtraFields(x),this.parseZIP64ExtraField(x),this.fileComment=x.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var x=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),x===d&&(this.dosPermissions=this.externalFileAttributes&63),x===g&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(x){if(!!this.extraFields[1]){var m=n(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(x){var m=x.index+this.extraFieldsLength,c,p,y;for(this.extraFields||(this.extraFields={});x.index+4<m;)c=x.readInt(2),p=x.readInt(2),y=x.readData(p),this.extraFields[c]={id:c,length:p,value:y};x.setIndex(m)},handleUTF8:function(){var x=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=v.utf8decode(this.fileName),this.fileCommentStr=v.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var c=a.transformTo(x,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(c)}var p=this.findExtraFieldUnicodeComment();if(p!==null)this.fileCommentStr=p;else{var y=a.transformTo(x,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var x=this.extraFields[28789];if(x){var m=n(x.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:v.utf8decode(m.readData(x.length-5))}return null},findExtraFieldUnicodeComment:function(){var x=this.extraFields[25461];if(x){var m=n(x.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:v.utf8decode(m.readData(x.length-5))}return null}},i.exports=S},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,i,t){var n=r("./stream/StreamHelper"),a=r("./stream/DataWorker"),o=r("./utf8"),l=r("./compressedObject"),v=r("./stream/GenericWorker"),h=function(E,S,x){this.name=E,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=S,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}};h.prototype={internalStream:function(E){var S=null,x="string";try{if(!E)throw new Error("No output type specified.");x=E.toLowerCase();var m=x==="string"||x==="text";(x==="binarystring"||x==="text")&&(x="string"),S=this._decompressWorker();var c=!this._dataBinary;c&&!m&&(S=S.pipe(new o.Utf8EncodeWorker)),!c&&m&&(S=S.pipe(new o.Utf8DecodeWorker))}catch(p){S=new v("error"),S.error(p)}return new n(S,x,"")},async:function(E,S){return this.internalStream(E).accumulate(S)},nodeStream:function(E,S){return this.internalStream(E||"nodebuffer").toNodejsStream(S)},_compressWorker:function(E,S){if(this._data instanceof l&&this._data.compression.magic===E.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new o.Utf8EncodeWorker)),l.createWorkerFrom(x,E,S)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof v?this._data:new a(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<f.length;g++)h.prototype[f[g]]=d;i.exports=h},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,i,t){(function(n){var a=n.MutationObserver||n.WebKitMutationObserver,o;if(a){var l=0,v=new a(E),h=n.document.createTextNode("");v.observe(h,{characterData:!0}),o=function(){h.data=l=++l%2}}else if(!n.setImmediate&&typeof n.MessageChannel!="undefined"){var f=new n.MessageChannel;f.port1.onmessage=E,o=function(){f.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var x=n.document.createElement("script");x.onreadystatechange=function(){E(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},n.document.documentElement.appendChild(x)}:o=function(){setTimeout(E,0)};var d,g=[];function E(){d=!0;for(var x,m,c=g.length;c;){for(m=g,g=[],x=-1;++x<c;)m[x]();c=g.length}d=!1}i.exports=S;function S(x){g.push(x)===1&&!d&&o()}}).call(this,typeof Wt!="undefined"?Wt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(r,i,t){var n=r("immediate");function a(){}var o={},l=["REJECTED"],v=["FULFILLED"],h=["PENDING"];i.exports=f;function f(u){if(typeof u!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,u!==a&&S(this,u)}f.prototype.finally=function(u){if(typeof u!="function")return this;var _=this.constructor;return this.then(b,T);function b(A){function L(){return A}return _.resolve(u()).then(L)}function T(A){function L(){throw A}return _.resolve(u()).then(L)}},f.prototype.catch=function(u){return this.then(null,u)},f.prototype.then=function(u,_){if(typeof u!="function"&&this.state===v||typeof _!="function"&&this.state===l)return this;var b=new this.constructor(a);if(this.state!==h){var T=this.state===v?u:_;g(b,T,this.outcome)}else this.queue.push(new d(b,u,_));return b};function d(u,_,b){this.promise=u,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(u){o.resolve(this.promise,u)},d.prototype.otherCallFulfilled=function(u){g(this.promise,this.onFulfilled,u)},d.prototype.callRejected=function(u){o.reject(this.promise,u)},d.prototype.otherCallRejected=function(u){g(this.promise,this.onRejected,u)};function g(u,_,b){n(function(){var T;try{T=_(b)}catch(A){return o.reject(u,A)}T===u?o.reject(u,new TypeError("Cannot resolve promise with itself")):o.resolve(u,T)})}o.resolve=function(u,_){var b=x(E,_);if(b.status==="error")return o.reject(u,b.value);var T=b.value;if(T)S(u,T);else{u.state=v,u.outcome=_;for(var A=-1,L=u.queue.length;++A<L;)u.queue[A].callFulfilled(_)}return u},o.reject=function(u,_){u.state=l,u.outcome=_;for(var b=-1,T=u.queue.length;++b<T;)u.queue[b].callRejected(_);return u};function E(u){var _=u&&u.then;if(u&&(typeof u=="object"||typeof u=="function")&&typeof _=="function")return function(){_.apply(u,arguments)}}function S(u,_){var b=!1;function T(w){b||(b=!0,o.reject(u,w))}function A(w){b||(b=!0,o.resolve(u,w))}function L(){_(A,T)}var R=x(L);R.status==="error"&&T(R.value)}function x(u,_){var b={};try{b.value=u(_),b.status="success"}catch(T){b.status="error",b.value=T}return b}f.resolve=m;function m(u){return u instanceof this?u:o.resolve(new this(a),u)}f.reject=c;function c(u){var _=new this(a);return o.reject(_,u)}f.all=p;function p(u){var _=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=u.length,T=!1;if(!b)return this.resolve([]);for(var A=new Array(b),L=0,R=-1,w=new this(a);++R<b;)O(u[R],R);return w;function O(I,D){_.resolve(I).then(C,function(P){T||(T=!0,o.reject(w,P))});function C(P){A[D]=P,++L===b&&!T&&(T=!0,o.resolve(w,A))}}}f.race=y;function y(u){var _=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=u.length,T=!1;if(!b)return this.resolve([]);for(var A=-1,L=new this(a);++A<b;)R(u[A]);return L;function R(w){_.resolve(w).then(function(O){T||(T=!0,o.resolve(L,O))},function(O){T||(T=!0,o.reject(L,O))})}}},{immediate:36}],38:[function(r,i,t){var n=r("./lib/utils/common").assign,a=r("./lib/deflate"),o=r("./lib/inflate"),l=r("./lib/zlib/constants"),v={};n(v,a,o,l),i.exports=v},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,i,t){var n=r("./zlib/deflate"),a=r("./utils/common"),o=r("./utils/strings"),l=r("./zlib/messages"),v=r("./zlib/zstream"),h=Object.prototype.toString,f=0,d=4,g=0,E=1,S=2,x=-1,m=0,c=8;function p(b){if(!(this instanceof p))return new p(b);this.options=a.assign({level:x,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},b||{});var T=this.options;T.raw&&T.windowBits>0?T.windowBits=-T.windowBits:T.gzip&&T.windowBits>0&&T.windowBits<16&&(T.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var A=n.deflateInit2(this.strm,T.level,T.method,T.windowBits,T.memLevel,T.strategy);if(A!==g)throw new Error(l[A]);if(T.header&&n.deflateSetHeader(this.strm,T.header),T.dictionary){var L;if(typeof T.dictionary=="string"?L=o.string2buf(T.dictionary):h.call(T.dictionary)==="[object ArrayBuffer]"?L=new Uint8Array(T.dictionary):L=T.dictionary,A=n.deflateSetDictionary(this.strm,L),A!==g)throw new Error(l[A]);this._dict_set=!0}}p.prototype.push=function(b,T){var A=this.strm,L=this.options.chunkSize,R,w;if(this.ended)return!1;w=T===~~T?T:T===!0?d:f,typeof b=="string"?A.input=o.string2buf(b):h.call(b)==="[object ArrayBuffer]"?A.input=new Uint8Array(b):A.input=b,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new a.Buf8(L),A.next_out=0,A.avail_out=L),R=n.deflate(A,w),R!==E&&R!==g)return this.onEnd(R),this.ended=!0,!1;(A.avail_out===0||A.avail_in===0&&(w===d||w===S))&&(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(A.output,A.next_out))):this.onData(a.shrinkBuf(A.output,A.next_out)))}while((A.avail_in>0||A.avail_out===0)&&R!==E);return w===d?(R=n.deflateEnd(this.strm),this.onEnd(R),this.ended=!0,R===g):(w===S&&(this.onEnd(g),A.avail_out=0),!0)},p.prototype.onData=function(b){this.chunks.push(b)},p.prototype.onEnd=function(b){b===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg};function y(b,T){var A=new p(T);if(A.push(b,!0),A.err)throw A.msg||l[A.err];return A.result}function u(b,T){return T=T||{},T.raw=!0,y(b,T)}function _(b,T){return T=T||{},T.gzip=!0,y(b,T)}t.Deflate=p,t.deflate=y,t.deflateRaw=u,t.gzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,i,t){var n=r("./zlib/inflate"),a=r("./utils/common"),o=r("./utils/strings"),l=r("./zlib/constants"),v=r("./zlib/messages"),h=r("./zlib/zstream"),f=r("./zlib/gzheader"),d=Object.prototype.toString;function g(x){if(!(this instanceof g))return new g(x);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},x||{});var m=this.options;m.raw&&m.windowBits>=0&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),m.windowBits>=0&&m.windowBits<16&&!(x&&x.windowBits)&&(m.windowBits+=32),m.windowBits>15&&m.windowBits<48&&(m.windowBits&15)==0&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var c=n.inflateInit2(this.strm,m.windowBits);if(c!==l.Z_OK)throw new Error(v[c]);this.header=new f,n.inflateGetHeader(this.strm,this.header)}g.prototype.push=function(x,m){var c=this.strm,p=this.options.chunkSize,y=this.options.dictionary,u,_,b,T,A,L,R=!1;if(this.ended)return!1;_=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof x=="string"?c.input=o.binstring2buf(x):d.call(x)==="[object ArrayBuffer]"?c.input=new Uint8Array(x):c.input=x,c.next_in=0,c.avail_in=c.input.length;do{if(c.avail_out===0&&(c.output=new a.Buf8(p),c.next_out=0,c.avail_out=p),u=n.inflate(c,l.Z_NO_FLUSH),u===l.Z_NEED_DICT&&y&&(typeof y=="string"?L=o.string2buf(y):d.call(y)==="[object ArrayBuffer]"?L=new Uint8Array(y):L=y,u=n.inflateSetDictionary(this.strm,L)),u===l.Z_BUF_ERROR&&R===!0&&(u=l.Z_OK,R=!1),u!==l.Z_STREAM_END&&u!==l.Z_OK)return this.onEnd(u),this.ended=!0,!1;c.next_out&&(c.avail_out===0||u===l.Z_STREAM_END||c.avail_in===0&&(_===l.Z_FINISH||_===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(b=o.utf8border(c.output,c.next_out),T=c.next_out-b,A=o.buf2string(c.output,b),c.next_out=T,c.avail_out=p-T,T&&a.arraySet(c.output,c.output,b,T,0),this.onData(A)):this.onData(a.shrinkBuf(c.output,c.next_out))),c.avail_in===0&&c.avail_out===0&&(R=!0)}while((c.avail_in>0||c.avail_out===0)&&u!==l.Z_STREAM_END);return u===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(u=n.inflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===l.Z_OK):(_===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),c.avail_out=0),!0)},g.prototype.onData=function(x){this.chunks.push(x)},g.prototype.onEnd=function(x){x===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg};function E(x,m){var c=new g(m);if(c.push(x,!0),c.err)throw c.msg||v[c.err];return c.result}function S(x,m){return m=m||{},m.raw=!0,E(x,m)}t.Inflate=g,t.inflate=E,t.inflateRaw=S,t.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,i,t){var n=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";t.assign=function(l){for(var v=Array.prototype.slice.call(arguments,1);v.length;){var h=v.shift();if(!!h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var f in h)h.hasOwnProperty(f)&&(l[f]=h[f])}}return l},t.shrinkBuf=function(l,v){return l.length===v?l:l.subarray?l.subarray(0,v):(l.length=v,l)};var a={arraySet:function(l,v,h,f,d){if(v.subarray&&l.subarray){l.set(v.subarray(h,h+f),d);return}for(var g=0;g<f;g++)l[d+g]=v[h+g]},flattenChunks:function(l){var v,h,f,d,g,E;for(f=0,v=0,h=l.length;v<h;v++)f+=l[v].length;for(E=new Uint8Array(f),d=0,v=0,h=l.length;v<h;v++)g=l[v],E.set(g,d),d+=g.length;return E}},o={arraySet:function(l,v,h,f,d){for(var g=0;g<f;g++)l[d+g]=v[h+g]},flattenChunks:function(l){return[].concat.apply([],l)}};t.setTyped=function(l){l?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)},{}],42:[function(r,i,t){var n=r("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(f){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(f){o=!1}for(var l=new n.Buf8(256),v=0;v<256;v++)l[v]=v>=252?6:v>=248?5:v>=240?4:v>=224?3:v>=192?2:1;l[254]=l[254]=1,t.string2buf=function(f){var d,g,E,S,x,m=f.length,c=0;for(S=0;S<m;S++)g=f.charCodeAt(S),(g&64512)==55296&&S+1<m&&(E=f.charCodeAt(S+1),(E&64512)==56320&&(g=65536+(g-55296<<10)+(E-56320),S++)),c+=g<128?1:g<2048?2:g<65536?3:4;for(d=new n.Buf8(c),x=0,S=0;x<c;S++)g=f.charCodeAt(S),(g&64512)==55296&&S+1<m&&(E=f.charCodeAt(S+1),(E&64512)==56320&&(g=65536+(g-55296<<10)+(E-56320),S++)),g<128?d[x++]=g:g<2048?(d[x++]=192|g>>>6,d[x++]=128|g&63):g<65536?(d[x++]=224|g>>>12,d[x++]=128|g>>>6&63,d[x++]=128|g&63):(d[x++]=240|g>>>18,d[x++]=128|g>>>12&63,d[x++]=128|g>>>6&63,d[x++]=128|g&63);return d};function h(f,d){if(d<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(f,d));for(var g="",E=0;E<d;E++)g+=String.fromCharCode(f[E]);return g}t.buf2binstring=function(f){return h(f,f.length)},t.binstring2buf=function(f){for(var d=new n.Buf8(f.length),g=0,E=d.length;g<E;g++)d[g]=f.charCodeAt(g);return d},t.buf2string=function(f,d){var g,E,S,x,m=d||f.length,c=new Array(m*2);for(E=0,g=0;g<m;){if(S=f[g++],S<128){c[E++]=S;continue}if(x=l[S],x>4){c[E++]=65533,g+=x-1;continue}for(S&=x===2?31:x===3?15:7;x>1&&g<m;)S=S<<6|f[g++]&63,x--;if(x>1){c[E++]=65533;continue}S<65536?c[E++]=S:(S-=65536,c[E++]=55296|S>>10&1023,c[E++]=56320|S&1023)}return h(c,E)},t.utf8border=function(f,d){var g;for(d=d||f.length,d>f.length&&(d=f.length),g=d-1;g>=0&&(f[g]&192)==128;)g--;return g<0||g===0?d:g+l[f[g]]>d?g:d}},{"./common":41}],43:[function(r,i,t){function n(a,o,l,v){for(var h=a&65535|0,f=a>>>16&65535|0,d=0;l!==0;){d=l>2e3?2e3:l,l-=d;do h=h+o[v++]|0,f=f+h|0;while(--d);h%=65521,f%=65521}return h|f<<16|0}i.exports=n},{}],44:[function(r,i,t){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,i,t){function n(){for(var l,v=[],h=0;h<256;h++){l=h;for(var f=0;f<8;f++)l=l&1?3988292384^l>>>1:l>>>1;v[h]=l}return v}var a=n();function o(l,v,h,f){var d=a,g=f+h;l^=-1;for(var E=f;E<g;E++)l=l>>>8^d[(l^v[E])&255];return l^-1}i.exports=o},{}],46:[function(r,i,t){var n=r("../utils/common"),a=r("./trees"),o=r("./adler32"),l=r("./crc32"),v=r("./messages"),h=0,f=1,d=3,g=4,E=5,S=0,x=1,m=-2,c=-3,p=-5,y=-1,u=1,_=2,b=3,T=4,A=0,L=2,R=8,w=9,O=15,I=8,D=29,C=256,P=C+1+D,M=30,N=19,B=2*P+1,U=15,F=3,j=258,V=j+F+1,G=32,Y=42,X=69,ie=73,he=91,de=103,Ae=113,pe=666,le=1,Ie=2,Ce=3,Ue=4,Me=3;function ze(k,oe){return k.msg=v[oe],oe}function Ge(k){return(k<<1)-(k>4?9:0)}function $e(k){for(var oe=k.length;--oe>=0;)k[oe]=0}function Ke(k){var oe=k.state,fe=oe.pending;fe>k.avail_out&&(fe=k.avail_out),fe!==0&&(n.arraySet(k.output,oe.pending_buf,oe.pending_out,fe,k.next_out),k.next_out+=fe,oe.pending_out+=fe,k.total_out+=fe,k.avail_out-=fe,oe.pending-=fe,oe.pending===0&&(oe.pending_out=0))}function Ne(k,oe){a._tr_flush_block(k,k.block_start>=0?k.block_start:-1,k.strstart-k.block_start,oe),k.block_start=k.strstart,Ke(k.strm)}function Te(k,oe){k.pending_buf[k.pending++]=oe}function et(k,oe){k.pending_buf[k.pending++]=oe>>>8&255,k.pending_buf[k.pending++]=oe&255}function st(k,oe,fe,z){var J=k.avail_in;return J>z&&(J=z),J===0?0:(k.avail_in-=J,n.arraySet(oe,k.input,k.next_in,J,fe),k.state.wrap===1?k.adler=o(k.adler,oe,J,fe):k.state.wrap===2&&(k.adler=l(k.adler,oe,J,fe)),k.next_in+=J,k.total_in+=J,J)}function qe(k,oe){var fe=k.max_chain_length,z=k.strstart,J,ae,We=k.prev_length,ke=k.nice_match,Fe=k.strstart>k.w_size-V?k.strstart-(k.w_size-V):0,rt=k.window,nr=k.w_mask,vt=k.prev,at=k.strstart+j,At=rt[z+We-1],Pt=rt[z+We];k.prev_length>=k.good_match&&(fe>>=2),ke>k.lookahead&&(ke=k.lookahead);do if(J=oe,!(rt[J+We]!==Pt||rt[J+We-1]!==At||rt[J]!==rt[z]||rt[++J]!==rt[z+1])){z+=2,J++;do;while(rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&rt[++z]===rt[++J]&&z<at);if(ae=j-(at-z),z=at-j,ae>We){if(k.match_start=oe,We=ae,ae>=ke)break;At=rt[z+We-1],Pt=rt[z+We]}}while((oe=vt[oe&nr])>Fe&&--fe!=0);return We<=k.lookahead?We:k.lookahead}function ot(k){var oe=k.w_size,fe,z,J,ae,We;do{if(ae=k.window_size-k.lookahead-k.strstart,k.strstart>=oe+(oe-V)){n.arraySet(k.window,k.window,oe,oe,0),k.match_start-=oe,k.strstart-=oe,k.block_start-=oe,z=k.hash_size,fe=z;do J=k.head[--fe],k.head[fe]=J>=oe?J-oe:0;while(--z);z=oe,fe=z;do J=k.prev[--fe],k.prev[fe]=J>=oe?J-oe:0;while(--z);ae+=oe}if(k.strm.avail_in===0)break;if(z=st(k.strm,k.window,k.strstart+k.lookahead,ae),k.lookahead+=z,k.lookahead+k.insert>=F)for(We=k.strstart-k.insert,k.ins_h=k.window[We],k.ins_h=(k.ins_h<<k.hash_shift^k.window[We+1])&k.hash_mask;k.insert&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[We+F-1])&k.hash_mask,k.prev[We&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=We,We++,k.insert--,!(k.lookahead+k.insert<F)););}while(k.lookahead<V&&k.strm.avail_in!==0)}function nt(k,oe){var fe=65535;for(fe>k.pending_buf_size-5&&(fe=k.pending_buf_size-5);;){if(k.lookahead<=1){if(ot(k),k.lookahead===0&&oe===h)return le;if(k.lookahead===0)break}k.strstart+=k.lookahead,k.lookahead=0;var z=k.block_start+fe;if((k.strstart===0||k.strstart>=z)&&(k.lookahead=k.strstart-z,k.strstart=z,Ne(k,!1),k.strm.avail_out===0)||k.strstart-k.block_start>=k.w_size-V&&(Ne(k,!1),k.strm.avail_out===0))return le}return k.insert=0,oe===g?(Ne(k,!0),k.strm.avail_out===0?Ce:Ue):(k.strstart>k.block_start&&(Ne(k,!1),k.strm.avail_out===0),le)}function dt(k,oe){for(var fe,z;;){if(k.lookahead<V){if(ot(k),k.lookahead<V&&oe===h)return le;if(k.lookahead===0)break}if(fe=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,fe=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),fe!==0&&k.strstart-fe<=k.w_size-V&&(k.match_length=qe(k,fe)),k.match_length>=F)if(z=a._tr_tally(k,k.strstart-k.match_start,k.match_length-F),k.lookahead-=k.match_length,k.match_length<=k.max_lazy_match&&k.lookahead>=F){k.match_length--;do k.strstart++,k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,fe=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart;while(--k.match_length!=0);k.strstart++}else k.strstart+=k.match_length,k.match_length=0,k.ins_h=k.window[k.strstart],k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+1])&k.hash_mask;else z=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++;if(z&&(Ne(k,!1),k.strm.avail_out===0))return le}return k.insert=k.strstart<F-1?k.strstart:F-1,oe===g?(Ne(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Ne(k,!1),k.strm.avail_out===0)?le:Ie}function ne(k,oe){for(var fe,z,J;;){if(k.lookahead<V){if(ot(k),k.lookahead<V&&oe===h)return le;if(k.lookahead===0)break}if(fe=0,k.lookahead>=F&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,fe=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart),k.prev_length=k.match_length,k.prev_match=k.match_start,k.match_length=F-1,fe!==0&&k.prev_length<k.max_lazy_match&&k.strstart-fe<=k.w_size-V&&(k.match_length=qe(k,fe),k.match_length<=5&&(k.strategy===u||k.match_length===F&&k.strstart-k.match_start>4096)&&(k.match_length=F-1)),k.prev_length>=F&&k.match_length<=k.prev_length){J=k.strstart+k.lookahead-F,z=a._tr_tally(k,k.strstart-1-k.prev_match,k.prev_length-F),k.lookahead-=k.prev_length-1,k.prev_length-=2;do++k.strstart<=J&&(k.ins_h=(k.ins_h<<k.hash_shift^k.window[k.strstart+F-1])&k.hash_mask,fe=k.prev[k.strstart&k.w_mask]=k.head[k.ins_h],k.head[k.ins_h]=k.strstart);while(--k.prev_length!=0);if(k.match_available=0,k.match_length=F-1,k.strstart++,z&&(Ne(k,!1),k.strm.avail_out===0))return le}else if(k.match_available){if(z=a._tr_tally(k,0,k.window[k.strstart-1]),z&&Ne(k,!1),k.strstart++,k.lookahead--,k.strm.avail_out===0)return le}else k.match_available=1,k.strstart++,k.lookahead--}return k.match_available&&(z=a._tr_tally(k,0,k.window[k.strstart-1]),k.match_available=0),k.insert=k.strstart<F-1?k.strstart:F-1,oe===g?(Ne(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Ne(k,!1),k.strm.avail_out===0)?le:Ie}function Ee(k,oe){for(var fe,z,J,ae,We=k.window;;){if(k.lookahead<=j){if(ot(k),k.lookahead<=j&&oe===h)return le;if(k.lookahead===0)break}if(k.match_length=0,k.lookahead>=F&&k.strstart>0&&(J=k.strstart-1,z=We[J],z===We[++J]&&z===We[++J]&&z===We[++J])){ae=k.strstart+j;do;while(z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&z===We[++J]&&J<ae);k.match_length=j-(ae-J),k.match_length>k.lookahead&&(k.match_length=k.lookahead)}if(k.match_length>=F?(fe=a._tr_tally(k,1,k.match_length-F),k.lookahead-=k.match_length,k.strstart+=k.match_length,k.match_length=0):(fe=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++),fe&&(Ne(k,!1),k.strm.avail_out===0))return le}return k.insert=0,oe===g?(Ne(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Ne(k,!1),k.strm.avail_out===0)?le:Ie}function xe(k,oe){for(var fe;;){if(k.lookahead===0&&(ot(k),k.lookahead===0)){if(oe===h)return le;break}if(k.match_length=0,fe=a._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++,fe&&(Ne(k,!1),k.strm.avail_out===0))return le}return k.insert=0,oe===g?(Ne(k,!0),k.strm.avail_out===0?Ce:Ue):k.last_lit&&(Ne(k,!1),k.strm.avail_out===0)?le:Ie}function we(k,oe,fe,z,J){this.good_length=k,this.max_lazy=oe,this.nice_length=fe,this.max_chain=z,this.func=J}var be;be=[new we(0,0,0,0,nt),new we(4,4,8,4,dt),new we(4,5,16,8,dt),new we(4,6,32,32,dt),new we(4,4,16,16,ne),new we(8,16,32,32,ne),new we(8,16,128,128,ne),new we(8,32,128,256,ne),new we(32,128,258,1024,ne),new we(32,258,258,4096,ne)];function je(k){k.window_size=2*k.w_size,$e(k.head),k.max_lazy_match=be[k.level].max_lazy,k.good_match=be[k.level].good_length,k.nice_match=be[k.level].nice_length,k.max_chain_length=be[k.level].max_chain,k.strstart=0,k.block_start=0,k.lookahead=0,k.insert=0,k.match_length=k.prev_length=F-1,k.match_available=0,k.ins_h=0}function K(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(B*2),this.dyn_dtree=new n.Buf16((2*M+1)*2),this.bl_tree=new n.Buf16((2*N+1)*2),$e(this.dyn_ltree),$e(this.dyn_dtree),$e(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(U+1),this.heap=new n.Buf16(2*P+1),$e(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*P+1),$e(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ce(k){var oe;return!k||!k.state?ze(k,m):(k.total_in=k.total_out=0,k.data_type=L,oe=k.state,oe.pending=0,oe.pending_out=0,oe.wrap<0&&(oe.wrap=-oe.wrap),oe.status=oe.wrap?Y:Ae,k.adler=oe.wrap===2?0:1,oe.last_flush=h,a._tr_init(oe),S)}function _e(k){var oe=ce(k);return oe===S&&je(k.state),oe}function Re(k,oe){return!k||!k.state||k.state.wrap!==2?m:(k.state.gzhead=oe,S)}function Z(k,oe,fe,z,J,ae){if(!k)return m;var We=1;if(oe===y&&(oe=6),z<0?(We=0,z=-z):z>15&&(We=2,z-=16),J<1||J>w||fe!==R||z<8||z>15||oe<0||oe>9||ae<0||ae>T)return ze(k,m);z===8&&(z=9);var ke=new K;return k.state=ke,ke.strm=k,ke.wrap=We,ke.gzhead=null,ke.w_bits=z,ke.w_size=1<<ke.w_bits,ke.w_mask=ke.w_size-1,ke.hash_bits=J+7,ke.hash_size=1<<ke.hash_bits,ke.hash_mask=ke.hash_size-1,ke.hash_shift=~~((ke.hash_bits+F-1)/F),ke.window=new n.Buf8(ke.w_size*2),ke.head=new n.Buf16(ke.hash_size),ke.prev=new n.Buf16(ke.w_size),ke.lit_bufsize=1<<J+6,ke.pending_buf_size=ke.lit_bufsize*4,ke.pending_buf=new n.Buf8(ke.pending_buf_size),ke.d_buf=1*ke.lit_bufsize,ke.l_buf=(1+2)*ke.lit_bufsize,ke.level=oe,ke.strategy=ae,ke.method=fe,_e(k)}function ue(k,oe){return Z(k,oe,R,O,I,A)}function W(k,oe){var fe,z,J,ae;if(!k||!k.state||oe>E||oe<0)return k?ze(k,m):m;if(z=k.state,!k.output||!k.input&&k.avail_in!==0||z.status===pe&&oe!==g)return ze(k,k.avail_out===0?p:m);if(z.strm=k,fe=z.last_flush,z.last_flush=oe,z.status===Y)if(z.wrap===2)k.adler=0,Te(z,31),Te(z,139),Te(z,8),z.gzhead?(Te(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),Te(z,z.gzhead.time&255),Te(z,z.gzhead.time>>8&255),Te(z,z.gzhead.time>>16&255),Te(z,z.gzhead.time>>24&255),Te(z,z.level===9?2:z.strategy>=_||z.level<2?4:0),Te(z,z.gzhead.os&255),z.gzhead.extra&&z.gzhead.extra.length&&(Te(z,z.gzhead.extra.length&255),Te(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(k.adler=l(k.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=X):(Te(z,0),Te(z,0),Te(z,0),Te(z,0),Te(z,0),Te(z,z.level===9?2:z.strategy>=_||z.level<2?4:0),Te(z,Me),z.status=Ae);else{var We=R+(z.w_bits-8<<4)<<8,ke=-1;z.strategy>=_||z.level<2?ke=0:z.level<6?ke=1:z.level===6?ke=2:ke=3,We|=ke<<6,z.strstart!==0&&(We|=G),We+=31-We%31,z.status=Ae,et(z,We),z.strstart!==0&&(et(z,k.adler>>>16),et(z,k.adler&65535)),k.adler=1}if(z.status===X)if(z.gzhead.extra){for(J=z.pending;z.gzindex<(z.gzhead.extra.length&65535)&&!(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),Ke(k),J=z.pending,z.pending===z.pending_buf_size));)Te(z,z.gzhead.extra[z.gzindex]&255),z.gzindex++;z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=ie)}else z.status=ie;if(z.status===ie)if(z.gzhead.name){J=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),Ke(k),J=z.pending,z.pending===z.pending_buf_size)){ae=1;break}z.gzindex<z.gzhead.name.length?ae=z.gzhead.name.charCodeAt(z.gzindex++)&255:ae=0,Te(z,ae)}while(ae!==0);z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),ae===0&&(z.gzindex=0,z.status=he)}else z.status=he;if(z.status===he)if(z.gzhead.comment){J=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),Ke(k),J=z.pending,z.pending===z.pending_buf_size)){ae=1;break}z.gzindex<z.gzhead.comment.length?ae=z.gzhead.comment.charCodeAt(z.gzindex++)&255:ae=0,Te(z,ae)}while(ae!==0);z.gzhead.hcrc&&z.pending>J&&(k.adler=l(k.adler,z.pending_buf,z.pending-J,J)),ae===0&&(z.status=de)}else z.status=de;if(z.status===de&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&Ke(k),z.pending+2<=z.pending_buf_size&&(Te(z,k.adler&255),Te(z,k.adler>>8&255),k.adler=0,z.status=Ae)):z.status=Ae),z.pending!==0){if(Ke(k),k.avail_out===0)return z.last_flush=-1,S}else if(k.avail_in===0&&Ge(oe)<=Ge(fe)&&oe!==g)return ze(k,p);if(z.status===pe&&k.avail_in!==0)return ze(k,p);if(k.avail_in!==0||z.lookahead!==0||oe!==h&&z.status!==pe){var Fe=z.strategy===_?xe(z,oe):z.strategy===b?Ee(z,oe):be[z.level].func(z,oe);if((Fe===Ce||Fe===Ue)&&(z.status=pe),Fe===le||Fe===Ce)return k.avail_out===0&&(z.last_flush=-1),S;if(Fe===Ie&&(oe===f?a._tr_align(z):oe!==E&&(a._tr_stored_block(z,0,0,!1),oe===d&&($e(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),Ke(k),k.avail_out===0))return z.last_flush=-1,S}return oe!==g?S:z.wrap<=0?x:(z.wrap===2?(Te(z,k.adler&255),Te(z,k.adler>>8&255),Te(z,k.adler>>16&255),Te(z,k.adler>>24&255),Te(z,k.total_in&255),Te(z,k.total_in>>8&255),Te(z,k.total_in>>16&255),Te(z,k.total_in>>24&255)):(et(z,k.adler>>>16),et(z,k.adler&65535)),Ke(k),z.wrap>0&&(z.wrap=-z.wrap),z.pending!==0?S:x)}function me(k){var oe;return!k||!k.state?m:(oe=k.state.status,oe!==Y&&oe!==X&&oe!==ie&&oe!==he&&oe!==de&&oe!==Ae&&oe!==pe?ze(k,m):(k.state=null,oe===Ae?ze(k,c):S))}function He(k,oe){var fe=oe.length,z,J,ae,We,ke,Fe,rt,nr;if(!k||!k.state||(z=k.state,We=z.wrap,We===2||We===1&&z.status!==Y||z.lookahead))return m;for(We===1&&(k.adler=o(k.adler,oe,fe,0)),z.wrap=0,fe>=z.w_size&&(We===0&&($e(z.head),z.strstart=0,z.block_start=0,z.insert=0),nr=new n.Buf8(z.w_size),n.arraySet(nr,oe,fe-z.w_size,z.w_size,0),oe=nr,fe=z.w_size),ke=k.avail_in,Fe=k.next_in,rt=k.input,k.avail_in=fe,k.next_in=0,k.input=oe,ot(z);z.lookahead>=F;){J=z.strstart,ae=z.lookahead-(F-1);do z.ins_h=(z.ins_h<<z.hash_shift^z.window[J+F-1])&z.hash_mask,z.prev[J&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=J,J++;while(--ae);z.strstart=J,z.lookahead=F-1,ot(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=F-1,z.match_available=0,k.next_in=Fe,k.input=rt,k.avail_in=ke,z.wrap=We,S}t.deflateInit=ue,t.deflateInit2=Z,t.deflateReset=_e,t.deflateResetKeep=ce,t.deflateSetHeader=Re,t.deflate=W,t.deflateEnd=me,t.deflateSetDictionary=He,t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,i,t){function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}i.exports=n},{}],48:[function(r,i,t){var n=30,a=12;i.exports=function(l,v){var h,f,d,g,E,S,x,m,c,p,y,u,_,b,T,A,L,R,w,O,I,D,C,P,M;h=l.state,f=l.next_in,P=l.input,d=f+(l.avail_in-5),g=l.next_out,M=l.output,E=g-(v-l.avail_out),S=g+(l.avail_out-257),x=h.dmax,m=h.wsize,c=h.whave,p=h.wnext,y=h.window,u=h.hold,_=h.bits,b=h.lencode,T=h.distcode,A=(1<<h.lenbits)-1,L=(1<<h.distbits)-1;e:do{_<15&&(u+=P[f++]<<_,_+=8,u+=P[f++]<<_,_+=8),R=b[u&A];t:for(;;){if(w=R>>>24,u>>>=w,_-=w,w=R>>>16&255,w===0)M[g++]=R&65535;else if(w&16){O=R&65535,w&=15,w&&(_<w&&(u+=P[f++]<<_,_+=8),O+=u&(1<<w)-1,u>>>=w,_-=w),_<15&&(u+=P[f++]<<_,_+=8,u+=P[f++]<<_,_+=8),R=T[u&L];r:for(;;){if(w=R>>>24,u>>>=w,_-=w,w=R>>>16&255,w&16){if(I=R&65535,w&=15,_<w&&(u+=P[f++]<<_,_+=8,_<w&&(u+=P[f++]<<_,_+=8)),I+=u&(1<<w)-1,I>x){l.msg="invalid distance too far back",h.mode=n;break e}if(u>>>=w,_-=w,w=g-E,I>w){if(w=I-w,w>c&&h.sane){l.msg="invalid distance too far back",h.mode=n;break e}if(D=0,C=y,p===0){if(D+=m-w,w<O){O-=w;do M[g++]=y[D++];while(--w);D=g-I,C=M}}else if(p<w){if(D+=m+p-w,w-=p,w<O){O-=w;do M[g++]=y[D++];while(--w);if(D=0,p<O){w=p,O-=w;do M[g++]=y[D++];while(--w);D=g-I,C=M}}}else if(D+=p-w,w<O){O-=w;do M[g++]=y[D++];while(--w);D=g-I,C=M}for(;O>2;)M[g++]=C[D++],M[g++]=C[D++],M[g++]=C[D++],O-=3;O&&(M[g++]=C[D++],O>1&&(M[g++]=C[D++]))}else{D=g-I;do M[g++]=M[D++],M[g++]=M[D++],M[g++]=M[D++],O-=3;while(O>2);O&&(M[g++]=M[D++],O>1&&(M[g++]=M[D++]))}}else if((w&64)==0){R=T[(R&65535)+(u&(1<<w)-1)];continue r}else{l.msg="invalid distance code",h.mode=n;break e}break}}else if((w&64)==0){R=b[(R&65535)+(u&(1<<w)-1)];continue t}else if(w&32){h.mode=a;break e}else{l.msg="invalid literal/length code",h.mode=n;break e}break}}while(f<d&&g<S);O=_>>3,f-=O,_-=O<<3,u&=(1<<_)-1,l.next_in=f,l.next_out=g,l.avail_in=f<d?5+(d-f):5-(f-d),l.avail_out=g<S?257+(S-g):257-(g-S),h.hold=u,h.bits=_}},{}],49:[function(r,i,t){var n=r("../utils/common"),a=r("./adler32"),o=r("./crc32"),l=r("./inffast"),v=r("./inftrees"),h=0,f=1,d=2,g=4,E=5,S=6,x=0,m=1,c=2,p=-2,y=-3,u=-4,_=-5,b=8,T=1,A=2,L=3,R=4,w=5,O=6,I=7,D=8,C=9,P=10,M=11,N=12,B=13,U=14,F=15,j=16,V=17,G=18,Y=19,X=20,ie=21,he=22,de=23,Ae=24,pe=25,le=26,Ie=27,Ce=28,Ue=29,Me=30,ze=31,Ge=32,$e=852,Ke=592,Ne=15,Te=Ne;function et(Z){return(Z>>>24&255)+(Z>>>8&65280)+((Z&65280)<<8)+((Z&255)<<24)}function st(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function qe(Z){var ue;return!Z||!Z.state?p:(ue=Z.state,Z.total_in=Z.total_out=ue.total=0,Z.msg="",ue.wrap&&(Z.adler=ue.wrap&1),ue.mode=T,ue.last=0,ue.havedict=0,ue.dmax=32768,ue.head=null,ue.hold=0,ue.bits=0,ue.lencode=ue.lendyn=new n.Buf32($e),ue.distcode=ue.distdyn=new n.Buf32(Ke),ue.sane=1,ue.back=-1,x)}function ot(Z){var ue;return!Z||!Z.state?p:(ue=Z.state,ue.wsize=0,ue.whave=0,ue.wnext=0,qe(Z))}function nt(Z,ue){var W,me;return!Z||!Z.state||(me=Z.state,ue<0?(W=0,ue=-ue):(W=(ue>>4)+1,ue<48&&(ue&=15)),ue&&(ue<8||ue>15))?p:(me.window!==null&&me.wbits!==ue&&(me.window=null),me.wrap=W,me.wbits=ue,ot(Z))}function dt(Z,ue){var W,me;return Z?(me=new st,Z.state=me,me.window=null,W=nt(Z,ue),W!==x&&(Z.state=null),W):p}function ne(Z){return dt(Z,Te)}var Ee=!0,xe,we;function be(Z){if(Ee){var ue;for(xe=new n.Buf32(512),we=new n.Buf32(32),ue=0;ue<144;)Z.lens[ue++]=8;for(;ue<256;)Z.lens[ue++]=9;for(;ue<280;)Z.lens[ue++]=7;for(;ue<288;)Z.lens[ue++]=8;for(v(f,Z.lens,0,288,xe,0,Z.work,{bits:9}),ue=0;ue<32;)Z.lens[ue++]=5;v(d,Z.lens,0,32,we,0,Z.work,{bits:5}),Ee=!1}Z.lencode=xe,Z.lenbits=9,Z.distcode=we,Z.distbits=5}function je(Z,ue,W,me){var He,k=Z.state;return k.window===null&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new n.Buf8(k.wsize)),me>=k.wsize?(n.arraySet(k.window,ue,W-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(He=k.wsize-k.wnext,He>me&&(He=me),n.arraySet(k.window,ue,W-me,He,k.wnext),me-=He,me?(n.arraySet(k.window,ue,W-me,me,0),k.wnext=me,k.whave=k.wsize):(k.wnext+=He,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=He))),0}function K(Z,ue){var W,me,He,k,oe,fe,z,J,ae,We,ke,Fe,rt,nr,vt=0,at,At,Pt,jt,$i,Gi,xt,qt,Dt=new n.Buf8(4),Dr,gr,Ra=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Z||!Z.state||!Z.output||!Z.input&&Z.avail_in!==0)return p;W=Z.state,W.mode===N&&(W.mode=B),oe=Z.next_out,He=Z.output,z=Z.avail_out,k=Z.next_in,me=Z.input,fe=Z.avail_in,J=W.hold,ae=W.bits,We=fe,ke=z,qt=x;e:for(;;)switch(W.mode){case T:if(W.wrap===0){W.mode=B;break}for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(W.wrap&2&&J===35615){W.check=0,Dt[0]=J&255,Dt[1]=J>>>8&255,W.check=o(W.check,Dt,2,0),J=0,ae=0,W.mode=A;break}if(W.flags=0,W.head&&(W.head.done=!1),!(W.wrap&1)||(((J&255)<<8)+(J>>8))%31){Z.msg="incorrect header check",W.mode=Me;break}if((J&15)!==b){Z.msg="unknown compression method",W.mode=Me;break}if(J>>>=4,ae-=4,xt=(J&15)+8,W.wbits===0)W.wbits=xt;else if(xt>W.wbits){Z.msg="invalid window size",W.mode=Me;break}W.dmax=1<<xt,Z.adler=W.check=1,W.mode=J&512?P:N,J=0,ae=0;break;case A:for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(W.flags=J,(W.flags&255)!==b){Z.msg="unknown compression method",W.mode=Me;break}if(W.flags&57344){Z.msg="unknown header flags set",W.mode=Me;break}W.head&&(W.head.text=J>>8&1),W.flags&512&&(Dt[0]=J&255,Dt[1]=J>>>8&255,W.check=o(W.check,Dt,2,0)),J=0,ae=0,W.mode=L;case L:for(;ae<32;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.head&&(W.head.time=J),W.flags&512&&(Dt[0]=J&255,Dt[1]=J>>>8&255,Dt[2]=J>>>16&255,Dt[3]=J>>>24&255,W.check=o(W.check,Dt,4,0)),J=0,ae=0,W.mode=R;case R:for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.head&&(W.head.xflags=J&255,W.head.os=J>>8),W.flags&512&&(Dt[0]=J&255,Dt[1]=J>>>8&255,W.check=o(W.check,Dt,2,0)),J=0,ae=0,W.mode=w;case w:if(W.flags&1024){for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.length=J,W.head&&(W.head.extra_len=J),W.flags&512&&(Dt[0]=J&255,Dt[1]=J>>>8&255,W.check=o(W.check,Dt,2,0)),J=0,ae=0}else W.head&&(W.head.extra=null);W.mode=O;case O:if(W.flags&1024&&(Fe=W.length,Fe>fe&&(Fe=fe),Fe&&(W.head&&(xt=W.head.extra_len-W.length,W.head.extra||(W.head.extra=new Array(W.head.extra_len)),n.arraySet(W.head.extra,me,k,Fe,xt)),W.flags&512&&(W.check=o(W.check,me,Fe,k)),fe-=Fe,k+=Fe,W.length-=Fe),W.length))break e;W.length=0,W.mode=I;case I:if(W.flags&2048){if(fe===0)break e;Fe=0;do xt=me[k+Fe++],W.head&&xt&&W.length<65536&&(W.head.name+=String.fromCharCode(xt));while(xt&&Fe<fe);if(W.flags&512&&(W.check=o(W.check,me,Fe,k)),fe-=Fe,k+=Fe,xt)break e}else W.head&&(W.head.name=null);W.length=0,W.mode=D;case D:if(W.flags&4096){if(fe===0)break e;Fe=0;do xt=me[k+Fe++],W.head&&xt&&W.length<65536&&(W.head.comment+=String.fromCharCode(xt));while(xt&&Fe<fe);if(W.flags&512&&(W.check=o(W.check,me,Fe,k)),fe-=Fe,k+=Fe,xt)break e}else W.head&&(W.head.comment=null);W.mode=C;case C:if(W.flags&512){for(;ae<16;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(J!==(W.check&65535)){Z.msg="header crc mismatch",W.mode=Me;break}J=0,ae=0}W.head&&(W.head.hcrc=W.flags>>9&1,W.head.done=!0),Z.adler=W.check=0,W.mode=N;break;case P:for(;ae<32;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}Z.adler=W.check=et(J),J=0,ae=0,W.mode=M;case M:if(W.havedict===0)return Z.next_out=oe,Z.avail_out=z,Z.next_in=k,Z.avail_in=fe,W.hold=J,W.bits=ae,c;Z.adler=W.check=1,W.mode=N;case N:if(ue===E||ue===S)break e;case B:if(W.last){J>>>=ae&7,ae-=ae&7,W.mode=Ie;break}for(;ae<3;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}switch(W.last=J&1,J>>>=1,ae-=1,J&3){case 0:W.mode=U;break;case 1:if(be(W),W.mode=X,ue===S){J>>>=2,ae-=2;break e}break;case 2:W.mode=V;break;case 3:Z.msg="invalid block type",W.mode=Me}J>>>=2,ae-=2;break;case U:for(J>>>=ae&7,ae-=ae&7;ae<32;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if((J&65535)!=(J>>>16^65535)){Z.msg="invalid stored block lengths",W.mode=Me;break}if(W.length=J&65535,J=0,ae=0,W.mode=F,ue===S)break e;case F:W.mode=j;case j:if(Fe=W.length,Fe){if(Fe>fe&&(Fe=fe),Fe>z&&(Fe=z),Fe===0)break e;n.arraySet(He,me,k,Fe,oe),fe-=Fe,k+=Fe,z-=Fe,oe+=Fe,W.length-=Fe;break}W.mode=N;break;case V:for(;ae<14;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(W.nlen=(J&31)+257,J>>>=5,ae-=5,W.ndist=(J&31)+1,J>>>=5,ae-=5,W.ncode=(J&15)+4,J>>>=4,ae-=4,W.nlen>286||W.ndist>30){Z.msg="too many length or distance symbols",W.mode=Me;break}W.have=0,W.mode=G;case G:for(;W.have<W.ncode;){for(;ae<3;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.lens[Ra[W.have++]]=J&7,J>>>=3,ae-=3}for(;W.have<19;)W.lens[Ra[W.have++]]=0;if(W.lencode=W.lendyn,W.lenbits=7,Dr={bits:W.lenbits},qt=v(h,W.lens,0,19,W.lencode,0,W.work,Dr),W.lenbits=Dr.bits,qt){Z.msg="invalid code lengths set",W.mode=Me;break}W.have=0,W.mode=Y;case Y:for(;W.have<W.nlen+W.ndist;){for(;vt=W.lencode[J&(1<<W.lenbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(Pt<16)J>>>=at,ae-=at,W.lens[W.have++]=Pt;else{if(Pt===16){for(gr=at+2;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(J>>>=at,ae-=at,W.have===0){Z.msg="invalid bit length repeat",W.mode=Me;break}xt=W.lens[W.have-1],Fe=3+(J&3),J>>>=2,ae-=2}else if(Pt===17){for(gr=at+3;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}J>>>=at,ae-=at,xt=0,Fe=3+(J&7),J>>>=3,ae-=3}else{for(gr=at+7;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}J>>>=at,ae-=at,xt=0,Fe=11+(J&127),J>>>=7,ae-=7}if(W.have+Fe>W.nlen+W.ndist){Z.msg="invalid bit length repeat",W.mode=Me;break}for(;Fe--;)W.lens[W.have++]=xt}}if(W.mode===Me)break;if(W.lens[256]===0){Z.msg="invalid code -- missing end-of-block",W.mode=Me;break}if(W.lenbits=9,Dr={bits:W.lenbits},qt=v(f,W.lens,0,W.nlen,W.lencode,0,W.work,Dr),W.lenbits=Dr.bits,qt){Z.msg="invalid literal/lengths set",W.mode=Me;break}if(W.distbits=6,W.distcode=W.distdyn,Dr={bits:W.distbits},qt=v(d,W.lens,W.nlen,W.ndist,W.distcode,0,W.work,Dr),W.distbits=Dr.bits,qt){Z.msg="invalid distances set",W.mode=Me;break}if(W.mode=X,ue===S)break e;case X:W.mode=ie;case ie:if(fe>=6&&z>=258){Z.next_out=oe,Z.avail_out=z,Z.next_in=k,Z.avail_in=fe,W.hold=J,W.bits=ae,l(Z,ke),oe=Z.next_out,He=Z.output,z=Z.avail_out,k=Z.next_in,me=Z.input,fe=Z.avail_in,J=W.hold,ae=W.bits,W.mode===N&&(W.back=-1);break}for(W.back=0;vt=W.lencode[J&(1<<W.lenbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(At&&(At&240)==0){for(jt=at,$i=At,Gi=Pt;vt=W.lencode[Gi+((J&(1<<jt+$i)-1)>>jt)],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(jt+at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}J>>>=jt,ae-=jt,W.back+=jt}if(J>>>=at,ae-=at,W.back+=at,W.length=Pt,At===0){W.mode=le;break}if(At&32){W.back=-1,W.mode=N;break}if(At&64){Z.msg="invalid literal/length code",W.mode=Me;break}W.extra=At&15,W.mode=he;case he:if(W.extra){for(gr=W.extra;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.length+=J&(1<<W.extra)-1,J>>>=W.extra,ae-=W.extra,W.back+=W.extra}W.was=W.length,W.mode=de;case de:for(;vt=W.distcode[J&(1<<W.distbits)-1],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if((At&240)==0){for(jt=at,$i=At,Gi=Pt;vt=W.distcode[Gi+((J&(1<<jt+$i)-1)>>jt)],at=vt>>>24,At=vt>>>16&255,Pt=vt&65535,!(jt+at<=ae);){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}J>>>=jt,ae-=jt,W.back+=jt}if(J>>>=at,ae-=at,W.back+=at,At&64){Z.msg="invalid distance code",W.mode=Me;break}W.offset=Pt,W.extra=At&15,W.mode=Ae;case Ae:if(W.extra){for(gr=W.extra;ae<gr;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}W.offset+=J&(1<<W.extra)-1,J>>>=W.extra,ae-=W.extra,W.back+=W.extra}if(W.offset>W.dmax){Z.msg="invalid distance too far back",W.mode=Me;break}W.mode=pe;case pe:if(z===0)break e;if(Fe=ke-z,W.offset>Fe){if(Fe=W.offset-Fe,Fe>W.whave&&W.sane){Z.msg="invalid distance too far back",W.mode=Me;break}Fe>W.wnext?(Fe-=W.wnext,rt=W.wsize-Fe):rt=W.wnext-Fe,Fe>W.length&&(Fe=W.length),nr=W.window}else nr=He,rt=oe-W.offset,Fe=W.length;Fe>z&&(Fe=z),z-=Fe,W.length-=Fe;do He[oe++]=nr[rt++];while(--Fe);W.length===0&&(W.mode=ie);break;case le:if(z===0)break e;He[oe++]=W.length,z--,W.mode=ie;break;case Ie:if(W.wrap){for(;ae<32;){if(fe===0)break e;fe--,J|=me[k++]<<ae,ae+=8}if(ke-=z,Z.total_out+=ke,W.total+=ke,ke&&(Z.adler=W.check=W.flags?o(W.check,He,ke,oe-ke):a(W.check,He,ke,oe-ke)),ke=z,(W.flags?J:et(J))!==W.check){Z.msg="incorrect data check",W.mode=Me;break}J=0,ae=0}W.mode=Ce;case Ce:if(W.wrap&&W.flags){for(;ae<32;){if(fe===0)break e;fe--,J+=me[k++]<<ae,ae+=8}if(J!==(W.total&4294967295)){Z.msg="incorrect length check",W.mode=Me;break}J=0,ae=0}W.mode=Ue;case Ue:qt=m;break e;case Me:qt=y;break e;case ze:return u;case Ge:default:return p}return Z.next_out=oe,Z.avail_out=z,Z.next_in=k,Z.avail_in=fe,W.hold=J,W.bits=ae,(W.wsize||ke!==Z.avail_out&&W.mode<Me&&(W.mode<Ie||ue!==g))&&je(Z,Z.output,Z.next_out,ke-Z.avail_out),We-=Z.avail_in,ke-=Z.avail_out,Z.total_in+=We,Z.total_out+=ke,W.total+=ke,W.wrap&&ke&&(Z.adler=W.check=W.flags?o(W.check,He,ke,Z.next_out-ke):a(W.check,He,ke,Z.next_out-ke)),Z.data_type=W.bits+(W.last?64:0)+(W.mode===N?128:0)+(W.mode===X||W.mode===F?256:0),(We===0&&ke===0||ue===g)&&qt===x&&(qt=_),qt}function ce(Z){if(!Z||!Z.state)return p;var ue=Z.state;return ue.window&&(ue.window=null),Z.state=null,x}function _e(Z,ue){var W;return!Z||!Z.state||(W=Z.state,(W.wrap&2)==0)?p:(W.head=ue,ue.done=!1,x)}function Re(Z,ue){var W=ue.length,me,He,k;return!Z||!Z.state||(me=Z.state,me.wrap!==0&&me.mode!==M)?p:me.mode===M&&(He=1,He=a(He,ue,W,0),He!==me.check)?y:(k=je(Z,ue,W,W),k?(me.mode=ze,u):(me.havedict=1,x))}t.inflateReset=ot,t.inflateReset2=nt,t.inflateResetKeep=qe,t.inflateInit=ne,t.inflateInit2=dt,t.inflate=K,t.inflateEnd=ce,t.inflateGetHeader=_e,t.inflateSetDictionary=Re,t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,i,t){var n=r("../utils/common"),a=15,o=852,l=592,v=0,h=1,f=2,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],S=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(m,c,p,y,u,_,b,T){var A=T.bits,L=0,R=0,w=0,O=0,I=0,D=0,C=0,P=0,M=0,N=0,B,U,F,j,V,G=null,Y=0,X,ie=new n.Buf16(a+1),he=new n.Buf16(a+1),de=null,Ae=0,pe,le,Ie;for(L=0;L<=a;L++)ie[L]=0;for(R=0;R<y;R++)ie[c[p+R]]++;for(I=A,O=a;O>=1&&ie[O]===0;O--);if(I>O&&(I=O),O===0)return u[_++]=1<<24|64<<16|0,u[_++]=1<<24|64<<16|0,T.bits=1,0;for(w=1;w<O&&ie[w]===0;w++);for(I<w&&(I=w),P=1,L=1;L<=a;L++)if(P<<=1,P-=ie[L],P<0)return-1;if(P>0&&(m===v||O!==1))return-1;for(he[1]=0,L=1;L<a;L++)he[L+1]=he[L]+ie[L];for(R=0;R<y;R++)c[p+R]!==0&&(b[he[c[p+R]]++]=R);if(m===v?(G=de=b,X=19):m===h?(G=d,Y-=257,de=g,Ae-=257,X=256):(G=E,de=S,X=-1),N=0,R=0,L=w,V=_,D=I,C=0,F=-1,M=1<<I,j=M-1,m===h&&M>o||m===f&&M>l)return 1;for(;;){pe=L-C,b[R]<X?(le=0,Ie=b[R]):b[R]>X?(le=de[Ae+b[R]],Ie=G[Y+b[R]]):(le=32+64,Ie=0),B=1<<L-C,U=1<<D,w=U;do U-=B,u[V+(N>>C)+U]=pe<<24|le<<16|Ie|0;while(U!==0);for(B=1<<L-1;N&B;)B>>=1;if(B!==0?(N&=B-1,N+=B):N=0,R++,--ie[L]==0){if(L===O)break;L=c[p+b[R]]}if(L>I&&(N&j)!==F){for(C===0&&(C=I),V+=w,D=L-C,P=1<<D;D+C<O&&(P-=ie[D+C],!(P<=0));)D++,P<<=1;if(M+=1<<D,m===h&&M>o||m===f&&M>l)return 1;F=N&j,u[F]=I<<24|D<<16|V-_|0}}return N!==0&&(u[V+N]=L-C<<24|64<<16|0),T.bits=I,0}},{"../utils/common":41}],51:[function(r,i,t){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,i,t){var n=r("../utils/common"),a=4,o=0,l=1,v=2;function h(K){for(var ce=K.length;--ce>=0;)K[ce]=0}var f=0,d=1,g=2,E=3,S=258,x=29,m=256,c=m+1+x,p=30,y=19,u=2*c+1,_=15,b=16,T=7,A=256,L=16,R=17,w=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,M=new Array((c+2)*2);h(M);var N=new Array(p*2);h(N);var B=new Array(P);h(B);var U=new Array(S-E+1);h(U);var F=new Array(x);h(F);var j=new Array(p);h(j);function V(K,ce,_e,Re,Z){this.static_tree=K,this.extra_bits=ce,this.extra_base=_e,this.elems=Re,this.max_length=Z,this.has_stree=K&&K.length}var G,Y,X;function ie(K,ce){this.dyn_tree=K,this.max_code=0,this.stat_desc=ce}function he(K){return K<256?B[K]:B[256+(K>>>7)]}function de(K,ce){K.pending_buf[K.pending++]=ce&255,K.pending_buf[K.pending++]=ce>>>8&255}function Ae(K,ce,_e){K.bi_valid>b-_e?(K.bi_buf|=ce<<K.bi_valid&65535,de(K,K.bi_buf),K.bi_buf=ce>>b-K.bi_valid,K.bi_valid+=_e-b):(K.bi_buf|=ce<<K.bi_valid&65535,K.bi_valid+=_e)}function pe(K,ce,_e){Ae(K,_e[ce*2],_e[ce*2+1])}function le(K,ce){var _e=0;do _e|=K&1,K>>>=1,_e<<=1;while(--ce>0);return _e>>>1}function Ie(K){K.bi_valid===16?(de(K,K.bi_buf),K.bi_buf=0,K.bi_valid=0):K.bi_valid>=8&&(K.pending_buf[K.pending++]=K.bi_buf&255,K.bi_buf>>=8,K.bi_valid-=8)}function Ce(K,ce){var _e=ce.dyn_tree,Re=ce.max_code,Z=ce.stat_desc.static_tree,ue=ce.stat_desc.has_stree,W=ce.stat_desc.extra_bits,me=ce.stat_desc.extra_base,He=ce.stat_desc.max_length,k,oe,fe,z,J,ae,We=0;for(z=0;z<=_;z++)K.bl_count[z]=0;for(_e[K.heap[K.heap_max]*2+1]=0,k=K.heap_max+1;k<u;k++)oe=K.heap[k],z=_e[_e[oe*2+1]*2+1]+1,z>He&&(z=He,We++),_e[oe*2+1]=z,!(oe>Re)&&(K.bl_count[z]++,J=0,oe>=me&&(J=W[oe-me]),ae=_e[oe*2],K.opt_len+=ae*(z+J),ue&&(K.static_len+=ae*(Z[oe*2+1]+J)));if(We!==0){do{for(z=He-1;K.bl_count[z]===0;)z--;K.bl_count[z]--,K.bl_count[z+1]+=2,K.bl_count[He]--,We-=2}while(We>0);for(z=He;z!==0;z--)for(oe=K.bl_count[z];oe!==0;)fe=K.heap[--k],!(fe>Re)&&(_e[fe*2+1]!==z&&(K.opt_len+=(z-_e[fe*2+1])*_e[fe*2],_e[fe*2+1]=z),oe--)}}function Ue(K,ce,_e){var Re=new Array(_+1),Z=0,ue,W;for(ue=1;ue<=_;ue++)Re[ue]=Z=Z+_e[ue-1]<<1;for(W=0;W<=ce;W++){var me=K[W*2+1];me!==0&&(K[W*2]=le(Re[me]++,me))}}function Me(){var K,ce,_e,Re,Z,ue=new Array(_+1);for(_e=0,Re=0;Re<x-1;Re++)for(F[Re]=_e,K=0;K<1<<O[Re];K++)U[_e++]=Re;for(U[_e-1]=Re,Z=0,Re=0;Re<16;Re++)for(j[Re]=Z,K=0;K<1<<I[Re];K++)B[Z++]=Re;for(Z>>=7;Re<p;Re++)for(j[Re]=Z<<7,K=0;K<1<<I[Re]-7;K++)B[256+Z++]=Re;for(ce=0;ce<=_;ce++)ue[ce]=0;for(K=0;K<=143;)M[K*2+1]=8,K++,ue[8]++;for(;K<=255;)M[K*2+1]=9,K++,ue[9]++;for(;K<=279;)M[K*2+1]=7,K++,ue[7]++;for(;K<=287;)M[K*2+1]=8,K++,ue[8]++;for(Ue(M,c+1,ue),K=0;K<p;K++)N[K*2+1]=5,N[K*2]=le(K,5);G=new V(M,O,m+1,c,_),Y=new V(N,I,0,p,_),X=new V(new Array(0),D,0,y,T)}function ze(K){var ce;for(ce=0;ce<c;ce++)K.dyn_ltree[ce*2]=0;for(ce=0;ce<p;ce++)K.dyn_dtree[ce*2]=0;for(ce=0;ce<y;ce++)K.bl_tree[ce*2]=0;K.dyn_ltree[A*2]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function Ge(K){K.bi_valid>8?de(K,K.bi_buf):K.bi_valid>0&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function $e(K,ce,_e,Re){Ge(K),Re&&(de(K,_e),de(K,~_e)),n.arraySet(K.pending_buf,K.window,ce,_e,K.pending),K.pending+=_e}function Ke(K,ce,_e,Re){var Z=ce*2,ue=_e*2;return K[Z]<K[ue]||K[Z]===K[ue]&&Re[ce]<=Re[_e]}function Ne(K,ce,_e){for(var Re=K.heap[_e],Z=_e<<1;Z<=K.heap_len&&(Z<K.heap_len&&Ke(ce,K.heap[Z+1],K.heap[Z],K.depth)&&Z++,!Ke(ce,Re,K.heap[Z],K.depth));)K.heap[_e]=K.heap[Z],_e=Z,Z<<=1;K.heap[_e]=Re}function Te(K,ce,_e){var Re,Z,ue=0,W,me;if(K.last_lit!==0)do Re=K.pending_buf[K.d_buf+ue*2]<<8|K.pending_buf[K.d_buf+ue*2+1],Z=K.pending_buf[K.l_buf+ue],ue++,Re===0?pe(K,Z,ce):(W=U[Z],pe(K,W+m+1,ce),me=O[W],me!==0&&(Z-=F[W],Ae(K,Z,me)),Re--,W=he(Re),pe(K,W,_e),me=I[W],me!==0&&(Re-=j[W],Ae(K,Re,me)));while(ue<K.last_lit);pe(K,A,ce)}function et(K,ce){var _e=ce.dyn_tree,Re=ce.stat_desc.static_tree,Z=ce.stat_desc.has_stree,ue=ce.stat_desc.elems,W,me,He=-1,k;for(K.heap_len=0,K.heap_max=u,W=0;W<ue;W++)_e[W*2]!==0?(K.heap[++K.heap_len]=He=W,K.depth[W]=0):_e[W*2+1]=0;for(;K.heap_len<2;)k=K.heap[++K.heap_len]=He<2?++He:0,_e[k*2]=1,K.depth[k]=0,K.opt_len--,Z&&(K.static_len-=Re[k*2+1]);for(ce.max_code=He,W=K.heap_len>>1;W>=1;W--)Ne(K,_e,W);k=ue;do W=K.heap[1],K.heap[1]=K.heap[K.heap_len--],Ne(K,_e,1),me=K.heap[1],K.heap[--K.heap_max]=W,K.heap[--K.heap_max]=me,_e[k*2]=_e[W*2]+_e[me*2],K.depth[k]=(K.depth[W]>=K.depth[me]?K.depth[W]:K.depth[me])+1,_e[W*2+1]=_e[me*2+1]=k,K.heap[1]=k++,Ne(K,_e,1);while(K.heap_len>=2);K.heap[--K.heap_max]=K.heap[1],Ce(K,ce),Ue(_e,He,K.bl_count)}function st(K,ce,_e){var Re,Z=-1,ue,W=ce[0*2+1],me=0,He=7,k=4;for(W===0&&(He=138,k=3),ce[(_e+1)*2+1]=65535,Re=0;Re<=_e;Re++)ue=W,W=ce[(Re+1)*2+1],!(++me<He&&ue===W)&&(me<k?K.bl_tree[ue*2]+=me:ue!==0?(ue!==Z&&K.bl_tree[ue*2]++,K.bl_tree[L*2]++):me<=10?K.bl_tree[R*2]++:K.bl_tree[w*2]++,me=0,Z=ue,W===0?(He=138,k=3):ue===W?(He=6,k=3):(He=7,k=4))}function qe(K,ce,_e){var Re,Z=-1,ue,W=ce[0*2+1],me=0,He=7,k=4;for(W===0&&(He=138,k=3),Re=0;Re<=_e;Re++)if(ue=W,W=ce[(Re+1)*2+1],!(++me<He&&ue===W)){if(me<k)do pe(K,ue,K.bl_tree);while(--me!=0);else ue!==0?(ue!==Z&&(pe(K,ue,K.bl_tree),me--),pe(K,L,K.bl_tree),Ae(K,me-3,2)):me<=10?(pe(K,R,K.bl_tree),Ae(K,me-3,3)):(pe(K,w,K.bl_tree),Ae(K,me-11,7));me=0,Z=ue,W===0?(He=138,k=3):ue===W?(He=6,k=3):(He=7,k=4)}}function ot(K){var ce;for(st(K,K.dyn_ltree,K.l_desc.max_code),st(K,K.dyn_dtree,K.d_desc.max_code),et(K,K.bl_desc),ce=y-1;ce>=3&&K.bl_tree[C[ce]*2+1]===0;ce--);return K.opt_len+=3*(ce+1)+5+5+4,ce}function nt(K,ce,_e,Re){var Z;for(Ae(K,ce-257,5),Ae(K,_e-1,5),Ae(K,Re-4,4),Z=0;Z<Re;Z++)Ae(K,K.bl_tree[C[Z]*2+1],3);qe(K,K.dyn_ltree,ce-1),qe(K,K.dyn_dtree,_e-1)}function dt(K){var ce=4093624447,_e;for(_e=0;_e<=31;_e++,ce>>>=1)if(ce&1&&K.dyn_ltree[_e*2]!==0)return o;if(K.dyn_ltree[9*2]!==0||K.dyn_ltree[10*2]!==0||K.dyn_ltree[13*2]!==0)return l;for(_e=32;_e<m;_e++)if(K.dyn_ltree[_e*2]!==0)return l;return o}var ne=!1;function Ee(K){ne||(Me(),ne=!0),K.l_desc=new ie(K.dyn_ltree,G),K.d_desc=new ie(K.dyn_dtree,Y),K.bl_desc=new ie(K.bl_tree,X),K.bi_buf=0,K.bi_valid=0,ze(K)}function xe(K,ce,_e,Re){Ae(K,(f<<1)+(Re?1:0),3),$e(K,ce,_e,!0)}function we(K){Ae(K,d<<1,3),pe(K,A,M),Ie(K)}function be(K,ce,_e,Re){var Z,ue,W=0;K.level>0?(K.strm.data_type===v&&(K.strm.data_type=dt(K)),et(K,K.l_desc),et(K,K.d_desc),W=ot(K),Z=K.opt_len+3+7>>>3,ue=K.static_len+3+7>>>3,ue<=Z&&(Z=ue)):Z=ue=_e+5,_e+4<=Z&&ce!==-1?xe(K,ce,_e,Re):K.strategy===a||ue===Z?(Ae(K,(d<<1)+(Re?1:0),3),Te(K,M,N)):(Ae(K,(g<<1)+(Re?1:0),3),nt(K,K.l_desc.max_code+1,K.d_desc.max_code+1,W+1),Te(K,K.dyn_ltree,K.dyn_dtree)),ze(K),Re&&Ge(K)}function je(K,ce,_e){return K.pending_buf[K.d_buf+K.last_lit*2]=ce>>>8&255,K.pending_buf[K.d_buf+K.last_lit*2+1]=ce&255,K.pending_buf[K.l_buf+K.last_lit]=_e&255,K.last_lit++,ce===0?K.dyn_ltree[_e*2]++:(K.matches++,ce--,K.dyn_ltree[(U[_e]+m+1)*2]++,K.dyn_dtree[he(ce)*2]++),K.last_lit===K.lit_bufsize-1}t._tr_init=Ee,t._tr_stored_block=xe,t._tr_flush_block=be,t._tr_tally=je,t._tr_align=we},{"../utils/common":41}],53:[function(r,i,t){function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}i.exports=n},{}],54:[function(r,i,t){i.exports=typeof setImmediate=="function"?setImmediate:function(){var a=[].slice.apply(arguments);a.splice(1,0,0),setTimeout.apply(null,a)}},{}]},{},[10])(10)})})($c);Object.defineProperty(ro,"__esModule",{value:!0});ro.default=void 0;var Rn=Be,rS=io(Bi),Gc=io(Tn),iS=io(Zr),nS=io($c.exports);function io(s){return s&&s.__esModule?s:{default:s}}class aS{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new nS.default}catch(e){throw new Error("JSZip lib not loaded")}}open(e,r){return this.zip.loadAsync(e,{base64:r})}openUrl(e,r){return(0,rS.default)(e,"binary").then(function(i){return this.zip.loadAsync(i,{base64:r})}.bind(this))}request(e,r){var i=new Rn.defer,t,n=new iS.default(e);return r||(r=n.extension),r=="blob"?t=this.getBlob(e):t=this.getText(e),t?t.then(function(a){let o=this.handleResponse(a,r);i.resolve(o)}.bind(this)):i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise}handleResponse(e,r){var i;return r=="json"?i=JSON.parse(e):(0,Rn.isXml)(r)?i=(0,Rn.parse)(e,"text/xml"):r=="xhtml"?i=(0,Rn.parse)(e,"application/xhtml+xml"):r=="html"||r=="htm"?i=(0,Rn.parse)(e,"text/html"):i=e,i}getBlob(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return r=r||Gc.default.lookup(t.name),t.async("uint8array").then(function(n){return new Blob([n],{type:r})})}getText(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return t.async("string").then(function(n){return n})}getBase64(e,r){var i=window.decodeURIComponent(e.substr(1)),t=this.zip.file(i);if(t)return r=r||Gc.default.lookup(t.name),t.async("base64").then(function(n){return"data:"+r+";base64,"+n})}createUrl(e,r){var i=new Rn.defer,t=window.URL||window.webkitURL||window.mozURL,n,a,o=r&&r.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then(function(l){this.urlCache[e]=l,i.resolve(l)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(l){n=t.createObjectURL(l),this.urlCache[e]=n,i.resolve(n)}.bind(this))),a||i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var r=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&r.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let r in this.urlCache)e.revokeObjectURL(r);this.zip=void 0,this.urlCache={}}}var sS=aS;ro.default=sS;var no={},Yc={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(s,e){(function(r){s.exports=r()})(function(){return function r(i,t,n){function a(v,h){if(!t[v]){if(!i[v]){var f=typeof zr=="function"&&zr;if(!h&&f)return f(v,!0);if(o)return o(v,!0);var d=new Error("Cannot find module '"+v+"'");throw d.code="MODULE_NOT_FOUND",d}var g=t[v]={exports:{}};i[v][0].call(g.exports,function(E){var S=i[v][1][E];return a(S||E)},g,g.exports,r,i,t,n)}return t[v].exports}for(var o=typeof zr=="function"&&zr,l=0;l<n.length;l++)a(n[l]);return a}({1:[function(r,i,t){(function(n){var a=n.MutationObserver||n.WebKitMutationObserver,o;if(a){var l=0,v=new a(E),h=n.document.createTextNode("");v.observe(h,{characterData:!0}),o=function(){h.data=l=++l%2}}else if(!n.setImmediate&&typeof n.MessageChannel!="undefined"){var f=new n.MessageChannel;f.port1.onmessage=E,o=function(){f.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?o=function(){var x=n.document.createElement("script");x.onreadystatechange=function(){E(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},n.document.documentElement.appendChild(x)}:o=function(){setTimeout(E,0)};var d,g=[];function E(){d=!0;for(var x,m,c=g.length;c;){for(m=g,g=[],x=-1;++x<c;)m[x]();c=g.length}d=!1}i.exports=S;function S(x){g.push(x)===1&&!d&&o()}}).call(this,typeof Wt!="undefined"?Wt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(r,i,t){var n=r(1);function a(){}var o={},l=["REJECTED"],v=["FULFILLED"],h=["PENDING"];i.exports=f;function f(u){if(typeof u!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,u!==a&&S(this,u)}f.prototype.catch=function(u){return this.then(null,u)},f.prototype.then=function(u,_){if(typeof u!="function"&&this.state===v||typeof _!="function"&&this.state===l)return this;var b=new this.constructor(a);if(this.state!==h){var T=this.state===v?u:_;g(b,T,this.outcome)}else this.queue.push(new d(b,u,_));return b};function d(u,_,b){this.promise=u,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}d.prototype.callFulfilled=function(u){o.resolve(this.promise,u)},d.prototype.otherCallFulfilled=function(u){g(this.promise,this.onFulfilled,u)},d.prototype.callRejected=function(u){o.reject(this.promise,u)},d.prototype.otherCallRejected=function(u){g(this.promise,this.onRejected,u)};function g(u,_,b){n(function(){var T;try{T=_(b)}catch(A){return o.reject(u,A)}T===u?o.reject(u,new TypeError("Cannot resolve promise with itself")):o.resolve(u,T)})}o.resolve=function(u,_){var b=x(E,_);if(b.status==="error")return o.reject(u,b.value);var T=b.value;if(T)S(u,T);else{u.state=v,u.outcome=_;for(var A=-1,L=u.queue.length;++A<L;)u.queue[A].callFulfilled(_)}return u},o.reject=function(u,_){u.state=l,u.outcome=_;for(var b=-1,T=u.queue.length;++b<T;)u.queue[b].callRejected(_);return u};function E(u){var _=u&&u.then;if(u&&(typeof u=="object"||typeof u=="function")&&typeof _=="function")return function(){_.apply(u,arguments)}}function S(u,_){var b=!1;function T(w){b||(b=!0,o.reject(u,w))}function A(w){b||(b=!0,o.resolve(u,w))}function L(){_(A,T)}var R=x(L);R.status==="error"&&T(R.value)}function x(u,_){var b={};try{b.value=u(_),b.status="success"}catch(T){b.status="error",b.value=T}return b}f.resolve=m;function m(u){return u instanceof this?u:o.resolve(new this(a),u)}f.reject=c;function c(u){var _=new this(a);return o.reject(_,u)}f.all=p;function p(u){var _=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=u.length,T=!1;if(!b)return this.resolve([]);for(var A=new Array(b),L=0,R=-1,w=new this(a);++R<b;)O(u[R],R);return w;function O(I,D){_.resolve(I).then(C,function(P){T||(T=!0,o.reject(w,P))});function C(P){A[D]=P,++L===b&&!T&&(T=!0,o.resolve(w,A))}}}f.race=y;function y(u){var _=this;if(Object.prototype.toString.call(u)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=u.length,T=!1;if(!b)return this.resolve([]);for(var A=-1,L=new this(a);++A<b;)R(u[A]);return L;function R(w){_.resolve(w).then(function(O){T||(T=!0,o.resolve(L,O))},function(O){T||(T=!0,o.reject(L,O))})}}},{"1":1}],3:[function(r,i,t){(function(n){typeof n.Promise!="function"&&(n.Promise=r(2))}).call(this,typeof Wt!="undefined"?Wt:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(r,i,t){var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H};function a(H,Q){if(!(H instanceof Q))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(H){return}}var l=o();function v(){try{if(!l||!l.open)return!1;var H=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Q=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!H||Q)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch($){return!1}}function h(H,Q){H=H||[],Q=Q||{};try{return new Blob(H,Q)}catch(ee){if(ee.name!=="TypeError")throw ee;for(var $=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,te=new $,re=0;re<H.length;re+=1)te.append(H[re]);return te.getBlob(Q.type)}}typeof Promise=="undefined"&&r(3);var f=Promise;function d(H,Q){Q&&H.then(function($){Q(null,$)},function($){Q($)})}function g(H,Q,$){typeof Q=="function"&&H.then(Q),typeof $=="function"&&H.catch($)}function E(H){return typeof H!="string"&&(console.warn(H+" used as a key, but it is not a string."),H=String(H)),H}function S(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var x="local-forage-detect-blob-support",m=void 0,c={},p=Object.prototype.toString,y="readonly",u="readwrite";function _(H){for(var Q=H.length,$=new ArrayBuffer(Q),te=new Uint8Array($),re=0;re<Q;re++)te[re]=H.charCodeAt(re);return $}function b(H){return new f(function(Q){var $=H.transaction(x,u),te=h([""]);$.objectStore(x).put(te,"key"),$.onabort=function(re){re.preventDefault(),re.stopPropagation(),Q(!1)},$.oncomplete=function(){var re=navigator.userAgent.match(/Chrome\/(\d+)/),ee=navigator.userAgent.match(/Edge\//);Q(ee||!re||parseInt(re[1],10)>=43)}}).catch(function(){return!1})}function T(H){return typeof m=="boolean"?f.resolve(m):b(H).then(function(Q){return m=Q,m})}function A(H){var Q=c[H.name],$={};$.promise=new f(function(te,re){$.resolve=te,$.reject=re}),Q.deferredOperations.push($),Q.dbReady?Q.dbReady=Q.dbReady.then(function(){return $.promise}):Q.dbReady=$.promise}function L(H){var Q=c[H.name],$=Q.deferredOperations.pop();if($)return $.resolve(),$.promise}function R(H,Q){var $=c[H.name],te=$.deferredOperations.pop();if(te)return te.reject(Q),te.promise}function w(H,Q){return new f(function($,te){if(c[H.name]=c[H.name]||F(),H.db)if(Q)A(H),H.db.close();else return $(H.db);var re=[H.name];Q&&re.push(H.version);var ee=l.open.apply(l,re);Q&&(ee.onupgradeneeded=function(ve){var Se=ee.result;try{Se.createObjectStore(H.storeName),ve.oldVersion<=1&&Se.createObjectStore(x)}catch(Oe){if(Oe.name==="ConstraintError")console.warn('The database "'+H.name+'" has been upgraded from version '+ve.oldVersion+" to version "+ve.newVersion+', but the storage "'+H.storeName+'" already exists.');else throw Oe}}),ee.onerror=function(ve){ve.preventDefault(),te(ee.error)},ee.onsuccess=function(){var ve=ee.result;ve.onversionchange=function(Se){Se.target.close()},$(ve),L(H)}})}function O(H){return w(H,!1)}function I(H){return w(H,!0)}function D(H,Q){if(!H.db)return!0;var $=!H.db.objectStoreNames.contains(H.storeName),te=H.version<H.db.version,re=H.version>H.db.version;if(te&&(H.version!==Q&&console.warn('The database "'+H.name+`" can't be downgraded from version `+H.db.version+" to version "+H.version+"."),H.version=H.db.version),re||$){if($){var ee=H.db.version+1;ee>H.version&&(H.version=ee)}return!0}return!1}function C(H){return new f(function(Q,$){var te=new FileReader;te.onerror=$,te.onloadend=function(re){var ee=btoa(re.target.result||"");Q({__local_forage_encoded_blob:!0,data:ee,type:H.type})},te.readAsBinaryString(H)})}function P(H){var Q=_(atob(H.data));return h([Q],{type:H.type})}function M(H){return H&&H.__local_forage_encoded_blob}function N(H){var Q=this,$=Q._initReady().then(function(){var te=c[Q._dbInfo.name];if(te&&te.dbReady)return te.dbReady});return g($,H,H),$}function B(H){A(H);for(var Q=c[H.name],$=Q.forages,te=0;te<$.length;te++){var re=$[te];re._dbInfo.db&&(re._dbInfo.db.close(),re._dbInfo.db=null)}return H.db=null,O(H).then(function(ee){return H.db=ee,D(H)?I(H):ee}).then(function(ee){H.db=Q.db=ee;for(var ve=0;ve<$.length;ve++)$[ve]._dbInfo.db=ee}).catch(function(ee){throw R(H,ee),ee})}function U(H,Q,$,te){te===void 0&&(te=1);try{var re=H.db.transaction(H.storeName,Q);$(null,re)}catch(ee){if(te>0&&(!H.db||ee.name==="InvalidStateError"||ee.name==="NotFoundError"))return f.resolve().then(function(){if(!H.db||ee.name==="NotFoundError"&&!H.db.objectStoreNames.contains(H.storeName)&&H.version<=H.db.version)return H.db&&(H.version=H.db.version+1),I(H)}).then(function(){return B(H).then(function(){U(H,Q,$,te-1)})}).catch($);$(ee)}}function F(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function j(H){var Q=this,$={db:null};if(H)for(var te in H)$[te]=H[te];var re=c[$.name];re||(re=F(),c[$.name]=re),re.forages.push(Q),Q._initReady||(Q._initReady=Q.ready,Q.ready=N);var ee=[];function ve(){return f.resolve()}for(var Se=0;Se<re.forages.length;Se++){var Oe=re.forages[Se];Oe!==Q&&ee.push(Oe._initReady().catch(ve))}var Le=re.forages.slice(0);return f.all(ee).then(function(){return $.db=re.db,O($)}).then(function(De){return $.db=De,D($,Q._defaultConfig.version)?I($):De}).then(function(De){$.db=re.db=De,Q._dbInfo=$;for(var Ve=0;Ve<Le.length;Ve++){var it=Le[Ve];it!==Q&&(it._dbInfo.db=$.db,it._dbInfo.version=$.version)}})}function V(H,Q){var $=this;H=E(H);var te=new f(function(re,ee){$.ready().then(function(){U($._dbInfo,y,function(ve,Se){if(ve)return ee(ve);try{var Oe=Se.objectStore($._dbInfo.storeName),Le=Oe.get(H);Le.onsuccess=function(){var De=Le.result;De===void 0&&(De=null),M(De)&&(De=P(De)),re(De)},Le.onerror=function(){ee(Le.error)}}catch(De){ee(De)}})}).catch(ee)});return d(te,Q),te}function G(H,Q){var $=this,te=new f(function(re,ee){$.ready().then(function(){U($._dbInfo,y,function(ve,Se){if(ve)return ee(ve);try{var Oe=Se.objectStore($._dbInfo.storeName),Le=Oe.openCursor(),De=1;Le.onsuccess=function(){var Ve=Le.result;if(Ve){var it=Ve.value;M(it)&&(it=P(it));var ft=H(it,Ve.key,De++);ft!==void 0?re(ft):Ve.continue()}else re()},Le.onerror=function(){ee(Le.error)}}catch(Ve){ee(Ve)}})}).catch(ee)});return d(te,Q),te}function Y(H,Q,$){var te=this;H=E(H);var re=new f(function(ee,ve){var Se;te.ready().then(function(){return Se=te._dbInfo,p.call(Q)==="[object Blob]"?T(Se.db).then(function(Oe){return Oe?Q:C(Q)}):Q}).then(function(Oe){U(te._dbInfo,u,function(Le,De){if(Le)return ve(Le);try{var Ve=De.objectStore(te._dbInfo.storeName);Oe===null&&(Oe=void 0);var it=Ve.put(Oe,H);De.oncomplete=function(){Oe===void 0&&(Oe=null),ee(Oe)},De.onabort=De.onerror=function(){var ft=it.error?it.error:it.transaction.error;ve(ft)}}catch(ft){ve(ft)}})}).catch(ve)});return d(re,$),re}function X(H,Q){var $=this;H=E(H);var te=new f(function(re,ee){$.ready().then(function(){U($._dbInfo,u,function(ve,Se){if(ve)return ee(ve);try{var Oe=Se.objectStore($._dbInfo.storeName),Le=Oe.delete(H);Se.oncomplete=function(){re()},Se.onerror=function(){ee(Le.error)},Se.onabort=function(){var De=Le.error?Le.error:Le.transaction.error;ee(De)}}catch(De){ee(De)}})}).catch(ee)});return d(te,Q),te}function ie(H){var Q=this,$=new f(function(te,re){Q.ready().then(function(){U(Q._dbInfo,u,function(ee,ve){if(ee)return re(ee);try{var Se=ve.objectStore(Q._dbInfo.storeName),Oe=Se.clear();ve.oncomplete=function(){te()},ve.onabort=ve.onerror=function(){var Le=Oe.error?Oe.error:Oe.transaction.error;re(Le)}}catch(Le){re(Le)}})}).catch(re)});return d($,H),$}function he(H){var Q=this,$=new f(function(te,re){Q.ready().then(function(){U(Q._dbInfo,y,function(ee,ve){if(ee)return re(ee);try{var Se=ve.objectStore(Q._dbInfo.storeName),Oe=Se.count();Oe.onsuccess=function(){te(Oe.result)},Oe.onerror=function(){re(Oe.error)}}catch(Le){re(Le)}})}).catch(re)});return d($,H),$}function de(H,Q){var $=this,te=new f(function(re,ee){if(H<0){re(null);return}$.ready().then(function(){U($._dbInfo,y,function(ve,Se){if(ve)return ee(ve);try{var Oe=Se.objectStore($._dbInfo.storeName),Le=!1,De=Oe.openKeyCursor();De.onsuccess=function(){var Ve=De.result;if(!Ve){re(null);return}H===0||Le?re(Ve.key):(Le=!0,Ve.advance(H))},De.onerror=function(){ee(De.error)}}catch(Ve){ee(Ve)}})}).catch(ee)});return d(te,Q),te}function Ae(H){var Q=this,$=new f(function(te,re){Q.ready().then(function(){U(Q._dbInfo,y,function(ee,ve){if(ee)return re(ee);try{var Se=ve.objectStore(Q._dbInfo.storeName),Oe=Se.openKeyCursor(),Le=[];Oe.onsuccess=function(){var De=Oe.result;if(!De){te(Le);return}Le.push(De.key),De.continue()},Oe.onerror=function(){re(Oe.error)}}catch(De){re(De)}})}).catch(re)});return d($,H),$}function pe(H,Q){Q=S.apply(this,arguments);var $=this.config();H=typeof H!="function"&&H||{},H.name||(H.name=H.name||$.name,H.storeName=H.storeName||$.storeName);var te=this,re;if(!H.name)re=f.reject("Invalid arguments");else{var ee=H.name===$.name&&te._dbInfo.db,ve=ee?f.resolve(te._dbInfo.db):O(H).then(function(Se){var Oe=c[H.name],Le=Oe.forages;Oe.db=Se;for(var De=0;De<Le.length;De++)Le[De]._dbInfo.db=Se;return Se});H.storeName?re=ve.then(function(Se){if(!!Se.objectStoreNames.contains(H.storeName)){var Oe=Se.version+1;A(H);var Le=c[H.name],De=Le.forages;Se.close();for(var Ve=0;Ve<De.length;Ve++){var it=De[Ve];it._dbInfo.db=null,it._dbInfo.version=Oe}var ft=new f(function(ct,It){var wt=l.open(H.name,Oe);wt.onerror=function(mr){var Mn=wt.result;Mn.close(),It(mr)},wt.onupgradeneeded=function(){var mr=wt.result;mr.deleteObjectStore(H.storeName)},wt.onsuccess=function(){var mr=wt.result;mr.close(),ct(mr)}});return ft.then(function(ct){Le.db=ct;for(var It=0;It<De.length;It++){var wt=De[It];wt._dbInfo.db=ct,L(wt._dbInfo)}}).catch(function(ct){throw(R(H,ct)||f.resolve()).catch(function(){}),ct})}}):re=ve.then(function(Se){A(H);var Oe=c[H.name],Le=Oe.forages;Se.close();for(var De=0;De<Le.length;De++){var Ve=Le[De];Ve._dbInfo.db=null}var it=new f(function(ft,ct){var It=l.deleteDatabase(H.name);It.onerror=function(){var wt=It.result;wt&&wt.close(),ct(It.error)},It.onblocked=function(){console.warn('dropInstance blocked for database "'+H.name+'" until all open connections are closed')},It.onsuccess=function(){var wt=It.result;wt&&wt.close(),ft(wt)}});return it.then(function(ft){Oe.db=ft;for(var ct=0;ct<Le.length;ct++){var It=Le[ct];L(It._dbInfo)}}).catch(function(ft){throw(R(H,ft)||f.resolve()).catch(function(){}),ft})})}return d(re,Q),re}var le={_driver:"asyncStorage",_initStorage:j,_support:v(),iterate:G,getItem:V,setItem:Y,removeItem:X,clear:ie,length:he,key:de,keys:Ae,dropInstance:pe};function Ie(){return typeof openDatabase=="function"}var Ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ue="~~local_forage_type~",Me=/^~~local_forage_type~([^~]+)~/,ze="__lfsc__:",Ge=ze.length,$e="arbf",Ke="blob",Ne="si08",Te="ui08",et="uic8",st="si16",qe="si32",ot="ur16",nt="ui32",dt="fl32",ne="fl64",Ee=Ge+$e.length,xe=Object.prototype.toString;function we(H){var Q=H.length*.75,$=H.length,te,re=0,ee,ve,Se,Oe;H[H.length-1]==="="&&(Q--,H[H.length-2]==="="&&Q--);var Le=new ArrayBuffer(Q),De=new Uint8Array(Le);for(te=0;te<$;te+=4)ee=Ce.indexOf(H[te]),ve=Ce.indexOf(H[te+1]),Se=Ce.indexOf(H[te+2]),Oe=Ce.indexOf(H[te+3]),De[re++]=ee<<2|ve>>4,De[re++]=(ve&15)<<4|Se>>2,De[re++]=(Se&3)<<6|Oe&63;return Le}function be(H){var Q=new Uint8Array(H),$="",te;for(te=0;te<Q.length;te+=3)$+=Ce[Q[te]>>2],$+=Ce[(Q[te]&3)<<4|Q[te+1]>>4],$+=Ce[(Q[te+1]&15)<<2|Q[te+2]>>6],$+=Ce[Q[te+2]&63];return Q.length%3==2?$=$.substring(0,$.length-1)+"=":Q.length%3==1&&($=$.substring(0,$.length-2)+"=="),$}function je(H,Q){var $="";if(H&&($=xe.call(H)),H&&($==="[object ArrayBuffer]"||H.buffer&&xe.call(H.buffer)==="[object ArrayBuffer]")){var te,re=ze;H instanceof ArrayBuffer?(te=H,re+=$e):(te=H.buffer,$==="[object Int8Array]"?re+=Ne:$==="[object Uint8Array]"?re+=Te:$==="[object Uint8ClampedArray]"?re+=et:$==="[object Int16Array]"?re+=st:$==="[object Uint16Array]"?re+=ot:$==="[object Int32Array]"?re+=qe:$==="[object Uint32Array]"?re+=nt:$==="[object Float32Array]"?re+=dt:$==="[object Float64Array]"?re+=ne:Q(new Error("Failed to get type for BinaryArray"))),Q(re+be(te))}else if($==="[object Blob]"){var ee=new FileReader;ee.onload=function(){var ve=Ue+H.type+"~"+be(this.result);Q(ze+Ke+ve)},ee.readAsArrayBuffer(H)}else try{Q(JSON.stringify(H))}catch(ve){console.error("Couldn't convert value into a JSON string: ",H),Q(null,ve)}}function K(H){if(H.substring(0,Ge)!==ze)return JSON.parse(H);var Q=H.substring(Ee),$=H.substring(Ge,Ee),te;if($===Ke&&Me.test(Q)){var re=Q.match(Me);te=re[1],Q=Q.substring(re[0].length)}var ee=we(Q);switch($){case $e:return ee;case Ke:return h([ee],{type:te});case Ne:return new Int8Array(ee);case Te:return new Uint8Array(ee);case et:return new Uint8ClampedArray(ee);case st:return new Int16Array(ee);case ot:return new Uint16Array(ee);case qe:return new Int32Array(ee);case nt:return new Uint32Array(ee);case dt:return new Float32Array(ee);case ne:return new Float64Array(ee);default:throw new Error("Unkown type: "+$)}}var ce={serialize:je,deserialize:K,stringToBuffer:we,bufferToString:be};function _e(H,Q,$,te){H.executeSql("CREATE TABLE IF NOT EXISTS "+Q.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],$,te)}function Re(H){var Q=this,$={db:null};if(H)for(var te in H)$[te]=typeof H[te]!="string"?H[te].toString():H[te];var re=new f(function(ee,ve){try{$.db=openDatabase($.name,String($.version),$.description,$.size)}catch(Se){return ve(Se)}$.db.transaction(function(Se){_e(Se,$,function(){Q._dbInfo=$,ee()},function(Oe,Le){ve(Le)})},ve)});return $.serializer=ce,re}function Z(H,Q,$,te,re,ee){H.executeSql($,te,re,function(ve,Se){Se.code===Se.SYNTAX_ERR?ve.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Q.storeName],function(Oe,Le){Le.rows.length?ee(Oe,Se):_e(Oe,Q,function(){Oe.executeSql($,te,re,ee)},ee)},ee):ee(ve,Se)},ee)}function ue(H,Q){var $=this;H=E(H);var te=new f(function(re,ee){$.ready().then(function(){var ve=$._dbInfo;ve.db.transaction(function(Se){Z(Se,ve,"SELECT * FROM "+ve.storeName+" WHERE key = ? LIMIT 1",[H],function(Oe,Le){var De=Le.rows.length?Le.rows.item(0).value:null;De&&(De=ve.serializer.deserialize(De)),re(De)},function(Oe,Le){ee(Le)})})}).catch(ee)});return d(te,Q),te}function W(H,Q){var $=this,te=new f(function(re,ee){$.ready().then(function(){var ve=$._dbInfo;ve.db.transaction(function(Se){Z(Se,ve,"SELECT * FROM "+ve.storeName,[],function(Oe,Le){for(var De=Le.rows,Ve=De.length,it=0;it<Ve;it++){var ft=De.item(it),ct=ft.value;if(ct&&(ct=ve.serializer.deserialize(ct)),ct=H(ct,ft.key,it+1),ct!==void 0){re(ct);return}}re()},function(Oe,Le){ee(Le)})})}).catch(ee)});return d(te,Q),te}function me(H,Q,$,te){var re=this;H=E(H);var ee=new f(function(ve,Se){re.ready().then(function(){Q===void 0&&(Q=null);var Oe=Q,Le=re._dbInfo;Le.serializer.serialize(Q,function(De,Ve){Ve?Se(Ve):Le.db.transaction(function(it){Z(it,Le,"INSERT OR REPLACE INTO "+Le.storeName+" (key, value) VALUES (?, ?)",[H,De],function(){ve(Oe)},function(ft,ct){Se(ct)})},function(it){if(it.code===it.QUOTA_ERR){if(te>0){ve(me.apply(re,[H,Oe,$,te-1]));return}Se(it)}})})}).catch(Se)});return d(ee,$),ee}function He(H,Q,$){return me.apply(this,[H,Q,$,1])}function k(H,Q){var $=this;H=E(H);var te=new f(function(re,ee){$.ready().then(function(){var ve=$._dbInfo;ve.db.transaction(function(Se){Z(Se,ve,"DELETE FROM "+ve.storeName+" WHERE key = ?",[H],function(){re()},function(Oe,Le){ee(Le)})})}).catch(ee)});return d(te,Q),te}function oe(H){var Q=this,$=new f(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"DELETE FROM "+ee.storeName,[],function(){te()},function(Se,Oe){re(Oe)})})}).catch(re)});return d($,H),$}function fe(H){var Q=this,$=new f(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"SELECT COUNT(key) as c FROM "+ee.storeName,[],function(Se,Oe){var Le=Oe.rows.item(0).c;te(Le)},function(Se,Oe){re(Oe)})})}).catch(re)});return d($,H),$}function z(H,Q){var $=this,te=new f(function(re,ee){$.ready().then(function(){var ve=$._dbInfo;ve.db.transaction(function(Se){Z(Se,ve,"SELECT key FROM "+ve.storeName+" WHERE id = ? LIMIT 1",[H+1],function(Oe,Le){var De=Le.rows.length?Le.rows.item(0).key:null;re(De)},function(Oe,Le){ee(Le)})})}).catch(ee)});return d(te,Q),te}function J(H){var Q=this,$=new f(function(te,re){Q.ready().then(function(){var ee=Q._dbInfo;ee.db.transaction(function(ve){Z(ve,ee,"SELECT key FROM "+ee.storeName,[],function(Se,Oe){for(var Le=[],De=0;De<Oe.rows.length;De++)Le.push(Oe.rows.item(De).key);te(Le)},function(Se,Oe){re(Oe)})})}).catch(re)});return d($,H),$}function ae(H){return new f(function(Q,$){H.transaction(function(te){te.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(re,ee){for(var ve=[],Se=0;Se<ee.rows.length;Se++)ve.push(ee.rows.item(Se).name);Q({db:H,storeNames:ve})},function(re,ee){$(ee)})},function(te){$(te)})})}function We(H,Q){Q=S.apply(this,arguments);var $=this.config();H=typeof H!="function"&&H||{},H.name||(H.name=H.name||$.name,H.storeName=H.storeName||$.storeName);var te=this,re;return H.name?re=new f(function(ee){var ve;H.name===$.name?ve=te._dbInfo.db:ve=openDatabase(H.name,"","",0),H.storeName?ee({db:ve,storeNames:[H.storeName]}):ee(ae(ve))}).then(function(ee){return new f(function(ve,Se){ee.db.transaction(function(Oe){function Le(ft){return new f(function(ct,It){Oe.executeSql("DROP TABLE IF EXISTS "+ft,[],function(){ct()},function(wt,mr){It(mr)})})}for(var De=[],Ve=0,it=ee.storeNames.length;Ve<it;Ve++)De.push(Le(ee.storeNames[Ve]));f.all(De).then(function(){ve()}).catch(function(ft){Se(ft)})},function(Oe){Se(Oe)})})}):re=f.reject("Invalid arguments"),d(re,Q),re}var ke={_driver:"webSQLStorage",_initStorage:Re,_support:Ie(),iterate:W,getItem:ue,setItem:He,removeItem:k,clear:oe,length:fe,key:z,keys:J,dropInstance:We};function Fe(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(H){return!1}}function rt(H,Q){var $=H.name+"/";return H.storeName!==Q.storeName&&($+=H.storeName+"/"),$}function nr(){var H="_localforage_support_test";try{return localStorage.setItem(H,!0),localStorage.removeItem(H),!1}catch(Q){return!0}}function vt(){return!nr()||localStorage.length>0}function at(H){var Q=this,$={};if(H)for(var te in H)$[te]=H[te];return $.keyPrefix=rt(H,Q._defaultConfig),vt()?(Q._dbInfo=$,$.serializer=ce,f.resolve()):f.reject()}function At(H){var Q=this,$=Q.ready().then(function(){for(var te=Q._dbInfo.keyPrefix,re=localStorage.length-1;re>=0;re--){var ee=localStorage.key(re);ee.indexOf(te)===0&&localStorage.removeItem(ee)}});return d($,H),$}function Pt(H,Q){var $=this;H=E(H);var te=$.ready().then(function(){var re=$._dbInfo,ee=localStorage.getItem(re.keyPrefix+H);return ee&&(ee=re.serializer.deserialize(ee)),ee});return d(te,Q),te}function jt(H,Q){var $=this,te=$.ready().then(function(){for(var re=$._dbInfo,ee=re.keyPrefix,ve=ee.length,Se=localStorage.length,Oe=1,Le=0;Le<Se;Le++){var De=localStorage.key(Le);if(De.indexOf(ee)===0){var Ve=localStorage.getItem(De);if(Ve&&(Ve=re.serializer.deserialize(Ve)),Ve=H(Ve,De.substring(ve),Oe++),Ve!==void 0)return Ve}}});return d(te,Q),te}function $i(H,Q){var $=this,te=$.ready().then(function(){var re=$._dbInfo,ee;try{ee=localStorage.key(H)}catch(ve){ee=null}return ee&&(ee=ee.substring(re.keyPrefix.length)),ee});return d(te,Q),te}function Gi(H){var Q=this,$=Q.ready().then(function(){for(var te=Q._dbInfo,re=localStorage.length,ee=[],ve=0;ve<re;ve++){var Se=localStorage.key(ve);Se.indexOf(te.keyPrefix)===0&&ee.push(Se.substring(te.keyPrefix.length))}return ee});return d($,H),$}function xt(H){var Q=this,$=Q.keys().then(function(te){return te.length});return d($,H),$}function qt(H,Q){var $=this;H=E(H);var te=$.ready().then(function(){var re=$._dbInfo;localStorage.removeItem(re.keyPrefix+H)});return d(te,Q),te}function Dt(H,Q,$){var te=this;H=E(H);var re=te.ready().then(function(){Q===void 0&&(Q=null);var ee=Q;return new f(function(ve,Se){var Oe=te._dbInfo;Oe.serializer.serialize(Q,function(Le,De){if(De)Se(De);else try{localStorage.setItem(Oe.keyPrefix+H,Le),ve(ee)}catch(Ve){(Ve.name==="QuotaExceededError"||Ve.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Se(Ve),Se(Ve)}})})});return d(re,$),re}function Dr(H,Q){if(Q=S.apply(this,arguments),H=typeof H!="function"&&H||{},!H.name){var $=this.config();H.name=H.name||$.name,H.storeName=H.storeName||$.storeName}var te=this,re;return H.name?re=new f(function(ee){H.storeName?ee(rt(H,te._defaultConfig)):ee(H.name+"/")}).then(function(ee){for(var ve=localStorage.length-1;ve>=0;ve--){var Se=localStorage.key(ve);Se.indexOf(ee)===0&&localStorage.removeItem(Se)}}):re=f.reject("Invalid arguments"),d(re,Q),re}var gr={_driver:"localStorageWrapper",_initStorage:at,_support:Fe(),iterate:jt,getItem:Pt,setItem:Dt,removeItem:qt,clear:At,length:xt,key:$i,keys:Gi,dropInstance:Dr},Ra=function(Q,$){return Q===$||typeof Q=="number"&&typeof $=="number"&&isNaN(Q)&&isNaN($)},Mh=function(Q,$){for(var te=Q.length,re=0;re<te;){if(Ra(Q[re],$))return!0;re++}return!1},ou=Array.isArray||function(H){return Object.prototype.toString.call(H)==="[object Array]"},Pn={},lu={},Yi={INDEXEDDB:le,WEBSQL:ke,LOCALSTORAGE:gr},kh=[Yi.INDEXEDDB._driver,Yi.WEBSQL._driver,Yi.LOCALSTORAGE._driver],Da=["dropInstance"],vo=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Da),Nh={description:"",driver:kh.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Fh(H,Q){H[Q]=function(){var $=arguments;return H.ready().then(function(){return H[Q].apply(H,$)})}}function go(){for(var H=1;H<arguments.length;H++){var Q=arguments[H];if(Q)for(var $ in Q)Q.hasOwnProperty($)&&(ou(Q[$])?arguments[0][$]=Q[$].slice():arguments[0][$]=Q[$])}return arguments[0]}var Bh=function(){function H(Q){a(this,H);for(var $ in Yi)if(Yi.hasOwnProperty($)){var te=Yi[$],re=te._driver;this[$]=re,Pn[re]||this.defineDriver(te)}this._defaultConfig=go({},Nh),this._config=go({},this._defaultConfig,Q),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return H.prototype.config=function($){if((typeof $=="undefined"?"undefined":n($))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var te in $){if(te==="storeName"&&($[te]=$[te].replace(/\W/g,"_")),te==="version"&&typeof $[te]!="number")return new Error("Database version must be a number.");this._config[te]=$[te]}return"driver"in $&&$.driver?this.setDriver(this._config.driver):!0}else return typeof $=="string"?this._config[$]:this._config},H.prototype.defineDriver=function($,te,re){var ee=new f(function(ve,Se){try{var Oe=$._driver,Le=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!$._driver){Se(Le);return}for(var De=vo.concat("_initStorage"),Ve=0,it=De.length;Ve<it;Ve++){var ft=De[Ve],ct=!Mh(Da,ft);if((ct||$[ft])&&typeof $[ft]!="function"){Se(Le);return}}var It=function(){for(var Mn=function(Wh){return function(){var zh=new Error("Method "+Wh+" is not implemented by the current driver"),uu=f.reject(zh);return d(uu,arguments[arguments.length-1]),uu}},mo=0,jh=Da.length;mo<jh;mo++){var yo=Da[mo];$[yo]||($[yo]=Mn(yo))}};It();var wt=function(Mn){Pn[Oe]&&console.info("Redefining LocalForage driver: "+Oe),Pn[Oe]=$,lu[Oe]=Mn,ve()};"_support"in $?$._support&&typeof $._support=="function"?$._support().then(wt,Se):wt(!!$._support):wt(!0)}catch(mr){Se(mr)}});return g(ee,te,re),ee},H.prototype.driver=function(){return this._driver||null},H.prototype.getDriver=function($,te,re){var ee=Pn[$]?f.resolve(Pn[$]):f.reject(new Error("Driver not found."));return g(ee,te,re),ee},H.prototype.getSerializer=function($){var te=f.resolve(ce);return g(te,$),te},H.prototype.ready=function($){var te=this,re=te._driverSet.then(function(){return te._ready===null&&(te._ready=te._initDriver()),te._ready});return g(re,$,$),re},H.prototype.setDriver=function($,te,re){var ee=this;ou($)||($=[$]);var ve=this._getSupportedDrivers($);function Se(){ee._config.driver=ee.driver()}function Oe(Ve){return ee._extend(Ve),Se(),ee._ready=ee._initStorage(ee._config),ee._ready}function Le(Ve){return function(){var it=0;function ft(){for(;it<Ve.length;){var ct=Ve[it];return it++,ee._dbInfo=null,ee._ready=null,ee.getDriver(ct).then(Oe).catch(ft)}Se();var It=new Error("No available storage method found.");return ee._driverSet=f.reject(It),ee._driverSet}return ft()}}var De=this._driverSet!==null?this._driverSet.catch(function(){return f.resolve()}):f.resolve();return this._driverSet=De.then(function(){var Ve=ve[0];return ee._dbInfo=null,ee._ready=null,ee.getDriver(Ve).then(function(it){ee._driver=it._driver,Se(),ee._wrapLibraryMethodsWithReady(),ee._initDriver=Le(ve)})}).catch(function(){Se();var Ve=new Error("No available storage method found.");return ee._driverSet=f.reject(Ve),ee._driverSet}),g(this._driverSet,te,re),this._driverSet},H.prototype.supports=function($){return!!lu[$]},H.prototype._extend=function($){go(this,$)},H.prototype._getSupportedDrivers=function($){for(var te=[],re=0,ee=$.length;re<ee;re++){var ve=$[re];this.supports(ve)&&te.push(ve)}return te},H.prototype._wrapLibraryMethodsWithReady=function(){for(var $=0,te=vo.length;$<te;$++)Fh(this,vo[$])},H.prototype.createInstance=function($){return new H($)},H}(),Uh=new Bh;i.exports=Uh},{"3":3}]},{},[4])(4)})})(Yc);Object.defineProperty(no,"__esModule",{value:!0});no.default=void 0;var li=Be,oS=wa(Bi),Yl=wa(Tn),lS=wa(Zr),uS=wa(Ar.exports),Xc=wa(Yc.exports);function wa(s){return s&&s.__esModule?s:{default:s}}class Zc{constructor(e,r,i){this.urlCache={},this.storage=void 0,this.name=e,this.requester=r||oS.default,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof Xc.default=="undefined"&&(e=Xc.default),this.storage=e.createInstance({name:this.name})}catch(e){throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let r=navigator.onLine;this.online=r,r?this.emit("online",this):this.emit("offline",this)}add(e,r){let i=e.resources.map(t=>{let{href:n}=t,a=this.resolver(n),o=window.encodeURIComponent(a);return this.storage.getItem(o).then(l=>!l||r?this.requester(a,"binary").then(v=>this.storage.setItem(o,v)):l)});return Promise.all(i)}put(e,r,i){let t=window.encodeURIComponent(e);return this.storage.getItem(t).then(n=>n||this.requester(e,"binary",r,i).then(a=>this.storage.setItem(t,a)))}request(e,r,i,t){return this.online?this.requester(e,r,i,t).then(n=>(this.put(e),n)):this.retrieve(e,r)}retrieve(e,r){new li.defer;var i,t=new lS.default(e);return r||(r=t.extension),r=="blob"?i=this.getBlob(e):i=this.getText(e),i.then(n=>{var a=new li.defer,o;return n?(o=this.handleResponse(n,r),a.resolve(o)):a.reject({message:"File not found in storage: "+e,stack:new Error().stack}),a.promise})}handleResponse(e,r){var i;return r=="json"?i=JSON.parse(e):(0,li.isXml)(r)?i=(0,li.parse)(e,"text/xml"):r=="xhtml"?i=(0,li.parse)(e,"application/xhtml+xml"):r=="html"||r=="htm"?i=(0,li.parse)(e,"text/html"):i=e,i}getBlob(e,r){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(function(t){if(!!t)return r=r||Yl.default.lookup(e),new Blob([t],{type:r})})}getText(e,r){let i=window.encodeURIComponent(e);return r=r||Yl.default.lookup(e),this.storage.getItem(i).then(function(t){var n=new li.defer,a=new FileReader,o;if(!!t)return o=new Blob([t],{type:r}),a.addEventListener("loadend",()=>{n.resolve(a.result)}),a.readAsText(o,r),n.promise})}getBase64(e,r){let i=window.encodeURIComponent(e);return r=r||Yl.default.lookup(e),this.storage.getItem(i).then(t=>{var n=new li.defer,a=new FileReader,o;if(!!t)return o=new Blob([t],{type:r}),a.addEventListener("loadend",()=>{n.resolve(a.result)}),a.readAsDataURL(o,r),n.promise})}createUrl(e,r){var i=new li.defer,t=window.URL||window.webkitURL||window.mozURL,n,a,o=r&&r.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then(function(l){this.urlCache[e]=l,i.resolve(l)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(l){n=t.createObjectURL(l),this.urlCache[e]=n,i.resolve(n)}.bind(this))),a||i.reject({message:"File not found in storage: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var r=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&r.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let r in this.urlCache)e.revokeObjectURL(r);this.urlCache={},this.removeListeners()}}(0,uS.default)(Zc.prototype);var fS=Zc;no.default=fS;var ao={};Object.defineProperty(ao,"__esModule",{value:!0});ao.default=void 0;var Qc=Be;class dS{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const r=(0,Qc.qs)(e,"display_options");return r?((0,Qc.qsa)(r,"option").forEach(t=>{let n="";switch(t.childNodes.length&&(n=t.childNodes[0].nodeValue),t.attributes.name.value){case"interactive":this.interactive=n;break;case"fixed-layout":this.fixedLayout=n;break;case"open-to-spread":this.openToSpread=n;break;case"orientation-lock":this.orientationLock=n;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}var cS=dS;ao.default=cS;Object.defineProperty(ra,"__esModule",{value:!0});ra.default=void 0;var hS=Xt(Ar.exports),Ur=Be,Si=Xt(ki),Jc=Xt(Zr),pS=Xt(ks),vS=Xt(Fs),gS=Xt(Us),qc=Xt(js),Xl=Xt(Ws),mS=Xt(zs),Zl=Xt(Ks),yS=Xt(An),ES=Xt(ro),eh=Xt(Bi),_S=Xt(Qt),xS=Xt(no),Ql=Xt(ao),th=Nt;function Xt(s){return s&&s.__esModule?s:{default:s}}const rh="META-INF/container.xml",bS="META-INF/com.apple.ibooks.display-options.xml",jr={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class ih{constructor(e,r){typeof r=="undefined"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(r=e,e=void 0),this.settings=(0,Ur.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),(0,Ur.extend)(this.settings,r),this.opening=new Ur.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Ur.defer,spine:new Ur.defer,metadata:new Ur.defer,cover:new Ur.defer,navigation:new Ur.defer,pageList:new Ur.defer,resources:new Ur.defer,displayOptions:new Ur.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||eh.default,this.spine=new pS.default,this.locations=new vS.default(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(i=>{var t=new Error("Cannot load book at "+e);this.emit(th.EVENTS.BOOK.OPEN_FAILED,t)})}open(e,r){var i,t=r||this.determineType(e);return t===jr.BINARY?(this.archived=!0,this.url=new Si.default("/",""),i=this.openEpub(e)):t===jr.BASE64?(this.archived=!0,this.url=new Si.default("/",""),i=this.openEpub(e,t)):t===jr.EPUB?(this.archived=!0,this.url=new Si.default("/",""),i=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):t==jr.OPF?(this.url=new Si.default(e),i=this.openPackaging(this.url.Path.toString())):t==jr.MANIFEST?(this.url=new Si.default(e),i=this.openManifest(this.url.Path.toString())):(this.url=new Si.default(e),i=this.openContainer(rh).then(this.openPackaging.bind(this))),i}openEpub(e,r){return this.unarchive(e,r||this.settings.encoding).then(()=>this.openContainer(rh)).then(i=>this.openPackaging(i))}openContainer(e){return this.load(e).then(r=>(this.container=new gS.default(r),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new Jc.default(e),this.load(e).then(r=>(this.packaging=new qc.default(r),this.unpack(this.packaging)))}openManifest(e){return this.path=new Jc.default(e),this.load(e).then(r=>(this.packaging=new qc.default,this.packaging.load(r),this.unpack(this.packaging)))}load(e){var r=this.resolve(e);return this.archived?this.archive.request(r):this.request(r,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,r){if(!!e){var i=e,t=e.indexOf("://")>-1;return t?e:(this.path&&(i=this.path.resolve(e)),r!=!1&&this.url&&(i=this.url.resolve(i)),i)}}canonical(e){var r=e;return e?(this.settings.canonical?r=this.settings.canonical(e):r=this.resolve(e,!0),r):""}determineType(e){var r,i,t;if(this.settings.encoding==="base64")return jr.BASE64;if(typeof e!="string")return jr.BINARY;if(r=new Si.default(e),i=r.path(),t=i.extension,t&&(t=t.replace(/\?.*$/,"")),!t)return jr.DIRECTORY;if(t==="epub")return jr.EPUB;if(t==="opf")return jr.OPF;if(t==="json")return jr.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(bS)).then(r=>{this.displayOptions=new Ql.default(r),this.loading.displayOptions.resolve(this.displayOptions)}).catch(r=>{this.displayOptions=new Ql.default,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Ql.default,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new mS.default(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(r=>{console.error(r)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let r=e.navPath||e.ncxPath,i=e.toc;return i?new Promise((t,n)=>{this.navigation=new Xl.default(i),e.pageList&&(this.pageList=new Zl.default(e.pageList)),t(this.navigation)}):r?this.load(r,"xml").then(t=>(this.navigation=new Xl.default(t),this.pageList=new Zl.default(t),this.navigation)):new Promise((t,n)=>{this.navigation=new Xl.default,this.pageList=new Zl.default,t(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,r){return this.rendition=new yS.default(this,r),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,r){return this.archive=new ES.default,this.archive.open(e,r)}store(e){let r=this.settings.replacements&&this.settings.replacements!=="none",i=this.url,t=this.settings.requestMethod||eh.default.bind(this);return this.storage=new xS.default(e,t,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let n=(a,o)=>{o.output=this.resources.substitute(a,o.url)};this.resources.settings.replacements=r||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Si.default("/",""),this.spine.hooks.serialize.register(n)}),this.storage.on("online",()=>{this.url=i,this.spine.hooks.serialize.deregister(n)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,r)=>{r.output=this.resources.substitute(e,r.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var r=new _S.default(e),i=this.spine.get(r.spinePos),t=this.load.bind(this);return i?i.load(t).then(function(n){var a=r.toRange(i.document);return a}):new Promise((n,a)=>{a("CFI could not be found")})}key(e){var r=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${th.EPUBJS_VERSION}:${r}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}(0,hS.default)(ih.prototype);var SS=ih;ra.default=SS;var so={};Object.defineProperty(so,"__esModule",{value:!0});so.default=void 0;var nh=Vi(ra),TS=Vi(An),AS=Vi(Qt),wS=Vi(ji),OS=LS(Be),ah=Nt;Vi(_a);Vi(On);Vi(Ta);function sh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(sh=function(i){return i?r:e})(s)}function LS(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||typeof s!="object"&&typeof s!="function")return{default:s};var r=sh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function Vi(s){return s&&s.__esModule?s:{default:s}}function Ki(s,e){return new nh.default(s,e)}Ki.VERSION=ah.EPUBJS_VERSION;typeof Wt!="undefined"&&(Wt.EPUBJS_VERSION=ah.EPUBJS_VERSION);Ki.Book=nh.default;Ki.Rendition=TS.default;Ki.Contents=wS.default;Ki.CFI=AS.default;Ki.utils=OS;var IS=Ki;so.default=IS;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"Book",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(s,"Contents",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(s,"EpubCFI",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"Layout",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(s,"Rendition",{enumerable:!0,get:function(){return i.default}}),s.default=void 0;var e=o(ra),r=o(Qt),i=o(An),t=o(ji),n=o(ya),a=o(so);function o(v){return v&&v.__esModule?v:{default:v}}var l=a.default;s.default=l})(ed);var Oa={};Object.defineProperty(Oa,"__esModule",{value:!0});Oa.default=void 0;var RS={viewHolder:{position:"relative",height:"100%",width:"100%"},view:{height:"100%"}},DS=RS;Oa.default=DS;function oo(s){return oo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oo(s)}Object.defineProperty(bs,"__esModule",{value:!0});bs.default=void 0;var lo=MS(Ye.exports),Jt=Jl(ml.exports),CS=Jl(ed),PS=Jl(Oa);function Jl(s){return s&&s.__esModule?s:{default:s}}function oh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(oh=function(t){return t?r:e})(s)}function MS(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||oo(s)!=="object"&&typeof s!="function")return{default:s};var r=oh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function lh(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),r.push.apply(r,i)}return r}function kS(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lh(Object(r),!0).forEach(function(i){tu(s,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):lh(Object(r)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(r,i))})}return s}function NS(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function uh(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function FS(s,e,r){return e&&uh(s.prototype,e),r&&uh(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function BS(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&ql(s,e)}function ql(s,e){return ql=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},ql(s,e)}function US(s){var e=WS();return function(){var i=uo(s),t;if(e){var n=uo(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return jS(this,t)}}function jS(s,e){if(e&&(oo(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return eu(s)}function eu(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function WS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function uo(s){return uo=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},uo(s)}function tu(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}var ru=function(s){BS(r,s);var e=US(r);function r(i){var t;return NS(this,r),t=e.call(this,i),tu(eu(t),"onLocationChange",function(n){var a=t.props,o=a.location,l=a.locationChanged,v=n&&n.start;o!==v&&(t.location=v,l&&l(v))}),tu(eu(t),"handleKeyPress",function(n){var a=n.key;a&&a==="ArrowRight"&&t.nextPage(),a&&a==="ArrowLeft"&&t.prevPage()}),t.state={isLoaded:!1,toc:[]},t.viewerRef=lo.default.createRef(),t.location=i.location,t.book=t.rendition=t.prevPage=t.nextPage=null,t}return FS(r,[{key:"componentDidMount",value:function(){this.initBook(!0),document.addEventListener("keyup",this.handleKeyPress,!1)}},{key:"initBook",value:function(){var t=this,n=this.props,a=n.url,o=n.tocChanged,l=n.epubInitOptions;this.book&&this.book.destroy(),this.book=new CS.default(a,l),this.book.loaded.navigation.then(function(v){var h=v.toc;t.setState({isLoaded:!0,toc:h},function(){o&&o(h),t.initReader()})})}},{key:"componentWillUnmount",value:function(){this.book=this.rendition=this.prevPage=this.nextPage=null,document.removeEventListener("keyup",this.handleKeyPress,!1)}},{key:"shouldComponentUpdate",value:function(t){return!this.state.isLoaded||t.location!==this.props.location||t.location!==this.props.location}},{key:"componentDidUpdate",value:function(t){t.location!==this.props.location&&this.location!==this.props.location&&this.rendition.display(this.props.location),t.url!==this.props.url&&this.initBook()}},{key:"initReader",value:function(){var t=this,n=this.state.toc,a=this.props,o=a.location,l=a.epubOptions,v=a.getRendition,h=this.viewerRef.current;this.rendition=this.book.renderTo(h,kS({contained:!0,width:"100%",height:"100%"},l)),this.prevPage=function(){t.rendition.prev()},this.nextPage=function(){t.rendition.next()},this.registerEvents(),v&&v(this.rendition),typeof o=="string"||typeof o=="number"?this.rendition.display(o):n.length>0&&n[0].href?this.rendition.display(n[0].href):this.rendition.display()}},{key:"registerEvents",value:function(){var t=this.props,n=t.handleKeyPress,a=t.handleTextSelected;this.rendition.on("locationChanged",this.onLocationChange),this.rendition.on("keyup",n||this.handleKeyPress),a&&this.rendition.on("selected",a)}},{key:"renderBook",value:function(){var t=this.props.styles;return lo.default.createElement("div",{ref:this.viewerRef,style:t.view})}},{key:"render",value:function(){var t=this.state.isLoaded,n=this.props,a=n.loadingView,o=n.styles;return lo.default.createElement("div",{style:o.viewHolder},t&&this.renderBook()||a)}}]),r}(lo.Component);ru.defaultProps={loadingView:null,locationChanged:null,tocChanged:null,styles:PS.default,epubOptions:{},epubInitOptions:{}};ru.propTypes={url:Jt.default.oneOfType([Jt.default.string,Jt.default.instanceOf(ArrayBuffer)]),loadingView:Jt.default.element,location:Jt.default.oneOfType([Jt.default.string,Jt.default.number]),locationChanged:Jt.default.func,tocChanged:Jt.default.func,styles:Jt.default.object,epubInitOptions:Jt.default.object,epubOptions:Jt.default.object,getRendition:Jt.default.func,handleKeyPress:Jt.default.func,handleTextSelected:Jt.default.func};var zS=ru;bs.default=zS;var fo={};function Wr(){return Wr=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Wr.apply(this,arguments)}var fh="Left",dh="Right",ch="Up",hh="Down",Dn={delta:10,preventDefaultTouchmoveEvent:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0},iu={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},ph="mousemove",vh="mouseup",VS="touchend",KS="touchmove",HS="touchstart";function $S(s,e,r,i){return s>e?r>0?dh:fh:i>0?hh:ch}function gh(s,e){if(e===0)return s;var r=Math.PI/180*e,i=s[0]*Math.cos(r)+s[1]*Math.sin(r),t=s[1]*Math.cos(r)-s[0]*Math.sin(r);return[i,t]}function GS(s,e){var r=function(f){f&&"touches"in f&&f.touches.length>1||s(function(d,g){g.trackMouse&&(document.addEventListener(ph,i),document.addEventListener(vh,a));var E="touches"in f?f.touches[0]:f,S=E.clientX,x=E.clientY,m=gh([S,x],g.rotationAngle);return Wr({},d,iu,{initial:[].concat(m),xy:m,start:f.timeStamp||0})})},i=function(f){s(function(d,g){if("touches"in f&&f.touches.length>1)return d;var E="touches"in f?f.touches[0]:f,S=E.clientX,x=E.clientY,m=gh([S,x],g.rotationAngle),c=m[0],p=m[1],y=c-d.xy[0],u=p-d.xy[1],_=Math.abs(y),b=Math.abs(u),T=(f.timeStamp||0)-d.start,A=Math.sqrt(_*_+b*b)/(T||1),L=[y/(T||1),u/(T||1)],R=$S(_,b,y,u),w=typeof g.delta=="number"?g.delta:g.delta[R.toLowerCase()]||Dn.delta;if(_<w&&b<w&&!d.swiping)return d;var O={absX:_,absY:b,deltaX:y,deltaY:u,dir:R,event:f,first:d.first,initial:d.initial,velocity:A,vxvy:L};O.first&&g.onSwipeStart&&g.onSwipeStart(O),g.onSwiping&&g.onSwiping(O);var I=!1;return(g.onSwiping||g.onSwiped||"onSwiped"+R in g)&&(I=!0),I&&g.preventDefaultTouchmoveEvent&&g.trackTouch&&f.cancelable&&f.preventDefault(),Wr({},d,{first:!1,eventData:O,swiping:!0})})},t=function(f){s(function(d,g){var E;if(d.swiping&&d.eventData){E=Wr({},d.eventData,{event:f}),g.onSwiped&&g.onSwiped(E);var S=g["onSwiped"+E.dir];S&&S(E)}else g.onTap&&g.onTap({event:f});return Wr({},d,iu,{eventData:E})})},n=function(){document.removeEventListener(ph,i),document.removeEventListener(vh,a)},a=function(f){n(),t(f)},o=function(f,d){var g=function(){};if(f&&f.addEventListener){var E=[[HS,r],[KS,i],[VS,t]];E.forEach(function(S){var x=S[0],m=S[1];return f.addEventListener(x,m,{passive:d})}),g=function(){return E.forEach(function(x){var m=x[0],c=x[1];return f.removeEventListener(m,c)})}}return g},l=function(f){f!==null&&s(function(d,g){if(d.el===f)return d;var E={};return d.el&&d.el!==f&&d.cleanUpTouch&&(d.cleanUpTouch(),E.cleanUpTouch=void 0),g.trackTouch&&f&&(E.cleanUpTouch=o(f,!g.preventDefaultTouchmoveEvent)),Wr({},d,{el:f},E)})},v={ref:l};return e.trackMouse&&(v.onMouseDown=r),[v,o]}function YS(s,e,r){var i={};return!e.trackTouch&&s.cleanUpTouch?(s.cleanUpTouch(),i.cleanUpTouch=void 0):e.trackTouch&&!s.cleanUpTouch&&s.el&&(i.cleanUpTouch=r(s.el,!e.preventDefaultTouchmoveEvent)),Wr({},s,i)}function XS(s){var e=s.trackMouse,r=Ye.exports.useRef(Wr({},iu)),i=Ye.exports.useRef(Wr({},Dn));i.current=Wr({},Dn,s,{delta:s.delta===void 0?Dn.delta:s.delta,rotationAngle:s.rotationAngle===void 0?Dn.rotationAngle:s.rotationAngle,trackTouch:s.trackTouch===void 0?Dn.trackTouch:s.trackTouch});var t=Ye.exports.useMemo(function(){return GS(function(o){return r.current=o(r.current,i.current)},{trackMouse:e})},[e]),n=t[0],a=t[1];return r.current=YS(r.current,i.current,a),n}var ZS=Object.freeze(Object.defineProperty({__proto__:null,DOWN:hh,LEFT:fh,RIGHT:dh,UP:ch,useSwipeable:XS},Symbol.toStringTag,{value:"Module"})),QS=Eo(ZS),La={};Object.defineProperty(La,"__esModule",{value:!0});La.default=void 0;var JS={container:{overflow:"hidden",height:"100%"},readerArea:{position:"relative",zIndex:1,height:"100%",width:"100%",backgroundColor:"#fff",transition:"all .3s ease"},containerExpanded:{transform:"translateX(256px)"},titleArea:{position:"absolute",top:20,left:50,right:50,textAlign:"center",color:"#999"},reader:{position:"absolute",top:50,left:50,bottom:20,right:50},swipeWrapper:{position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:200},prev:{left:1},next:{right:1},arrow:{outline:"none",border:"none",background:"none",position:"absolute",top:"50%",marginTop:-32,fontSize:64,padding:"0 10px",color:"#E2E2E2",fontFamily:"arial, sans-serif",cursor:"pointer",userSelect:"none",appearance:"none",fontWeight:"normal"},arrowHover:{color:"#777"},tocBackground:{position:"absolute",left:256,top:0,bottom:0,right:0,zIndex:1},tocArea:{position:"absolute",left:0,top:0,bottom:0,zIndex:0,width:256,overflowY:"auto",WebkitOverflowScrolling:"touch",background:"#f2f2f2",padding:"10px 0"},tocAreaButton:{userSelect:"none",appearance:"none",background:"none",border:"none",display:"block",fontFamily:"sans-serif",width:"100%",fontSize:".9em",textAlign:"left",padding:".9em 1em",borderBottom:"1px solid #ddd",color:"#aaa",boxSizing:"border-box",outline:"none",cursor:"pointer"},tocButton:{background:"none",border:"none",width:32,height:32,position:"absolute",top:10,left:10,borderRadius:2,outline:"none",cursor:"pointer"},tocButtonExpanded:{background:"#f2f2f2"},tocButtonBar:{position:"absolute",width:"60%",background:"#ccc",height:2,left:"50%",margin:"-1px -30%",top:"50%",transition:"all .5s ease"},tocButtonBarTop:{top:"35%"},tocButtonBottom:{top:"66%"},loadingView:{position:"absolute",top:"50%",left:"10%",right:"10%",color:"#ccc",textAlign:"center",margintop:"-.5em"}},qS=JS;La.default=qS;function co(s){return co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},co(s)}Object.defineProperty(fo,"__esModule",{value:!0});fo.default=void 0;var _t=nT(Ye.exports),Rr=yh(ml.exports),eT=QS,tT=gl,mh=yh(La),rT=["children"],iT=["title","showToc","loadingView","styles","locationChanged","swipeable","epubViewStyles"];function yh(s){return s&&s.__esModule?s:{default:s}}function Eh(s){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(Eh=function(t){return t?r:e})(s)}function nT(s,e){if(!e&&s&&s.__esModule)return s;if(s===null||co(s)!=="object"&&typeof s!="function")return{default:s};var r=Eh(e);if(r&&r.has(s))return r.get(s);var i={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in s)if(n!=="default"&&Object.prototype.hasOwnProperty.call(s,n)){var a=t?Object.getOwnPropertyDescriptor(s,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=s[n]}return i.default=s,r&&r.set(s,i),i}function ho(){return ho=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},ho.apply(this,arguments)}function _h(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function xh(s,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(s,i.key,i)}}function bh(s,e,r){return e&&xh(s.prototype,e),r&&xh(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function Sh(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&nu(s,e)}function nu(s,e){return nu=Object.setPrototypeOf||function(i,t){return i.__proto__=t,i},nu(s,e)}function Th(s){var e=sT();return function(){var i=po(s),t;if(e){var n=po(this).constructor;t=Reflect.construct(i,arguments,n)}else t=i.apply(this,arguments);return aT(this,t)}}function aT(s,e){if(e&&(co(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hi(s)}function Hi(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function sT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(s){return!1}}function po(s){return po=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},po(s)}function Cn(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function Ah(s,e){if(s==null)return{};var r=oT(s,e),i,t;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);for(t=0;t<n.length;t++)i=n[t],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(r[i]=s[i]))}return r}function oT(s,e){if(s==null)return{};var r={},i=Object.keys(s),t,n;for(n=0;n<i.length;n++)t=i[n],!(e.indexOf(t)>=0)&&(r[t]=s[t]);return r}var lT=function(e){var r=e.children,i=Ah(e,rT),t=(0,eT.useSwipeable)(i);return _t.default.createElement("div",t,r)},wh=function(s){Sh(r,s);var e=Th(r);function r(){var i;_h(this,r);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return i=e.call.apply(e,[this].concat(n)),Cn(Hi(i),"setLocation",function(){i.props.setLocation(i.props.href)}),i}return bh(r,[{key:"render",value:function(){var t=this.props,n=t.label,a=t.styles;return _t.default.createElement("button",{onClick:this.setLocation,style:a},n)}}]),r}(_t.PureComponent);wh.propTypes={label:Rr.default.string,href:Rr.default.string,setLocation:Rr.default.func,styles:Rr.default.object};var au=function(s){Sh(r,s);var e=Th(r);function r(i){var t;return _h(this,r),t=e.call(this,i),Cn(Hi(t),"toggleToc",function(){t.setState({expandedToc:!t.state.expandedToc})}),Cn(Hi(t),"next",function(){var n=t.readerRef.current;n.nextPage()}),Cn(Hi(t),"prev",function(){var n=t.readerRef.current;n.prevPage()}),Cn(Hi(t),"onTocChange",function(n){var a=t.props.tocChanged;t.setState({toc:n},function(){return a&&a(n)})}),Cn(Hi(t),"setLocation",function(n){var a=t.props.locationChanged;t.setState({expandedToc:!1},function(){return a&&a(n)})}),t.readerRef=_t.default.createRef(),t.state={expandedToc:!1,toc:!1},t}return bh(r,[{key:"renderToc",value:function(){var t=this,n=this.state,a=n.toc,o=n.expandedToc,l=this.props.styles;return _t.default.createElement("div",null,_t.default.createElement("div",{style:l.tocArea},_t.default.createElement("div",{style:l.toc},a.map(function(v,h){return _t.default.createElement(wh,ho({},v,{key:h,setLocation:t.setLocation,styles:l.tocAreaButton}))}))),o&&_t.default.createElement("div",{style:l.tocBackground,onClick:this.toggleToc}))}},{key:"renderTocToggle",value:function(){var t=this.state.expandedToc,n=this.props.styles;return _t.default.createElement("button",{style:Object.assign({},n.tocButton,t?n.tocButtonExpanded:{}),onClick:this.toggleToc},_t.default.createElement("span",{style:Object.assign({},n.tocButtonBar,n.tocButtonBarTop)}),_t.default.createElement("span",{style:Object.assign({},n.tocButtonBar,n.tocButtonBottom)}))}},{key:"render",value:function(){var t=this.props,n=t.title,a=t.showToc,o=t.loadingView,l=t.styles,v=t.locationChanged,h=t.swipeable,f=t.epubViewStyles,d=Ah(t,iT),g=this.state,E=g.toc,S=g.expandedToc;return _t.default.createElement("div",{style:l.container},_t.default.createElement("div",{style:Object.assign({},l.readerArea,S?l.containerExpanded:{})},a&&this.renderTocToggle(),_t.default.createElement("div",{style:l.titleArea},n),_t.default.createElement(lT,{onSwipedRight:this.prev,onSwipedLeft:this.next,trackMouse:!0},_t.default.createElement("div",{style:l.reader},_t.default.createElement(tT.EpubView,ho({ref:this.readerRef,loadingView:o,styles:f},d,{tocChanged:this.onTocChange,locationChanged:v})),h&&_t.default.createElement("div",{style:l.swipeWrapper}))),_t.default.createElement("button",{style:Object.assign({},l.arrow,l.prev),onClick:this.prev},"\u2039"),_t.default.createElement("button",{style:Object.assign({},l.arrow,l.next),onClick:this.next},"\u203A")),a&&E&&this.renderToc())}}]),r}(_t.PureComponent);au.defaultProps={loadingView:_t.default.createElement("div",{style:mh.default.loadingView},"Loading\u2026"),locationChanged:null,tocChanged:null,showToc:!0,styles:mh.default};au.propTypes={title:Rr.default.string,loadingView:Rr.default.element,showToc:Rr.default.bool,locationChanged:Rr.default.func,tocChanged:Rr.default.func,styles:Rr.default.object,epubViewStyles:Rr.default.object,swipeable:Rr.default.bool};var uT=au;fo.default=uT;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"EpubView",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(s,"EpubViewStyle",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(s,"ReactReader",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(s,"ReactReaderStyle",{enumerable:!0,get:function(){return t.default}});var e=n(bs),r=n(Oa),i=n(fo),t=n(La);function n(a){return a&&a.__esModule?a:{default:a}}})(gl);const Oh=(s=!0)=>{const{setShowUnfold:e,unfold:r}=Ye.exports.useContext(ei);return Ye.exports.useEffect(()=>(s&&e(!0),()=>{e(!1)}),[]),{unfold:r,setShowUnfold:e}},fT=-1,dT=["epub"],cT=({file:s})=>{const[e,r]=Ye.exports.useState(void 0),i=a=>{r(a)},{unfold:t}=Oh(!0),n=ui();return q.createElement(Xi,{w:"full",h:t?"full":"75vh",pos:t?"fixed":"unset",left:t?"0":"unset",top:t?"0":"unset",transition:"all 0.3s",backdropFilter:"blur(10px)",className:"epub-box"},q.createElement(gl.ReactReader,{location:e,locationChanged:i,url:n()}))};var hT=Object.freeze(Object.defineProperty({__proto__:null,type:fT,exts:dT,default:cT},Symbol.toStringTag,{value:"Module"}));const pT=6,vT=[],gT=({file:s})=>{const e=ui(),[r,i]=Ye.exports.useState(""),{getSetting:t,password:n}=Ye.exports.useContext(ei);return Ye.exports.useEffect(()=>{i(e(s))},[]),q.createElement(Zi,{className:"image-box",w:"full"},q.createElement(Xh,{maxH:"75vh",fallback:q.createElement(Zh,{color:t("icon color")||"#1890ff",size:"xl"}),rounded:"lg",src:r}))};var mT=Object.freeze(Object.defineProperty({__proto__:null,type:pT,exts:vT,default:gT},Symbol.toStringTag,{value:"Module"}));let su="/";su==="/"&&(su=localStorage.getItem("API_SERVER"));const yT=su,ET=-1,_T=["ipa"],xT=({file:s})=>{const{getSetting:e}=Ye.exports.useContext(ei),r=s.name.split(".").pop()||"",i=ui(),{t}=Nn(),n=i(),[a,o]=Ye.exports.useState(!1);return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(_o,{spacing:"8"},q.createElement(Fn,{color:e("icon color")||"#1890ff",boxSize:20,as:Pa(s.type,r)}),q.createElement(Ca,{size:"md"},s.name),q.createElement(pu,{spacing:"8"},q.createElement(Er,{onClick:()=>{window.open(n,"_blank")}},t("Download")),q.createElement(xo,{href:`itms-services://?action=download-manifest&url=${yT}i/${btoa(n).replaceAll("/","_").replaceAll("=","-")}/ipa.plist`},q.createElement(Er,{onClick:()=>{o(!0)},colorScheme:"green"},t(a?"Installing":"Install"))))))};var bT=Object.freeze(Object.defineProperty({__proto__:null,type:ET,exts:_T,default:xT},Symbol.toStringTag,{value:"Module"}));const ST=-1,TT=[],Lh=({url:s,unfold:e})=>q.createElement(Zi,{w:"full",h:"full",className:"pdf-preview-box"},q.createElement("iframe",{title:"pdf-viewer",width:"100%",height:"100%",src:`https://alist-org.github.io/pdf.js/web/viewer.html?file=${s}`}));var AT=Object.freeze(Object.defineProperty({__proto__:null,type:ST,exts:TT,default:Lh},Symbol.toStringTag,{value:"Module"}));const wT=2,OT=[],LT=({file:s})=>{let{pathname:e}=vp();const{password:r}=Ye.exports.useContext(ei);let i=ui(!1,!1);const{unfold:t,setShowUnfold:n}=Oh(!1),[a,o]=q.useState(""),[l,v]=q.useState(""),h=i(),[f,d]=q.useState("office"),g=[{name:"office",url:`https://view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent(h)}`},{name:"google",url:`https://docs.google.com/gview?url=${encodeURIComponent(h)}&embedded=true`}],E=()=>{s.driver==="AliDrive"?fp.post("preview",{path:e,password:r}).then(S=>{const x=S.data;if(x.code!==200)return;aliyun.config({mount:document.querySelector("#office-preview"),url:x.data.preview_url}).setToken({token:x.data.access_token})}):(s.name.endsWith(".pdf")?(v(i()),o("pdf")):o("office"),n(!0))};return Ye.exports.useEffect(()=>{E()},[]),q.createElement(Xi,{w:"full",h:t?"full":"75vh",pos:t?"fixed":"unset",left:t?"0":"unset",top:t?"0":"unset",id:"office-preview",transition:"all 0.3s",backdropFilter:"blur(10px)",className:"office-preview-box"},a==="office"&&q.createElement(Xi,{w:"full",h:"full"},q.createElement(Qh,{m:"1",onChange:d,value:f},q.createElement(Jh,{direction:"row"},g.map(S=>q.createElement(qh,{value:S.name,key:S.name},S.name)))),g.map(S=>S.name===f&&q.createElement("iframe",{key:S.name,width:"100%",style:{height:"calc(100% - 24px - 0.25rem)"},src:S.url,frameBorder:"0"}))),a==="pdf"&&q.createElement(Lh,{url:l,unfold:t||!1}))};var IT=Object.freeze(Object.defineProperty({__proto__:null,type:wT,exts:OT,default:LT},Symbol.toStringTag,{value:"Module"}));const RT=-1,DT=["plist"],CT=({file:s})=>{const{getSetting:e}=Ye.exports.useContext(ei),r=s.name.split(".").pop()||"",i=ui(),{t}=Nn(),n=i(),[a,o]=Ye.exports.useState(!1);return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(_o,{spacing:"8"},q.createElement(Fn,{color:e("icon color")||"#1890ff",boxSize:20,as:Pa(s.type,r)}),q.createElement(Ca,{size:"md"},s.name),q.createElement(pu,{spacing:"8"},q.createElement(Er,{onClick:()=>{window.open(n,"_blank")}},t("Download")),q.createElement(xo,{href:"itms-services://?action=download-manifest&url="+n},q.createElement(Er,{onClick:()=>{o(!0)},colorScheme:"green"},t(a?"Installing":"Install"))))))};var PT=Object.freeze(Object.defineProperty({__proto__:null,type:RT,exts:DT,default:CT},Symbol.toStringTag,{value:"Module"})),Ih={exports:{}};/*!
 * artplayer.js v4.4.1
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(s,e){(function(r,i,t,n,a){var o=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof Wt!="undefined"?Wt:{},l=typeof o.parcelRequire4dc0=="function"&&o.parcelRequire4dc0,v=l.cache||{},h=typeof zr=="function"&&zr.bind(s);function f(E,S){if(!v[E]){if(!r[E]){var x=typeof o.parcelRequire4dc0=="function"&&o.parcelRequire4dc0;if(!S&&x)return x(E,!0);if(l)return l(E,!0);if(h&&typeof E=="string")return h(E);var m=new Error("Cannot find module '"+E+"'");throw m.code="MODULE_NOT_FOUND",m}p.resolve=function(y){var u=r[E][1][y];return u!=null?u:y},p.cache={};var c=v[E]=new f.Module(E);r[E][0].call(c.exports,p,c,c.exports,this)}return v[E].exports;function p(y){var u=p.resolve(y);return u===!1?{}:f(u)}}f.isParcelRequire=!0,f.Module=function(E){this.id=E,this.bundle=f,this.exports={}},f.modules=r,f.cache=v,f.parent=l,f.register=function(E,S){r[E]=[function(x,m){m.exports=S},{}]},Object.defineProperty(f,"root",{get:function(){return o.parcelRequire4dc0}}),o.parcelRequire4dc0=f;for(var d=0;d<i.length;d++)f(i[d]);var g=f(t);s.exports=g})({"6SN6P":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("bundle-text:./style/index.less"),o=n.interopDefault(a),l=r("option-validator"),v=n.interopDefault(l),h=r("./utils/emitter"),f=n.interopDefault(h),d=r("./utils"),g=r("./scheme"),E=n.interopDefault(g),S=r("./config"),x=n.interopDefault(S),m=r("./whitelist"),c=n.interopDefault(m),p=r("./template"),y=n.interopDefault(p),u=r("./i18n"),_=n.interopDefault(u),b=r("./player"),T=n.interopDefault(b),A=r("./control"),L=n.interopDefault(A),R=r("./contextmenu"),w=n.interopDefault(R),O=r("./info"),I=n.interopDefault(O),D=r("./subtitle"),C=n.interopDefault(D),P=r("./events"),M=n.interopDefault(P),N=r("./hotkey"),B=n.interopDefault(N),U=r("./layer"),F=n.interopDefault(U),j=r("./loading"),V=n.interopDefault(j),G=r("./notice"),Y=n.interopDefault(G),X=r("./mask"),ie=n.interopDefault(X),he=r("./icons"),de=n.interopDefault(he),Ae=r("./setting"),pe=n.interopDefault(Ae),le=r("./storage"),Ie=n.interopDefault(le),Ce=r("./plugins"),Ue=n.interopDefault(Ce),Me=r("./ads"),ze=n.interopDefault(Me),Ge=r("./mobile"),$e=n.interopDefault(Ge);let Ke=0;const Ne=[];class Te extends f.default{constructor(st,qe){super(),this.id=++Ke;const ot=d.mergeDeep(Te.option,st);this.option=v.default(ot,E.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isDestroy=!1,this.whitelist=new c.default(this),this.template=new y.default(this),this.events=new M.default(this),this.whitelist.state?(this.storage=new Ie.default(this),this.icons=new de.default(this),this.i18n=new _.default(this),this.notice=new Y.default(this),this.player=new T.default(this),this.layers=new F.default(this),this.controls=new L.default(this),this.contextmenu=new w.default(this),this.subtitle=new C.default(this),this.ads=new ze.default(this),this.info=new I.default(this),this.loading=new V.default(this),this.hotkey=new B.default(this),this.mask=new ie.default(this),this.setting=new pe.default(this),this.plugins=new Ue.default(this)):this.mobile=new $e.default(this),typeof qe=="function"&&this.on("ready",()=>qe.call(this)),Ne.push(this)}static get instances(){return Ne}static get version(){return"4.4.1"}static get env(){return"production"}static get build(){return"1652773785803"}static get config(){return x.default}static get utils(){return d}static get scheme(){return E.default}static get Emitter(){return f.default}static get validator(){return v.default}static get kindOf(){return v.default.kindOf}static get html(){return y.default.html}static get option(){return{container:"#artplayer",url:"",poster:"",title:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,fastForward:!1,autoPlayback:!1,autoOrientation:!1,ads:[],layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],whitelist:[],thumbnails:{url:"",number:60,column:10},subtitle:{url:"",type:"",style:{},encoding:"utf-8"},moreVideoAttr:{controls:!1,preload:d.isSafari?"auto":"metadata"},icons:{},customType:{},lang:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}destroy(st=!0){this.events.destroy(),this.template.destroy(st),Ne.splice(Ne.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}if(t.default=Te,Te.NOTICE_TIME=2e3,Te.SETTING_WIDTH=250,Te.SETTING_ITEM_WIDTH=200,Te.SETTING_ITEM_HEIGHT=35,Te.INDICATOR_SIZE=14,Te.INDICATOR_SIZE_ICON=16,Te.INDICATOR_SIZE_MOBILE=18,Te.INDICATOR_SIZE_MOBILE_ICON=20,Te.VOLUME_PANEL_WIDTH=60,Te.VOLUME_HANDLE_WIDTH=12,Te.RESIZE_TIME=500,Te.SCROLL_TIME=200,Te.SCROLL_GAP=50,Te.AUTO_PLAYBACK_MAX=10,Te.RECONNECT_TIME_MAX=5,Te.RECONNECT_SLEEP_TIME=1e3,Te.CONTROL_HIDE_TIME=3e3,Te.DB_CLICE_TIME=300,Te.MOBILE_AUTO_PLAYBACKRATE=3,Te.MOBILE_AUTO_PLAYBACKRATE_TIME=1e3,Te.MOBILE_AUTO_ORIENTATION_TIME=200,Te.INFO_LOOP_TIME=1e3,Te.FAST_FORWARD_VALUE=3,Te.FAST_FORWARD_TIME=1e3,typeof document!="undefined"&&!document.getElementById("artplayer-style")){const et=document.createElement("style");et.id="artplayer-style",et.textContent=o.default,document.head.appendChild(et)}typeof window!="undefined"&&(window.Artplayer=Te),console.log(`%c ArtPlayer %c ${Te.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},{"bundle-text:./style/index.less":"9EPUe","option-validator":"hqjoJ","./utils/emitter":"7pHuB","./utils":"geSvU","./scheme":"3vPoh","./config":"eksZR","./whitelist":"fCKwj","./template":"bqHdK","./i18n":"4O9ZY","./player":"fzROd","./control":"kJ9J9","./contextmenu":"7rh9q","./info":"c896w","./subtitle":"2hqso","./events":"j2hlX","./hotkey":"aTHWZ","./layer":"f2kxw","./loading":"bOs9w","./notice":"ic4th","./mask":"iLfmB","./icons":"5lAmI","./setting":"d5XKP","./storage":"5M8nN","./plugins":"jWfEd","./ads":"aafSd","./mobile":"fkUkB","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9EPUe":[function(r,i,t){i.exports='.art-video-player{z-index:20;width:100%;height:100%;zoom:1;color:#eee;text-align:left;direction:ltr;user-select:none;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#000;outline:0;margin:0 auto;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:14px;line-height:1.3;display:flex;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box;margin:0;padding:0}.art-video-player ::-webkit-scrollbar{width:5px;height:5px}.art-video-player ::-webkit-scrollbar-thumb{background-color:#666}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.art-video-player .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-video-player .art-icon svg{fill:#fff}.art-video-player img{max-width:100%;vertical-align:top}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-video-player .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-video-player .art-video{z-index:10;width:100%;height:100%;cursor:pointer;background-color:#000;position:absolute;inset:0}.art-video-player .art-poster{z-index:11;width:100%;height:100%;user-select:none;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;width:100%;text-align:center;color:#fff;pointer-events:none;text-shadow:1px 0 1px #000,0 1px 1px #000,-1px 0 1px #000,0 -1px 1px #000,1px 1px 1px #000,-1px -1px 1px #000,1px -1px 1px #000,-1px 1px 1px #000;padding:0 20px;font-size:20px;display:none;position:absolute;bottom:10px}.art-video-player .art-subtitle p{word-break:break-all;height:fit-content;margin:5px 0 0;line-height:1.2}.art-video-player.art-subtitle-show .art-subtitle{display:block}.art-video-player.art-control-show .art-subtitle{bottom:50px}.art-video-player .art-danmuku{z-index:30;width:100%;height:100%;pointer-events:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:block}.art-video-player .art-mask{z-index:50;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-mask .art-state{width:60px;height:60px;opacity:.85;cursor:pointer;pointer-events:all;justify-content:center;align-items:center;display:flex;position:absolute;bottom:65px;right:30px}.art-video-player.art-mask-show .art-mask{display:flex}.art-video-player.art-mobile .art-state{position:static}.art-video-player .art-loading{z-index:70;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;height:100px;opacity:0;visibility:hidden;pointer-events:none;background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:space-between;padding:50px 10px 0;transition:all .2s ease-in-out;display:flex;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-bottom .art-progress{z-index:0;pointer-events:auto;flex:1;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress{height:4px;cursor:pointer;flex-direction:row;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner{height:50%;width:100%;background:#fff3;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;height:100%;width:0;background:#fff6;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;height:100%;width:0;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;height:100%;pointer-events:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{width:7px;height:100%;pointer-events:auto;background:#fff;display:inline-block;position:absolute;top:0;left:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:hidden;z-index:40;border-radius:50%;justify-content:center;align-items:center;transition:transform .1s ease-in-out;position:absolute;transform:scale(.1)}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{width:100%;height:100%;pointer-events:none;user-select:none}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;height:20px;color:#fff;text-align:center;white-space:nowrap;background:#000000b3;border-radius:3px;padding:0 5px;font-size:12px;font-weight:700;line-height:20px;display:none;position:absolute;top:-25px;left:0}.art-video-player .art-bottom .art-progress .art-control-thumbnails{pointer-events:none;background-color:#000000b3;display:none;position:absolute;bottom:8px;left:0}.art-video-player .art-bottom .art-progress .art-control-loop{width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-loop .art-loop-point{width:2px;height:8px;background:#ffffffbf;position:absolute;top:-2px;left:0}.art-video-player .art-bottom .art-controls{z-index:1;pointer-events:auto;height:45px;justify-content:space-between;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-controls .art-controls-left,.art-video-player .art-bottom .art-controls .art-controls-right{display:flex}.art-video-player .art-bottom .art-controls .art-controls-center{height:100%;flex:1;justify-content:center;align-items:center;padding:0 10px;display:flex}.art-video-player .art-bottom .art-controls .art-controls-right{justify-content:flex-end}.art-video-player .art-bottom .art-controls .art-control{opacity:.9;min-height:36px;min-width:36px;text-align:center;cursor:pointer;white-space:nowrap;justify-content:center;align-items:center;font-size:12px;line-height:1;display:flex}.art-video-player .art-bottom .art-controls .art-control .art-icon{float:left;height:36px;width:36px;justify-content:center;align-items:center;display:flex}.art-video-player .art-bottom .art-controls .art-control:hover{opacity:1}.art-video-player .art-bottom .art-controls .art-control-onlyText{padding:0 10px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel{float:left;width:0;height:100%;transition:margin .2s cubic-bezier(.4,0,1,1),width .2s cubic-bezier(.4,0,1,1);position:relative;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle{width:12px;height:12px;background:#fff;border-radius:12px;margin-top:-6px;position:absolute;top:50%;left:0}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before{background:#fff;left:-54px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{background:#fff3;left:6px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before,.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{content:"";height:3px;width:60px;margin-top:-2px;display:block;position:absolute;top:50%}.art-video-player .art-bottom .art-controls .art-control-volume:hover .art-volume-panel{width:60px}.art-video-player .art-bottom .art-controls .art-control-quality{z-index:30;position:relative}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys{width:100px;text-align:center;color:#fff;background:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;line-height:30px;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item:hover{background-color:#ffffff1a}.art-video-player .art-bottom .art-controls .art-control-quality:hover .art-qualitys{display:block}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner{height:100%}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:visible;transform:scale(1)}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1;visibility:visible}.art-video-player.art-error .art-progress-indicator,.art-video-player.art-destroy .art-progress-indicator,.art-video-player.art-error .art-progress-tip,.art-video-player.art-destroy .art-progress-tip{display:none!important}.art-video-player.art-mobile .art-bottom{padding:50px 7px 0}.art-video-player.art-mobile .art-bottom .art-controls{height:40px}.art-video-player.art-mobile .art-bottom .art-progress-indicator{visibility:visible!important;transform:scale(1)!important}.art-video-player .art-notice{z-index:80;width:100%;pointer-events:none;padding:10px;font-size:14px;display:none;position:absolute;top:0;left:0}.art-video-player .art-notice .art-notice-inner{color:#fff;background-color:#0009;border-radius:3px;padding:5px 10px;display:inline-block}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;min-width:200px;background-color:#000000e6;border-radius:3px;flex-direction:column;padding:5px 0;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;color:#fff;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;border-bottom:1px solid #ffffff1a;padding:10px 15px;font-size:12px;display:block;overflow:hidden}.art-video-player .art-contextmenus .art-contextmenu a{color:#fff;text-decoration:none}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 7px;display:inline-block}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:#00c9ff}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:0}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;height:auto;max-height:300px;background-color:#000000e6;border-radius:3px;font-size:13px;transition:all .2s;display:none;position:absolute;bottom:50px;right:10px;overflow:auto}.art-video-player .art-settings .art-setting-panel{display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:block}.art-video-player .art-settings .art-setting-panel .art-setting-item{height:35px;cursor:pointer;color:#fffc;justify-content:space-between;align-items:center;padding:0 5px;line-height:1;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover,.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:#fff;background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon{width:30px;height:30px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{white-space:nowrap;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:24px;width:24px;justify-content:center;align-items:center;margin-right:10px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80;margin-right:5px;font-size:12px}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{height:24px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{height:3px;width:80px;appearance:none;background-color:#fff3;outline:0}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:block}.art-video-player.art-mobile .art-settings{max-height:200px}.art-video-player .art-info{z-index:100;width:350px;color:#fff;-webkit-font-smoothing:antialiased;background-color:#000000e6;flex-direction:column;padding:10px;font-family:Noto Sans CJK SC DemiLight,Roboto,Segoe UI,Tahoma,Arial,Helvetica,sans-serif;font-size:12px;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-info .art-info-item{margin-bottom:5px;display:flex}.art-video-player .art-info .art-info-item .art-info-title{width:100px;text-align:right}.art-video-player .art-info .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;flex:1;padding-left:5px;overflow:hidden}.art-video-player .art-info .art-info-item:last-child{margin-bottom:0}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-video-player.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio] video{box-sizing:content-box;object-fit:fill}.art-video-player.art-fullscreen-web{z-index:9999;width:100%;height:100%;position:fixed;inset:0}.art-video-player .art-mini-header{z-index:110;height:35px;color:#fff;opacity:0;visibility:hidden;background-color:#00000080;justify-content:space-between;align-items:center;line-height:35px;transition:all .2s ease-in-out;display:none;position:absolute;top:0;left:0;right:0}.art-video-player .art-mini-header .art-mini-title{text-overflow:ellipsis;white-space:nowrap;cursor:move;flex:1;padding:0 10px;overflow:hidden}.art-video-player .art-mini-header .art-mini-close{width:35px;text-align:center;cursor:pointer;font-size:22px}.art-video-player.art-is-dragging{opacity:.7}.art-video-player.art-mini{z-index:9999;width:400px;height:225px;position:fixed;box-shadow:0 2px 5px #00000029,0 3px 6px #0003}.art-video-player.art-mini .art-mini-header{user-select:none;display:flex}.art-video-player.art-mini.art-hover .art-mini-header{opacity:1;visibility:visible}.art-video-player.art-mini .art-mask .art-state{position:static}.art-video-player.art-mini .art-contextmenu,.art-video-player.art-mini .art-bottom,.art-video-player.art-mini .art-danmu,.art-video-player.art-mini .art-info,.art-video-player.art-mini .art-layers,.art-video-player.art-mini .art-notice,.art-video-player.art-mini .art-settings,.art-video-player.art-mini .art-subtitle{display:none!important}.art-auto-size{justify-content:center;align-items:center;display:flex}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-miniProgressBar{height:2px;background-color:var(--theme);display:block;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-layer-lock{height:34px;width:34px;color:#fff;background-color:#00000080;border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;top:calc(50% - 17px);left:15px}.art-video-player.art-lock .art-bottom{display:none!important}.art-video-player.art-lock .art-subtitle{bottom:10px!important}.art-video-player.art-lock .art-layer-miniProgressBar{display:block!important}.art-video-player.art-control-show .art-layer-miniProgressBar{display:none}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-video-player .art-control-selector{position:relative}.art-video-player .art-control-selector .art-selector-list{min-width:100px;max-width:200px;max-height:200px;text-align:center;color:#fff;background-color:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px;overflow:auto}.art-video-player .art-control-selector .art-selector-list .art-selector-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;padding:0 5px;line-height:30px;overflow:hidden}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover,.art-video-player .art-control-selector .art-selector-list .art-selector-item.art-current{color:#00c9ff}.art-video-player .art-control-selector:hover .art-selector-list{display:block}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000000;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}'},{}],hqjoJ:[function(r,i,t){i.exports=function(){function n(d){return(n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(d)}var a=Object.prototype.toString,o=function(d){if(d===void 0)return"undefined";if(d===null)return"null";var g=n(d);if(g==="boolean")return"boolean";if(g==="string")return"string";if(g==="number")return"number";if(g==="symbol")return"symbol";if(g==="function")return function(E){return l(E)==="GeneratorFunction"}(d)?"generatorfunction":"function";if(function(E){return Array.isArray?Array.isArray(E):E instanceof Array}(d))return"array";if(function(E){return!(!E.constructor||typeof E.constructor.isBuffer!="function")&&E.constructor.isBuffer(E)}(d))return"buffer";if(function(E){try{if(typeof E.length=="number"&&typeof E.callee=="function")return!0}catch(S){if(S.message.indexOf("callee")!==-1)return!0}return!1}(d))return"arguments";if(function(E){return E instanceof Date||typeof E.toDateString=="function"&&typeof E.getDate=="function"&&typeof E.setDate=="function"}(d))return"date";if(function(E){return E instanceof Error||typeof E.message=="string"&&E.constructor&&typeof E.constructor.stackTraceLimit=="number"}(d))return"error";if(function(E){return E instanceof RegExp||typeof E.flags=="string"&&typeof E.ignoreCase=="boolean"&&typeof E.multiline=="boolean"&&typeof E.global=="boolean"}(d))return"regexp";switch(l(d)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(E){return typeof E.throw=="function"&&typeof E.return=="function"&&typeof E.next=="function"}(d))return"generator";switch(g=a.call(d)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return g.slice(8,-1).toLowerCase().replace(/\s/g,"")};function l(d){return d.constructor?d.constructor.name:null}function v(d,g){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return h(d,g,E),f(d,g,E),function(S,x,m){var c=o(x),p=o(S);if(c==="object"){if(p!=="object")throw new Error("[Type Error]: '".concat(m.join("."),"' require 'object' type, but got '").concat(p,"'"));Object.keys(x).forEach(function(y){var u=S[y],_=x[y],b=m.slice();b.push(y),h(u,_,b),f(u,_,b),v(u,_,b)})}if(c==="array"){if(p!=="array")throw new Error("[Type Error]: '".concat(m.join("."),"' require 'array' type, but got '").concat(p,"'"));S.forEach(function(y,u){var _=S[u],b=x[u]||x[0],T=m.slice();T.push(u),h(_,b,T),f(_,b,T),v(_,b,T)})}}(d,g,E),d}function h(d,g,E){if(o(g)==="string"){var S=o(d);if(g[0]==="?"&&(g=g.slice(1)+"|undefined"),!(-1<g.indexOf("|")?g.split("|").map(function(x){return x.toLowerCase().trim()}).filter(Boolean).some(function(x){return S===x}):g.toLowerCase().trim()===S))throw new Error("[Type Error]: '".concat(E.join("."),"' require '").concat(g,"' type, but got '").concat(S,"'"))}}function f(d,g,E){if(o(g)==="function"){var S=g(d,o(d),E);if(S!==!0){var x=o(S);throw x==="string"?new Error(S):x==="error"?S:new Error("[Validator Error]: The scheme for '".concat(E.join("."),"' validator require return true, but got '").concat(S,"'"))}}}return v.kindOf=o,v}()},{}],"7pHuB":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{on(n,a,o){const l=this.e||(this.e={});return(l[n]||(l[n]=[])).push({fn:a,ctx:o}),this}once(n,a,o){const l=this;function v(...h){l.off(n,v),a.apply(o,h)}return v._=a,this.on(n,v,o)}emit(n,...a){const o=((this.e||(this.e={}))[n]||[]).slice();for(let l=0;l<o.length;l+=1)o[l].fn.apply(o[l].ctx,a);return this}off(n,a){const o=this.e||(this.e={}),l=o[n],v=[];if(l&&a)for(let h=0,f=l.length;h<f;h+=1)l[h].fn!==a&&l[h].fn._!==a&&v.push(l[h]);return v.length?o[n]=v:delete o[n],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(r,i,t){t.interopDefault=function(n){return n&&n.__esModule?n:{default:n}},t.defineInteropFlag=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.exportAll=function(n,a){return Object.keys(n).forEach(function(o){o==="default"||o==="__esModule"||a.hasOwnProperty(o)||Object.defineProperty(a,o,{enumerable:!0,get:function(){return n[o]}})}),a},t.export=function(n,a,o){Object.defineProperty(n,a,{enumerable:!0,get:o})}},{}],geSvU:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./dom");n.exportAll(a,t);var o=r("./error");n.exportAll(o,t);var l=r("./subtitle");n.exportAll(l,t);var v=r("./file");n.exportAll(v,t);var h=r("./property");n.exportAll(h,t);var f=r("./time");n.exportAll(f,t);var d=r("./format");n.exportAll(d,t);var g=r("./compatibility");n.exportAll(g,t)},{"./dom":"ff6Hs","./error":"lDQPM","./subtitle":"1dyFb","./file":"96gQe","./property":"lMM6V","./time":"41yFW","./format":"MRJhs","./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ff6Hs:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"query",()=>o),n.export(t,"queryAll",()=>l),n.export(t,"addClass",()=>v),n.export(t,"removeClass",()=>h),n.export(t,"hasClass",()=>f),n.export(t,"append",()=>d),n.export(t,"remove",()=>g),n.export(t,"setStyle",()=>E),n.export(t,"setStyles",()=>S),n.export(t,"getStyle",()=>x),n.export(t,"sublings",()=>m),n.export(t,"inverseClass",()=>c),n.export(t,"tooltip",()=>p),n.export(t,"isInViewport",()=>y),n.export(t,"includeFromEvent",()=>u),n.export(t,"replaceElement",()=>_);var a=r("./compatibility");function o(b,T=document){return T.querySelector(b)}function l(b,T=document){return Array.from(T.querySelectorAll(b))}function v(b,T){return b.classList.add(T)}function h(b,T){return b.classList.remove(T)}function f(b,T){return b.classList.contains(T)}function d(b,T){return T instanceof Element?b.appendChild(T):b.insertAdjacentHTML("beforeend",String(T)),b.lastElementChild||b.lastChild}function g(b){return b.parentNode.removeChild(b)}function E(b,T,A){return b.style[T]=A,b}function S(b,T){return Object.keys(T).forEach(A=>{E(b,A,T[A])}),b}function x(b,T,A=!0){const L=window.getComputedStyle(b,null).getPropertyValue(T);return A?parseFloat(L):L}function m(b){return Array.from(b.parentElement.children).filter(T=>T!==b)}function c(b,T){m(b).forEach(A=>h(A,T)),v(b,T)}function p(b,T,A="top"){a.isMobile||(b.setAttribute("aria-label",T),v(b,"hint--rounded"),v(b,`hint--${A}`))}function y(b,T=0){const A=b.getBoundingClientRect(),L=window.innerHeight||document.documentElement.clientHeight,R=window.innerWidth||document.documentElement.clientWidth,w=A.top-T<=L&&A.top+A.height+T>=0,O=A.left-T<=R+T&&A.left+A.width+T>=0;return w&&O}function u(b,T){return b.composedPath&&b.composedPath().indexOf(T)>-1}function _(b,T){return T.parentNode.replaceChild(b,T),b}},{"./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ki3pQ:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"userAgent",()=>a),n.export(t,"isMobile",()=>o),n.export(t,"isSafari",()=>l),n.export(t,"isWechat",()=>v),n.export(t,"isIE",()=>h),n.export(t,"isAndroid",()=>f),n.export(t,"isIOS",()=>d);const a=typeof window!="undefined"?window.navigator.userAgent:"",o=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a),l=/^((?!chrome|android).)*safari/i.test(a),v=/MicroMessenger/i.test(a),h=/MSIE|Trident/i.test(a),f=/android/i.test(a),d=/iPad|iPhone|iPod/i.test(a)&&!window.MSStream},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lDQPM:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"ArtPlayerError",()=>a),n.export(t,"errorHandle",()=>o);class a extends Error{constructor(v,h){super(v),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,h||this.constructor),this.name="ArtPlayerError"}}function o(l,v){if(!l)throw new a(v);return l}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1dyFb":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(v){return`WEBVTT \r
\r
`.concat((h=v,h.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(f,d,g)=>{let E=g.slice(0,3);return g.length===1&&(E=g+"00"),g.length===2&&(E=g+"0"),`${d},${E}`})).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat(`\r
\r
`));var h}function o(v){return URL.createObjectURL(new Blob([v],{type:"text/vtt"}))}function l(v){const h=new RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function f(d=""){return d.split(/[:.]/).map((g,E,S)=>{if(E===S.length-1){if(g.length===1)return`.${g}00`;if(g.length===2)return`.${g}0`}else if(g.length===1)return(E===0?"0":":0")+g;return E===0?g:E===S.length-1?`.${g}`:`:${g}`}).join("")}return`WEBVTT

${v.split(/\r?\n/).map(d=>{const g=d.match(h);return g?{start:f(g[1].trim()),end:f(g[2].trim()),text:g[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(E=>E.trim()).join(`
`)}:null}).filter(d=>d).map((d,g)=>d?`${g+1}
${d.start} --> ${d.end}
${d.text}`:"").filter(d=>d.trim()).join(`

`)}`}n.defineInteropFlag(t),n.export(t,"srtToVtt",()=>a),n.export(t,"vttToBlob",()=>o),n.export(t,"assToVtt",()=>l)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"96gQe":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(l){return l.includes("?")?a(l.split("?")[0]):l.includes("#")?a(l.split("#")[0]):l.trim().toLowerCase().split(".").pop()}function o(l,v){const h=document.createElement("a");h.style.display="none",h.href=l,h.download=v,document.body.appendChild(h),h.click(),document.body.removeChild(h)}n.defineInteropFlag(t),n.export(t,"getExt",()=>a),n.export(t,"download",()=>o)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lMM6V:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"def",()=>a),n.export(t,"has",()=>l),n.export(t,"get",()=>v),n.export(t,"mergeDeep",()=>h);const a=Object.defineProperty,{hasOwnProperty:o}=Object.prototype;function l(f,d){return o.call(f,d)}function v(f,d){return Object.getOwnPropertyDescriptor(f,d)}function h(...f){const d=g=>g&&typeof g=="object"&&!Array.isArray(g);return f.reduce((g,E)=>(Object.keys(E).forEach(S=>{const x=g[S],m=E[S];Array.isArray(x)&&Array.isArray(m)?g[S]=x.concat(...m):!d(x)||!d(m)||m instanceof Element?g[S]=m:g[S]=h(x,m)}),g),{})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"41yFW":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(v=0){return new Promise(h=>setTimeout(h,v))}function o(v,h,f){let d;function g(...E){clearTimeout(d),d=setTimeout(function(){d=null,v.apply(f,E)},h)}return g.clearTimeout=function(){clearTimeout(d)},g}function l(v,h){let f,d,g=!1;return function E(...S){if(g)return f=S,void(d=this);g=!0,v.apply(this,S),setTimeout(()=>{g=!1,f&&(E.apply(d,f),f=null,d=null)},h)}}n.defineInteropFlag(t),n.export(t,"sleep",()=>a),n.export(t,"debounce",()=>o),n.export(t,"throttle",()=>l)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],MRJhs:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function a(v,h,f){return Math.max(Math.min(v,Math.max(h,f)),Math.min(h,f))}function o(v){const h=Math.floor(v/3600),f=Math.floor((v-3600*h)/60),d=Math.floor(v-3600*h-60*f);return(h>0?[h,f,d]:[f,d]).map(g=>g<10?`0${g}`:String(g)).join(":")}function l(v){return v.replace(/[&<>'"]/g,h=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[h]||h)}n.defineInteropFlag(t),n.export(t,"clamp",()=>a),n.export(t,"secondToTime",()=>o),n.export(t,"escape",()=>l)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3vPoh":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"ComponentOption",()=>E);var a=r("../utils");const o="array",l="boolean",v="string",h="number",f="object",d="function";function g(S,x,m){return a.errorHandle(x===v||x===h||S instanceof Element,`${m.join(".")} require '${v}' or 'Element' type`)}const E={html:g,disable:`?${l}`,name:`?${v}`,index:`?${h}`,style:`?${f}`,click:`?${d}`,mounted:`?${d}`,tooltip:`?${v}|${h}`,width:`?${h}`,selector:`?${o}`,onSelect:`?${d}`,switch:`?${l}`,onSwitch:`?${d}`,range:`?${o}`,onRange:`?${d}`};t.default={container:g,url:v,poster:v,title:v,type:v,theme:v,lang:v,volume:h,isLive:l,muted:l,autoplay:l,autoSize:l,autoMini:l,loop:l,flip:l,playbackRate:l,aspectRatio:l,screenshot:l,setting:l,hotkey:l,pip:l,mutex:l,backdrop:l,fullscreen:l,fullscreenWeb:l,subtitleOffset:l,miniProgressBar:l,useSSR:l,playsInline:l,lock:l,fastForward:l,autoPlayback:l,autoOrientation:l,ads:[{url:v}],plugins:[d],whitelist:[`${v}|${d}|regexp`],layers:[E],contextmenu:[E],settings:[E],controls:[Ot(yt({},E),{position:(S,x,m)=>{const c=["top","left","right"];return a.errorHandle(c.includes(S),`${m.join(".")} only accept ${c.toString()} as parameters`)}})],quality:[{default:`?${l}`,html:v,url:v}],highlight:[{time:h,text:v}],thumbnails:{url:v,number:h,column:h},subtitle:{url:v,type:v,style:f,encoding:v},moreVideoAttr:f,icons:f,customType:f}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eksZR:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fCKwj:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a}get state(){const{option:a,constructor:{kindOf:o}}=this.art;return!n.isMobile||a.whitelist.some(l=>{switch(o(l)){case"string":return l==="*"||n.userAgent.indexOf(l)>-1;case"function":return l(n.userAgent);case"regexp":return l.test(n.userAgent);default:return!1}})}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bqHdK:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");class a{constructor(l){this.art=l;const{option:v,constructor:h,whitelist:f}=l;v.container instanceof Element?this.$container=v.container:(this.$container=n.query(v.container),n.errorHandle(this.$container,`No container element found by ${v.container}`));const d=this.$container.tagName.toLowerCase();n.errorHandle(d==="div",`Unsupported container element type, only support 'div' but got '${d}'`),n.errorHandle(h.instances.every(g=>g.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=l.id,this.$original=this.$container.cloneNode(!0),f.state?this.desktop():this.mobile()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show"><video class="art-video"></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">4.4.1</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span> x <span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-mini-header"><div class="art-mini-title"></div><div class="art-mini-close">\xD7</div></div><div class="art-contextmenus"></div></div>'}query(l){return n.query(l,this.$container)}desktop(){const{option:l}=this.art;l.useSSR||(this.$container.innerHTML=a.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$miniHeader=this.query(".art-mini-header"),this.$miniTitle=this.query(".art-mini-title"),this.$miniClose=this.query(".art-mini-close"),this.$contextmenu=this.query(".art-contextmenus"),l.backdrop&&(n.addClass(this.$setting,"art-backdrop-filter"),n.addClass(this.$contextmenu,"art-backdrop-filter"),n.addClass(this.$info,"art-backdrop-filter")),n.isMobile&&n.addClass(this.$player,"art-mobile")}mobile(){this.$container.innerHTML='<div class="art-video-player"><video class="art-video"></video></div>',this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video")}destroy(l){l?n.replaceElement(this.$original,this.$container):n.addClass(this.$player,"art-destroy")}}t.default=a},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4O9ZY":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("./zh-cn.json"),l=n.interopDefault(o),v=r("./zh-tw.json"),h=n.interopDefault(v),f=r("./pl.json"),d=n.interopDefault(f),g=r("./cs.json"),E=n.interopDefault(g);t.default=class{constructor(S){this.art=S,this.languages={"zh-cn":l.default,"zh-tw":h.default,pl:d.default,cs:E.default},this.init()}init(){const S=this.art.option.lang.toLowerCase();this.language=this.languages[S]||{}}get(S){return this.language[S]||S}update(S){this.languages=a.mergeDeep(this.languages,S),this.init()}}},{"../utils":"geSvU","./zh-cn.json":"e7BQ4","./zh-tw.json":"5kFyN","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","./pl.json":"3cd1e","./cs.json":"an7cR"}],e7BQ4:[function(r,i,t){i.exports=JSON.parse('{"Video Info":"\u7EDF\u8BA1\u4FE1\u606F","Close":"\u5173\u95ED","Video Load Failed":"\u52A0\u8F7D\u5931\u8D25","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u6682\u505C","Rate":"\u901F\u5EA6","Mute":"\u9759\u97F3","Video Flip":"\u753B\u9762\u7FFB\u8F6C","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u8FDE\u63A5","Show Setting":"\u663E\u793A\u8BBE\u7F6E","Hide Setting":"\u9690\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u56FE","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u753B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8BA4","Normal":"\u6B63\u5E38","Open":"\u6253\u5F00","Switch Video":"\u5207\u6362","Switch Subtitle":"\u5207\u6362\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7F51\u9875\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7F51\u9875\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u5F00\u542F\u753B\u4E2D\u753B","Exit PIP Mode":"\u9000\u51FA\u753B\u4E2D\u753B","PIP Not Supported":"\u4E0D\u652F\u6301\u753B\u4E2D\u753B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Auto playback at":"\u5DF2\u4E3A\u60A8\u5B9A\u4F4D\u81F3"}')},{}],"5kFyN":[function(r,i,t){i.exports=JSON.parse('{"Video Info":"\u7D71\u8A08\u8A0A\u606F","Close":"\u95DC\u9589","Video Load Failed":"\u8F09\u5165\u5931\u6557","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u66AB\u505C","Rate":"\u901F\u5EA6","Mute":"\u975C\u97F3","Video Flip":"\u756B\u9762\u7FFB\u8F49","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u9023\u63A5","Show Setting":"\u986F\u793A\u8BBE\u7F6E","Hide Setting":"\u96B1\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u5716","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u756B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8A8D","Normal":"\u6B63\u5E38","Open":"\u6253\u958B","Switch Video":"\u5207\u63DB","Switch Subtitle":"\u5207\u63DB\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7DB2\u9801\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7DB2\u9801\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u958B\u555F\u756B\u4E2D\u756B","Exit PIP Mode":"\u9000\u51FA\u756B\u4E2D\u756B","PIP Not Supported":"\u4E0D\u652F\u6301\u756B\u4E2D\u756B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Auto playback at":"\u5DF2\u70BA\u60A8\u5B9A\u4F4D\u81F3"}')},{}],"3cd1e":[function(r,i,t){i.exports=JSON.parse('{"Video Info":"Informacje o wideo","Close":"Zamknij","Video Load Failed":"B\u0142\u0105d \u0142adowania wideo","Volume":"G\u0142o\u015Bno\u015B\u0107","Play":"Odtw\xF3rz","Pause":"Wstrzymaj","Rate":"Oce\u0144","Mute":"Wycisz","Video Flip":"Rotacja wideo","Horizontal":"Pozioma","Vertical":"Pionowa","Reconnect":"Po\u0142\u0105cz ponownie","Show Setting":"Poka\u017C ustawienia","Hide Setting":"Ukryj ustawienia","Screenshot":"Zrzut ekranu","Play Speed":"Pr\u0119dko\u015B\u0107 odtwarzania","Aspect Ratio":"Wsp\xF3\u0142czynnik proporcji","Default":"Domy\u015Blny","Normal":"Normalny","Open":"Otw\xF3rz","Switch Video":"Prze\u0142\u0105cz wideo","Switch Subtitle":"Prze\u0142\u0105cz napisy","Fullscreen":"Pe\u0142ny ekran","Exit Fullscreen":"Zamknij pe\u0142ny ekran","Web Fullscreen":"Tryb pe\u0142nej strony","Exit Web Fullscreen":"Zamknij tryb pe\u0142nej strony","Mini Player":"Miniodtwarzacz","PIP Mode":"Tryb PiP","Exit PIP Mode":"Zamknij tryb PiP","PIP Not Supported":"Tryb PiP nieobs\u0142ugiwany","Fullscreen Not Supported":"Pe\u0142ny ekran nieobs\u0142ugiwany","Subtitle Offset":"Przesuni\u0119cie napis\xF3w","Auto playback at":"Automatyczne odtwarzanie za"}')},{}],an7cR:[function(r,i,t){i.exports=JSON.parse('{"Video Info":"Info o videu","Close":"Zav\u0159\xEDt","Video Load Failed":"Nahr\xE1n\xED videa selhalo","Volume":"Hlasitost","Play":"P\u0159ehr\xE1t","Pause":"Pozastavit","Rate":"Hodnocen\xED","Mute":"Ztlumit","Video Flip":"Oto\u010Dit video","Horizontal":"Horizont\xE1ln\u011B","Vertical":"Vertik\xE1ln\u011B","Reconnect":"Op\u011Btovn\xE9 p\u0159ipojen\xED","Show Setting":"Zobrazit nastaven\xED","Hide Setting":"Skr\xFDt nastaven\xED","Screenshot":"Sn\xEDmek obrazovky","Play Speed":"Rychlost p\u0159ehr\xE1v\xE1n\xED","Aspect Ratio":"Pom\u011Br stran","Default":"V\xFDchoz\xED","Normal":"Norm\xE1ln\xED","Open":"Otev\u0159\xEDt","Switch Video":"P\u0159epnout video","Switch Subtitle":"P\u0159epnout titulky","Fullscreen":"Cel\xE1 obrazovka","Exit Fullscreen":"Opustit re\u017Eim cel\xE9 obrazovky","Web Fullscreen":"Cel\xE1 str\xE1nka","Exit Web Fullscreen":"Zav\u0159\xEDt re\u017Eim cel\xE9 str\xE1nky","Mini Player":"Mini p\u0159ehr\xE1va\u010D","PIP Mode":"Re\u017Eim PIP","Exit PIP Mode":"Opustit re\u017Eim PIP","PIP Not Supported":"Re\u017Eim PIP nen\xED podporov\xE1n","Fullscreen Not Supported":"Re\u017Eim cel\xE9 obrazovky nen\xED podporov\xE1n","Subtitle Offset":"Posun titulk\u016F","Auto playback at":"Automatick\xE9 p\u0159ehr\xE1v\xE1n\xED za"}')},{}],fzROd:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./urlMix"),o=n.interopDefault(a),l=r("./attrMix"),v=n.interopDefault(l),h=r("./playMix"),f=n.interopDefault(h),d=r("./pauseMix"),g=n.interopDefault(d),E=r("./toggleMix"),S=n.interopDefault(E),x=r("./seekMix"),m=n.interopDefault(x),c=r("./volumeMix"),p=n.interopDefault(c),y=r("./currentTimeMix"),u=n.interopDefault(y),_=r("./durationMix"),b=n.interopDefault(_),T=r("./switchMix"),A=n.interopDefault(T),L=r("./playbackRateMix"),R=n.interopDefault(L),w=r("./aspectRatioMix"),O=n.interopDefault(w),I=r("./screenshotMix"),D=n.interopDefault(I),C=r("./fullscreenMix"),P=n.interopDefault(C),M=r("./fullscreenWebMix"),N=n.interopDefault(M),B=r("./pipMix"),U=n.interopDefault(B),F=r("./loadedMix"),j=n.interopDefault(F),V=r("./playedMix"),G=n.interopDefault(V),Y=r("./playingMix"),X=n.interopDefault(Y),ie=r("./autoSizeMix"),he=n.interopDefault(ie),de=r("./rectMix"),Ae=n.interopDefault(de),pe=r("./flipMix"),le=n.interopDefault(pe),Ie=r("./miniMix"),Ce=n.interopDefault(Ie),Ue=r("./loopMix"),Me=n.interopDefault(Ue),ze=r("./posterMix"),Ge=n.interopDefault(ze),$e=r("./autoHeightMix"),Ke=n.interopDefault($e),Ne=r("./themeMix"),Te=n.interopDefault(Ne),et=r("./titleMix"),st=n.interopDefault(et),qe=r("./normalSizeMix"),ot=n.interopDefault(qe),nt=r("./subtitleOffsetMix"),dt=n.interopDefault(nt),ne=r("./optionInit"),Ee=n.interopDefault(ne),xe=r("./eventInit"),we=n.interopDefault(xe);t.default=class{constructor(be){o.default(be),v.default(be),f.default(be),g.default(be),S.default(be),m.default(be),p.default(be),u.default(be),b.default(be),A.default(be),R.default(be),O.default(be),D.default(be),P.default(be),N.default(be),U.default(be),j.default(be),G.default(be),X.default(be),he.default(be),Ae.default(be),le.default(be),Ce.default(be),Me.default(be),Ge.default(be),Ke.default(be),Te.default(be),st.default(be),ot.default(be),dt.default(be),we.default(be),Ee.default(be)}}},{"./urlMix":"cChak","./attrMix":"e6Qkm","./playMix":"1FNSV","./pauseMix":"aPHUd","./toggleMix":"joISC","./seekMix":"4wG3e","./volumeMix":"42Xo1","./currentTimeMix":"8Z3pM","./durationMix":"hpnJy","./switchMix":"aCsa8","./playbackRateMix":"61TVa","./aspectRatioMix":"8BV9k","./screenshotMix":"bop8O","./fullscreenMix":"i63VK","./fullscreenWebMix":"bEKHA","./pipMix":"ibIuh","./loadedMix":"kwpxq","./playedMix":"e4Iws","./playingMix":"fueZP","./autoSizeMix":"l6TMg","./rectMix":"6URTt","./flipMix":"joth7","./miniMix":"durkk","./loopMix":"5EZwI","./posterMix":"22WMt","./autoHeightMix":"8pdNr","./themeMix":"eADqm","./titleMix":"8T9U6","./subtitleOffsetMix":"8CMLG","./optionInit":"aqLU7","./eventInit":"59ETf","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","./normalSizeMix":"iEQHG"}],cChak:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$video:l}}=a;n.def(a,"url",{get:()=>l.currentSrc,set(v){return yr(this,null,function*(){const h=o.type||n.getExt(v),f=o.customType[h];h&&f?(yield n.sleep(),a.loading.show=!0,f.call(a,l,v,a)):(a.url&&a.url!==v&&a.once("video:canplay",()=>{a.isReady&&a.emit("restart")}),l.src=v,a.option.url=v,a.emit("url",v))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e6Qkm:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o}}=a;n.def(a,"attr",{value(l,v){if(v===void 0)return o[l];o[l]=v}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1FNSV":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,notice:l,option:v,constructor:{instances:h},template:{$video:f}}=a;n.def(a,"play",{value(){const d=f.play();if(d&&d.then&&d.then().catch(g=>{throw l.show=g,g}),v.mutex)for(let g=0;g<h.length;g++){const E=h[g];E!==a&&E.pause()}return l.show=o.get("Play"),a.emit("play"),d}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPHUd:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:l,notice:v}=a;n.def(a,"pause",{value(){const h=o.pause();return v.show=l.get("Pause"),a.emit("pause"),h}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joISC:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"toggle",{value:()=>a.playing?a.pause():a.play()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4wG3e":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{notice:o}=a;n.def(a,"seek",{set(l){a.currentTime=l,a.emit("seek",a.currentTime),a.duration&&(o.show=`${n.secondToTime(a.currentTime)} / ${n.secondToTime(a.duration)}`)}}),n.def(a,"forward",{set(l){a.seek=a.currentTime+l}}),n.def(a,"backward",{set(l){a.seek=a.currentTime-l}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"42Xo1":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:l,notice:v,storage:h}=a;n.def(a,"volume",{get:()=>o.volume||0,set:f=>{o.volume=n.clamp(f,0,1),v.show=`${l.get("Volume")}: ${parseInt(100*o.volume,10)}`,o.volume!==0&&h.set("volume",o.volume),a.emit("volume",o.volume)}}),n.def(a,"muted",{get:()=>o.muted,set:f=>{o.muted=f,a.emit("volume",o.volume)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8Z3pM":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"currentTime",{get:()=>o.currentTime||0,set:l=>{l=parseFloat(l),Number.isNaN(l)||(o.currentTime=n.clamp(l,0,a.duration))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],hpnJy:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"duration",{get:()=>{const{duration:o}=a.template.$video;return o===1/0?0:o||0}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aCsa8:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,option:l,notice:v}=a;function h(f,d,g){return new Promise(E=>{if(f===a.url)return E(f);const{playing:S}=a;a.pause(),URL.revokeObjectURL(a.url),a.url=f,a.once("video:canplay",()=>{a.playbackRate=!1,a.aspectRatio=!1,a.flip="normal",a.autoSize=l.autoSize,a.currentTime=g,a.notice.show="",S&&a.play(),d&&(v.show=`${o.get("Switch Video")}: ${d}`),a.emit("switch",f),E(f)})})}n.def(a,"switchQuality",{value:(f,d)=>h(f,d,a.currentTime)}),n.def(a,"switchUrl",{value:(f,d)=>h(f,d,0)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"61TVa":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o},i18n:l,notice:v}=a;n.def(a,"playbackRate",{get:()=>o.playbackRate,set(h){if(h){if(h===o.playbackRate)return;const f=[.25,.5,.75,1,1.25,1.5,1.75,2,3,4];n.errorHandle(f.includes(h),`'playbackRate' only accept ${f.toString()} as parameters`),o.playbackRate=h,v.show=`${l.get("Rate")}: ${h===1?l.get("Normal"):`${h}x`}`,a.emit("playbackRate",h)}else a.playbackRate=1,a.emit("playbackRate")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8BV9k":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$video:o,$player:l},i18n:v,notice:h}=a;n.def(a,"aspectRatio",{get:()=>l.dataset.aspectRatio||"default",set(f){f||(f="default");const d=["default","4:3","16:9"];if(n.errorHandle(d.includes(f),`'aspectRatio' only accept ${d.toString()} as parameters`),f==="default")n.setStyle(o,"width",null),n.setStyle(o,"height",null),n.setStyle(o,"padding",null),delete l.dataset.aspectRatio;else{const g=f.split(":").map(Number),{videoWidth:E,videoHeight:S}=o,{clientWidth:x,clientHeight:m}=l,c=E/S,p=g[0]/g[1];if(c>p){const y=p*S/E;n.setStyle(o,"width",100*y+"%"),n.setStyle(o,"height","100%"),n.setStyle(o,"padding",`0 ${(x-x*y)/2}px`)}else{const y=E/p/S;n.setStyle(o,"width","100%"),n.setStyle(o,"height",100*y+"%"),n.setStyle(o,"padding",(m-m*y)/2+"px 0")}l.dataset.aspectRatio=f}h.show=`${v.get("Aspect Ratio")}: ${f==="default"?v.get("Default"):f}`,a.emit("aspectRatio",f)}}),n.def(a,"aspectRatioReset",{set(f){if(f){const{aspectRatio:d}=a;a.aspectRatio=d}}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bop8O:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,notice:l,template:{$video:v}}=a,h=document.createElement("canvas");n.def(a,"getDataURL",{value:()=>new Promise((f,d)=>{try{h.width=v.videoWidth,h.height=v.videoHeight,h.getContext("2d").drawImage(v,0,0),f(h.toDataURL("image/png"))}catch(g){l.show=g,d(g)}})}),n.def(a,"getBlobUrl",{value:()=>new Promise((f,d)=>{try{h.width=v.videoWidth,h.height=v.videoHeight,h.getContext("2d").drawImage(v,0,0),h.toBlob(g=>{f(URL.createObjectURL(g))})}catch(g){l.show=g,d(g)}})}),n.def(a,"screenshot",{value:()=>yr(this,null,function*(){const f=yield a.getDataURL();return n.download(f,`${o.title||"artplayer"}_${n.secondToTime(v.currentTime)}.png`),a.emit("screenshot",f),f})})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i63VK:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../libs/screenfull"),o=n.interopDefault(a),l=r("../utils");t.default=function(v){const{i18n:h,notice:f,template:{$video:d,$player:g}}=v,E=o.default();v.once("video:loadedmetadata",()=>{var S;E.isEnabled?(S=v,E.on("change",()=>S.emit("fullscreen",E.isFullscreen)),l.def(S,"fullscreen",{get:()=>E.isFullscreen,set(x){return yr(this,null,function*(){x?(S.normalSize="fullscreen",S.aspectRatioReset=!0,S.autoSize=!1,yield E.request(g),l.addClass(g,"art-fullscreen"),S.emit("resize"),S.emit("fullscreen",!0),f.show=""):(S.aspectRatioReset=!0,S.autoSize=S.option.autoSize,yield E.exit(),l.removeClass(g,"art-fullscreen"),S.emit("resize"),S.emit("fullscreen"),f.show="")})}})):document.fullscreenEnabled||d.webkitSupportsFullscreen?(x=>{l.def(x,"fullscreen",{get:()=>d.webkitDisplayingFullscreen,set(m){m?(x.normalSize="fullscreen",d.webkitEnterFullscreen(),x.emit("fullscreen",!0),f.show=""):(d.webkitExitFullscreen(),x.emit("fullscreen"),f.show="")}})})(v):l.def(v,"fullscreen",{get:()=>!1,set(){f.show=h.get("Fullscreen Not Supported")}}),l.def(v,"fullscreen",l.get(v,"fullscreen"))})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","../libs/screenfull":"aPwar"}],aPwar:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(){const n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=(()=>{const v=n[0],h={};for(const f of n)if(f[1]in document){for(const[d,g]of f.entries())h[v[d]]=g;return h}return!1})(),o={change:a.fullscreenchange,error:a.fullscreenerror};let l={request:(v=document.documentElement,h)=>new Promise((f,d)=>{const g=()=>{l.off("change",g),f()};l.on("change",g);const E=v[a.requestFullscreen](h);E instanceof Promise&&E.then(g).catch(d)}),exit:()=>new Promise((v,h)=>{if(!l.isFullscreen)return void v();const f=()=>{l.off("change",f),v()};l.on("change",f);const d=document[a.exitFullscreen]();d instanceof Promise&&d.then(f).catch(h)}),toggle:(v,h)=>l.isFullscreen?l.exit():l.request(v,h),onchange(v){l.on("change",v)},onerror(v){l.on("error",v)},on(v,h){const f=o[v];f&&document.addEventListener(f,h,!1)},off(v,h){const f=o[v];f&&document.removeEventListener(f,h,!1)},raw:a};return Object.defineProperties(l,{isFullscreen:{get:()=>Boolean(document[a.fullscreenElement])},element:{enumerable:!0,get:()=>document[a.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>Boolean(document[a.fullscreenEnabled])}}),a||(l={isEnabled:!1}),l}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bEKHA:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{notice:o,template:{$player:l}}=a;n.def(a,"fullscreenWeb",{get:()=>n.hasClass(l,"art-fullscreen-web"),set(v){v?(a.normalSize="fullscreenWeb",n.addClass(l,"art-fullscreen-web"),a.aspectRatioReset=!0,a.autoSize=!1,a.emit("resize"),a.emit("fullscreenWeb",!0),o.show=""):(n.removeClass(l,"art-fullscreen-web"),a.aspectRatioReset=!0,a.autoSize=a.option.autoSize,a.emit("resize"),a.emit("fullscreenWeb"),o.show="")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ibIuh:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,notice:l,template:{$video:v}}=a;document.pictureInPictureEnabled?function(h){const{template:{$video:f},events:{proxy:d},notice:g}=h;f.disablePictureInPicture=!1,n.def(h,"pip",{get:()=>document.pictureInPictureElement,set(E){E?(h.normalSize="pip",f.requestPictureInPicture().catch(S=>{throw g.show=S,S})):document.exitPictureInPicture().catch(S=>{throw g.show=S,S})}}),d(f,"enterpictureinpicture",()=>{h.emit("pip",!0)}),d(f,"leavepictureinpicture",()=>{h.emit("pip")})}(a):v.webkitSupportsPresentationMode?function(h){const{$video:f}=h.template;f.webkitSetPresentationMode("inline"),n.def(h,"pip",{get:()=>f.webkitPresentationMode==="picture-in-picture",set(d){d?(h.normalSize="pip",f.webkitSetPresentationMode("picture-in-picture"),h.emit("pip",!0)):(f.webkitSetPresentationMode("inline"),h.emit("pip"))}})}(a):n.def(a,"pip",{get:()=>!1,set(){l.show=o.get("PIP Not Supported")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kwpxq:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"loaded",{get:()=>a.loadedTime/o.duration}),n.def(a,"loadedTime",{get:()=>o.buffered.length?o.buffered.end(o.buffered.length-1):0})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e4Iws:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"played",{get:()=>a.currentTime/a.duration})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fueZP:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$video:o}=a.template;n.def(a,"playing",{get:()=>o.currentTime>0&&!o.paused&&!o.ended&&o.readyState>2})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],l6TMg:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{$container:o,$player:l,$video:v}=a.template;n.def(a,"autoSize",{get:()=>n.hasClass(o,"art-auto-size"),set(h){if(h){const{videoWidth:f,videoHeight:d}=v,{width:g,height:E}=o.getBoundingClientRect(),S=f/d,x=g/E;if(n.addClass(o,"art-auto-size"),x>S){const m=E*S/g*100;n.setStyle(l,"width",`${m}%`),n.setStyle(l,"height","100%")}else{const m=g/S/E*100;n.setStyle(l,"width","100%"),n.setStyle(l,"height",`${m}%`)}a.emit("autoSize",{width:a.width,height:a.height})}else n.removeClass(o,"art-auto-size"),n.setStyle(l,"width",null),n.setStyle(l,"height",null),a.emit("autoSize")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"6URTt":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"rect",{get:()=>a.template.$player.getBoundingClientRect()});const o=["bottom","height","left","right","top","width"];for(let l=0;l<o.length;l++){const v=o[l];n.def(a,v,{get:()=>a.rect[v]})}n.def(a,"x",{get:()=>a.left+window.pageXOffset}),n.def(a,"y",{get:()=>a.top+window.pageYOffset})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joth7:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{template:{$player:o},i18n:l,notice:v}=a;n.def(a,"flip",{get:()=>o.dataset.flip||"normal",set(h){h||(h="normal");const f=["normal","horizontal","vertical"];n.errorHandle(f.includes(h),`'flip' only accept ${f.toString()} as parameters`),h==="normal"?delete o.dataset.flip:o.dataset.flip=h;const d=h.replace(h[0],h[0].toUpperCase());v.show=`${l.get("Video Flip")}: ${l.get(d)}`,a.emit("flip",h)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],durkk:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,option:l,storage:v,events:{proxy:h},template:{$player:f,$miniClose:d,$miniTitle:g,$miniHeader:E}}=a;let S="",x=!1,m=0,c=0,p=0,y=0;h(E,"mousedown",u=>{x=!0,m=u.pageX,c=u.pageY,p=a.left,y=a.top}),h(document,"mousemove",u=>{if(x){n.addClass(f,"art-is-dragging");const _=y+u.pageY-c,b=p+u.pageX-m;n.setStyle(f,"top",`${_}px`),n.setStyle(f,"left",`${b}px`),v.set("top",_),v.set("left",b)}}),h(document,"mouseup",()=>{x=!1,n.removeClass(f,"art-is-dragging")}),h(d,"click",()=>{a.mini=!1,x=!1,n.removeClass(f,"art-is-dragging")}),n.append(g,l.title||o.get("Mini Player")),n.def(a,"mini",{get:()=>n.hasClass(f,"art-mini"),set(u){if(u){a.normalSize="mini",a.autoSize=!1,S=f.style.cssText,n.addClass(f,"art-mini");const _=v.get("top"),b=v.get("left");if(_&&b)n.setStyle(f,"top",`${_}px`),n.setStyle(f,"left",`${b}px`),n.isInViewport(E)||(v.del("top"),v.del("left"),a.mini=!0);else{const T=document.body,A=T.clientHeight-a.height-50,L=T.clientWidth-a.width-50;v.set("top",A),v.set("left",L),n.setStyle(f,"top",`${A}px`),n.setStyle(f,"left",`${L}px`)}a.aspectRatio=!1,a.playbackRate=!1,a.notice.show="",a.emit("mini",!0)}else f.style.cssText=S,n.removeClass(f,"art-mini"),n.setStyle(f,"top",null),n.setStyle(f,"left",null),a.aspectRatio=!1,a.playbackRate=!1,a.autoSize=l.autoSize,a.notice.show="",a.emit("mini")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5EZwI":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){let o=[];n.def(a,"loop",{get:()=>o,set:l=>{if(Array.isArray(l)&&typeof l[0]=="number"&&typeof l[1]=="number"){const v=n.clamp(l[0],0,Math.min(l[1],a.duration)),h=n.clamp(l[1],v,a.duration);h-v>=1?(o=[v,h],a.emit("loop",o)):(o=[],a.emit("loop"))}else o=[],a.emit("loop")}}),a.on("video:timeupdate",()=>{o.length&&(a.currentTime<o[0]||a.currentTime>o[1])&&(a.seek=o[0])})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"22WMt":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$poster:l}}=a;n.def(a,"poster",{get:()=>o.poster,set(v){o.poster=v,n.setStyle(l,"backgroundImage",`url(${v})`)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8pdNr":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$container:l,$video:v}}=a,h=l.style.height;n.def(a,"autoHeight",{get:()=>n.hasClass(l,"art-auto-height"),set(f){if(f){const{clientWidth:d}=l,{videoHeight:g,videoWidth:E}=v,S=g*(d/E);n.setStyle(l,"height",S+"px"),n.addClass(l,"art-auto-height"),a.autoSize=o.autoSize,a.emit("autoHeight",S)}else n.setStyle(l,"height",h),n.removeClass(l,"art-auto-height"),a.autoSize=o.autoSize,a.emit("autoHeight")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eADqm:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,template:{$player:l}}=a;n.def(a,"theme",{get:()=>getComputedStyle(l).getPropertyValue("--theme"),set(v){o.theme=v,l.style.setProperty("--theme",v)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8T9U6":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){n.def(a,"title",{get:()=>a.option.title,set(o){a.option.title=o}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8CMLG":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{clamp:o}=a.constructor.utils,{notice:l,template:v,i18n:h}=a;let f=0,d=[];a.on("subtitle:switch",()=>{d=[]}),n.def(a,"subtitleOffset",{get:()=>f,set(g){if(v.$track&&v.$track.track){const E=Array.from(v.$track.track.cues);f=o(g,-5,5);for(let S=0;S<E.length;S++){const x=E[S];d[S]||(d[S]={startTime:x.startTime,endTime:x.endTime}),x.startTime=o(d[S].startTime+f,0,a.duration),x.endTime=o(d[S].endTime+f,0,a.duration)}a.subtitle.update(),l.show=`${h.get("Subtitle Offset")}: ${g}s`,a.emit("subtitleOffset",g)}else a.emit("subtitleOffset",0)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aqLU7:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,storage:l,template:{$video:v,$poster:h}}=a;Object.keys(o.moreVideoAttr).forEach(d=>{a.attr(d,o.moreVideoAttr[d])}),o.muted&&(a.muted=o.muted),o.volume&&(v.volume=n.clamp(o.volume,0,1));const f=l.get("volume");typeof f=="number"&&(v.volume=n.clamp(f,0,1)),o.poster&&n.setStyle(h,"backgroundImage",`url(${o.poster})`),o.autoplay&&(v.autoplay=o.autoplay),o.playsInline&&(v.playsInline=!0,v["webkit-playsinline"]=!0),o.theme&&(a.theme=o.theme),o.ads.length===0&&(a.url=o.url)}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"59ETf":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../config"),o=n.interopDefault(a),l=r("../utils");t.default=function(v){const{i18n:h,notice:f,option:d,constructor:g,events:{proxy:E},template:{$player:S,$video:x,$poster:m}}=v;let c=0;for(let p=0;p<o.default.events.length;p++)E(x,o.default.events[p],y=>{v.emit(`video:${y.type}`,y)});v.on("video:canplay",()=>{c=0,v.loading.show=!1}),v.once("video:canplay",()=>{v.loading.show=!1,v.controls.show=!0,v.mask.show=!0,v.isReady=!0,v.emit("ready")}),v.on("video:ended",()=>{d.loop?(v.seek=0,v.play(),v.controls.show=!1,v.mask.show=!1):(v.controls.show=!0,v.mask.show=!0)}),v.on("video:error",()=>yr(this,null,function*(){c<g.RECONNECT_TIME_MAX?(yield l.sleep(g.RECONNECT_SLEEP_TIME),c+=1,v.url=d.url,f.show=`${h.get("Reconnect")}: ${c}`,v.emit("error",c)):(v.loading.show=!1,v.controls.show=!1,l.addClass(S,"art-error"),yield l.sleep(g.RECONNECT_SLEEP_TIME),f.show=h.get("Video Load Failed"),v.destroy(!1))})),v.once("video:loadedmetadata",()=>{v.autoSize=d.autoSize,l.isMobile&&(v.loading.show=!1,v.controls.show=!0,v.mask.show=!0)}),v.on("video:loadstart",()=>{v.loading.show=!0}),v.on("video:pause",()=>{v.controls.show=!0,v.mask.show=!0}),v.on("video:play",()=>{v.mask.show=!1,l.setStyle(m,"display","none")}),v.on("video:playing",()=>{v.mask.show=!1}),v.on("video:seeked",()=>{v.loading.show=!1}),v.on("video:seeking",()=>{v.loading.show=!0}),v.on("video:timeupdate",()=>{v.mask.show=!1}),v.on("video:waiting",()=>{v.loading.show=!0})}},{"../config":"eksZR","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iEQHG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const o=["mini","pip","fullscreen","fullscreenWeb"];n.def(a,"normalSize",{get:()=>o.every(l=>!a[l]),set(l){o.filter(v=>v!==l).forEach(v=>{a[v]&&(a[v]=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kJ9J9:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("../utils/component"),l=n.interopDefault(o),v=r("./fullscreen"),h=n.interopDefault(v),f=r("./fullscreenWeb"),d=n.interopDefault(f),g=r("./pip"),E=n.interopDefault(g),S=r("./playAndPause"),x=n.interopDefault(S),m=r("./progress"),c=n.interopDefault(m),p=r("./time"),y=n.interopDefault(p),u=r("./volume"),_=n.interopDefault(u),b=r("./setting"),T=n.interopDefault(b),A=r("./thumbnails"),L=n.interopDefault(A),R=r("./screenshot"),w=n.interopDefault(R),O=r("./quality"),I=n.interopDefault(O),D=r("./loop"),C=n.interopDefault(D);class P extends l.default{constructor(N){super(N),this.name="control";const{option:B,constructor:U,events:{proxy:F},template:{$player:j}}=N;let V=Date.now();F(j,["click","mousemove","touchstart","touchmove"],()=>{this.show=!0,a.removeClass(j,"art-hide-cursor"),a.addClass(j,"art-hover"),V=Date.now()}),N.on("video:timeupdate",()=>{!N.isInput&&N.playing&&this.show&&Date.now()-V>=U.CONTROL_HIDE_TIME&&(this.show=!1,a.addClass(j,"art-hide-cursor"),a.removeClass(j,"art-hover"))}),N.once("video:loadedmetadata",()=>{this.add(c.default({name:"progress",disable:B.isLive,position:"top",index:10})),this.add(L.default({name:"thumbnails",disable:!B.thumbnails.url||B.isLive||a.isMobile,position:"top",index:20})),this.add(C.default({name:"loop",disable:!1,position:"top",index:30})),this.add(x.default({name:"playAndPause",disable:!1,position:"left",index:10})),this.add(_.default({name:"volume",disable:!1,position:"left",index:20})),this.add(y.default({name:"time",disable:B.isLive,position:"left",index:30})),this.add(I.default({name:"quality",disable:B.quality.length===0,position:"right",index:10})),this.add(w.default({name:"screenshot",disable:!B.screenshot||a.isMobile,position:"right",index:20})),this.add(T.default({name:"setting",disable:!B.setting,position:"right",index:30})),this.add(E.default({name:"pip",disable:!B.pip,position:"right",index:40})),this.add(d.default({name:"fullscreenWeb",disable:!B.fullscreenWeb,position:"right",index:50})),this.add(h.default({name:"fullscreen",disable:!B.fullscreen,position:"right",index:60}));for(let G=0;G<B.controls.length;G++)this.add(B.controls[G])})}add(N){const B=typeof N=="function"?N(this.art):N,{$progress:U,$controlsLeft:F,$controlsRight:j}=this.art.template;switch(B.position){case"top":this.$parent=U;break;case"left":this.$parent=F;break;case"right":this.$parent=j;break;default:a.errorHandle(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(B)}}t.default=P},{"../utils":"geSvU","../utils/component":"kPHYl","./fullscreen":"awkUw","./fullscreenWeb":"3qoPe","./pip":"lFHYL","./playAndPause":"b8vU1","./progress":"dRwzT","./time":"ltYI1","./volume":"8O7mM","./setting":"lX5UX","./thumbnails":"lUoGG","./screenshot":"jvdQ0","./quality":"k9pKK","./loop":"aE690","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kPHYl:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./dom"),o=r("option-validator"),l=n.interopDefault(o),v=r("../scheme"),h=r("./property"),f=r("./error");t.default=class{constructor(d){this.id=0,this.art=d,this.add=this.add.bind(this)}get show(){return a.hasClass(this.art.template.$player,`art-${this.name}-show`)}set show(d){const{$player:g}=this.art.template,E=`art-${this.name}-show`;d?a.addClass(g,E):a.removeClass(g,E),this.art.emit(this.name,d)}set toggle(d){d&&(this.show=!this.show)}add(d){const g=typeof d=="function"?d(this.art):d;if(g.html=g.html||"",l.default(g,v.ComponentOption),!this.$parent||!this.name||g.disable)return;const E=g.name||`${this.name}${this.id}`;f.errorHandle(!h.has(this,E),`Cannot add an existing name [${E}] to the [${this.name}]`),this.id+=1;const S=document.createElement("div");a.addClass(S,`art-${this.name}`),a.addClass(S,`art-${this.name}-${E}`);const x=Array.from(this.$parent.children);S.dataset.index=g.index||this.id;const m=x.find(c=>Number(c.dataset.index)>=Number(S.dataset.index));return m?m.insertAdjacentElement("beforebegin",S):a.append(this.$parent,S),g.html&&a.append(S,g.html),g.style&&a.setStyles(S,g.style),g.tooltip&&a.tooltip(S,g.tooltip),g.click&&this.art.events.proxy(S,"click",c=>{c.preventDefault(),g.click.call(this.art,this,c)}),g.selector&&["left","right"].includes(g.position)&&this.selector(g,S),g.mounted&&g.mounted.call(this.art,S),S.childNodes.length===1&&S.childNodes[0].nodeType===3&&a.addClass(S,"art-control-onlyText"),h.def(this,E,{value:S}),S}selector(d,g){const{hover:E,proxy:S}=this.art.events;a.addClass(g,"art-control-selector");const x=document.createElement("div");a.addClass(x,"art-selector-value"),a.append(x,d.html),g.innerText="",a.append(g,x);const m=d.selector.map((y,u)=>`<div class="art-selector-item ${y.default?"art-current":""}" data-index="${u}">${y.html}</div>`).join(""),c=document.createElement("div");a.addClass(c,"art-selector-list"),a.append(c,m),a.append(g,c);const p=()=>{const y=a.getStyle(g,"width")/2-a.getStyle(c,"width")/2;c.style.left=`${y}px`};E(g,p),S(c,"click",y=>yr(this,null,function*(){const u=(y.composedPath()||[]).find(T=>a.hasClass(T,"art-selector-item"));if(!u)return;a.inverseClass(u,"art-current");const _=Number(u.dataset.index),b=d.selector[_]||{};if(x.innerText=u.innerText,d.onSelect){const T=yield d.onSelect.call(this.art,b,u,y);typeof T!="string"&&typeof T!="number"||(x.innerHTML=T)}p(),this.art.emit("selector",b,u)}))}}},{"./dom":"ff6Hs","option-validator":"hqjoJ","../scheme":"3vPoh","./property":"lMM6V","./error":"lDQPM","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],awkUw:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("Fullscreen"),mounted:l=>{const{events:{proxy:v},icons:h,i18n:f}=o,d=n.append(l,h.fullscreenOn),g=n.append(l,h.fullscreenOff);n.setStyle(g,"display","none"),v(l,"click",()=>{o.fullscreen=!o.fullscreen}),o.on("fullscreen",E=>{E?(n.tooltip(l,f.get("Exit Fullscreen")),n.setStyle(d,"display","none"),n.setStyle(g,"display","inline-flex")):(n.tooltip(l,f.get("Fullscreen")),n.setStyle(d,"display","inline-flex"),n.setStyle(g,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3qoPe":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("Web Fullscreen"),mounted:l=>{const{events:{proxy:v},icons:h,i18n:f}=o,d=n.append(l,h.fullscreenWebOn),g=n.append(l,h.fullscreenWebOff);n.setStyle(g,"display","none"),v(l,"click",()=>{o.fullscreenWeb=!o.fullscreenWeb}),o.on("fullscreenWeb",E=>{E?(n.tooltip(l,f.get("Exit Web Fullscreen")),n.setStyle(d,"display","none"),n.setStyle(g,"display","inline-flex")):(n.tooltip(l,f.get("Web Fullscreen")),n.setStyle(d,"display","inline-flex"),n.setStyle(g,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lFHYL:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("PIP Mode"),mounted:l=>{const{events:{proxy:v},icons:h,i18n:f}=o;n.append(l,h.pip),v(l,"click",()=>{o.pip=!o.pip}),o.on("pip",d=>{n.tooltip(l,f.get(d?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],b8vU1:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{mounted:l=>{const{events:{proxy:v},icons:h,i18n:f}=o,d=n.append(l,h.play),g=n.append(l,h.pause);function E(){n.setStyle(d,"display","flex"),n.setStyle(g,"display","none")}function S(){n.setStyle(d,"display","none"),n.setStyle(g,"display","flex")}n.tooltip(d,f.get("Play")),n.tooltip(g,f.get("Pause")),v(d,"click",()=>{o.play()}),v(g,"click",()=>{o.pause()}),o.playing?S():E(),o.on("video:playing",()=>{S()}),o.on("video:pause",()=>{E()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],dRwzT:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"getPosFromEvent",()=>o);var a=r("../utils");function o(l,v){const{$progress:h}=l.template,{left:f}=h.getBoundingClientRect(),d=v.pageX,g=a.clamp(d-f,0,h.clientWidth),E=g/h.clientWidth*l.duration;return{second:E,time:a.secondToTime(E),width:g,percentage:a.clamp(g/h.clientWidth,0,1)}}t.default=function(l){return v=>{const{icons:h,option:f,events:{proxy:d}}=v;return Ot(yt({},l),{html:'<div class="art-control-progress-inner"><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:g=>{let E=!1;const S=a.query(".art-progress-loaded",g),x=a.query(".art-progress-played",g),m=a.query(".art-progress-highlight",g),c=a.query(".art-progress-indicator",g),p=a.query(".art-progress-tip",g);a.setStyle(x,"backgroundColor","var(--theme)");let y=v.constructor.INDICATOR_SIZE;function u(_,b){_==="loaded"&&a.setStyle(S,"width",100*b+"%"),_==="played"&&(a.setStyle(x,"width",100*b+"%"),a.setStyle(c,"left",`calc(${100*b}% - ${y/2}px)`))}h.indicator?(y=v.constructor.INDICATOR_SIZE_ICON,a.append(c,h.indicator)):a.setStyles(c,{backgroundColor:"var(--theme)"}),a.isMobile&&(y=v.constructor.INDICATOR_SIZE_MOBILE,h.indicator&&(y=v.constructor.INDICATOR_SIZE_MOBILE_ICON)),a.setStyles(c,{left:`-${y/2}px`,width:`${y}px`,height:`${y}px`});for(let _=0;_<f.highlight.length;_++){const b=f.highlight[_],T=a.clamp(b.time,0,v.duration)/v.duration*100;a.append(m,`<span data-text="${b.text}" data-time="${b.time}" style="left: ${T}%"></span>`)}u("loaded",v.loaded),v.on("setBar",(_,b)=>{u(_,b)}),v.on("video:progress",()=>{u("loaded",v.loaded)}),v.on("video:timeupdate",()=>{u("played",v.played)}),v.on("video:ended",()=>{u("played",1)}),a.isMobile||(d(g,"click",_=>{if(_.target!==c){const{second:b,percentage:T}=o(v,_);u("played",T),v.seek=b}}),d(g,"mousemove",_=>{a.setStyle(p,"display","block"),a.includeFromEvent(_,m)?function(b){const{width:T}=o(v,b),{text:A}=b.target.dataset;p.innerHTML=A;const L=p.clientWidth;T<=L/2?a.setStyle(p,"left",0):T>g.clientWidth-L/2?a.setStyle(p,"left",g.clientWidth-L+"px"):a.setStyle(p,"left",T-L/2+"px")}(_):function(b){const{width:T,time:A}=o(v,b);p.innerHTML=A;const L=p.clientWidth;T<=L/2?a.setStyle(p,"left",0):T>g.clientWidth-L/2?a.setStyle(p,"left",g.clientWidth-L+"px"):a.setStyle(p,"left",T-L/2+"px")}(_)}),d(g,"mouseout",()=>{a.setStyle(p,"display","none")}),d(c,"mousedown",()=>{E=!0}),d(document,"mousemove",_=>{if(E){const{second:b,percentage:T}=o(v,_);u("played",T),v.seek=b}}),d(document,"mouseup",()=>{E&&(E=!1)}))}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ltYI1:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{style:{cursor:"auto"},mounted:l=>{function v(){const f=`${n.secondToTime(o.currentTime)} / ${n.secondToTime(o.duration)}`;f!==l.innerText&&(l.innerText=f)}v();const h=["video:loadedmetadata","video:timeupdate","video:progress"];for(let f=0;f<h.length;f++)o.on(h[f],v)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8O7mM":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{mounted:l=>{const{events:{proxy:v},icons:h,i18n:f}=o;let d=!1;const g=o.constructor.VOLUME_PANEL_WIDTH,E=o.constructor.VOLUME_HANDLE_WIDTH,S=n.append(l,h.volume),x=n.append(l,h.volumeClose),m=n.append(l,'<div class="art-volume-panel"></div>'),c=n.append(m,'<div class="art-volume-slider-handle"></div>');function p(u){const{left:_}=m.getBoundingClientRect();return n.clamp(u.pageX-_-E/2,0,g-E/2)/(g-E)}function y(u=.7){if(o.muted||u===0)n.setStyle(S,"display","none"),n.setStyle(x,"display","flex"),n.setStyle(c,"left","0");else{const _=(g-E)*u;n.setStyle(S,"display","flex"),n.setStyle(x,"display","none"),n.setStyle(c,"left",`${_}px`)}}n.tooltip(S,f.get("Mute")),n.setStyle(x,"display","none"),n.isMobile&&n.setStyle(m,"display","none"),y(o.volume),o.on("video:volumechange",()=>{y(o.volume)}),v(S,"click",()=>{o.muted=!0}),v(x,"click",()=>{o.muted=!1}),v(m,"click",u=>{o.muted=!1,o.volume=p(u)}),v(c,"mousedown",()=>{d=!0}),v(l,"mousemove",u=>{d&&(o.muted=!1,o.volume=p(u))}),v(document,"mouseup",()=>{d&&(d=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lX5UX:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("Show Setting"),mounted:l=>{const{events:{proxy:v},icons:h,i18n:f,setting:d}=o;n.append(l,h.setting),v(l,"click",()=>{d.toggle=!0}),o.on("setting",g=>{n.tooltip(l,f.get(g?"Hide Setting":"Show Setting"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lUoGG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils"),a=r("./progress");t.default=function(o){return l=>Ot(yt({},o),{mounted:v=>{const{option:h,template:{$progress:f,$video:d},events:{proxy:g,loadImg:E}}=l;let S=null,x=!1,m=!1;g(f,"mousemove",c=>yr(this,null,function*(){x||(x=!0,S=yield E(h.thumbnails.url),m=!0),m&&(n.setStyle(v,"display","block"),function(p){const{width:y}=a.getPosFromEvent(l,p),{url:u,number:_,column:b}=h.thumbnails,T=S.naturalWidth/b,A=T/(d.videoWidth/d.videoHeight),L=f.clientWidth/_,R=Math.floor(y/L),w=Math.ceil(R/b)-1,O=R%b||b-1;n.setStyle(v,"backgroundImage",`url(${u})`),n.setStyle(v,"height",`${A}px`),n.setStyle(v,"width",`${T}px`),n.setStyle(v,"backgroundPosition",`-${O*T}px -${w*A}px`),y<=T/2?n.setStyle(v,"left",0):y>f.clientWidth-T/2?n.setStyle(v,"left",f.clientWidth-T+"px"):n.setStyle(v,"left",y-T/2+"px")}(c))})),g(f,"mouseout",()=>{n.setStyle(v,"display","none")})}})}},{"../utils":"geSvU","./progress":"dRwzT","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jvdQ0:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{tooltip:o.i18n.get("Screenshot"),mounted:l=>{const{events:{proxy:v},icons:h}=o;n.append(l,h.screenshot),v(l,"click",()=>{o.screenshot()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k9pKK:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>{const o=a.option.quality,l=o.find(v=>v.default)||o[0];return Ot(yt({},n),{html:l?l.html:"",selector:o,onSelect(v){a.switchQuality(v.url,v.html)}})}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aE690:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>Ot(yt({},a),{mounted:l=>{const v=n.append(l,'<span class="art-loop-point"></span>'),h=n.append(l,'<span class="art-loop-point"></span>');o.on("loop",f=>{f?(n.setStyle(l,"display","block"),n.setStyle(v,"left",`calc(${f[0]/o.duration*100}% - ${v.clientWidth}px)`),n.setStyle(h,"left",f[1]/o.duration*100+"%")):n.setStyle(l,"display","none")})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7rh9q":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("../utils/component"),l=n.interopDefault(o),v=r("./playbackRate"),h=n.interopDefault(v),f=r("./aspectRatio"),d=n.interopDefault(f),g=r("./flip"),E=n.interopDefault(g),S=r("./info"),x=n.interopDefault(S),m=r("./version"),c=n.interopDefault(m),p=r("./close"),y=n.interopDefault(p);class u extends l.default{constructor(b){super(b),this.art=b,this.name="contextmenu",this.$parent=b.template.$contextmenu,b.once("video:loadedmetadata",()=>{a.isMobile||this.init()})}init(){const{option:b,template:{$player:T,$contextmenu:A},events:{proxy:L}}=this.art;this.add(h.default({disable:!b.playbackRate,name:"playbackRate",index:10})),this.add(d.default({disable:!b.aspectRatio,name:"aspectRatio",index:20})),this.add(E.default({disable:!b.flip,name:"flip",index:30})),this.add(x.default({disable:!1,name:"info",index:40})),this.add(c.default({disable:!1,name:"version",index:50})),this.add(y.default({disable:!1,name:"close",index:60}));for(let R=0;R<b.contextmenu.length;R++)this.add(b.contextmenu[R]);L(T,"contextmenu",R=>{R.preventDefault(),this.show=!0;const w=R.clientX,O=R.clientY,{height:I,width:D,left:C,top:P}=T.getBoundingClientRect(),{height:M,width:N}=A.getBoundingClientRect();let B=w-C,U=O-P;w+N>C+D&&(B=D-N),O+M>P+I&&(U=I-M),a.setStyles(A,{top:`${U}px`,left:`${B}px`})}),L(T,"click",R=>{a.includeFromEvent(R,A)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}t.default=u},{"../utils":"geSvU","../utils/component":"kPHYl","./playbackRate":"9P3rd","./aspectRatio":"3OqVf","./flip":"iMg4Y","./info":"9FFXO","./version":"duhqU","./close":"k3lJQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9P3rd":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:l}=o;return Ot(yt({},a),{html:`${l.get("Play Speed")}:<span data-value="0.5">0.5</span><span data-value="0.75">0.75</span><span data-value="1.0" class="art-current">${l.get("Normal")}</span><span data-value="1.25">1.25</span><span data-value="1.5">1.5</span><span data-value="2.0">2.0</span>`,click:(v,h)=>{const{value:f}=h.target.dataset;f&&(o.playbackRate=Number(f),v.show=!1)},mounted:v=>{o.on("playbackRate",h=>{const f=n.queryAll("span",v).find(d=>Number(d.dataset.value)===h);f&&n.inverseClass(f,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3OqVf":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:l}=o;return Ot(yt({},a),{html:`${l.get("Aspect Ratio")}:<span data-value="default" class="art-current">${l.get("Default")}</span><span data-value="4:3">4:3</span><span data-value="16:9">16:9</span>`,click:(v,h)=>{const{value:f}=h.target.dataset;f&&(o.aspectRatio=f,v.show=!1)},mounted:v=>{o.on("aspectRatio",h=>{const f=n.queryAll("span",v).find(d=>d.dataset.value===h);f&&n.inverseClass(f,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iMg4Y:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){return o=>{const{i18n:l}=o;return Ot(yt({},a),{html:`${l.get("Video Flip")}:<span data-value="normal" class="art-current">${l.get("Normal")}</span><span data-value="horizontal">${l.get("Horizontal")}</span><span data-value="vertical">${l.get("Vertical")}</span>`,click:(v,h)=>{const{value:f}=h.target.dataset;f&&(o.flip=f,v.show=!1)},mounted:v=>{o.on("flip",h=>{const f=n.queryAll("span",v).find(d=>d.dataset.value===h);f&&n.inverseClass(f,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9FFXO":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>Ot(yt({},n),{html:a.i18n.get("Video Info"),click:o=>{a.info.show=!0,o.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],duhqU:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return Ot(yt({},n),{html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 4.4.1</a>'})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k3lJQ:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return a=>Ot(yt({},n),{html:a.i18n.get("Close"),click:o=>{o.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],c896w:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),l=n.interopDefault(o);class v extends l.default{constructor(f){super(f),this.name="info",f.once("video:loadedmetadata",()=>{a.isMobile||this.init()})}init(){const{constructor:f,events:{proxy:d},template:{$infoPanel:g,$infoClose:E,$video:S}}=this.art;d(E,"click",()=>{this.show=!1});let x=null;const m=a.queryAll("[data-video]",g)||[];this.art.on("destroy",()=>{clearTimeout(x)}),function c(){for(let p=0;p<m.length;p++){const y=m[p],u=S[y.dataset.video],_=typeof u=="number"?u.toFixed(2):u;y.innerText!==_&&(y.innerText=_)}x=setTimeout(c,f.INFO_LOOP_TIME)}()}}t.default=v},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"2hqso":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),l=n.interopDefault(o),v=r("option-validator"),h=n.interopDefault(v),f=r("./scheme"),d=n.interopDefault(f);class g extends l.default{constructor(S){super(S),this.name="subtitle",S.once("video:loadedmetadata",()=>{this.init(S.option.subtitle)})}get url(){return this.art.template.$track.src}set url(S){this.switch(S)}get textTrack(){return this.art.template.$video.textTracks[0]}get activeCue(){return this.textTrack.activeCues[0]}style(S,x){const{$subtitle:m}=this.art.template;return typeof S=="object"?a.setStyles(m,S):a.setStyle(m,S,x)}update(){const{$subtitle:S}=this.art.template;S.innerHTML="",this.activeCue&&(S.innerHTML=this.activeCue.text.split(/\r?\n/).map(x=>`<p>${a.escape(x)}</p>`).join(""),this.art.emit("subtitleUpdate",this.activeCue.text))}switch(m){return yr(this,arguments,function*(S,x={}){const{i18n:c,notice:p,option:y}=this.art,u=Ot(yt(yt({},y.subtitle),x),{url:S}),_=yield this.init(u);return x.name&&(p.show=`${c.get("Switch Subtitle")}: ${x.name}`),_})}init(S){if(h.default(S,d.default.subtitle),!S.url)return;const{notice:x,events:{proxy:m},template:{$subtitle:c,$video:p,$track:y}}=this.art;if(!y){const u=document.createElement("track");u.default=!0,u.kind="metadata",p.appendChild(u),this.art.template.$track=u,m(this.textTrack,"cuechange",this.update.bind(this))}return this.style(S.style),a.errorHandle(window.fetch,"fetch not support"),fetch(S.url).then(u=>u.arrayBuffer()).then(u=>{a.errorHandle(window.TextDecoder,"TextDecoder not support");const _=new TextDecoder(S.encoding).decode(u);switch(this.art.emit("subtitleLoad",S.url),S.type||a.getExt(S.url)){case"srt":return a.vttToBlob(a.srtToVtt(_));case"ass":return a.vttToBlob(a.assToVtt(_));case"vtt":return a.vttToBlob(_);default:return S.url}}).then(u=>(c.innerHTML="",this.url===u||(URL.revokeObjectURL(this.url),this.art.template.$track.src=u,this.art.emit("subtitleSwitch",u)),u)).catch(u=>{throw x.show=u,u})}}t.default=g},{"./utils":"geSvU","./utils/component":"kPHYl","option-validator":"hqjoJ","./scheme":"3vPoh","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j2hlX:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils/error"),o=r("./clickInit"),l=n.interopDefault(o),v=r("./hoverInit"),h=n.interopDefault(v),f=r("./mousemoveInit"),d=n.interopDefault(f),g=r("./resizeInit"),E=n.interopDefault(g),S=r("./gestureInit"),x=n.interopDefault(S),m=r("./viewInit"),c=n.interopDefault(m);t.default=class{constructor(p){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),this.loadImg=this.loadImg.bind(this),p.whitelist.state&&p.once("video:loadedmetadata",()=>{l.default(p,this),h.default(p,this),d.default(p,this),E.default(p,this),x.default(p,this),c.default(p,this)})}proxy(p,y,u,_={}){if(Array.isArray(y))return y.map(T=>this.proxy(p,T,u,_));p.addEventListener(y,u,_);const b=()=>p.removeEventListener(y,u,_);return this.destroyEvents.push(b),b}hover(p,y,u){y&&this.proxy(p,"mouseenter",y),u&&this.proxy(p,"mouseleave",u)}loadImg(p){return new Promise((y,u)=>{let _;if(p instanceof HTMLImageElement)_=p;else{if(typeof p!="string")return u(new a.ArtPlayerError("Unable to get Image"));_=new Image,_.src=p}if(_.complete)return y(_);this.proxy(_,"load",()=>y(_)),this.proxy(_,"error",()=>u(new a.ArtPlayerError(`Failed to load Image: ${_.src}`)))})}destroy(){for(let p=0;p<this.destroyEvents.length;p++)this.destroyEvents[p]()}}},{"../utils/error":"lDQPM","./clickInit":"iP4Z9","./hoverInit":"aoIIW","./mousemoveInit":"4WC5c","./resizeInit":"7fpan","./gestureInit":"ixtiG","./viewInit":"5WvmH","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iP4Z9:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{constructor:l,template:{$player:v,$video:h}}=a;o.proxy(document,["click","contextmenu"],d=>{n.includeFromEvent(d,v)?(a.isInput=d.target.tagName==="INPUT",a.isFocus=!0,a.emit("focus")):(a.isInput=!1,a.isFocus=!1,a.emit("blur"))});let f=0;o.proxy(h,"click",()=>{const d=Date.now();d-f<=l.DB_CLICE_TIME?(a.emit("dblclick"),n.isMobile?a.isLock||a.toggle():a.fullscreen=!a.fullscreen):(a.emit("click"),n.isMobile||a.toggle()),f=d})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aoIIW:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{$player:l}=a.template;o.hover(l,()=>{n.addClass(l,"art-hover"),a.emit("hover",!0)},()=>{n.removeClass(l,"art-hover"),a.emit("hover")})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4WC5c":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n,a){const{$player:o}=n.template;a.proxy(o,"mousemove",l=>{n.emit("mousemove",l)})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7fpan":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{notice:l,option:v}=a,h=n.throttle(()=>{a.normalSize&&(a.autoSize=v.autoSize),a.aspectRatioReset=!0,l.show="",a.emit("resize")},a.constructor.RESIZE_TIME);o.proxy(window,["orientationchange","resize"],()=>{h()}),screen&&screen.orientation&&screen.orientation.onchange&&o.proxy(screen.orientation,"change",()=>{h()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ixtiG:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){if(n.isMobile&&!a.option.isLive){const{notice:l,plugins:v,template:{$video:h,$bottom:f,$controls:d}}=a;let g=!1,E=0,S=0,x=0;const m=y=>{if(y.touches.length===1&&!a.isLock){g=!0;const{clientX:u,clientY:_}=y.touches[0];E=u,S=_,x=a.currentTime}},c=y=>{if(y.touches.length===1&&g&&a.duration){const u=v.autoOrientation&&v.autoOrientation.state,{clientX:_,clientY:b}=y.touches[0],T=n.clamp((_-E)/a.width,-1,1),A=n.clamp((b-S)/a.height,-1,1),L=u?A:T,R=n.clamp(x+a.duration*L/2,0,a.duration);a.seek=R,a.emit("setBar","played",n.clamp(R/a.duration,0,1)),l.show=`${n.secondToTime(R)} / ${n.secondToTime(a.duration)}`}},p=()=>{g&&(E=0,S=0,x=0,g=!1)};o.proxy(f,"touchstart",y=>{n.includeFromEvent(y,d)||m(y)}),o.proxy(f,"touchmove",c),o.proxy(h,"touchstart",m),o.proxy(h,"touchmove",c),o.proxy(document,"touchend",p)}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5WvmH":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a,o){const{option:l,constructor:v,template:{$container:h}}=a,f=n.throttle(()=>{a.emit("view",n.isInViewport(h,v.SCROLL_GAP))},v.SCROLL_TIME);o.proxy(window,"scroll",()=>{f()}),a.on("view",d=>{l.autoMini&&(a.mini=!d)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aTHWZ:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a,this.keys={},a.once("video:loadedmetadata",()=>{a.option.hotkey&&!n.isMobile&&this.init()})}init(){const{proxy:a}=this.art.events;this.add(27,()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add(32,()=>{this.art.toggle()}),this.add(37,()=>{this.art.backward=5}),this.add(38,()=>{this.art.volume+=.1}),this.add(39,()=>{this.art.forward=5}),this.add(40,()=>{this.art.volume-=.1}),a(window,"keydown",o=>{if(this.art.isFocus){const l=document.activeElement.tagName.toUpperCase(),v=document.activeElement.getAttribute("contenteditable");if(l!=="INPUT"&&l!=="TEXTAREA"&&v!==""&&v!=="true"){const h=this.keys[o.keyCode];if(h){o.preventDefault();for(let f=0;f<h.length;f++)h[f].call(this.art,o);this.art.emit("hotkey",o)}}}})}add(a,o){return this.keys[a]?this.keys[a].push(o):this.keys[a]=[o],this}remove(a,o){if(this.keys[a]){const l=this.keys[a].indexOf(o);l!==-1&&this.keys[a].splice(l,1)}return this}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],f2kxw:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils/component"),o=n.interopDefault(a);class l extends o.default{constructor(h){super(h);const{option:f,template:{$layer:d}}=h;this.name="layer",this.$parent=d,h.once("video:loadedmetadata",()=>{for(let g=0;g<f.layers.length;g++)this.add(f.layers[g])})}}t.default=l},{"./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bOs9w:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),l=n.interopDefault(o);class v extends l.default{constructor(f){super(f),this.name="loading",a.append(f.template.$loading,f.icons.loading)}}t.default=v},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ic4th:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("./utils");t.default=class{constructor(a){this.art=a,this.timer=null}set show(a){const{constructor:o,template:{$player:l,$noticeInner:v}}=this.art;a?(v.innerText=a instanceof Error?a.message.trim():a,n.addClass(l,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{v.innerText="",n.removeClass(l,"art-notice-show")},o.NOTICE_TIME)):n.removeClass(l,"art-notice-show")}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iLfmB:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./utils"),o=r("./utils/component"),l=n.interopDefault(o);class v extends l.default{constructor(f){super(f),this.name="mask";const{template:d,icons:g,events:E}=f;a.append(d.$state,g.state),E.proxy(d.$state,"click",()=>f.play())}}t.default=v},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5lAmI":[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("bundle-text:./loading.svg"),l=n.interopDefault(o),v=r("bundle-text:./state.svg"),h=n.interopDefault(v),f=r("bundle-text:./check.svg"),d=n.interopDefault(f),g=r("bundle-text:./play.svg"),E=n.interopDefault(g),S=r("bundle-text:./pause.svg"),x=n.interopDefault(S),m=r("bundle-text:./volume.svg"),c=n.interopDefault(m),p=r("bundle-text:./volume-close.svg"),y=n.interopDefault(p),u=r("bundle-text:./screenshot.svg"),_=n.interopDefault(u),b=r("bundle-text:./setting.svg"),T=n.interopDefault(b),A=r("bundle-text:./arrow-left.svg"),L=n.interopDefault(A),R=r("bundle-text:./arrow-right.svg"),w=n.interopDefault(R),O=r("bundle-text:./playback-rate.svg"),I=n.interopDefault(O),D=r("bundle-text:./aspect-ratio.svg"),C=n.interopDefault(D),P=r("bundle-text:./config.svg"),M=n.interopDefault(P),N=r("bundle-text:./pip.svg"),B=n.interopDefault(N),U=r("bundle-text:./lock.svg"),F=n.interopDefault(U),j=r("bundle-text:./unlock.svg"),V=n.interopDefault(j),G=r("bundle-text:./fullscreen-off.svg"),Y=n.interopDefault(G),X=r("bundle-text:./fullscreen-on.svg"),ie=n.interopDefault(X),he=r("bundle-text:./fullscreen-web-off.svg"),de=n.interopDefault(he),Ae=r("bundle-text:./fullscreen-web-on.svg"),pe=n.interopDefault(Ae),le=r("bundle-text:./switch-on.svg"),Ie=n.interopDefault(le),Ce=r("bundle-text:./switch-off.svg"),Ue=n.interopDefault(Ce),Me=r("bundle-text:./flip.svg"),ze=n.interopDefault(Me);t.default=class{constructor(Ge){const $e=yt({loading:l.default,state:h.default,play:E.default,pause:x.default,check:d.default,volume:c.default,volumeClose:y.default,screenshot:_.default,setting:T.default,pip:B.default,arrowLeft:L.default,arrowRight:w.default,playbackRate:I.default,aspectRatio:C.default,config:M.default,lock:F.default,flip:ze.default,unlock:V.default,fullscreenOff:Y.default,fullscreenOn:ie.default,fullscreenWebOff:de.default,fullscreenWebOn:pe.default,switchOn:Ie.default,switchOff:Ue.default},Ge.option.icons);Object.keys($e).forEach(Ke=>{a.def(this,Ke,{get:()=>{const Ne=document.createElement("i");return a.addClass(Ne,"art-icon"),a.addClass(Ne,`art-icon-${Ke}`),a.append(Ne,$e[Ke]),Ne}})})}}},{"../utils":"geSvU","bundle-text:./loading.svg":"hX0lQ","bundle-text:./state.svg":"01U3R","bundle-text:./check.svg":"9jaCP","bundle-text:./play.svg":"invok","bundle-text:./pause.svg":"68285","bundle-text:./volume.svg":"3zSKr","bundle-text:./volume-close.svg":"ft8Zf","bundle-text:./screenshot.svg":"dfLel","bundle-text:./setting.svg":"j8dnn","bundle-text:./arrow-left.svg":"fMoi9","bundle-text:./arrow-right.svg":"auIjA","bundle-text:./playback-rate.svg":"g3V1U","bundle-text:./aspect-ratio.svg":"3LQJt","bundle-text:./config.svg":"bcTkc","bundle-text:./pip.svg":"jDSoL","bundle-text:./lock.svg":"jqFLt","bundle-text:./unlock.svg":"5qYod","bundle-text:./fullscreen-off.svg":"25MvP","bundle-text:./fullscreen-on.svg":"6CCX4","bundle-text:./fullscreen-web-off.svg":"m9TwS","bundle-text:./fullscreen-web-on.svg":"iWJrW","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","bundle-text:./switch-on.svg":"8cFxH","bundle-text:./switch-off.svg":"6tBmw","bundle-text:./flip.svg":"6N8Hu"}],hX0lQ:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-default"><path fill="none" class="bk" d="M0 0h100v100H0z"/><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="translate(0 -30)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-1s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(30 105.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.9166666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(60 75.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.8333333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(90 65 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.75s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(120 58.66 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.6666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(150 54.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5833333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(180 50 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.4166666666666667s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.3333333333333333s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-90 35 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.25s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.16666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.08333333333333333s" repeatCount="indefinite"/></rect></svg>'},{}],"01U3R":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="60" width="60" style="filter:drop-shadow(0 1px 1px #000)" viewBox="0 0 24 24"><path d="M20 2H4C1.8 2 0 3.8 0 6v12c0 2.2 1.8 4 4 4h16c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4zm-4.4 10.8L10.5 16c-.6.5-1.5 0-1.5-.8V8.8c0-.8.9-1.3 1.5-.8l5.1 3.2c.7.3.7 1.3 0 1.6z"/></svg>'},{}],"9jaCP":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;height:100%"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#fff"/></svg>'},{}],invok:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"/></svg>'},{}],68285:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zm8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"/></svg>'},{}],"3zSKr":[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"/><path d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"/></svg>'},{}],ft8Zf:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"/><path d="M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zm5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"/></svg>'},{}],dfLel:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10Zm0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8Z"/></svg>'},{}],j8dnn:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>'},{}],fMoi9:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z" fill="#fff"/></svg>'},{}],auIjA:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z" fill="#fff"/></svg>'},{}],g3V1U:[function(r,i,t){i.exports='<svg height="24" width="24"><path d="M10 8v8l6-4-6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2zM5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8zm0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4l.8-.7zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22l.1-1zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"3LQJt":[function(r,i,t){i.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" style="width:100%;height:100%;transform:translate(0,0)"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0z"/></clipPath></defs><g style="display:block" clip-path="url('#__lottie_element_216')"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0zm-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13-2.83-2.82zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8h56z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>`},{}],bcTkc:[function(r,i,t){i.exports='<svg height="24" width="24"><path d="M15 17h6v1h-6v-1zm-4 0H3v1h8v2h1v-5h-1v2zm3-9h1V3h-1v2H3v1h11v2zm4-3v1h3V5h-3zM6 14h1V9H6v2H3v1h3v2zm4-2h11v-1H10v1z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],jDSoL:[function(r,i,t){i.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" height="32" width="32"><path d="M25 17h-8v6h8v-6Zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2Zm-2 .02H9V10.97h18v14.05Z"/></svg>'},{}],jqFLt:[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128z" fill="#fff"/></svg>'},{}],"5qYod":[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816z" fill="#fff"/></svg>'},{}],"25MvP":[function(r,i,t){i.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768v170.667zM341.333 384h-256v-85.333H256V128h85.333v256zM768 725.333V896h-85.333V640h256v85.333H768zM341.333 640v256H256V725.333H85.333V640h256z"/></svg>'},{}],"6CCX4":[function(r,i,t){i.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256V256zM256 398.222V256h142.222V142.222h-256v256H256zm512 227.556V768H625.778v113.778h256v-256H768zM398.222 768H256V625.778H142.222v256h256V768z"/></svg>'},{}],m9TwS:[function(r,i,t){i.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384H896zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448H256z"/></svg>'},{}],iWJrW:[function(r,i,t){i.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448H448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384H704z"/></svg>'},{}],"8cFxH":[function(r,i,t){i.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1664 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024zm0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z"/></svg>'},{}],"6tBmw":[function(r,i,t){i.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1740 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898zm-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.872 463.872 0 0 1 511.334 48.435v.205z"/></svg>'},{}],"6N8Hu":[function(r,i,t){i.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M554.667 810.667V896h-85.334v-85.333h85.334zm-384-632.662a42.667 42.667 0 0 1 34.986 18.219l203.904 291.328a42.667 42.667 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667zm682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.667 42.667 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.667 42.667 0 0 1 34.944-18.219zM554.667 640v85.333h-85.334V640h85.334zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334h85.334zm0-170.667V384h-85.334v-85.333h85.334zm0-170.667v85.333h-85.334V128h85.334z" fill="#fff"/></svg>'},{}],d5XKP:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./flip"),o=n.interopDefault(a),l=r("./aspectRatio"),v=n.interopDefault(l),h=r("./playbackRate"),f=n.interopDefault(h),d=r("./subtitleOffset"),g=n.interopDefault(d),E=r("../utils/component"),S=n.interopDefault(E),x=r("../utils");function m(y,u,_){for(let b=0;b<y.length;b++){const T=y[b];T.$parentItem=u,T.$parentList=_,T.selector&&m(T.selector,T,y)}return y}function c(y){return["string","number"].includes(typeof y)}class p extends S.default{constructor(u){super(u);const{option:_,events:{proxy:b},template:{$setting:T,$player:A}}=u;this.art=u,this.name="setting",this.$parent=T,this.option=[],this.events=[],this.cache=new Map,_.setting&&(u.once("video:loadedmetadata",()=>{_.playbackRate&&this.option.push(f.default(u)),_.aspectRatio&&this.option.push(v.default(u)),_.flip&&this.option.push(o.default(u)),_.subtitleOffset&&this.option.push(g.default(u));for(let L=0;L<_.settings.length;L++)this.option.push(_.settings[L]);this.option=m(this.option),this.init(this.option)}),u.on("blur",()=>{this.show&&(this.show=!1,this.init(this.option))}),b(A,"click",L=>{!this.show||x.includeFromEvent(L,u.controls.setting)||x.includeFromEvent(L,this.$parent)||(this.show=!1,this.init(this.option))}))}add(u){typeof u=="function"?this.option.push(u(this.art)):this.option.push(u),this.cache=new Map,this.events.forEach(_=>_()),this.events=[],this.$parent.innerHTML="",this.option=m(this.option),this.init(this.option)}creatHeader(u){const{icons:_,events:{proxy:b}}=this.art,T=document.createElement("div");x.addClass(T,"art-setting-item"),x.addClass(T,"art-setting-item-back");const A=x.append(T,'<div class="art-setting-item-left"></div>'),L=document.createElement("div");x.addClass(L,"art-setting-item-left-icon"),x.append(L,_.arrowLeft),x.append(A,L),x.append(A,u.$parentItem.html);const R=b(T,"click",()=>{this.init(u.$parentList)});return this.events.push(R),T}creatItem(u,_){const{icons:b,events:{proxy:T}}=this.art,A=document.createElement("div");x.addClass(A,"art-setting-item"),c(_.name)&&(A.dataset.name=_.name),c(_.value)&&(A.dataset.value=_.value);const L=x.append(A,'<div class="art-setting-item-left"></div>'),R=x.append(A,'<div class="art-setting-item-right"></div>'),w=document.createElement("div");switch(x.addClass(w,"art-setting-item-left-icon"),u){case"switch":case"range":x.append(w,c(_.icon)||_.icon instanceof Element?_.icon:b.config);break;case"selector":_.selector&&_.selector.length?x.append(w,c(_.icon)||_.icon instanceof Element?_.icon:b.config):x.append(w,b.check)}x.append(L,w),_.$icon=w,x.def(_,"icon",{get:()=>w.innerHTML,set(D){c(D)&&(w.innerHTML=D)}});const O=document.createElement("div");x.addClass(O,"art-setting-item-left-text"),x.append(O,_.html||""),x.append(L,O),_.$html=O,x.def(_,"html",{get:()=>O.innerHTML,set(D){c(D)&&(O.innerHTML=D)}});const I=document.createElement("div");switch(x.addClass(I,"art-setting-item-right-tooltip"),x.append(I,_.tooltip||""),x.append(R,I),_.$tooltip=I,x.def(_,"tooltip",{get:()=>I.innerHTML,set(D){c(D)&&(I.innerHTML=D)}}),u){case"switch":{const D=document.createElement("div");x.addClass(D,"art-setting-item-right-icon");const C=x.append(D,b.switchOn),P=x.append(D,b.switchOff);x.setStyle(_.switch?P:C,"display","none"),x.append(R,D),_.$switch=_.switch,x.def(_,"switch",{get:()=>_.$switch,set(M){_.$switch=M,M?(x.setStyle(P,"display","none"),x.setStyle(C,"display",null)):(x.setStyle(P,"display",null),x.setStyle(C,"display","none"))}});break}case"range":{const D=document.createElement("div");x.addClass(D,"art-setting-item-right-icon");const C=x.append(D,'<input type="range">');C.value=_.range[0]||0,C.min=_.range[1]||0,C.max=_.range[2]||10,C.step=_.range[3]||1,x.addClass(C,"art-setting-range"),x.append(R,D),_.$range=C,x.def(_,"range",{get:()=>C.valueAsNumber,set(P){C.value=Number(P)}})}break;case"selector":if(_.selector&&_.selector.length){const D=document.createElement("div");x.addClass(D,"art-setting-item-right-icon"),x.append(D,b.arrowRight),x.append(R,D)}}switch(u){case"switch":if(_.onSwitch){const D=T(A,"click",C=>yr(this,null,function*(){_.switch=yield _.onSwitch.call(this.art,_,A,C)}));this.events.push(D)}break;case"range":if(_.onRange&&_.$range){const D=T(_.$range,"change",C=>yr(this,null,function*(){_.tooltip=yield _.onRange.call(this.art,_,A,C)}));this.events.push(D)}break;case"selector":{const D=T(A,"click",C=>yr(this,null,function*(){if(_.selector&&_.selector.length)this.init(_.selector,_.width);else if(x.inverseClass(A,"art-current"),_.$parentList&&this.init(_.$parentList),_.$parentItem&&_.$parentItem.onSelect){const P=yield _.$parentItem.onSelect.call(this.art,_,A,C);_.$parentItem.$tooltip&&c(P)&&(_.$parentItem.$tooltip.innerHTML=P)}}));this.events.push(D),_.default&&x.addClass(A,"art-current")}}return A}init(u,_){const{constructor:b}=this.art;if(this.cache.has(u)){const T=this.cache.get(u);x.inverseClass(T,"art-current"),x.setStyle(this.$parent,"width",`${T.dataset.width}px`),x.setStyle(this.$parent,"height",`${T.dataset.height}px`)}else{const T=document.createElement("div");x.addClass(T,"art-setting-panel"),T.dataset.width=_||b.SETTING_WIDTH,T.dataset.height=u.length*b.SETTING_ITEM_HEIGHT,u[0]&&u[0].$parentItem&&(x.append(T,this.creatHeader(u[0])),T.dataset.height=Number(T.dataset.height)+b.SETTING_ITEM_HEIGHT);for(let A=0;A<u.length;A++){const L=u[A];x.has(L,"switch")?x.append(T,this.creatItem("switch",L)):x.has(L,"range")?x.append(T,this.creatItem("range",L)):x.append(T,this.creatItem("selector",L))}x.append(this.$parent,T),this.cache.set(u,T),x.inverseClass(T,"art-current"),x.setStyle(this.$parent,"width",`${T.dataset.width}px`),x.setStyle(this.$parent,"height",`${T.dataset.height}px`),u[0]&&u[0].$parentItem&&u[0].$parentItem.mounted&&u[0].$parentItem.mounted.call(this.art,T,u[0].$parentItem)}}}t.default=p},{"./flip":"ah3Qs","./aspectRatio":"1gs5B","./playbackRate":"j50mh","./subtitleOffset":"i17b6","../utils/component":"kPHYl","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ah3Qs:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:l,constructor:v}=a,h={normal:"Normal",horizontal:"Horizontal",vertical:"Vertical"};function f(d,g,E){g&&(g.innerText=o.get(h[E]));const S=n.queryAll(".art-setting-item",d).find(x=>x.dataset.value===E);S&&n.inverseClass(S,"art-current")}return{width:v.SETTING_ITEM_WIDTH,html:o.get("Video Flip"),tooltip:o.get(h[a.flip]),icon:l.flip,selector:Object.keys(h).map(d=>({value:d,default:d===a.flip,html:o.get(h[d])})),onSelect(d){a.flip=d.value},mounted:(d,g)=>{f(d,g.$tooltip,a.flip),a.on("flip",()=>{f(d,g.$tooltip,a.flip)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1gs5B":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:l,constructor:v}=a;function h(d){return d==="default"?o.get("Default"):d}function f(d,g,E){g&&(g.innerText=h(E));const S=n.queryAll(".art-setting-item",d).find(x=>x.dataset.value===E);S&&n.inverseClass(S,"art-current")}return{width:v.SETTING_ITEM_WIDTH,html:o.get("Aspect Ratio"),icon:l.aspectRatio,tooltip:h(a.aspectRatio),selector:["default","4:3","16:9"].map(d=>({value:d,default:d===a.aspectRatio,html:h(d)})),onSelect(d){a.aspectRatio=d.value},mounted:(d,g)=>{f(d,g.$tooltip,a.aspectRatio),a.on("aspectRatio",()=>{f(d,g.$tooltip,a.aspectRatio)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j50mh:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:l,constructor:v}=a;function h(d){return d===1?o.get("Normal"):d}function f(d,g,E){g&&(g.innerText=h(E));const S=n.queryAll(".art-setting-item",d).find(x=>Number(x.dataset.value)===E);S&&n.inverseClass(S,"art-current")}return{width:v.SETTING_ITEM_WIDTH,html:o.get("Play Speed"),tooltip:h(a.playbackRate),icon:l.playbackRate,selector:[.5,.75,1,1.25,1.5,2].map(d=>({value:d,default:d===a.playbackRate,html:h(d)})),onSelect(d){a.playbackRate=d.value},mounted:(d,g)=>{f(d,g.$tooltip,a.playbackRate),a.on("playbackRate",()=>{f(d,g.$tooltip,a.playbackRate)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i17b6:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,icons:l,constructor:v}=a;function h(d){return d===0?o.get("Normal"):d}function f(d,g,E){g&&(g.innerText=h(E));const S=n.queryAll(".art-setting-item",d).find(x=>Number(x.dataset.value)===E);S&&n.inverseClass(S,"art-current")}return{width:v.SETTING_ITEM_WIDTH,html:o.get("Subtitle Offset"),tooltip:h(a.subtitleOffset),icon:l.subtitle,selector:[-5,-4,-3,-2,-1,0,1,2,3,4,5].map(d=>({value:d,default:d===a.subtitleOffset,html:h(d)})),onSelect(d){a.subtitleOffset=d.value},mounted:(d,g)=>{f(d,g.$tooltip,a.subtitleOffset),a.on("subtitleOffset",()=>{f(d,g.$tooltip,a.subtitleOffset)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5M8nN":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(n){try{const a=JSON.parse(window.localStorage.getItem(this.name))||{};return n?a[n]:a}catch(a){return n?this.settings[n]:this.settings}}set(n,a){try{const o=Object.assign({},this.get(),{[n]:a});window.localStorage.setItem(this.name,JSON.stringify(o))}catch(o){this.settings[n]=a}}del(n){try{const a=this.get();delete a[n],window.localStorage.setItem(this.name,JSON.stringify(a))}catch(a){delete this.settings[n]}}clear(){try{window.localStorage.removeItem(this.name)}catch(n){this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jWfEd:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("../utils"),o=r("./miniProgressBar"),l=n.interopDefault(o),v=r("./autoOrientation"),h=n.interopDefault(v),f=r("./autoPlayback"),d=n.interopDefault(f),g=r("./fastForward"),E=n.interopDefault(g),S=r("./lock"),x=n.interopDefault(S);t.default=class{constructor(m){this.art=m,this.id=0;const{option:c}=m;c.miniProgressBar&&!c.isLive&&this.add(l.default),c.lock&&a.isMobile&&this.add(x.default),c.autoPlayback&&this.add(d.default),c.autoOrientation&&a.isMobile&&this.add(h.default),c.fastForward&&a.isMobile&&!c.isLive&&this.add(E.default);for(let p=0;p<c.plugins.length;p++)this.add(c.plugins[p])}add(m){this.id+=1;const c=m.call(this,this.art),p=c&&c.name||m.name||`plugin${this.id}`;return a.errorHandle(!a.has(this,p),`Cannot add a plugin that already has the same name: ${p}`),a.def(this,p,{value:c}),this}}},{"../utils":"geSvU","./miniProgressBar":"7KBj0","./autoOrientation":"aPIVP","./autoPlayback":"j87OI","./fastForward":"1VTki","./lock":"7BtoE","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7KBj0":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=function(n){return n.on("ready",()=>{n.layers.add({name:"miniProgressBar",mounted(a){n.on("destroy",()=>{a.style.display="none"}),n.on("video:timeupdate",()=>{a.style.width=100*n.played+"%"}),n.on("setBar",(o,l)=>{o==="played"&&(a.style.width=100*l+"%")})}})}),{name:"miniProgressBar"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPIVP:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{option:o,constructor:l,template:{$player:v,$video:h}}=a;return a.on("fullscreenWeb",f=>{if(f){const{videoWidth:d,videoHeight:g}=h,{clientWidth:E,clientHeight:S}=document.documentElement;(d>g&&E<S||d<g&&E>S)&&setTimeout(()=>{n.setStyle(v,"width",`${S}px`),n.setStyle(v,"height",`${E}px`),n.setStyle(v,"transform-origin","0 0"),n.setStyle(v,"transform",`rotate(90deg) translate(0, -${E}px)`),n.addClass(v,"art-auto-orientation"),a.emit("resize")},l.MOBILE_AUTO_ORIENTATION_TIME)}else n.hasClass(v,"art-auto-orientation")&&(n.setStyle(v,"width",null),n.setStyle(v,"height",null),n.setStyle(v,"transform",null),n.setStyle(v,"transform-origin",null),n.removeClass(v,"art-auto-orientation"),a.aspectRatioReset=!0,a.autoSize=o.autoSize,a.notice.show="",a.emit("resize"))}),a.on("fullscreen",f=>yr(this,null,function*(){const d=screen.orientation.type;if(f){const{videoWidth:g,videoHeight:E}=h,{clientWidth:S,clientHeight:x}=document.documentElement;if(g>E&&S<x||g<E&&S>x){const m=d.startsWith("portrait")?"landscape":"portrait";yield screen.orientation.lock(m),n.addClass(v,"art-auto-orientation-fullscreen")}}else n.hasClass(v,"art-auto-orientation-fullscreen")&&(yield screen.orientation.lock(d),n.removeClass(v,"art-auto-orientation-fullscreen"))})),{name:"autoOrientation",get state(){return n.hasClass(v,"art-auto-orientation")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j87OI:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{i18n:o,storage:l,constructor:v,template:{$poster:h}}=a;return a.on("video:timeupdate",()=>{const f=l.get("times")||{},d=Object.keys(f);d.length>v.AUTO_PLAYBACK_MAX&&delete f[d[0]],f[a.option.url]=a.currentTime,l.set("times",f)}),a.on("ready",()=>{const f=(l.get("times")||{})[a.option.url];f&&(a.seek=f,n.setStyle(h,"display","none"),a.notice.show=`${o.get("Auto playback at")} ${n.secondToTime(f)}`)}),{name:"autoPlayback",get times(){return l.get("times")||{}},clear:()=>l.del("times")}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1VTki":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{constructor:o,events:{proxy:l},template:{$player:v,$video:h}}=a;let f=null,d=!1;const g=()=>{clearTimeout(f),d&&(d=!1,a.playbackRate=1,n.removeClass(v,"art-fast-forward"))};return l(h,"touchstart",E=>{E.touches.length===1&&a.playing&&!a.isLock&&(f=setTimeout(()=>{d=!0,a.playbackRate=o.FAST_FORWARD_VALUE,n.addClass(v,"art-fast-forward")},o.FAST_FORWARD_TIME))}),l(document,"touchmove",g),l(document,"touchend",g),{name:"fastForward",get state(){return n.hasClass(v,"art-fast-forward")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7BtoE":[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var n=r("../utils");t.default=function(a){const{layers:o,icons:l,template:{$player:v}}=a;return o.add({name:"lock",mounted(h){const f=n.append(h,l.lock),d=n.append(h,l.unlock);n.setStyle(f,"display","none"),a.on("lock",g=>{g?(n.setStyle(f,"display","inline-flex"),n.setStyle(d,"display","none")):(n.setStyle(f,"display","none"),n.setStyle(d,"display","inline-flex"))})},click(){n.hasClass(v,"art-lock")?(n.removeClass(v,"art-lock"),this.isLock=!1,a.emit("lock",!1)):(n.addClass(v,"art-lock"),this.isLock=!0,a.emit("lock",!0))}}),{name:"lock",get state(){return n.hasClass(v,"art-lock")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aafSd:[function(r,i,t){r("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t),t.default=class{constructor(n){this.art=n,this.init()}get current(){return this.art.option.ads[this.index]}get prev(){return this.art.option.ads[this.index-1]}get next(){return this.art.option.ads[this.index+1]}init(){this.index=0,this.isEnd=!1,this.playing=!1,this.urlCache=this.art.option.url,this.current&&(this.playing=!0,this.play(this.current))}play(n={}){this.isEnd||(this.art.switchUrl(n.url),this.art.once("video:timeupdate",()=>{this.art.emit("ads:start",n)}),this.art.once("video:ended",()=>{const a=this.next;a?(this.index+=1,this.play(a)):this.end()}))}end(){this.isEnd||(this.isEnd=!0,this.playing=!1,this.art.option.url=this.urlCache,this.art.switchUrl(this.urlCache),this.art.emit("ads:end"))}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fkUkB:[function(r,i,t){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t);var a=r("./config"),o=n.interopDefault(a),l=r("./utils");t.default=class{constructor(v){const{option:h,events:{proxy:f},template:{$video:d}}=v;for(let S=0;S<o.default.events.length;S++)f(d,o.default.events[S],x=>{v.emit(`video:${x.type}`,x)});Object.keys(h.moreVideoAttr).forEach(S=>{d[S]=h.moreVideoAttr[S]}),h.muted&&(d.muted=h.muted),h.volume&&(d.volume=l.clamp(h.volume,0,1)),h.poster&&(d.poster=h.poster),h.autoplay&&(d.autoplay=h.autoplay),h.playsInline&&(d.playsInline=!0,d["webkit-playsinline"]=!0);const g=h.type||l.getExt(h.url),E=h.customType[g];g&&E?(E(d,h.url,v),v.emit("customType",g)):(d.src=h.url,v.emit("url",d.src))}}},{"./config":"eksZR","./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}]},["6SN6P"],"6SN6P")})(Ih);var MT=bo(Ih.exports),Rh={exports:{}};(function(s,e){(function(i,t){s.exports=t()})(self,function(){return function(){var r={"./node_modules/es6-promise/dist/es6-promise.js":function(a,o,l){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(v,h){a.exports=h()})(this,function(){function v(ne){var Ee=typeof ne;return ne!==null&&(Ee==="object"||Ee==="function")}function h(ne){return typeof ne=="function"}var f=void 0;Array.isArray?f=Array.isArray:f=function(ne){return Object.prototype.toString.call(ne)==="[object Array]"};var d=f,g=0,E=void 0,S=void 0,x=function(Ee,xe){O[g]=Ee,O[g+1]=xe,g+=2,g===2&&(S?S(I):C())};function m(ne){S=ne}function c(ne){x=ne}var p=typeof window!="undefined"?window:void 0,y=p||{},u=y.MutationObserver||y.WebKitMutationObserver,_=typeof self=="undefined"&&typeof process!="undefined"&&{}.toString.call(process)==="[object process]",b=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function T(){return function(){return process.nextTick(I)}}function A(){return typeof E!="undefined"?function(){E(I)}:w()}function L(){var ne=0,Ee=new u(I),xe=document.createTextNode("");return Ee.observe(xe,{characterData:!0}),function(){xe.data=ne=++ne%2}}function R(){var ne=new MessageChannel;return ne.port1.onmessage=I,function(){return ne.port2.postMessage(0)}}function w(){var ne=setTimeout;return function(){return ne(I,1)}}var O=new Array(1e3);function I(){for(var ne=0;ne<g;ne+=2){var Ee=O[ne],xe=O[ne+1];Ee(xe),O[ne]=void 0,O[ne+1]=void 0}g=0}function D(){try{var ne=Function("return this")().require("vertx");return E=ne.runOnLoop||ne.runOnContext,A()}catch(Ee){return w()}}var C=void 0;_?C=T():u?C=L():b?C=R():p===void 0?C=D():C=w();function P(ne,Ee){var xe=this,we=new this.constructor(B);we[N]===void 0&&$e(we);var be=xe._state;if(be){var je=arguments[be-1];x(function(){return Ue(be,we,je,xe._result)})}else Ie(xe,we,ne,Ee);return we}function M(ne){var Ee=this;if(ne&&typeof ne=="object"&&ne.constructor===Ee)return ne;var xe=new Ee(B);return de(xe,ne),xe}var N=Math.random().toString(36).substring(2);function B(){}var U=void 0,F=1,j=2;function V(){return new TypeError("You cannot resolve a promise with itself")}function G(){return new TypeError("A promises callback cannot return that same promise.")}function Y(ne,Ee,xe,we){try{ne.call(Ee,xe,we)}catch(be){return be}}function X(ne,Ee,xe){x(function(we){var be=!1,je=Y(xe,Ee,function(K){be||(be=!0,Ee!==K?de(we,K):pe(we,K))},function(K){be||(be=!0,le(we,K))},"Settle: "+(we._label||" unknown promise"));!be&&je&&(be=!0,le(we,je))},ne)}function ie(ne,Ee){Ee._state===F?pe(ne,Ee._result):Ee._state===j?le(ne,Ee._result):Ie(Ee,void 0,function(xe){return de(ne,xe)},function(xe){return le(ne,xe)})}function he(ne,Ee,xe){Ee.constructor===ne.constructor&&xe===P&&Ee.constructor.resolve===M?ie(ne,Ee):xe===void 0?pe(ne,Ee):h(xe)?X(ne,Ee,xe):pe(ne,Ee)}function de(ne,Ee){if(ne===Ee)le(ne,V());else if(v(Ee)){var xe=void 0;try{xe=Ee.then}catch(we){le(ne,we);return}he(ne,Ee,xe)}else pe(ne,Ee)}function Ae(ne){ne._onerror&&ne._onerror(ne._result),Ce(ne)}function pe(ne,Ee){ne._state===U&&(ne._result=Ee,ne._state=F,ne._subscribers.length!==0&&x(Ce,ne))}function le(ne,Ee){ne._state===U&&(ne._state=j,ne._result=Ee,x(Ae,ne))}function Ie(ne,Ee,xe,we){var be=ne._subscribers,je=be.length;ne._onerror=null,be[je]=Ee,be[je+F]=xe,be[je+j]=we,je===0&&ne._state&&x(Ce,ne)}function Ce(ne){var Ee=ne._subscribers,xe=ne._state;if(Ee.length!==0){for(var we=void 0,be=void 0,je=ne._result,K=0;K<Ee.length;K+=3)we=Ee[K],be=Ee[K+xe],we?Ue(xe,we,be,je):be(je);ne._subscribers.length=0}}function Ue(ne,Ee,xe,we){var be=h(xe),je=void 0,K=void 0,ce=!0;if(be){try{je=xe(we)}catch(_e){ce=!1,K=_e}if(Ee===je){le(Ee,G());return}}else je=we;Ee._state!==U||(be&&ce?de(Ee,je):ce===!1?le(Ee,K):ne===F?pe(Ee,je):ne===j&&le(Ee,je))}function Me(ne,Ee){try{Ee(function(we){de(ne,we)},function(we){le(ne,we)})}catch(xe){le(ne,xe)}}var ze=0;function Ge(){return ze++}function $e(ne){ne[N]=ze++,ne._state=void 0,ne._result=void 0,ne._subscribers=[]}function Ke(){return new Error("Array Methods must be provided an Array")}var Ne=function(){function ne(Ee,xe){this._instanceConstructor=Ee,this.promise=new Ee(B),this.promise[N]||$e(this.promise),d(xe)?(this.length=xe.length,this._remaining=xe.length,this._result=new Array(this.length),this.length===0?pe(this.promise,this._result):(this.length=this.length||0,this._enumerate(xe),this._remaining===0&&pe(this.promise,this._result))):le(this.promise,Ke())}return ne.prototype._enumerate=function(xe){for(var we=0;this._state===U&&we<xe.length;we++)this._eachEntry(xe[we],we)},ne.prototype._eachEntry=function(xe,we){var be=this._instanceConstructor,je=be.resolve;if(je===M){var K=void 0,ce=void 0,_e=!1;try{K=xe.then}catch(Z){_e=!0,ce=Z}if(K===P&&xe._state!==U)this._settledAt(xe._state,we,xe._result);else if(typeof K!="function")this._remaining--,this._result[we]=xe;else if(be===nt){var Re=new be(B);_e?le(Re,ce):he(Re,xe,K),this._willSettleAt(Re,we)}else this._willSettleAt(new be(function(Z){return Z(xe)}),we)}else this._willSettleAt(je(xe),we)},ne.prototype._settledAt=function(xe,we,be){var je=this.promise;je._state===U&&(this._remaining--,xe===j?le(je,be):this._result[we]=be),this._remaining===0&&pe(je,this._result)},ne.prototype._willSettleAt=function(xe,we){var be=this;Ie(xe,void 0,function(je){return be._settledAt(F,we,je)},function(je){return be._settledAt(j,we,je)})},ne}();function Te(ne){return new Ne(this,ne).promise}function et(ne){var Ee=this;return d(ne)?new Ee(function(xe,we){for(var be=ne.length,je=0;je<be;je++)Ee.resolve(ne[je]).then(xe,we)}):new Ee(function(xe,we){return we(new TypeError("You must pass an array to race."))})}function st(ne){var Ee=this,xe=new Ee(B);return le(xe,ne),xe}function qe(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ot(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var nt=function(){function ne(Ee){this[N]=Ge(),this._result=this._state=void 0,this._subscribers=[],B!==Ee&&(typeof Ee!="function"&&qe(),this instanceof ne?Me(this,Ee):ot())}return ne.prototype.catch=function(xe){return this.then(null,xe)},ne.prototype.finally=function(xe){var we=this,be=we.constructor;return h(xe)?we.then(function(je){return be.resolve(xe()).then(function(){return je})},function(je){return be.resolve(xe()).then(function(){throw je})}):we.then(xe,xe)},ne}();nt.prototype.then=P,nt.all=Te,nt.race=et,nt.resolve=M,nt.reject=st,nt._setScheduler=m,nt._setAsap=c,nt._asap=x;function dt(){var ne=void 0;if(typeof l.g!="undefined")ne=l.g;else if(typeof self!="undefined")ne=self;else try{ne=Function("return this")()}catch(we){throw new Error("polyfill failed because global object is unavailable in this environment")}var Ee=ne.Promise;if(Ee){var xe=null;try{xe=Object.prototype.toString.call(Ee.resolve())}catch(we){}if(xe==="[object Promise]"&&!Ee.cast)return}ne.Promise=nt}return nt.polyfill=dt,nt.Promise=nt,nt})},"./node_modules/events/events.js":function(a){var o=typeof Reflect=="object"?Reflect:null,l=o&&typeof o.apply=="function"?o.apply:function(w,O,I){return Function.prototype.apply.call(w,O,I)},v;o&&typeof o.ownKeys=="function"?v=o.ownKeys:Object.getOwnPropertySymbols?v=function(w){return Object.getOwnPropertyNames(w).concat(Object.getOwnPropertySymbols(w))}:v=function(w){return Object.getOwnPropertyNames(w)};function h(R){console&&console.warn&&console.warn(R)}var f=Number.isNaN||function(w){return w!==w};function d(){d.init.call(this)}a.exports=d,a.exports.once=T,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._eventsCount=0,d.prototype._maxListeners=void 0;var g=10;function E(R){if(typeof R!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof R)}Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(R){if(typeof R!="number"||R<0||f(R))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+R+".");g=R}}),d.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},d.prototype.setMaxListeners=function(w){if(typeof w!="number"||w<0||f(w))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+w+".");return this._maxListeners=w,this};function S(R){return R._maxListeners===void 0?d.defaultMaxListeners:R._maxListeners}d.prototype.getMaxListeners=function(){return S(this)},d.prototype.emit=function(w){for(var O=[],I=1;I<arguments.length;I++)O.push(arguments[I]);var D=w==="error",C=this._events;if(C!==void 0)D=D&&C.error===void 0;else if(!D)return!1;if(D){var P;if(O.length>0&&(P=O[0]),P instanceof Error)throw P;var M=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw M.context=P,M}var N=C[w];if(N===void 0)return!1;if(typeof N=="function")l(N,this,O);else for(var B=N.length,U=u(N,B),I=0;I<B;++I)l(U[I],this,O);return!0};function x(R,w,O,I){var D,C,P;if(E(O),C=R._events,C===void 0?(C=R._events=Object.create(null),R._eventsCount=0):(C.newListener!==void 0&&(R.emit("newListener",w,O.listener?O.listener:O),C=R._events),P=C[w]),P===void 0)P=C[w]=O,++R._eventsCount;else if(typeof P=="function"?P=C[w]=I?[O,P]:[P,O]:I?P.unshift(O):P.push(O),D=S(R),D>0&&P.length>D&&!P.warned){P.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=R,M.type=w,M.count=P.length,h(M)}return R}d.prototype.addListener=function(w,O){return x(this,w,O,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(w,O){return x(this,w,O,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(R,w,O){var I={fired:!1,wrapFn:void 0,target:R,type:w,listener:O},D=m.bind(I);return D.listener=O,I.wrapFn=D,D}d.prototype.once=function(w,O){return E(O),this.on(w,c(this,w,O)),this},d.prototype.prependOnceListener=function(w,O){return E(O),this.prependListener(w,c(this,w,O)),this},d.prototype.removeListener=function(w,O){var I,D,C,P,M;if(E(O),D=this._events,D===void 0)return this;if(I=D[w],I===void 0)return this;if(I===O||I.listener===O)--this._eventsCount==0?this._events=Object.create(null):(delete D[w],D.removeListener&&this.emit("removeListener",w,I.listener||O));else if(typeof I!="function"){for(C=-1,P=I.length-1;P>=0;P--)if(I[P]===O||I[P].listener===O){M=I[P].listener,C=P;break}if(C<0)return this;C===0?I.shift():_(I,C),I.length===1&&(D[w]=I[0]),D.removeListener!==void 0&&this.emit("removeListener",w,M||O)}return this},d.prototype.off=d.prototype.removeListener,d.prototype.removeAllListeners=function(w){var O,I,D;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[w]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete I[w]),this;if(arguments.length===0){var C=Object.keys(I),P;for(D=0;D<C.length;++D)P=C[D],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(O=I[w],typeof O=="function")this.removeListener(w,O);else if(O!==void 0)for(D=O.length-1;D>=0;D--)this.removeListener(w,O[D]);return this};function p(R,w,O){var I=R._events;if(I===void 0)return[];var D=I[w];return D===void 0?[]:typeof D=="function"?O?[D.listener||D]:[D]:O?b(D):u(D,D.length)}d.prototype.listeners=function(w){return p(this,w,!0)},d.prototype.rawListeners=function(w){return p(this,w,!1)},d.listenerCount=function(R,w){return typeof R.listenerCount=="function"?R.listenerCount(w):y.call(R,w)},d.prototype.listenerCount=y;function y(R){var w=this._events;if(w!==void 0){var O=w[R];if(typeof O=="function")return 1;if(O!==void 0)return O.length}return 0}d.prototype.eventNames=function(){return this._eventsCount>0?v(this._events):[]};function u(R,w){for(var O=new Array(w),I=0;I<w;++I)O[I]=R[I];return O}function _(R,w){for(;w+1<R.length;w++)R[w]=R[w+1];R.pop()}function b(R){for(var w=new Array(R.length),O=0;O<w.length;++O)w[O]=R[O].listener||R[O];return w}function T(R,w){return new Promise(function(O,I){function D(P){R.removeListener(w,C),I(P)}function C(){typeof R.removeListener=="function"&&R.removeListener("error",D),O([].slice.call(arguments))}L(R,w,C,{once:!0}),w!=="error"&&A(R,D,{once:!0})})}function A(R,w,O){typeof R.on=="function"&&L(R,"error",w,O)}function L(R,w,O,I){if(typeof R.on=="function")I.once?R.once(w,O):R.on(w,O);else if(typeof R.addEventListener=="function")R.addEventListener(w,function D(C){I.once&&R.removeEventListener(w,D),O(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof R)}},"./node_modules/webworkify-webpack/index.js":function(a,o,l){function v(m){var c={};function p(u){if(c[u])return c[u].exports;var _=c[u]={i:u,l:!1,exports:{}};return m[u].call(_.exports,_,_.exports,p),_.l=!0,_.exports}p.m=m,p.c=c,p.i=function(u){return u},p.d=function(u,_,b){p.o(u,_)||Object.defineProperty(u,_,{configurable:!1,enumerable:!0,get:b})},p.r=function(u){Object.defineProperty(u,"__esModule",{value:!0})},p.n=function(u){var _=u&&u.__esModule?function(){return u.default}:function(){return u};return p.d(_,"a",_),_},p.o=function(u,_){return Object.prototype.hasOwnProperty.call(u,_)},p.p="/",p.oe=function(u){throw console.error(u),u};var y=p(p.s=ENTRY_MODULE);return y.default||y}var h="[\\.|\\-|\\+|\\w|/|@]+",f="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+h+").*?\\)";function d(m){return(m+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function g(m){return!isNaN(1*m)}function E(m,c,p){var y={};y[p]=[];var u=c.toString(),_=u.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!_)return y;for(var b=_[1],T=new RegExp("(\\\\n|\\W)"+d(b)+f,"g"),A;A=T.exec(u);)A[3]!=="dll-reference"&&y[p].push(A[3]);for(T=new RegExp("\\("+d(b)+'\\("(dll-reference\\s('+h+'))"\\)\\)'+f,"g");A=T.exec(u);)m[A[2]]||(y[p].push(A[1]),m[A[2]]=l(A[1]).m),y[A[2]]=y[A[2]]||[],y[A[2]].push(A[4]);for(var L=Object.keys(y),R=0;R<L.length;R++)for(var w=0;w<y[L[R]].length;w++)g(y[L[R]][w])&&(y[L[R]][w]=1*y[L[R]][w]);return y}function S(m){var c=Object.keys(m);return c.reduce(function(p,y){return p||m[y].length>0},!1)}function x(m,c){for(var p={main:[c]},y={main:[]},u={main:{}};S(p);)for(var _=Object.keys(p),b=0;b<_.length;b++){var T=_[b],A=p[T],L=A.pop();if(u[T]=u[T]||{},!(u[T][L]||!m[T][L])){u[T][L]=!0,y[T]=y[T]||[],y[T].push(L);for(var R=E(m,m[T][L],T),w=Object.keys(R),O=0;O<w.length;O++)p[w[O]]=p[w[O]]||[],p[w[O]]=p[w[O]].concat(R[w[O]])}}return y}a.exports=function(m,c){c=c||{};var p={main:l.m},y=c.all?{main:Object.keys(p.main)}:x(p,m),u="";Object.keys(y).filter(function(L){return L!=="main"}).forEach(function(L){for(var R=0;y[L][R];)R++;y[L].push(R),p[L][R]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",u=u+"var "+L+" = ("+v.toString().replace("ENTRY_MODULE",JSON.stringify(R))+")({"+y[L].map(function(w){return""+JSON.stringify(w)+": "+p[L][w].toString()}).join(",")+`});
`}),u=u+"new (("+v.toString().replace("ENTRY_MODULE",JSON.stringify(m))+")({"+y.main.map(function(L){return""+JSON.stringify(L)+": "+p.main[L].toString()}).join(",")+"}))(self);";var _=new window.Blob([u],{type:"text/javascript"});if(c.bare)return _;var b=window.URL||window.webkitURL||window.mozURL||window.msURL,T=b.createObjectURL(_),A=new window.Worker(T);return A.objectURL=T,A}},"./src/config.js":function(a,o,l){l.r(o),l.d(o,{defaultConfig:function(){return v},createDefaultConfig:function(){return h}});var v={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function h(){return Object.assign({},v)}},"./src/core/features.js":function(a,o,l){l.r(o);var v=l("./src/io/io-controller.js"),h=l("./src/config.js"),f=function(){function d(){}return d.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},d.supportNetworkStreamIO=function(){var g=new v.default({},(0,h.createDefaultConfig)()),E=g.loaderType;return g.destroy(),E=="fetch-stream-loader"||E=="xhr-moz-chunked-loader"},d.getNetworkLoaderTypeName=function(){var g=new v.default({},(0,h.createDefaultConfig)()),E=g.loaderType;return g.destroy(),E},d.supportNativeMediaPlayback=function(g){d.videoElement==null&&(d.videoElement=window.document.createElement("video"));var E=d.videoElement.canPlayType(g);return E==="probably"||E=="maybe"},d.getFeatureList=function(){var g={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return g.mseFlvPlayback=d.supportMSEH264Playback(),g.networkStreamIO=d.supportNetworkStreamIO(),g.networkLoaderName=d.getNetworkLoaderTypeName(),g.mseLiveFlvPlayback=g.mseFlvPlayback&&g.networkStreamIO,g.nativeMP4H264Playback=d.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),g.nativeWebmVP8Playback=d.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),g.nativeWebmVP9Playback=d.supportNativeMediaPlayback('video/webm; codecs="vp9"'),g},d}();o.default=f},"./src/core/media-info.js":function(a,o,l){l.r(o);var v=function(){function h(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return h.prototype.isComplete=function(){var f=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,d=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&f&&d},h.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},h.prototype.getNearestKeyframe=function(f){if(this.keyframesIndex==null)return null;var d=this.keyframesIndex,g=this._search(d.times,f);return{index:g,milliseconds:d.times[g],fileposition:d.filepositions[g]}},h.prototype._search=function(f,d){var g=0,E=f.length-1,S=0,x=0,m=E;for(d<f[0]&&(g=0,x=m+1);x<=m;)if(S=x+Math.floor((m-x)/2),S===E||d>=f[S]&&d<f[S+1]){g=S;break}else f[S]<d?x=S+1:m=S-1;return g},h}();o.default=v},"./src/core/media-segment-info.js":function(a,o,l){l.r(o),l.d(o,{SampleInfo:function(){return v},MediaSegmentInfo:function(){return h},IDRSampleList:function(){return f},MediaSegmentInfoList:function(){return d}});var v=function(){function g(E,S,x,m,c){this.dts=E,this.pts=S,this.duration=x,this.originalDts=m,this.isSyncPoint=c,this.fileposition=null}return g}(),h=function(){function g(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return g.prototype.appendSyncPoint=function(E){E.isSyncPoint=!0,this.syncPoints.push(E)},g}(),f=function(){function g(){this._list=[]}return g.prototype.clear=function(){this._list=[]},g.prototype.appendArray=function(E){var S=this._list;E.length!==0&&(S.length>0&&E[0].originalDts<S[S.length-1].originalDts&&this.clear(),Array.prototype.push.apply(S,E))},g.prototype.getLastSyncPointBeforeDts=function(E){if(this._list.length==0)return null;var S=this._list,x=0,m=S.length-1,c=0,p=0,y=m;for(E<S[0].dts&&(x=0,p=y+1);p<=y;)if(c=p+Math.floor((y-p)/2),c===m||E>=S[c].dts&&E<S[c+1].dts){x=c;break}else S[c].dts<E?p=c+1:y=c-1;return this._list[x]},g}(),d=function(){function g(E){this._type=E,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),g.prototype.isEmpty=function(){return this._list.length===0},g.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},g.prototype._searchNearestSegmentBefore=function(E){var S=this._list;if(S.length===0)return-2;var x=S.length-1,m=0,c=0,p=x,y=0;if(E<S[0].originalBeginDts)return y=-1,y;for(;c<=p;)if(m=c+Math.floor((p-c)/2),m===x||E>S[m].lastSample.originalDts&&E<S[m+1].originalBeginDts){y=m;break}else S[m].originalBeginDts<E?c=m+1:p=m-1;return y},g.prototype._searchNearestSegmentAfter=function(E){return this._searchNearestSegmentBefore(E)+1},g.prototype.append=function(E){var S=this._list,x=E,m=this._lastAppendLocation,c=0;m!==-1&&m<S.length&&x.originalBeginDts>=S[m].lastSample.originalDts&&(m===S.length-1||m<S.length-1&&x.originalBeginDts<S[m+1].originalBeginDts)?c=m+1:S.length>0&&(c=this._searchNearestSegmentBefore(x.originalBeginDts)+1),this._lastAppendLocation=c,this._list.splice(c,0,x)},g.prototype.getLastSegmentBefore=function(E){var S=this._searchNearestSegmentBefore(E);return S>=0?this._list[S]:null},g.prototype.getLastSampleBefore=function(E){var S=this.getLastSegmentBefore(E);return S!=null?S.lastSample:null},g.prototype.getLastSyncPointBefore=function(E){for(var S=this._searchNearestSegmentBefore(E),x=this._list[S].syncPoints;x.length===0&&S>0;)S--,x=this._list[S].syncPoints;return x.length>0?x[x.length-1]:null},g}()},"./src/core/mse-controller.js":function(a,o,l){l.r(o);var v=l("./node_modules/events/events.js"),h=l.n(v),f=l("./src/utils/logger.js"),d=l("./src/utils/browser.js"),g=l("./src/core/mse-events.js"),E=l("./src/core/media-segment-info.js"),S=l("./src/utils/exception.js"),x=function(){function m(c){this.TAG="MSEController",this._config=c,this._emitter=new(h()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new E.IDRSampleList}return m.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},m.prototype.on=function(c,p){this._emitter.addListener(c,p)},m.prototype.off=function(c,p){this._emitter.removeListener(c,p)},m.prototype.attachMediaElement=function(c){if(this._mediaSource)throw new S.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var p=this._mediaSource=new window.MediaSource;p.addEventListener("sourceopen",this.e.onSourceOpen),p.addEventListener("sourceended",this.e.onSourceEnded),p.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=c,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),c.src=this._mediaSourceObjectURL},m.prototype.detachMediaElement=function(){if(this._mediaSource){var c=this._mediaSource;for(var p in this._sourceBuffers){var y=this._pendingSegments[p];y.splice(0,y.length),this._pendingSegments[p]=null,this._pendingRemoveRanges[p]=null,this._lastInitSegments[p]=null;var u=this._sourceBuffers[p];if(u){if(c.readyState!=="closed"){try{c.removeSourceBuffer(u)}catch(_){f.default.e(this.TAG,_.message)}u.removeEventListener("error",this.e.onSourceBufferError),u.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[p]=null,this._sourceBuffers[p]=null}}if(c.readyState==="open")try{c.endOfStream()}catch(_){f.default.e(this.TAG,_.message)}c.removeEventListener("sourceopen",this.e.onSourceOpen),c.removeEventListener("sourceended",this.e.onSourceEnded),c.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},m.prototype.appendInitSegment=function(c,p){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(c),this._pendingSegments[c.type].push(c);return}var y=c,u=""+y.container;y.codec&&y.codec.length>0&&(u+=";codecs="+y.codec);var _=!1;if(f.default.v(this.TAG,"Received Initialization Segment, mimeType: "+u),this._lastInitSegments[y.type]=y,u!==this._mimeTypes[y.type]){if(this._mimeTypes[y.type])f.default.v(this.TAG,"Notice: "+y.type+" mimeType changed, origin: "+this._mimeTypes[y.type]+", target: "+u);else{_=!0;try{var b=this._sourceBuffers[y.type]=this._mediaSource.addSourceBuffer(u);b.addEventListener("error",this.e.onSourceBufferError),b.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(T){f.default.e(this.TAG,T.message),this._emitter.emit(g.default.ERROR,{code:T.code,msg:T.message});return}}this._mimeTypes[y.type]=u}p||this._pendingSegments[y.type].push(y),_||this._sourceBuffers[y.type]&&!this._sourceBuffers[y.type].updating&&this._doAppendSegments(),d.default.safari&&y.container==="audio/mpeg"&&y.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=y.mediaDuration/1e3,this._updateMediaSourceDuration())},m.prototype.appendMediaSegment=function(c){var p=c;this._pendingSegments[p.type].push(p),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var y=this._sourceBuffers[p.type];y&&!y.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},m.prototype.seek=function(c){for(var p in this._sourceBuffers)if(!!this._sourceBuffers[p]){var y=this._sourceBuffers[p];if(this._mediaSource.readyState==="open")try{y.abort()}catch(L){f.default.e(this.TAG,L.message)}this._idrList.clear();var u=this._pendingSegments[p];if(u.splice(0,u.length),this._mediaSource.readyState!=="closed"){for(var _=0;_<y.buffered.length;_++){var b=y.buffered.start(_),T=y.buffered.end(_);this._pendingRemoveRanges[p].push({start:b,end:T})}if(y.updating||this._doRemoveRanges(),d.default.safari){var A=this._lastInitSegments[p];A&&(this._pendingSegments[p].push(A),y.updating||this._doAppendSegments())}}}},m.prototype.endOfStream=function(){var c=this._mediaSource,p=this._sourceBuffers;if(!c||c.readyState!=="open"){c&&c.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}p.video&&p.video.updating||p.audio&&p.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,c.endOfStream())},m.prototype.getNearestKeyframe=function(c){return this._idrList.getLastSyncPointBeforeDts(c)},m.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var c=this._mediaElement.currentTime;for(var p in this._sourceBuffers){var y=this._sourceBuffers[p];if(y){var u=y.buffered;if(u.length>=1&&c-u.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},m.prototype._doCleanupSourceBuffer=function(){var c=this._mediaElement.currentTime;for(var p in this._sourceBuffers){var y=this._sourceBuffers[p];if(y){for(var u=y.buffered,_=!1,b=0;b<u.length;b++){var T=u.start(b),A=u.end(b);if(T<=c&&c<A+3){if(c-T>=this._config.autoCleanupMaxBackwardDuration){_=!0;var L=c-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[p].push({start:T,end:L})}}else A<c&&(_=!0,this._pendingRemoveRanges[p].push({start:T,end:A}))}_&&!y.updating&&this._doRemoveRanges()}}},m.prototype._updateMediaSourceDuration=function(){var c=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(c.video&&c.video.updating||c.audio&&c.audio.updating)){var p=this._mediaSource.duration,y=this._pendingMediaDuration;y>0&&(isNaN(p)||y>p)&&(f.default.v(this.TAG,"Update MediaSource duration from "+p+" to "+y),this._mediaSource.duration=y),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},m.prototype._doRemoveRanges=function(){for(var c in this._pendingRemoveRanges)if(!(!this._sourceBuffers[c]||this._sourceBuffers[c].updating))for(var p=this._sourceBuffers[c],y=this._pendingRemoveRanges[c];y.length&&!p.updating;){var u=y.shift();p.remove(u.start,u.end)}},m.prototype._doAppendSegments=function(){var c=this._pendingSegments;for(var p in c)if(!(!this._sourceBuffers[p]||this._sourceBuffers[p].updating)&&c[p].length>0){var y=c[p].shift();if(y.timestampOffset){var u=this._sourceBuffers[p].timestampOffset,_=y.timestampOffset/1e3,b=Math.abs(u-_);b>.1&&(f.default.v(this.TAG,"Update MPEG audio timestampOffset from "+u+" to "+_),this._sourceBuffers[p].timestampOffset=_),delete y.timestampOffset}if(!y.data||y.data.byteLength===0)continue;try{this._sourceBuffers[p].appendBuffer(y.data),this._isBufferFull=!1,p==="video"&&y.hasOwnProperty("info")&&this._idrList.appendArray(y.info.syncPoints)}catch(T){this._pendingSegments[p].unshift(y),T.code===22?(this._isBufferFull||this._emitter.emit(g.default.BUFFER_FULL),this._isBufferFull=!0):(f.default.e(this.TAG,T.message),this._emitter.emit(g.default.ERROR,{code:T.code,msg:T.message}))}}},m.prototype._onSourceOpen=function(){if(f.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var c=this._pendingSourceBufferInit;c.length;){var p=c.shift();this.appendInitSegment(p,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(g.default.SOURCE_OPEN)},m.prototype._onSourceEnded=function(){f.default.v(this.TAG,"MediaSource onSourceEnded")},m.prototype._onSourceClose=function(){f.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},m.prototype._hasPendingSegments=function(){var c=this._pendingSegments;return c.video.length>0||c.audio.length>0},m.prototype._hasPendingRemoveRanges=function(){var c=this._pendingRemoveRanges;return c.video.length>0||c.audio.length>0},m.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(g.default.UPDATE_END)},m.prototype._onSourceBufferError=function(c){f.default.e(this.TAG,"SourceBuffer Error: "+c)},m}();o.default=x},"./src/core/mse-events.js":function(a,o,l){l.r(o);var v={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};o.default=v},"./src/core/transmuxer.js":function(a,o,l){l.r(o);var v=l("./node_modules/events/events.js"),h=l.n(v),f=l("./node_modules/webworkify-webpack/index.js"),d=l.n(f),g=l("./src/utils/logger.js"),E=l("./src/utils/logging-control.js"),S=l("./src/core/transmuxing-controller.js"),x=l("./src/core/transmuxing-events.js"),m=l("./src/core/media-info.js"),c=function(){function p(y,u){if(this.TAG="Transmuxer",this._emitter=new(h()),u.enableWorker&&typeof Worker!="undefined")try{this._worker=d()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[y,u]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},E.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:E.default.getConfig()})}catch(b){g.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new S.default(y,u)}else this._controller=new S.default(y,u);if(this._controller){var _=this._controller;_.on(x.default.IO_ERROR,this._onIOError.bind(this)),_.on(x.default.DEMUX_ERROR,this._onDemuxError.bind(this)),_.on(x.default.INIT_SEGMENT,this._onInitSegment.bind(this)),_.on(x.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),_.on(x.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),_.on(x.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),_.on(x.default.MEDIA_INFO,this._onMediaInfo.bind(this)),_.on(x.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),_.on(x.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),_.on(x.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),_.on(x.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return p.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),E.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},p.prototype.on=function(y,u){this._emitter.addListener(y,u)},p.prototype.off=function(y,u){this._emitter.removeListener(y,u)},p.prototype.hasWorker=function(){return this._worker!=null},p.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},p.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},p.prototype.seek=function(y){this._worker?this._worker.postMessage({cmd:"seek",param:y}):this._controller.seek(y)},p.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},p.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},p.prototype._onInitSegment=function(y,u){var _=this;Promise.resolve().then(function(){_._emitter.emit(x.default.INIT_SEGMENT,y,u)})},p.prototype._onMediaSegment=function(y,u){var _=this;Promise.resolve().then(function(){_._emitter.emit(x.default.MEDIA_SEGMENT,y,u)})},p.prototype._onLoadingComplete=function(){var y=this;Promise.resolve().then(function(){y._emitter.emit(x.default.LOADING_COMPLETE)})},p.prototype._onRecoveredEarlyEof=function(){var y=this;Promise.resolve().then(function(){y._emitter.emit(x.default.RECOVERED_EARLY_EOF)})},p.prototype._onMediaInfo=function(y){var u=this;Promise.resolve().then(function(){u._emitter.emit(x.default.MEDIA_INFO,y)})},p.prototype._onMetaDataArrived=function(y){var u=this;Promise.resolve().then(function(){u._emitter.emit(x.default.METADATA_ARRIVED,y)})},p.prototype._onScriptDataArrived=function(y){var u=this;Promise.resolve().then(function(){u._emitter.emit(x.default.SCRIPTDATA_ARRIVED,y)})},p.prototype._onStatisticsInfo=function(y){var u=this;Promise.resolve().then(function(){u._emitter.emit(x.default.STATISTICS_INFO,y)})},p.prototype._onIOError=function(y,u){var _=this;Promise.resolve().then(function(){_._emitter.emit(x.default.IO_ERROR,y,u)})},p.prototype._onDemuxError=function(y,u){var _=this;Promise.resolve().then(function(){_._emitter.emit(x.default.DEMUX_ERROR,y,u)})},p.prototype._onRecommendSeekpoint=function(y){var u=this;Promise.resolve().then(function(){u._emitter.emit(x.default.RECOMMEND_SEEKPOINT,y)})},p.prototype._onLoggingConfigChanged=function(y){this._worker&&this._worker.postMessage({cmd:"logging_config",param:y})},p.prototype._onWorkerMessage=function(y){var u=y.data,_=u.data;if(u.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(u.msg){case x.default.INIT_SEGMENT:case x.default.MEDIA_SEGMENT:this._emitter.emit(u.msg,_.type,_.data);break;case x.default.LOADING_COMPLETE:case x.default.RECOVERED_EARLY_EOF:this._emitter.emit(u.msg);break;case x.default.MEDIA_INFO:Object.setPrototypeOf(_,m.default.prototype),this._emitter.emit(u.msg,_);break;case x.default.METADATA_ARRIVED:case x.default.SCRIPTDATA_ARRIVED:case x.default.STATISTICS_INFO:this._emitter.emit(u.msg,_);break;case x.default.IO_ERROR:case x.default.DEMUX_ERROR:this._emitter.emit(u.msg,_.type,_.info);break;case x.default.RECOMMEND_SEEKPOINT:this._emitter.emit(u.msg,_);break;case"logcat_callback":g.default.emitter.emit("log",_.type,_.logcat);break}},p}();o.default=c},"./src/core/transmuxing-controller.js":function(a,o,l){l.r(o);var v=l("./node_modules/events/events.js"),h=l.n(v),f=l("./src/utils/logger.js"),d=l("./src/utils/browser.js"),g=l("./src/core/media-info.js"),E=l("./src/demux/flv-demuxer.js"),S=l("./src/remux/mp4-remuxer.js"),x=l("./src/demux/demux-errors.js"),m=l("./src/io/io-controller.js"),c=l("./src/core/transmuxing-events.js"),p=function(){function y(u,_){this.TAG="TransmuxingController",this._emitter=new(h()),this._config=_,u.segments||(u.segments=[{duration:u.duration,filesize:u.filesize,url:u.url}]),typeof u.cors!="boolean"&&(u.cors=!0),typeof u.withCredentials!="boolean"&&(u.withCredentials=!1),this._mediaDataSource=u,this._currentSegmentIndex=0;var b=0;this._mediaDataSource.segments.forEach(function(T){T.timestampBase=b,b+=T.duration,T.cors=u.cors,T.withCredentials=u.withCredentials,_.referrerPolicy&&(T.referrerPolicy=_.referrerPolicy)}),!isNaN(b)&&this._mediaDataSource.duration!==b&&(this._mediaDataSource.duration=b),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return y.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},y.prototype.on=function(u,_){this._emitter.addListener(u,_)},y.prototype.off=function(u,_){this._emitter.removeListener(u,_)},y.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},y.prototype._loadSegment=function(u,_){this._currentSegmentIndex=u;var b=this._mediaDataSource.segments[u],T=this._ioctl=new m.default(b,this._config,u);T.onError=this._onIOException.bind(this),T.onSeeked=this._onIOSeeked.bind(this),T.onComplete=this._onIOComplete.bind(this),T.onRedirect=this._onIORedirect.bind(this),T.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),_?this._demuxer.bindDataSource(this._ioctl):T.onDataArrival=this._onInitChunkArrival.bind(this),T.open(_)},y.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},y.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},y.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},y.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},y.prototype.seek=function(u){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var _=this._searchSegmentIndexContains(u);if(_===this._currentSegmentIndex){var b=this._mediaInfo.segments[_];if(b==null)this._pendingSeekTime=u;else{var T=b.getNearestKeyframe(u);this._remuxer.seek(T.milliseconds),this._ioctl.seek(T.fileposition),this._pendingResolveSeekPoint=T.milliseconds}}else{var A=this._mediaInfo.segments[_];if(A==null)this._pendingSeekTime=u,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(_);else{var T=A.getNearestKeyframe(u);this._internalAbort(),this._remuxer.seek(u),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[_].timestampBase,this._loadSegment(_,T.fileposition),this._pendingResolveSeekPoint=T.milliseconds,this._reportSegmentMediaInfo(_)}}this._enableStatisticsReporter()}},y.prototype._searchSegmentIndexContains=function(u){for(var _=this._mediaDataSource.segments,b=_.length-1,T=0;T<_.length;T++)if(u<_[T].timestampBase){b=T-1;break}return b},y.prototype._onInitChunkArrival=function(u,_){var b=this,T=null,A=0;if(_>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,A=this._demuxer.parseChunks(u,_);else if((T=E.default.probe(u)).match){this._demuxer=new E.default(T,this._config),this._remuxer||(this._remuxer=new S.default(this._config));var L=this._mediaDataSource;L.duration!=null&&!isNaN(L.duration)&&(this._demuxer.overridedDuration=L.duration),typeof L.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=L.hasAudio),typeof L.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=L.hasVideo),this._demuxer.timestampBase=L.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),A=this._demuxer.parseChunks(u,_)}else T=null,f.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){b._internalAbort()}),this._emitter.emit(c.default.DEMUX_ERROR,x.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),A=0;return A},y.prototype._onMediaInfo=function(u){var _=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},u),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,g.default.prototype));var b=Object.assign({},u);Object.setPrototypeOf(b,g.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=b,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var T=_._pendingSeekTime;_._pendingSeekTime=null,_.seek(T)})},y.prototype._onMetaDataArrived=function(u){this._emitter.emit(c.default.METADATA_ARRIVED,u)},y.prototype._onScriptDataArrived=function(u){this._emitter.emit(c.default.SCRIPTDATA_ARRIVED,u)},y.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},y.prototype._onIOComplete=function(u){var _=u,b=_+1;b<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(b)):(this._remuxer.flushStashedSamples(),this._emitter.emit(c.default.LOADING_COMPLETE),this._disableStatisticsReporter())},y.prototype._onIORedirect=function(u){var _=this._ioctl.extraData;this._mediaDataSource.segments[_].redirectedURL=u},y.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(c.default.RECOVERED_EARLY_EOF)},y.prototype._onIOException=function(u,_){f.default.e(this.TAG,"IOException: type = "+u+", code = "+_.code+", msg = "+_.msg),this._emitter.emit(c.default.IO_ERROR,u,_),this._disableStatisticsReporter()},y.prototype._onDemuxException=function(u,_){f.default.e(this.TAG,"DemuxException: type = "+u+", info = "+_),this._emitter.emit(c.default.DEMUX_ERROR,u,_)},y.prototype._onRemuxerInitSegmentArrival=function(u,_){this._emitter.emit(c.default.INIT_SEGMENT,u,_)},y.prototype._onRemuxerMediaSegmentArrival=function(u,_){if(this._pendingSeekTime==null&&(this._emitter.emit(c.default.MEDIA_SEGMENT,u,_),this._pendingResolveSeekPoint!=null&&u==="video")){var b=_.info.syncPoints,T=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,d.default.safari&&b.length>0&&b[0].originalDts===T&&(T=b[0].pts),this._emitter.emit(c.default.RECOMMEND_SEEKPOINT,T)}},y.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},y.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},y.prototype._reportSegmentMediaInfo=function(u){var _=this._mediaInfo.segments[u],b=Object.assign({},_);b.duration=this._mediaInfo.duration,b.segmentCount=this._mediaInfo.segmentCount,delete b.segments,delete b.keyframesIndex,this._emitter.emit(c.default.MEDIA_INFO,b)},y.prototype._reportStatisticsInfo=function(){var u={};u.url=this._ioctl.currentURL,u.hasRedirect=this._ioctl.hasRedirect,u.hasRedirect&&(u.redirectedURL=this._ioctl.currentRedirectedURL),u.speed=this._ioctl.currentSpeed,u.loaderType=this._ioctl.loaderType,u.currentSegmentIndex=this._currentSegmentIndex,u.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(c.default.STATISTICS_INFO,u)},y}();o.default=p},"./src/core/transmuxing-events.js":function(a,o,l){l.r(o);var v={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};o.default=v},"./src/core/transmuxing-worker.js":function(a,o,l){l.r(o);var v=l("./src/utils/logging-control.js"),h=l("./src/utils/polyfill.js"),f=l("./src/core/transmuxing-controller.js"),d=l("./src/core/transmuxing-events.js"),g=function(E){var S=null,x=w.bind(this);h.default.install(),E.addEventListener("message",function(O){switch(O.data.cmd){case"init":S=new f.default(O.data.param[0],O.data.param[1]),S.on(d.default.IO_ERROR,A.bind(this)),S.on(d.default.DEMUX_ERROR,L.bind(this)),S.on(d.default.INIT_SEGMENT,m.bind(this)),S.on(d.default.MEDIA_SEGMENT,c.bind(this)),S.on(d.default.LOADING_COMPLETE,p.bind(this)),S.on(d.default.RECOVERED_EARLY_EOF,y.bind(this)),S.on(d.default.MEDIA_INFO,u.bind(this)),S.on(d.default.METADATA_ARRIVED,_.bind(this)),S.on(d.default.SCRIPTDATA_ARRIVED,b.bind(this)),S.on(d.default.STATISTICS_INFO,T.bind(this)),S.on(d.default.RECOMMEND_SEEKPOINT,R.bind(this));break;case"destroy":S&&(S.destroy(),S=null),E.postMessage({msg:"destroyed"});break;case"start":S.start();break;case"stop":S.stop();break;case"seek":S.seek(O.data.param);break;case"pause":S.pause();break;case"resume":S.resume();break;case"logging_config":{var I=O.data.param;v.default.applyConfig(I),I.enableCallback===!0?v.default.addLogListener(x):v.default.removeLogListener(x);break}}});function m(O,I){var D={msg:d.default.INIT_SEGMENT,data:{type:O,data:I}};E.postMessage(D,[I.data])}function c(O,I){var D={msg:d.default.MEDIA_SEGMENT,data:{type:O,data:I}};E.postMessage(D,[I.data])}function p(){var O={msg:d.default.LOADING_COMPLETE};E.postMessage(O)}function y(){var O={msg:d.default.RECOVERED_EARLY_EOF};E.postMessage(O)}function u(O){var I={msg:d.default.MEDIA_INFO,data:O};E.postMessage(I)}function _(O){var I={msg:d.default.METADATA_ARRIVED,data:O};E.postMessage(I)}function b(O){var I={msg:d.default.SCRIPTDATA_ARRIVED,data:O};E.postMessage(I)}function T(O){var I={msg:d.default.STATISTICS_INFO,data:O};E.postMessage(I)}function A(O,I){E.postMessage({msg:d.default.IO_ERROR,data:{type:O,info:I}})}function L(O,I){E.postMessage({msg:d.default.DEMUX_ERROR,data:{type:O,info:I}})}function R(O){E.postMessage({msg:d.default.RECOMMEND_SEEKPOINT,data:O})}function w(O,I){E.postMessage({msg:"logcat_callback",data:{type:O,logcat:I}})}};o.default=g},"./src/demux/amf-parser.js":function(a,o,l){l.r(o);var v=l("./src/utils/logger.js"),h=l("./src/utils/utf8-conv.js"),f=l("./src/utils/exception.js"),d=function(){var E=new ArrayBuffer(2);return new DataView(E).setInt16(0,256,!0),new Int16Array(E)[0]===256}(),g=function(){function E(){}return E.parseScriptData=function(S,x,m){var c={};try{var p=E.parseValue(S,x,m),y=E.parseValue(S,x+p.size,m-p.size);c[p.data]=y.data}catch(u){v.default.e("AMF",u.toString())}return c},E.parseObject=function(S,x,m){if(m<3)throw new f.IllegalStateException("Data not enough when parse ScriptDataObject");var c=E.parseString(S,x,m),p=E.parseValue(S,x+c.size,m-c.size),y=p.objectEnd;return{data:{name:c.data,value:p.data},size:c.size+p.size,objectEnd:y}},E.parseVariable=function(S,x,m){return E.parseObject(S,x,m)},E.parseString=function(S,x,m){if(m<2)throw new f.IllegalStateException("Data not enough when parse String");var c=new DataView(S,x,m),p=c.getUint16(0,!d),y;return p>0?y=(0,h.default)(new Uint8Array(S,x+2,p)):y="",{data:y,size:2+p}},E.parseLongString=function(S,x,m){if(m<4)throw new f.IllegalStateException("Data not enough when parse LongString");var c=new DataView(S,x,m),p=c.getUint32(0,!d),y;return p>0?y=(0,h.default)(new Uint8Array(S,x+4,p)):y="",{data:y,size:4+p}},E.parseDate=function(S,x,m){if(m<10)throw new f.IllegalStateException("Data size invalid when parse Date");var c=new DataView(S,x,m),p=c.getFloat64(0,!d),y=c.getInt16(8,!d);return p+=y*60*1e3,{data:new Date(p),size:8+2}},E.parseValue=function(S,x,m){if(m<1)throw new f.IllegalStateException("Data not enough when parse Value");var c=new DataView(S,x,m),p=1,y=c.getUint8(0),u,_=!1;try{switch(y){case 0:u=c.getFloat64(1,!d),p+=8;break;case 1:{var b=c.getUint8(1);u=!!b,p+=1;break}case 2:{var T=E.parseString(S,x+1,m-1);u=T.data,p+=T.size;break}case 3:{u={};var A=0;for((c.getUint32(m-4,!d)&16777215)==9&&(A=3);p<m-4;){var L=E.parseObject(S,x+p,m-p-A);if(L.objectEnd)break;u[L.data.name]=L.data.value,p+=L.size}if(p<=m-3){var R=c.getUint32(p-1,!d)&16777215;R===9&&(p+=3)}break}case 8:{u={},p+=4;var A=0;for((c.getUint32(m-4,!d)&16777215)==9&&(A=3);p<m-8;){var w=E.parseVariable(S,x+p,m-p-A);if(w.objectEnd)break;u[w.data.name]=w.data.value,p+=w.size}if(p<=m-3){var R=c.getUint32(p-1,!d)&16777215;R===9&&(p+=3)}break}case 9:u=void 0,p=1,_=!0;break;case 10:{u=[];var O=c.getUint32(1,!d);p+=4;for(var I=0;I<O;I++){var D=E.parseValue(S,x+p,m-p);u.push(D.data),p+=D.size}break}case 11:{var C=E.parseDate(S,x+1,m-1);u=C.data,p+=C.size;break}case 12:{var P=E.parseString(S,x+1,m-1);u=P.data,p+=P.size;break}default:p=m,v.default.w("AMF","Unsupported AMF value type "+y)}}catch(M){v.default.e("AMF",M.toString())}return{data:u,size:p,objectEnd:_}},E}();o.default=g},"./src/demux/demux-errors.js":function(a,o,l){l.r(o);var v={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};o.default=v},"./src/demux/exp-golomb.js":function(a,o,l){l.r(o);var v=l("./src/utils/exception.js"),h=function(){function f(d){this.TAG="ExpGolomb",this._buffer=d,this._buffer_index=0,this._total_bytes=d.byteLength,this._total_bits=d.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return f.prototype.destroy=function(){this._buffer=null},f.prototype._fillCurrentWord=function(){var d=this._total_bytes-this._buffer_index;if(d<=0)throw new v.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var g=Math.min(4,d),E=new Uint8Array(4);E.set(this._buffer.subarray(this._buffer_index,this._buffer_index+g)),this._current_word=new DataView(E.buffer).getUint32(0,!1),this._buffer_index+=g,this._current_word_bits_left=g*8},f.prototype.readBits=function(d){if(d>32)throw new v.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(d<=this._current_word_bits_left){var g=this._current_word>>>32-d;return this._current_word<<=d,this._current_word_bits_left-=d,g}var E=this._current_word_bits_left?this._current_word:0;E=E>>>32-this._current_word_bits_left;var S=d-this._current_word_bits_left;this._fillCurrentWord();var x=Math.min(S,this._current_word_bits_left),m=this._current_word>>>32-x;return this._current_word<<=x,this._current_word_bits_left-=x,E=E<<x|m,E},f.prototype.readBool=function(){return this.readBits(1)===1},f.prototype.readByte=function(){return this.readBits(8)},f.prototype._skipLeadingZero=function(){var d;for(d=0;d<this._current_word_bits_left;d++)if((this._current_word&2147483648>>>d)!=0)return this._current_word<<=d,this._current_word_bits_left-=d,d;return this._fillCurrentWord(),d+this._skipLeadingZero()},f.prototype.readUEG=function(){var d=this._skipLeadingZero();return this.readBits(d+1)-1},f.prototype.readSEG=function(){var d=this.readUEG();return d&1?d+1>>>1:-1*(d>>>1)},f}();o.default=h},"./src/demux/flv-demuxer.js":function(a,o,l){l.r(o);var v=l("./src/utils/logger.js"),h=l("./src/demux/amf-parser.js"),f=l("./src/demux/sps-parser.js"),d=l("./src/demux/demux-errors.js"),g=l("./src/core/media-info.js"),E=l("./src/utils/exception.js");function S(m,c){return m[c]<<24|m[c+1]<<16|m[c+2]<<8|m[c+3]}var x=function(){function m(c,p){this.TAG="FLVDemuxer",this._config=p,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=c.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=c.hasAudioTrack,this._hasVideo=c.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new g.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var y=new ArrayBuffer(2);return new DataView(y).setInt16(0,256,!0),new Int16Array(y)[0]===256}()}return m.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},m.probe=function(c){var p=new Uint8Array(c),y={match:!1};if(p[0]!==70||p[1]!==76||p[2]!==86||p[3]!==1)return y;var u=(p[4]&4)>>>2!=0,_=(p[4]&1)!=0,b=S(p,5);return b<9?y:{match:!0,consumed:b,dataOffset:b,hasAudioTrack:u,hasVideoTrack:_}},m.prototype.bindDataSource=function(c){return c.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(m.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(c){this._onTrackMetadata=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(c){this._onMediaInfo=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(c){this._onMetaDataArrived=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(c){this._onScriptDataArrived=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onError",{get:function(){return this._onError},set:function(c){this._onError=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(c){this._onDataAvailable=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(c){this._timestampBase=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"overridedDuration",{get:function(){return this._duration},set:function(c){this._durationOverrided=!0,this._duration=c,this._mediaInfo.duration=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"overridedHasAudio",{set:function(c){this._hasAudioFlagOverrided=!0,this._hasAudio=c,this._mediaInfo.hasAudio=c},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"overridedHasVideo",{set:function(c){this._hasVideoFlagOverrided=!0,this._hasVideo=c,this._mediaInfo.hasVideo=c},enumerable:!1,configurable:!0}),m.prototype.resetMediaInfo=function(){this._mediaInfo=new g.default},m.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},m.prototype.parseChunks=function(c,p){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new E.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var y=0,u=this._littleEndian;if(p===0)if(c.byteLength>13){var _=m.probe(c);y=_.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,p+y!==this._dataOffset&&v.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var b=new DataView(c,y),T=b.getUint32(0,!u);T!==0&&v.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),y+=4}for(;y<c.byteLength;){this._dispatch=!0;var b=new DataView(c,y);if(y+11+4>c.byteLength)break;var A=b.getUint8(0),L=b.getUint32(0,!u)&16777215;if(y+11+L+4>c.byteLength)break;if(A!==8&&A!==9&&A!==18){v.default.w(this.TAG,"Unsupported tag type "+A+", skipped"),y+=11+L+4;continue}var R=b.getUint8(4),w=b.getUint8(5),O=b.getUint8(6),I=b.getUint8(7),D=O|w<<8|R<<16|I<<24,C=b.getUint32(7,!u)&16777215;C!==0&&v.default.w(this.TAG,"Meet tag which has StreamID != 0!");var P=y+11;switch(A){case 8:this._parseAudioData(c,P,L,D);break;case 9:this._parseVideoData(c,P,L,D,p+y);break;case 18:this._parseScriptData(c,P,L);break}var M=b.getUint32(11+L,!u);M!==11+L&&v.default.w(this.TAG,"Invalid PrevTagSize "+M),y+=11+L+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),y},m.prototype._parseScriptData=function(c,p,y){var u=h.default.parseScriptData(c,p,y);if(u.hasOwnProperty("onMetaData")){if(u.onMetaData==null||typeof u.onMetaData!="object"){v.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&v.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=u;var _=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},_)),typeof _.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=_.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof _.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=_.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof _.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=_.audiodatarate),typeof _.videodatarate=="number"&&(this._mediaInfo.videoDataRate=_.videodatarate),typeof _.width=="number"&&(this._mediaInfo.width=_.width),typeof _.height=="number"&&(this._mediaInfo.height=_.height),typeof _.duration=="number"){if(!this._durationOverrided){var b=Math.floor(_.duration*this._timescale);this._duration=b,this._mediaInfo.duration=b}}else this._mediaInfo.duration=0;if(typeof _.framerate=="number"){var T=Math.floor(_.framerate*1e3);if(T>0){var A=T/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=A,this._referenceFrameRate.fps_num=T,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=A}}if(typeof _.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var L=_.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(L),_.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=_,v.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(u).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},u))},m.prototype._parseKeyframesIndex=function(c){for(var p=[],y=[],u=1;u<c.times.length;u++){var _=this._timestampBase+Math.floor(c.times[u]*1e3);p.push(_),y.push(c.filepositions[u])}return{times:p,filepositions:y}},m.prototype._parseAudioData=function(c,p,y,u){if(y<=1){v.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var _=new DataView(c,p,y),b=_.getUint8(0),T=b>>>4;if(T!==2&&T!==10){this._onError(d.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+T);return}var A=0,L=(b&12)>>>2;if(L>=0&&L<=4)A=this._flvSoundRateTable[L];else{this._onError(d.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+L);return}var R=b&1,w=this._audioMetadata,O=this._audioTrack;if(w||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),w=this._audioMetadata={},w.type="audio",w.id=O.id,w.timescale=this._timescale,w.duration=this._duration,w.audioSampleRate=A,w.channelCount=R===0?1:2),T===10){var I=this._parseAACAudioData(c,p+1,y-1);if(I==null)return;if(I.packetType===0){w.config&&v.default.w(this.TAG,"Found another AudioSpecificConfig!");var D=I.data;w.audioSampleRate=D.samplingRate,w.channelCount=D.channelCount,w.codec=D.codec,w.originalCodec=D.originalCodec,w.config=D.config,w.refSampleDuration=1024/w.audioSampleRate*w.timescale,v.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",w);var C=this._mediaInfo;C.audioCodec=w.originalCodec,C.audioSampleRate=w.audioSampleRate,C.audioChannelCount=w.channelCount,C.hasVideo?C.videoCodec!=null&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.audioCodec+'"',C.isComplete()&&this._onMediaInfo(C)}else if(I.packetType===1){var P=this._timestampBase+u,M={unit:I.data,length:I.data.byteLength,dts:P,pts:P};O.samples.push(M),O.length+=I.data.length}else v.default.e(this.TAG,"Flv: Unsupported AAC data type "+I.packetType)}else if(T===2){if(!w.codec){var D=this._parseMP3AudioData(c,p+1,y-1,!0);if(D==null)return;w.audioSampleRate=D.samplingRate,w.channelCount=D.channelCount,w.codec=D.codec,w.originalCodec=D.originalCodec,w.refSampleDuration=1152/w.audioSampleRate*w.timescale,v.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",w);var C=this._mediaInfo;C.audioCodec=w.codec,C.audioSampleRate=w.audioSampleRate,C.audioChannelCount=w.channelCount,C.audioDataRate=D.bitRate,C.hasVideo?C.videoCodec!=null&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.audioCodec+'"',C.isComplete()&&this._onMediaInfo(C)}var N=this._parseMP3AudioData(c,p+1,y-1,!1);if(N==null)return;var P=this._timestampBase+u,B={unit:N,length:N.byteLength,dts:P,pts:P};O.samples.push(B),O.length+=N.length}}},m.prototype._parseAACAudioData=function(c,p,y){if(y<=1){v.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var u={},_=new Uint8Array(c,p,y);return u.packetType=_[0],_[0]===0?u.data=this._parseAACAudioSpecificConfig(c,p+1,y-1):u.data=_.subarray(1),u},m.prototype._parseAACAudioSpecificConfig=function(c,p,y){var u=new Uint8Array(c,p,y),_=null,b=0,T=0,A=0,L=null;if(b=T=u[0]>>>3,A=(u[0]&7)<<1|u[1]>>>7,A<0||A>=this._mpegSamplingRates.length){this._onError(d.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var R=this._mpegSamplingRates[A],w=(u[1]&120)>>>3;if(w<0||w>=8){this._onError(d.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}b===5&&(L=(u[1]&7)<<1|u[2]>>>7,(u[2]&124)>>>2);var O=self.navigator.userAgent.toLowerCase();return O.indexOf("firefox")!==-1?A>=6?(b=5,_=new Array(4),L=A-3):(b=2,_=new Array(2),L=A):O.indexOf("android")!==-1?(b=2,_=new Array(2),L=A):(b=5,L=A,_=new Array(4),A>=6?L=A-3:w===1&&(b=2,_=new Array(2),L=A)),_[0]=b<<3,_[0]|=(A&15)>>>1,_[1]=(A&15)<<7,_[1]|=(w&15)<<3,b===5&&(_[1]|=(L&15)>>>1,_[2]=(L&1)<<7,_[2]|=2<<2,_[3]=0),{config:_,samplingRate:R,channelCount:w,codec:"mp4a.40."+b,originalCodec:"mp4a.40."+T}},m.prototype._parseMP3AudioData=function(c,p,y,u){if(y<4){v.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var _=new Uint8Array(c,p,y),b=null;if(u){if(_[0]!==255)return;var T=_[1]>>>3&3,A=(_[1]&6)>>1,L=(_[2]&240)>>>4,R=(_[2]&12)>>>2,w=_[3]>>>6&3,O=w!==3?2:1,I=0,D=0,C="mp3";switch(T){case 0:I=this._mpegAudioV25SampleRateTable[R];break;case 2:I=this._mpegAudioV20SampleRateTable[R];break;case 3:I=this._mpegAudioV10SampleRateTable[R];break}switch(A){case 1:L<this._mpegAudioL3BitRateTable.length&&(D=this._mpegAudioL3BitRateTable[L]);break;case 2:L<this._mpegAudioL2BitRateTable.length&&(D=this._mpegAudioL2BitRateTable[L]);break;case 3:L<this._mpegAudioL1BitRateTable.length&&(D=this._mpegAudioL1BitRateTable[L]);break}b={bitRate:D,samplingRate:I,channelCount:O,codec:C,originalCodec:C}}else b=_;return b},m.prototype._parseVideoData=function(c,p,y,u,_){if(y<=1){v.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var b=new Uint8Array(c,p,y)[0],T=(b&240)>>>4,A=b&15;if(A!==7){this._onError(d.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+A);return}this._parseAVCVideoPacket(c,p+1,y-1,u,_,T)}},m.prototype._parseAVCVideoPacket=function(c,p,y,u,_,b){if(y<4){v.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var T=this._littleEndian,A=new DataView(c,p,y),L=A.getUint8(0),R=A.getUint32(0,!T)&16777215,w=R<<8>>8;if(L===0)this._parseAVCDecoderConfigurationRecord(c,p+4,y-4);else if(L===1)this._parseAVCVideoData(c,p+4,y-4,u,_,b,w);else if(L!==2){this._onError(d.default.FORMAT_ERROR,"Flv: Invalid video packet type "+L);return}},m.prototype._parseAVCDecoderConfigurationRecord=function(c,p,y){if(y<7){v.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var u=this._videoMetadata,_=this._videoTrack,b=this._littleEndian,T=new DataView(c,p,y);u?typeof u.avcc!="undefined"&&v.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),u=this._videoMetadata={},u.type="video",u.id=_.id,u.timescale=this._timescale,u.duration=this._duration);var A=T.getUint8(0),L=T.getUint8(1);if(T.getUint8(2),T.getUint8(3),A!==1||L===0){this._onError(d.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(T.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(d.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var R=T.getUint8(5)&31;if(R===0){this._onError(d.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else R>1&&v.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+R);for(var w=6,O=0;O<R;O++){var I=T.getUint16(w,!b);if(w+=2,I!==0){var D=new Uint8Array(c,p+w,I);w+=I;var C=f.default.parseSPS(D);if(O===0){u.codecWidth=C.codec_size.width,u.codecHeight=C.codec_size.height,u.presentWidth=C.present_size.width,u.presentHeight=C.present_size.height,u.profile=C.profile_string,u.level=C.level_string,u.bitDepth=C.bit_depth,u.chromaFormat=C.chroma_format,u.sarRatio=C.sar_ratio,u.frameRate=C.frame_rate,(C.frame_rate.fixed===!1||C.frame_rate.fps_num===0||C.frame_rate.fps_den===0)&&(u.frameRate=this._referenceFrameRate);var P=u.frameRate.fps_den,M=u.frameRate.fps_num;u.refSampleDuration=u.timescale*(P/M);for(var N=D.subarray(1,4),B="avc1.",U=0;U<3;U++){var F=N[U].toString(16);F.length<2&&(F="0"+F),B+=F}u.codec=B;var j=this._mediaInfo;j.width=u.codecWidth,j.height=u.codecHeight,j.fps=u.frameRate.fps,j.profile=u.profile,j.level=u.level,j.refFrames=C.ref_frames,j.chromaFormat=C.chroma_format_string,j.sarNum=u.sarRatio.width,j.sarDen=u.sarRatio.height,j.videoCodec=B,j.hasAudio?j.audioCodec!=null&&(j.mimeType='video/x-flv; codecs="'+j.videoCodec+","+j.audioCodec+'"'):j.mimeType='video/x-flv; codecs="'+j.videoCodec+'"',j.isComplete()&&this._onMediaInfo(j)}}}var V=T.getUint8(w);if(V===0){this._onError(d.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else V>1&&v.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+V);w++;for(var O=0;O<V;O++){var I=T.getUint16(w,!b);w+=2,I!==0&&(w+=I)}u.avcc=new Uint8Array(y),u.avcc.set(new Uint8Array(c,p,y),0),v.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",u)},m.prototype._parseAVCVideoData=function(c,p,y,u,_,b,T){for(var A=this._littleEndian,L=new DataView(c,p,y),R=[],w=0,O=0,I=this._naluLengthSize,D=this._timestampBase+u,C=b===1;O<y;){if(O+4>=y){v.default.w(this.TAG,"Malformed Nalu near timestamp "+D+", offset = "+O+", dataSize = "+y);break}var P=L.getUint32(O,!A);if(I===3&&(P>>>=8),P>y-I){v.default.w(this.TAG,"Malformed Nalus near timestamp "+D+", NaluSize > DataSize!");return}var M=L.getUint8(O+I)&31;M===5&&(C=!0);var N=new Uint8Array(c,p+O,I+P),B={type:M,data:N};R.push(B),w+=N.byteLength,O+=I+P}if(R.length){var U=this._videoTrack,F={units:R,length:w,isKeyframe:C,dts:D,cts:T,pts:D+T};C&&(F.fileposition=_),U.samples.push(F),U.length+=w}},m}();o.default=x},"./src/demux/sps-parser.js":function(a,o,l){l.r(o);var v=l("./src/demux/exp-golomb.js"),h=function(){function f(){}return f._ebsp2rbsp=function(d){for(var g=d,E=g.byteLength,S=new Uint8Array(E),x=0,m=0;m<E;m++)m>=2&&g[m]===3&&g[m-1]===0&&g[m-2]===0||(S[x]=g[m],x++);return new Uint8Array(S.buffer,0,x)},f.parseSPS=function(d){var g=f._ebsp2rbsp(d),E=new v.default(g);E.readByte();var S=E.readByte();E.readByte();var x=E.readByte();E.readUEG();var m=f.getProfileString(S),c=f.getLevelString(x),p=1,y=420,u=[0,420,422,444],_=8;if((S===100||S===110||S===122||S===244||S===44||S===83||S===86||S===118||S===128||S===138||S===144)&&(p=E.readUEG(),p===3&&E.readBits(1),p<=3&&(y=u[p]),_=E.readUEG()+8,E.readUEG(),E.readBits(1),E.readBool()))for(var b=p!==3?8:12,T=0;T<b;T++)E.readBool()&&(T<6?f._skipScalingList(E,16):f._skipScalingList(E,64));E.readUEG();var A=E.readUEG();if(A===0)E.readUEG();else if(A===1){E.readBits(1),E.readSEG(),E.readSEG();for(var L=E.readUEG(),T=0;T<L;T++)E.readSEG()}var R=E.readUEG();E.readBits(1);var w=E.readUEG(),O=E.readUEG(),I=E.readBits(1);I===0&&E.readBits(1),E.readBits(1);var D=0,C=0,P=0,M=0,N=E.readBool();N&&(D=E.readUEG(),C=E.readUEG(),P=E.readUEG(),M=E.readUEG());var B=1,U=1,F=0,j=!0,V=0,G=0,Y=E.readBool();if(Y){if(E.readBool()){var X=E.readByte(),ie=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],he=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];X>0&&X<16?(B=ie[X-1],U=he[X-1]):X===255&&(B=E.readByte()<<8|E.readByte(),U=E.readByte()<<8|E.readByte())}if(E.readBool()&&E.readBool(),E.readBool()&&(E.readBits(4),E.readBool()&&E.readBits(24)),E.readBool()&&(E.readUEG(),E.readUEG()),E.readBool()){var de=E.readBits(32),Ae=E.readBits(32);j=E.readBool(),V=Ae,G=de*2,F=V/G}}var pe=1;(B!==1||U!==1)&&(pe=B/U);var le=0,Ie=0;if(p===0)le=1,Ie=2-I;else{var Ce=p===3?1:2,Ue=p===1?2:1;le=Ce,Ie=Ue*(2-I)}var Me=(w+1)*16,ze=(2-I)*((O+1)*16);Me-=(D+C)*le,ze-=(P+M)*Ie;var Ge=Math.ceil(Me*pe);return E.destroy(),E=null,{profile_string:m,level_string:c,bit_depth:_,ref_frames:R,chroma_format:y,chroma_format_string:f.getChromaFormatString(y),frame_rate:{fixed:j,fps:F,fps_den:G,fps_num:V},sar_ratio:{width:B,height:U},codec_size:{width:Me,height:ze},present_size:{width:Ge,height:ze}}},f._skipScalingList=function(d,g){for(var E=8,S=8,x=0,m=0;m<g;m++)S!==0&&(x=d.readSEG(),S=(E+x+256)%256),E=S===0?E:S},f.getProfileString=function(d){switch(d){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},f.getLevelString=function(d){return(d/10).toFixed(1)},f.getChromaFormatString=function(d){switch(d){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},f}();o.default=h},"./src/flv.js":function(a,o,l){l.r(o);var v=l("./src/utils/polyfill.js"),h=l("./src/core/features.js"),f=l("./src/io/loader.js"),d=l("./src/player/flv-player.js"),g=l("./src/player/native-player.js"),E=l("./src/player/player-events.js"),S=l("./src/player/player-errors.js"),x=l("./src/utils/logging-control.js"),m=l("./src/utils/exception.js");v.default.install();function c(_,b){var T=_;if(T==null||typeof T!="object")throw new m.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!T.hasOwnProperty("type"))throw new m.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(T.type){case"flv":return new d.default(T,b);default:return new g.default(T,b)}}function p(){return h.default.supportMSEH264Playback()}function y(){return h.default.getFeatureList()}var u={};u.createPlayer=c,u.isSupported=p,u.getFeatureList=y,u.BaseLoader=f.BaseLoader,u.LoaderStatus=f.LoaderStatus,u.LoaderErrors=f.LoaderErrors,u.Events=E.default,u.ErrorTypes=S.ErrorTypes,u.ErrorDetails=S.ErrorDetails,u.FlvPlayer=d.default,u.NativePlayer=g.default,u.LoggingControl=x.default,Object.defineProperty(u,"version",{enumerable:!0,get:function(){return"1.6.2"}}),o.default=u},"./src/index.js":function(a,o,l){a.exports=l("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(a,o,l){l.r(o);var v=l("./src/utils/browser.js"),h=l("./src/io/loader.js"),f=l("./src/utils/exception.js"),d=function(){var E=function(S,x){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,c){m.__proto__=c}||function(m,c){for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(m[p]=c[p])},E(S,x)};return function(S,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");E(S,x);function m(){this.constructor=S}S.prototype=x===null?Object.create(x):(m.prototype=x.prototype,new m)}}(),g=function(E){d(S,E);function S(x,m){var c=E.call(this,"fetch-stream-loader")||this;return c.TAG="FetchStreamLoader",c._seekHandler=x,c._config=m,c._needStash=!0,c._requestAbort=!1,c._contentLength=null,c._receivedLength=0,c}return S.isSupported=function(){try{var x=v.default.msedge&&v.default.version.minor>=15048,m=v.default.msedge?x:!0;return self.fetch&&self.ReadableStream&&m}catch(c){return!1}},S.prototype.destroy=function(){this.isWorking()&&this.abort(),E.prototype.destroy.call(this)},S.prototype.open=function(x,m){var c=this;this._dataSource=x,this._range=m;var p=x.url;this._config.reuseRedirectedURL&&x.redirectedURL!=null&&(p=x.redirectedURL);var y=this._seekHandler.getConfig(p,m),u=new self.Headers;if(typeof y.headers=="object"){var _=y.headers;for(var b in _)_.hasOwnProperty(b)&&u.append(b,_[b])}var T={method:"GET",headers:u,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var b in this._config.headers)u.append(b,this._config.headers[b]);x.cors===!1&&(T.mode="same-origin"),x.withCredentials&&(T.credentials="include"),x.referrerPolicy&&(T.referrerPolicy=x.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,T.signal=this._abortController.signal),this._status=h.LoaderStatus.kConnecting,self.fetch(y.url,T).then(function(A){if(c._requestAbort){c._status=h.LoaderStatus.kIdle,A.body.cancel();return}if(A.ok&&A.status>=200&&A.status<=299){if(A.url!==y.url&&c._onURLRedirect){var L=c._seekHandler.removeURLParameters(A.url);c._onURLRedirect(L)}var R=A.headers.get("Content-Length");return R!=null&&(c._contentLength=parseInt(R),c._contentLength!==0&&c._onContentLengthKnown&&c._onContentLengthKnown(c._contentLength)),c._pump.call(c,A.body.getReader())}else if(c._status=h.LoaderStatus.kError,c._onError)c._onError(h.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:A.status,msg:A.statusText});else throw new f.RuntimeException("FetchStreamLoader: Http code invalid, "+A.status+" "+A.statusText)}).catch(function(A){if(!(c._abortController&&c._abortController.signal.aborted))if(c._status=h.LoaderStatus.kError,c._onError)c._onError(h.LoaderErrors.EXCEPTION,{code:-1,msg:A.message});else throw A})},S.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==h.LoaderStatus.kBuffering||!v.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(x){}},S.prototype._pump=function(x){var m=this;return x.read().then(function(c){if(c.done)if(m._contentLength!==null&&m._receivedLength<m._contentLength){m._status=h.LoaderStatus.kError;var p=h.LoaderErrors.EARLY_EOF,y={code:-1,msg:"Fetch stream meet Early-EOF"};if(m._onError)m._onError(p,y);else throw new f.RuntimeException(y.msg)}else m._status=h.LoaderStatus.kComplete,m._onComplete&&m._onComplete(m._range.from,m._range.from+m._receivedLength-1);else{if(m._abortController&&m._abortController.signal.aborted){m._status=h.LoaderStatus.kComplete;return}else if(m._requestAbort===!0)return m._status=h.LoaderStatus.kComplete,x.cancel();m._status=h.LoaderStatus.kBuffering;var u=c.value.buffer,_=m._range.from+m._receivedLength;m._receivedLength+=u.byteLength,m._onDataArrival&&m._onDataArrival(u,_,m._receivedLength),m._pump(x)}}).catch(function(c){if(m._abortController&&m._abortController.signal.aborted){m._status=h.LoaderStatus.kComplete;return}if(!(c.code===11&&v.default.msedge)){m._status=h.LoaderStatus.kError;var p=0,y=null;if((c.code===19||c.message==="network error")&&(m._contentLength===null||m._contentLength!==null&&m._receivedLength<m._contentLength)?(p=h.LoaderErrors.EARLY_EOF,y={code:c.code,msg:"Fetch stream meet Early-EOF"}):(p=h.LoaderErrors.EXCEPTION,y={code:c.code,msg:c.message}),m._onError)m._onError(p,y);else throw new f.RuntimeException(y.msg)}})},S}(h.BaseLoader);o.default=g},"./src/io/io-controller.js":function(a,o,l){l.r(o);var v=l("./src/utils/logger.js"),h=l("./src/io/speed-sampler.js"),f=l("./src/io/loader.js"),d=l("./src/io/fetch-stream-loader.js"),g=l("./src/io/xhr-moz-chunked-loader.js"),E=l("./src/io/xhr-range-loader.js"),S=l("./src/io/websocket-loader.js"),x=l("./src/io/range-seek-handler.js"),m=l("./src/io/param-seek-handler.js"),c=l("./src/utils/exception.js"),p=function(){function y(u,_,b){this.TAG="IOController",this._config=_,this._extraData=b,this._stashInitialSize=1024*384,_.stashInitialSize!=null&&_.stashInitialSize>0&&(this._stashInitialSize=_.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,_.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=u,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(u.url),this._refTotalLength=u.filesize?u.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new h.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return y.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},y.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},y.prototype.isPaused=function(){return this._paused},Object.defineProperty(y.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"extraData",{get:function(){return this._extraData},set:function(u){this._extraData=u},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(u){this._onDataArrival=u},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(u){this._onSeeked=u},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onError",{get:function(){return this._onError},set:function(u){this._onError=u},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onComplete",{get:function(){return this._onComplete},set:function(u){this._onComplete=u},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(u){this._onRedirect=u},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(u){this._onRecoveredEarlyEof=u},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"currentSpeed",{get:function(){return this._loaderClass===E.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),y.prototype._selectSeekHandler=function(){var u=this._config;if(u.seekType==="range")this._seekHandler=new x.default(this._config.rangeLoadZeroStart);else if(u.seekType==="param"){var _=u.seekParamStart||"bstart",b=u.seekParamEnd||"bend";this._seekHandler=new m.default(_,b)}else if(u.seekType==="custom"){if(typeof u.customSeekHandler!="function")throw new c.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new u.customSeekHandler}else throw new c.InvalidArgumentException("Invalid seekType in config: "+u.seekType)},y.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=S.default;else if(d.default.isSupported())this._loaderClass=d.default;else if(g.default.isSupported())this._loaderClass=g.default;else if(E.default.isSupported())this._loaderClass=E.default;else throw new c.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},y.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},y.prototype.open=function(u){this._currentRange={from:0,to:-1},u&&(this._currentRange.from=u),this._speedSampler.reset(),u||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},y.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},y.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},y.prototype.resume=function(){if(this._paused){this._paused=!1;var u=this._resumeFrom;this._resumeFrom=0,this._internalSeek(u,!0)}},y.prototype.seek=function(u){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(u,!0)},y.prototype._internalSeek=function(u,_){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(_),this._loader.destroy(),this._loader=null;var b={from:u,to:-1};this._currentRange={from:b.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,b),this._onSeeked&&this._onSeeked()},y.prototype.updateUrl=function(u){if(!u||typeof u!="string"||u.length===0)throw new c.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=u},y.prototype._expandBuffer=function(u){for(var _=this._stashSize;_+1024*1024*1<u;)_*=2;if(_+=1024*1024*1,_!==this._bufferSize){var b=new ArrayBuffer(_);if(this._stashUsed>0){var T=new Uint8Array(this._stashBuffer,0,this._stashUsed),A=new Uint8Array(b,0,_);A.set(T,0)}this._stashBuffer=b,this._bufferSize=_}},y.prototype._normalizeSpeed=function(u){var _=this._speedNormalizeList,b=_.length-1,T=0,A=0,L=b;if(u<_[0])return _[0];for(;A<=L;){if(T=A+Math.floor((L-A)/2),T===b||u>=_[T]&&u<_[T+1])return _[T];_[T]<u?A=T+1:L=T-1}},y.prototype._adjustStashSize=function(u){var _=0;this._config.isLive||u<512?_=u:u>=512&&u<=1024?_=Math.floor(u*1.5):_=u*2,_>8192&&(_=8192);var b=_*1024+1024*1024*1;this._bufferSize<b&&this._expandBuffer(b),this._stashSize=_*1024},y.prototype._dispatchChunks=function(u,_){return this._currentRange.to=_+u.byteLength-1,this._onDataArrival(u,_)},y.prototype._onURLRedirect=function(u){this._redirectedURL=u,this._onRedirect&&this._onRedirect(u)},y.prototype._onContentLengthKnown=function(u){u&&this._fullRequestFlag&&(this._totalLength=u,this._fullRequestFlag=!1)},y.prototype._onLoaderChunkArrival=function(u,_,b){if(!this._onDataArrival)throw new c.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(u.byteLength);var T=this._speedSampler.lastSecondKBps;if(T!==0){var A=this._normalizeSpeed(T);this._speedNormalized!==A&&(this._speedNormalized=A,this._adjustStashSize(A))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=_),this._stashUsed+u.byteLength<=this._stashSize){var w=new Uint8Array(this._stashBuffer,0,this._stashSize);w.set(new Uint8Array(u),this._stashUsed),this._stashUsed+=u.byteLength}else{var w=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var I=this._stashBuffer.slice(0,this._stashUsed),L=this._dispatchChunks(I,this._stashByteStart);if(L<I.byteLength){if(L>0){var O=new Uint8Array(I,L);w.set(O,0),this._stashUsed=O.byteLength,this._stashByteStart+=L}}else this._stashUsed=0,this._stashByteStart+=L;this._stashUsed+u.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+u.byteLength),w=new Uint8Array(this._stashBuffer,0,this._bufferSize)),w.set(new Uint8Array(u),this._stashUsed),this._stashUsed+=u.byteLength}else{var L=this._dispatchChunks(u,_);if(L<u.byteLength){var R=u.byteLength-L;R>this._bufferSize&&(this._expandBuffer(R),w=new Uint8Array(this._stashBuffer,0,this._bufferSize)),w.set(new Uint8Array(u,L),0),this._stashUsed+=R,this._stashByteStart=_+L}}}else if(this._stashUsed===0){var L=this._dispatchChunks(u,_);if(L<u.byteLength){var R=u.byteLength-L;R>this._bufferSize&&this._expandBuffer(R);var w=new Uint8Array(this._stashBuffer,0,this._bufferSize);w.set(new Uint8Array(u,L),0),this._stashUsed+=R,this._stashByteStart=_+L}}else{this._stashUsed+u.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+u.byteLength);var w=new Uint8Array(this._stashBuffer,0,this._bufferSize);w.set(new Uint8Array(u),this._stashUsed),this._stashUsed+=u.byteLength;var L=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(L<this._stashUsed&&L>0){var O=new Uint8Array(this._stashBuffer,L);w.set(O,0)}this._stashUsed-=L,this._stashByteStart+=L}}},y.prototype._flushStashBuffer=function(u){if(this._stashUsed>0){var _=this._stashBuffer.slice(0,this._stashUsed),b=this._dispatchChunks(_,this._stashByteStart),T=_.byteLength-b;if(b<_.byteLength)if(u)v.default.w(this.TAG,T+" bytes unconsumed data remain when flush buffer, dropped");else{if(b>0){var A=new Uint8Array(this._stashBuffer,0,this._bufferSize),L=new Uint8Array(_,b);A.set(L,0),this._stashUsed=L.byteLength,this._stashByteStart+=b}return 0}return this._stashUsed=0,this._stashByteStart=0,T}return 0},y.prototype._onLoaderComplete=function(u,_){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},y.prototype._onLoaderError=function(u,_){switch(v.default.e(this.TAG,"Loader error, code = "+_.code+", msg = "+_.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,u=f.LoaderErrors.UNRECOVERABLE_EARLY_EOF),u){case f.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var b=this._currentRange.to+1;b<this._totalLength&&(v.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(b,!1));return}u=f.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case f.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case f.LoaderErrors.CONNECTING_TIMEOUT:case f.LoaderErrors.HTTP_STATUS_CODE_INVALID:case f.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(u,_);else throw new c.RuntimeException("IOException: "+_.msg)},y}();o.default=p},"./src/io/loader.js":function(a,o,l){l.r(o),l.d(o,{LoaderStatus:function(){return h},LoaderErrors:function(){return f},BaseLoader:function(){return d}});var v=l("./src/utils/exception.js"),h={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},f={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},d=function(){function g(E){this._type=E||"undefined",this._status=h.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return g.prototype.destroy=function(){this._status=h.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},g.prototype.isWorking=function(){return this._status===h.kConnecting||this._status===h.kBuffering},Object.defineProperty(g.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(E){this._onContentLengthKnown=E},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(E){this._onURLRedirect=E},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(E){this._onDataArrival=E},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onError",{get:function(){return this._onError},set:function(E){this._onError=E},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"onComplete",{get:function(){return this._onComplete},set:function(E){this._onComplete=E},enumerable:!1,configurable:!0}),g.prototype.open=function(E,S){throw new v.NotImplementedException("Unimplemented abstract function!")},g.prototype.abort=function(){throw new v.NotImplementedException("Unimplemented abstract function!")},g}()},"./src/io/param-seek-handler.js":function(a,o,l){l.r(o);var v=function(){function h(f,d){this._startName=f,this._endName=d}return h.prototype.getConfig=function(f,d){var g=f;if(d.from!==0||d.to!==-1){var E=!0;g.indexOf("?")===-1&&(g+="?",E=!1),E&&(g+="&"),g+=this._startName+"="+d.from.toString(),d.to!==-1&&(g+="&"+this._endName+"="+d.to.toString())}return{url:g,headers:{}}},h.prototype.removeURLParameters=function(f){var d=f.split("?")[0],g=void 0,E=f.indexOf("?");E!==-1&&(g=f.substring(E+1));var S="";if(g!=null&&g.length>0)for(var x=g.split("&"),m=0;m<x.length;m++){var c=x[m].split("="),p=m>0;c[0]!==this._startName&&c[0]!==this._endName&&(p&&(S+="&"),S+=x[m])}return S.length===0?d:d+"?"+S},h}();o.default=v},"./src/io/range-seek-handler.js":function(a,o,l){l.r(o);var v=function(){function h(f){this._zeroStart=f||!1}return h.prototype.getConfig=function(f,d){var g={};if(d.from!==0||d.to!==-1){var E=void 0;d.to!==-1?E="bytes="+d.from.toString()+"-"+d.to.toString():E="bytes="+d.from.toString()+"-",g.Range=E}else this._zeroStart&&(g.Range="bytes=0-");return{url:f,headers:g}},h.prototype.removeURLParameters=function(f){return f},h}();o.default=v},"./src/io/speed-sampler.js":function(a,o,l){l.r(o);var v=function(){function h(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return h.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},h.prototype.addBytes=function(f){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=f,this._totalBytes+=f):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=f,this._totalBytes+=f):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=f,this._totalBytes+=f,this._lastCheckpoint=this._now())},Object.defineProperty(h.prototype,"currentKBps",{get:function(){this.addBytes(0);var f=(this._now()-this._lastCheckpoint)/1e3;return f==0&&(f=1),this._intervalBytes/f/1024},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"averageKBps",{get:function(){var f=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/f/1024},enumerable:!1,configurable:!0}),h}();o.default=v},"./src/io/websocket-loader.js":function(a,o,l){l.r(o);var v=l("./src/io/loader.js"),h=l("./src/utils/exception.js"),f=function(){var g=function(E,S){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,m){x.__proto__=m}||function(x,m){for(var c in m)Object.prototype.hasOwnProperty.call(m,c)&&(x[c]=m[c])},g(E,S)};return function(E,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");g(E,S);function x(){this.constructor=E}E.prototype=S===null?Object.create(S):(x.prototype=S.prototype,new x)}}(),d=function(g){f(E,g);function E(){var S=g.call(this,"websocket-loader")||this;return S.TAG="WebSocketLoader",S._needStash=!0,S._ws=null,S._requestAbort=!1,S._receivedLength=0,S}return E.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch(S){return!1}},E.prototype.destroy=function(){this._ws&&this.abort(),g.prototype.destroy.call(this)},E.prototype.open=function(S){try{var x=this._ws=new self.WebSocket(S.url);x.binaryType="arraybuffer",x.onopen=this._onWebSocketOpen.bind(this),x.onclose=this._onWebSocketClose.bind(this),x.onmessage=this._onWebSocketMessage.bind(this),x.onerror=this._onWebSocketError.bind(this),this._status=v.LoaderStatus.kConnecting}catch(c){this._status=v.LoaderStatus.kError;var m={code:c.code,msg:c.message};if(this._onError)this._onError(v.LoaderErrors.EXCEPTION,m);else throw new h.RuntimeException(m.msg)}},E.prototype.abort=function(){var S=this._ws;S&&(S.readyState===0||S.readyState===1)&&(this._requestAbort=!0,S.close()),this._ws=null,this._status=v.LoaderStatus.kComplete},E.prototype._onWebSocketOpen=function(S){this._status=v.LoaderStatus.kBuffering},E.prototype._onWebSocketClose=function(S){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=v.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},E.prototype._onWebSocketMessage=function(S){var x=this;if(S.data instanceof ArrayBuffer)this._dispatchArrayBuffer(S.data);else if(S.data instanceof Blob){var m=new FileReader;m.onload=function(){x._dispatchArrayBuffer(m.result)},m.readAsArrayBuffer(S.data)}else{this._status=v.LoaderStatus.kError;var c={code:-1,msg:"Unsupported WebSocket message type: "+S.data.constructor.name};if(this._onError)this._onError(v.LoaderErrors.EXCEPTION,c);else throw new h.RuntimeException(c.msg)}},E.prototype._dispatchArrayBuffer=function(S){var x=S,m=this._receivedLength;this._receivedLength+=x.byteLength,this._onDataArrival&&this._onDataArrival(x,m,this._receivedLength)},E.prototype._onWebSocketError=function(S){this._status=v.LoaderStatus.kError;var x={code:S.code,msg:S.message};if(this._onError)this._onError(v.LoaderErrors.EXCEPTION,x);else throw new h.RuntimeException(x.msg)},E}(v.BaseLoader);o.default=d},"./src/io/xhr-moz-chunked-loader.js":function(a,o,l){l.r(o);var v=l("./src/utils/logger.js"),h=l("./src/io/loader.js"),f=l("./src/utils/exception.js"),d=function(){var E=function(S,x){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,c){m.__proto__=c}||function(m,c){for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(m[p]=c[p])},E(S,x)};return function(S,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");E(S,x);function m(){this.constructor=S}S.prototype=x===null?Object.create(x):(m.prototype=x.prototype,new m)}}(),g=function(E){d(S,E);function S(x,m){var c=E.call(this,"xhr-moz-chunked-loader")||this;return c.TAG="MozChunkedLoader",c._seekHandler=x,c._config=m,c._needStash=!0,c._xhr=null,c._requestAbort=!1,c._contentLength=null,c._receivedLength=0,c}return S.isSupported=function(){try{var x=new XMLHttpRequest;return x.open("GET","https://example.com",!0),x.responseType="moz-chunked-arraybuffer",x.responseType==="moz-chunked-arraybuffer"}catch(m){return v.default.w("MozChunkedLoader",m.message),!1}},S.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),E.prototype.destroy.call(this)},S.prototype.open=function(x,m){this._dataSource=x,this._range=m;var c=x.url;this._config.reuseRedirectedURL&&x.redirectedURL!=null&&(c=x.redirectedURL);var p=this._seekHandler.getConfig(c,m);this._requestURL=p.url;var y=this._xhr=new XMLHttpRequest;if(y.open("GET",p.url,!0),y.responseType="moz-chunked-arraybuffer",y.onreadystatechange=this._onReadyStateChange.bind(this),y.onprogress=this._onProgress.bind(this),y.onloadend=this._onLoadEnd.bind(this),y.onerror=this._onXhrError.bind(this),x.withCredentials&&(y.withCredentials=!0),typeof p.headers=="object"){var u=p.headers;for(var _ in u)u.hasOwnProperty(_)&&y.setRequestHeader(_,u[_])}if(typeof this._config.headers=="object"){var u=this._config.headers;for(var _ in u)u.hasOwnProperty(_)&&y.setRequestHeader(_,u[_])}this._status=h.LoaderStatus.kConnecting,y.send()},S.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=h.LoaderStatus.kComplete},S.prototype._onReadyStateChange=function(x){var m=x.target;if(m.readyState===2){if(m.responseURL!=null&&m.responseURL!==this._requestURL&&this._onURLRedirect){var c=this._seekHandler.removeURLParameters(m.responseURL);this._onURLRedirect(c)}if(m.status!==0&&(m.status<200||m.status>299))if(this._status=h.LoaderStatus.kError,this._onError)this._onError(h.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:m.status,msg:m.statusText});else throw new f.RuntimeException("MozChunkedLoader: Http code invalid, "+m.status+" "+m.statusText);else this._status=h.LoaderStatus.kBuffering}},S.prototype._onProgress=function(x){if(this._status!==h.LoaderStatus.kError){this._contentLength===null&&x.total!==null&&x.total!==0&&(this._contentLength=x.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var m=x.target.response,c=this._range.from+this._receivedLength;this._receivedLength+=m.byteLength,this._onDataArrival&&this._onDataArrival(m,c,this._receivedLength)}},S.prototype._onLoadEnd=function(x){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===h.LoaderStatus.kError)return;this._status=h.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},S.prototype._onXhrError=function(x){this._status=h.LoaderStatus.kError;var m=0,c=null;if(this._contentLength&&x.loaded<this._contentLength?(m=h.LoaderErrors.EARLY_EOF,c={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(m=h.LoaderErrors.EXCEPTION,c={code:-1,msg:x.constructor.name+" "+x.type}),this._onError)this._onError(m,c);else throw new f.RuntimeException(c.msg)},S}(h.BaseLoader);o.default=g},"./src/io/xhr-range-loader.js":function(a,o,l){l.r(o);var v=l("./src/utils/logger.js"),h=l("./src/io/speed-sampler.js"),f=l("./src/io/loader.js"),d=l("./src/utils/exception.js"),g=function(){var S=function(x,m){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,p){c.__proto__=p}||function(c,p){for(var y in p)Object.prototype.hasOwnProperty.call(p,y)&&(c[y]=p[y])},S(x,m)};return function(x,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");S(x,m);function c(){this.constructor=x}x.prototype=m===null?Object.create(m):(c.prototype=m.prototype,new c)}}(),E=function(S){g(x,S);function x(m,c){var p=S.call(this,"xhr-range-loader")||this;return p.TAG="RangeLoader",p._seekHandler=m,p._config=c,p._needStash=!1,p._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],p._currentChunkSizeKB=384,p._currentSpeedNormalized=0,p._zeroSpeedChunkCount=0,p._xhr=null,p._speedSampler=new h.default,p._requestAbort=!1,p._waitForTotalLength=!1,p._totalLengthReceived=!1,p._currentRequestURL=null,p._currentRedirectedURL=null,p._currentRequestRange=null,p._totalLength=null,p._contentLength=null,p._receivedLength=0,p._lastTimeLoaded=0,p}return x.isSupported=function(){try{var m=new XMLHttpRequest;return m.open("GET","https://example.com",!0),m.responseType="arraybuffer",m.responseType==="arraybuffer"}catch(c){return v.default.w("RangeLoader",c.message),!1}},x.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),S.prototype.destroy.call(this)},Object.defineProperty(x.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),x.prototype.open=function(m,c){this._dataSource=m,this._range=c,this._status=f.LoaderStatus.kConnecting;var p=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(p=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!p?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},x.prototype._openSubRange=function(){var m=this._currentChunkSizeKB*1024,c=this._range.from+this._receivedLength,p=c+m;this._contentLength!=null&&p-this._range.from>=this._contentLength&&(p=this._range.from+this._contentLength-1),this._currentRequestRange={from:c,to:p},this._internalOpen(this._dataSource,this._currentRequestRange)},x.prototype._internalOpen=function(m,c){this._lastTimeLoaded=0;var p=m.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?p=this._currentRedirectedURL:m.redirectedURL!=null&&(p=m.redirectedURL));var y=this._seekHandler.getConfig(p,c);this._currentRequestURL=y.url;var u=this._xhr=new XMLHttpRequest;if(u.open("GET",y.url,!0),u.responseType="arraybuffer",u.onreadystatechange=this._onReadyStateChange.bind(this),u.onprogress=this._onProgress.bind(this),u.onload=this._onLoad.bind(this),u.onerror=this._onXhrError.bind(this),m.withCredentials&&(u.withCredentials=!0),typeof y.headers=="object"){var _=y.headers;for(var b in _)_.hasOwnProperty(b)&&u.setRequestHeader(b,_[b])}if(typeof this._config.headers=="object"){var _=this._config.headers;for(var b in _)_.hasOwnProperty(b)&&u.setRequestHeader(b,_[b])}u.send()},x.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=f.LoaderStatus.kComplete},x.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},x.prototype._onReadyStateChange=function(m){var c=m.target;if(c.readyState===2){if(c.responseURL!=null){var p=this._seekHandler.removeURLParameters(c.responseURL);c.responseURL!==this._currentRequestURL&&p!==this._currentRedirectedURL&&(this._currentRedirectedURL=p,this._onURLRedirect&&this._onURLRedirect(p))}if(c.status>=200&&c.status<=299){if(this._waitForTotalLength)return;this._status=f.LoaderStatus.kBuffering}else if(this._status=f.LoaderStatus.kError,this._onError)this._onError(f.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:c.status,msg:c.statusText});else throw new d.RuntimeException("RangeLoader: Http code invalid, "+c.status+" "+c.statusText)}},x.prototype._onProgress=function(m){if(this._status!==f.LoaderStatus.kError){if(this._contentLength===null){var c=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,c=!0;var p=m.total;this._internalAbort(),p!=null&p!==0&&(this._totalLength=p)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,c){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var y=m.loaded-this._lastTimeLoaded;this._lastTimeLoaded=m.loaded,this._speedSampler.addBytes(y)}},x.prototype._normalizeSpeed=function(m){var c=this._chunkSizeKBList,p=c.length-1,y=0,u=0,_=p;if(m<c[0])return c[0];for(;u<=_;){if(y=u+Math.floor((_-u)/2),y===p||m>=c[y]&&m<c[y+1])return c[y];c[y]<m?u=y+1:_=y-1}},x.prototype._onLoad=function(m){if(this._status!==f.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var c=this._speedSampler.lastSecondKBps;if(c===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(c=this._speedSampler.currentKBps)),c!==0){var p=this._normalizeSpeed(c);this._currentSpeedNormalized!==p&&(this._currentSpeedNormalized=p,this._currentChunkSizeKB=p)}var y=m.target.response,u=this._range.from+this._receivedLength;this._receivedLength+=y.byteLength;var _=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():_=!0,this._onDataArrival&&this._onDataArrival(y,u,this._receivedLength),_&&(this._status=f.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},x.prototype._onXhrError=function(m){this._status=f.LoaderStatus.kError;var c=0,p=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(c=f.LoaderErrors.EARLY_EOF,p={code:-1,msg:"RangeLoader meet Early-Eof"}):(c=f.LoaderErrors.EXCEPTION,p={code:-1,msg:m.constructor.name+" "+m.type}),this._onError)this._onError(c,p);else throw new d.RuntimeException(p.msg)},x}(f.BaseLoader);o.default=E},"./src/player/flv-player.js":function(a,o,l){l.r(o);var v=l("./node_modules/events/events.js"),h=l.n(v),f=l("./src/utils/logger.js"),d=l("./src/utils/browser.js"),g=l("./src/player/player-events.js"),E=l("./src/core/transmuxer.js"),S=l("./src/core/transmuxing-events.js"),x=l("./src/core/mse-controller.js"),m=l("./src/core/mse-events.js"),c=l("./src/player/player-errors.js"),p=l("./src/config.js"),y=l("./src/utils/exception.js"),u=function(){function _(b,T){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(h()),this._config=(0,p.createDefaultConfig)(),typeof T=="object"&&Object.assign(this._config,T),b.type.toLowerCase()!=="flv")throw new y.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");b.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=b,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var A=d.default.chrome&&(d.default.version.major<50||d.default.version.major===50&&d.default.version.build<2661);this._alwaysSeekKeyframe=!!(A||d.default.msedge||d.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return _.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},_.prototype.on=function(b,T){var A=this;b===g.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){A._emitter.emit(g.default.MEDIA_INFO,A.mediaInfo)}):b===g.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){A._emitter.emit(g.default.STATISTICS_INFO,A.statisticsInfo)}),this._emitter.addListener(b,T)},_.prototype.off=function(b,T){this._emitter.removeListener(b,T)},_.prototype.attachMediaElement=function(b){var T=this;if(this._mediaElement=b,b.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),b.addEventListener("seeking",this.e.onvSeeking),b.addEventListener("canplay",this.e.onvCanPlay),b.addEventListener("stalled",this.e.onvStalled),b.addEventListener("progress",this.e.onvProgress),this._msectl=new x.default(this._config),this._msectl.on(m.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(m.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(m.default.SOURCE_OPEN,function(){T._mseSourceOpened=!0,T._hasPendingLoad&&(T._hasPendingLoad=!1,T.load())}),this._msectl.on(m.default.ERROR,function(A){T._emitter.emit(g.default.ERROR,c.ErrorTypes.MEDIA_ERROR,c.ErrorDetails.MEDIA_MSE_ERROR,A)}),this._msectl.attachMediaElement(b),this._pendingSeekTime!=null)try{b.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(A){}},_.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},_.prototype.load=function(){var b=this;if(!this._mediaElement)throw new y.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new y.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new E.default(this._mediaDataSource,this._config),this._transmuxer.on(S.default.INIT_SEGMENT,function(T,A){b._msectl.appendInitSegment(A)}),this._transmuxer.on(S.default.MEDIA_SEGMENT,function(T,A){if(b._msectl.appendMediaSegment(A),b._config.lazyLoad&&!b._config.isLive){var L=b._mediaElement.currentTime;A.info.endDts>=(L+b._config.lazyLoadMaxDuration)*1e3&&b._progressChecker==null&&(f.default.v(b.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),b._suspendTransmuxer())}}),this._transmuxer.on(S.default.LOADING_COMPLETE,function(){b._msectl.endOfStream(),b._emitter.emit(g.default.LOADING_COMPLETE)}),this._transmuxer.on(S.default.RECOVERED_EARLY_EOF,function(){b._emitter.emit(g.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(S.default.IO_ERROR,function(T,A){b._emitter.emit(g.default.ERROR,c.ErrorTypes.NETWORK_ERROR,T,A)}),this._transmuxer.on(S.default.DEMUX_ERROR,function(T,A){b._emitter.emit(g.default.ERROR,c.ErrorTypes.MEDIA_ERROR,T,{code:-1,msg:A})}),this._transmuxer.on(S.default.MEDIA_INFO,function(T){b._mediaInfo=T,b._emitter.emit(g.default.MEDIA_INFO,Object.assign({},T))}),this._transmuxer.on(S.default.METADATA_ARRIVED,function(T){b._emitter.emit(g.default.METADATA_ARRIVED,T)}),this._transmuxer.on(S.default.SCRIPTDATA_ARRIVED,function(T){b._emitter.emit(g.default.SCRIPTDATA_ARRIVED,T)}),this._transmuxer.on(S.default.STATISTICS_INFO,function(T){b._statisticsInfo=b._fillStatisticsInfo(T),b._emitter.emit(g.default.STATISTICS_INFO,Object.assign({},b._statisticsInfo))}),this._transmuxer.on(S.default.RECOMMEND_SEEKPOINT,function(T){b._mediaElement&&!b._config.accurateSeek&&(b._requestSetTime=!0,b._mediaElement.currentTime=T/1e3)}),this._transmuxer.open()}},_.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},_.prototype.play=function(){return this._mediaElement.play()},_.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(_.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(b){this._mediaElement.volume=b},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(b){this._mediaElement.muted=b},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(b){this._mediaElement?this._internalSeek(b):this._pendingSeekTime=b},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),_.prototype._fillStatisticsInfo=function(b){if(b.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return b;var T=!0,A=0,L=0;if(this._mediaElement.getVideoPlaybackQuality){var R=this._mediaElement.getVideoPlaybackQuality();A=R.totalVideoFrames,L=R.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(A=this._mediaElement.webkitDecodedFrameCount,L=this._mediaElement.webkitDroppedFrameCount):T=!1;return T&&(b.decodedFrames=A,b.droppedFrames=L),b},_.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var b=this._mediaElement.buffered,T=this._mediaElement.currentTime,A=0,L=0;L<b.length;L++){var R=b.start(L),w=b.end(L);if(R<=T&&T<w){A=w;break}}A>=T+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(f.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},_.prototype._onmseBufferFull=function(){f.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},_.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},_.prototype._checkProgressAndResume=function(){for(var b=this._mediaElement.currentTime,T=this._mediaElement.buffered,A=!1,L=0;L<T.length;L++){var R=T.start(L),w=T.end(L);if(b>=R&&b<w){b>=w-this._config.lazyLoadRecoverDuration&&(A=!0);break}}A&&(window.clearInterval(this._progressChecker),this._progressChecker=null,A&&(f.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},_.prototype._isTimepointBuffered=function(b){for(var T=this._mediaElement.buffered,A=0;A<T.length;A++){var L=T.start(A),R=T.end(A);if(b>=L&&b<R)return!0}return!1},_.prototype._internalSeek=function(b){var T=this._isTimepointBuffered(b),A=!1,L=0;if(b<1&&this._mediaElement.buffered.length>0){var R=this._mediaElement.buffered.start(0);(R<1&&b<R||d.default.safari)&&(A=!0,L=d.default.safari?.1:R)}if(A)this._requestSetTime=!0,this._mediaElement.currentTime=L;else if(T){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=b;else{var w=this._msectl.getNearestKeyframe(Math.floor(b*1e3));this._requestSetTime=!0,w!=null?this._mediaElement.currentTime=w.dts/1e3:this._mediaElement.currentTime=b}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(b),this._transmuxer.seek(Math.floor(b*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=b)},_.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var b=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(b)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(b),this._transmuxer.seek(Math.floor(b*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=b))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},_.prototype._checkAndResumeStuckPlayback=function(b){var T=this._mediaElement;if(b||!this._receivedCanPlay||T.readyState<2){var A=T.buffered;A.length>0&&T.currentTime<A.start(0)&&(f.default.w(this.TAG,"Playback seems stuck at "+T.currentTime+", seek to "+A.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=A.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},_.prototype._onvLoadedMetadata=function(b){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},_.prototype._onvSeeking=function(b){var T=this._mediaElement.currentTime,A=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(T<1&&A.length>0){var L=A.start(0);if(L<1&&T<L||d.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=d.default.safari?.1:L;return}}if(this._isTimepointBuffered(T)){if(this._alwaysSeekKeyframe){var R=this._msectl.getNearestKeyframe(Math.floor(T*1e3));R!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=R.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:T,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},_.prototype._onvCanPlay=function(b){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},_.prototype._onvStalled=function(b){this._checkAndResumeStuckPlayback(!0)},_.prototype._onvProgress=function(b){this._checkAndResumeStuckPlayback()},_}();o.default=u},"./src/player/native-player.js":function(a,o,l){l.r(o);var v=l("./node_modules/events/events.js"),h=l.n(v),f=l("./src/player/player-events.js"),d=l("./src/config.js"),g=l("./src/utils/exception.js"),E=function(){function S(x,m){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(h()),this._config=(0,d.createDefaultConfig)(),typeof m=="object"&&Object.assign(this._config,m),x.type.toLowerCase()==="flv")throw new g.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(x.hasOwnProperty("segments"))throw new g.InvalidArgumentException("NativePlayer("+x.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=x,this._mediaElement=null}return S.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},S.prototype.on=function(x,m){var c=this;x===f.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){c._emitter.emit(f.default.MEDIA_INFO,c.mediaInfo)}):x===f.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){c._emitter.emit(f.default.STATISTICS_INFO,c.statisticsInfo)}),this._emitter.addListener(x,m)},S.prototype.off=function(x,m){this._emitter.removeListener(x,m)},S.prototype.attachMediaElement=function(x){if(this._mediaElement=x,x.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{x.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(m){}},S.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},S.prototype.load=function(){if(!this._mediaElement)throw new g.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},S.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},S.prototype.play=function(){return this._mediaElement.play()},S.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(S.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(x){this._mediaElement.volume=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(x){this._mediaElement.muted=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(x){this._mediaElement?this._mediaElement.currentTime=x:this._pendingSeekTime=x},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"mediaInfo",{get:function(){var x=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",m={mimeType:x+this._mediaDataSource.type};return this._mediaElement&&(m.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(m.width=this._mediaElement.videoWidth,m.height=this._mediaElement.videoHeight)),m},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"statisticsInfo",{get:function(){var x={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return x;var m=!0,c=0,p=0;if(this._mediaElement.getVideoPlaybackQuality){var y=this._mediaElement.getVideoPlaybackQuality();c=y.totalVideoFrames,p=y.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(c=this._mediaElement.webkitDecodedFrameCount,p=this._mediaElement.webkitDroppedFrameCount):m=!1;return m&&(x.decodedFrames=c,x.droppedFrames=p),x},enumerable:!1,configurable:!0}),S.prototype._onvLoadedMetadata=function(x){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(f.default.MEDIA_INFO,this.mediaInfo)},S.prototype._reportStatisticsInfo=function(){this._emitter.emit(f.default.STATISTICS_INFO,this.statisticsInfo)},S}();o.default=E},"./src/player/player-errors.js":function(a,o,l){l.r(o),l.d(o,{ErrorTypes:function(){return f},ErrorDetails:function(){return d}});var v=l("./src/io/loader.js"),h=l("./src/demux/demux-errors.js"),f={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},d={NETWORK_EXCEPTION:v.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:v.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:v.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:v.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:h.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:h.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:h.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(a,o,l){l.r(o);var v={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};o.default=v},"./src/remux/aac-silent.js":function(a,o,l){l.r(o);var v=function(){function h(){}return h.getSilentFrame=function(f,d){if(f==="mp4a.40.2"){if(d===1)return new Uint8Array([0,200,0,128,35,128]);if(d===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(d===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(d===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(d===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(d===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(d===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(d===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(d===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},h}();o.default=v},"./src/remux/mp4-generator.js":function(a,o,l){l.r(o);var v=function(){function h(){}return h.init=function(){h.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var f in h.types)h.types.hasOwnProperty(f)&&(h.types[f]=[f.charCodeAt(0),f.charCodeAt(1),f.charCodeAt(2),f.charCodeAt(3)]);var d=h.constants={};d.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),d.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),d.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),d.STSC=d.STCO=d.STTS,d.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),d.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),d.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),d.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),d.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),d.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},h.box=function(f){for(var d=8,g=null,E=Array.prototype.slice.call(arguments,1),S=E.length,x=0;x<S;x++)d+=E[x].byteLength;g=new Uint8Array(d),g[0]=d>>>24&255,g[1]=d>>>16&255,g[2]=d>>>8&255,g[3]=d&255,g.set(f,4);for(var m=8,x=0;x<S;x++)g.set(E[x],m),m+=E[x].byteLength;return g},h.generateInitSegment=function(f){var d=h.box(h.types.ftyp,h.constants.FTYP),g=h.moov(f),E=new Uint8Array(d.byteLength+g.byteLength);return E.set(d,0),E.set(g,d.byteLength),E},h.moov=function(f){var d=h.mvhd(f.timescale,f.duration),g=h.trak(f),E=h.mvex(f);return h.box(h.types.moov,d,g,E)},h.mvhd=function(f,d){return h.box(h.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},h.trak=function(f){return h.box(h.types.trak,h.tkhd(f),h.mdia(f))},h.tkhd=function(f){var d=f.id,g=f.duration,E=f.presentWidth,S=f.presentHeight;return h.box(h.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255,0,0,0,0,g>>>24&255,g>>>16&255,g>>>8&255,g&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,E>>>8&255,E&255,0,0,S>>>8&255,S&255,0,0]))},h.mdia=function(f){return h.box(h.types.mdia,h.mdhd(f),h.hdlr(f),h.minf(f))},h.mdhd=function(f){var d=f.timescale,g=f.duration;return h.box(h.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,85,196,0,0]))},h.hdlr=function(f){var d=null;return f.type==="audio"?d=h.constants.HDLR_AUDIO:d=h.constants.HDLR_VIDEO,h.box(h.types.hdlr,d)},h.minf=function(f){var d=null;return f.type==="audio"?d=h.box(h.types.smhd,h.constants.SMHD):d=h.box(h.types.vmhd,h.constants.VMHD),h.box(h.types.minf,d,h.dinf(),h.stbl(f))},h.dinf=function(){var f=h.box(h.types.dinf,h.box(h.types.dref,h.constants.DREF));return f},h.stbl=function(f){var d=h.box(h.types.stbl,h.stsd(f),h.box(h.types.stts,h.constants.STTS),h.box(h.types.stsc,h.constants.STSC),h.box(h.types.stsz,h.constants.STSZ),h.box(h.types.stco,h.constants.STCO));return d},h.stsd=function(f){return f.type==="audio"?f.codec==="mp3"?h.box(h.types.stsd,h.constants.STSD_PREFIX,h.mp3(f)):h.box(h.types.stsd,h.constants.STSD_PREFIX,h.mp4a(f)):h.box(h.types.stsd,h.constants.STSD_PREFIX,h.avc1(f))},h.mp3=function(f){var d=f.channelCount,g=f.audioSampleRate,E=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,d,0,16,0,0,0,0,g>>>8&255,g&255,0,0]);return h.box(h.types[".mp3"],E)},h.mp4a=function(f){var d=f.channelCount,g=f.audioSampleRate,E=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,d,0,16,0,0,0,0,g>>>8&255,g&255,0,0]);return h.box(h.types.mp4a,E,h.esds(f))},h.esds=function(f){var d=f.config||[],g=d.length,E=new Uint8Array([0,0,0,0,3,23+g,0,1,0,4,15+g,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([g]).concat(d).concat([6,1,2]));return h.box(h.types.esds,E)},h.avc1=function(f){var d=f.avcc,g=f.codecWidth,E=f.codecHeight,S=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,g>>>8&255,g&255,E>>>8&255,E&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return h.box(h.types.avc1,S,h.box(h.types.avcC,d))},h.mvex=function(f){return h.box(h.types.mvex,h.trex(f))},h.trex=function(f){var d=f.id,g=new Uint8Array([0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return h.box(h.types.trex,g)},h.moof=function(f,d){return h.box(h.types.moof,h.mfhd(f.sequenceNumber),h.traf(f,d))},h.mfhd=function(f){var d=new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255]);return h.box(h.types.mfhd,d)},h.traf=function(f,d){var g=f.id,E=h.box(h.types.tfhd,new Uint8Array([0,0,0,0,g>>>24&255,g>>>16&255,g>>>8&255,g&255])),S=h.box(h.types.tfdt,new Uint8Array([0,0,0,0,d>>>24&255,d>>>16&255,d>>>8&255,d&255])),x=h.sdtp(f),m=h.trun(f,x.byteLength+16+16+8+16+8+8);return h.box(h.types.traf,E,S,m,x)},h.sdtp=function(f){for(var d=f.samples||[],g=d.length,E=new Uint8Array(4+g),S=0;S<g;S++){var x=d[S].flags;E[S+4]=x.isLeading<<6|x.dependsOn<<4|x.isDependedOn<<2|x.hasRedundancy}return h.box(h.types.sdtp,E)},h.trun=function(f,d){var g=f.samples||[],E=g.length,S=12+16*E,x=new Uint8Array(S);d+=8+S,x.set([0,0,15,1,E>>>24&255,E>>>16&255,E>>>8&255,E&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255],0);for(var m=0;m<E;m++){var c=g[m].duration,p=g[m].size,y=g[m].flags,u=g[m].cts;x.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255,y.isLeading<<2|y.dependsOn,y.isDependedOn<<6|y.hasRedundancy<<4|y.isNonSync,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255],12+16*m)}return h.box(h.types.trun,x)},h.mdat=function(f){return h.box(h.types.mdat,f)},h}();v.init(),o.default=v},"./src/remux/mp4-remuxer.js":function(a,o,l){l.r(o);var v=l("./src/utils/logger.js"),h=l("./src/remux/mp4-generator.js"),f=l("./src/remux/aac-silent.js"),d=l("./src/utils/browser.js"),g=l("./src/core/media-segment-info.js"),E=l("./src/utils/exception.js"),S=function(){function x(m){this.TAG="MP4Remuxer",this._config=m,this._isLive=m.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new g.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new g.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(d.default.chrome&&(d.default.version.major<50||d.default.version.major===50&&d.default.version.build<2661)),this._fillSilentAfterSeek=d.default.msedge||d.default.msie,this._mp3UseMpegAudio=!d.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return x.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},x.prototype.bindDataSource=function(m){return m.onDataAvailable=this.remux.bind(this),m.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(x.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(m){this._onInitSegment=m},enumerable:!1,configurable:!0}),Object.defineProperty(x.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(m){this._onMediaSegment=m},enumerable:!1,configurable:!0}),x.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},x.prototype.seek=function(m){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},x.prototype.remux=function(m,c){if(!this._onMediaSegment)throw new E.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(m,c),this._remuxVideo(c),this._remuxAudio(m)},x.prototype._onTrackMetadataReceived=function(m,c){var p=null,y="mp4",u=c.codec;if(m==="audio")this._audioMeta=c,c.codec==="mp3"&&this._mp3UseMpegAudio?(y="mpeg",u="",p=new Uint8Array):p=h.default.generateInitSegment(c);else if(m==="video")this._videoMeta=c,p=h.default.generateInitSegment(c);else return;if(!this._onInitSegment)throw new E.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(m,{type:m,data:p.buffer,codec:u,container:m+"/"+y,mediaDuration:c.duration})},x.prototype._calculateDtsBase=function(m,c){this._dtsBaseInited||(m.samples&&m.samples.length&&(this._audioDtsBase=m.samples[0].dts),c.samples&&c.samples.length&&(this._videoDtsBase=c.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},x.prototype.flushStashedSamples=function(){var m=this._videoStashedLastSample,c=this._audioStashedLastSample,p={type:"video",id:1,sequenceNumber:0,samples:[],length:0};m!=null&&(p.samples.push(m),p.length=m.length);var y={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};c!=null&&(y.samples.push(c),y.length=c.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(p,!0),this._remuxAudio(y,!0)},x.prototype._remuxAudio=function(m,c){if(this._audioMeta!=null){var p=m,y=p.samples,u=void 0,_=-1,b=-1,T=this._audioMeta.refSampleDuration,A=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,L=this._dtsBaseInited&&this._audioNextDts===void 0,R=!1;if(!(!y||y.length===0)&&!(y.length===1&&!c)){var w=0,O=null,I=0;A?(w=0,I=p.length):(w=8,I=8+p.length);var D=null;if(y.length>1&&(D=y.pop(),I-=D.length),this._audioStashedLastSample!=null){var C=this._audioStashedLastSample;this._audioStashedLastSample=null,y.unshift(C),I+=C.length}D!=null&&(this._audioStashedLastSample=D);var P=y[0].dts-this._dtsBase;if(this._audioNextDts)u=P-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())u=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(R=!0);else{var M=this._audioSegmentInfoList.getLastSampleBefore(P);if(M!=null){var N=P-(M.originalDts+M.duration);N<=3&&(N=0);var B=M.dts+M.duration+N;u=P-B}else u=0}if(R){var U=P-u,F=this._videoSegmentInfoList.getLastSegmentBefore(P);if(F!=null&&F.beginDts<U){var j=f.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(j){var V=F.beginDts,G=U-F.beginDts;v.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+V+", duration: "+G),y.unshift({unit:j,dts:V,pts:V}),I+=j.byteLength}}else R=!1}for(var Y=[],X=0;X<y.length;X++){var C=y[X],ie=C.unit,he=C.dts-this._dtsBase,V=he,de=!1,Ae=null,pe=0;if(!(he<-.001)){if(this._audioMeta.codec!=="mp3"){var le=he,Ie=3;if(this._audioNextDts&&(le=this._audioNextDts),u=he-le,u<=-Ie*T){v.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+he+" ms ,curRefDts: "+le+" ms)  due to dtsCorrection: "+u+" ms overlap.");continue}else if(u>=Ie*T&&this._fillAudioTimestampGap&&!d.default.safari){de=!0;var Ce=Math.floor(u/T);v.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+he+" ms, curRefDts: "+le+" ms, ")+("dtsCorrection: "+Math.round(u)+" ms, generate: "+Ce+" frames")),V=Math.floor(le),pe=Math.floor(le+T)-V;var j=f.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);j==null&&(v.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),j=ie),Ae=[];for(var Ue=0;Ue<Ce;Ue++){le=le+T;var Me=Math.floor(le),ze=Math.floor(le+T)-Me,Ge={dts:Me,pts:Me,cts:0,unit:j,size:j.byteLength,duration:ze,originalDts:he,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Ae.push(Ge),I+=Ge.size}this._audioNextDts=le+T}else V=Math.floor(le),pe=Math.floor(le+T)-V,this._audioNextDts=le+T}else{if(V=he-u,X!==y.length-1){var $e=y[X+1].dts-this._dtsBase-u;pe=$e-V}else if(D!=null){var $e=D.dts-this._dtsBase-u;pe=$e-V}else Y.length>=1?pe=Y[Y.length-1].duration:pe=Math.floor(T);this._audioNextDts=V+pe}_===-1&&(_=V),Y.push({dts:V,pts:V,cts:0,unit:C.unit,size:C.unit.byteLength,duration:pe,originalDts:he,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),de&&Y.push.apply(Y,Ae)}}if(Y.length===0){p.samples=[],p.length=0;return}A?O=new Uint8Array(I):(O=new Uint8Array(I),O[0]=I>>>24&255,O[1]=I>>>16&255,O[2]=I>>>8&255,O[3]=I&255,O.set(h.default.types.mdat,4));for(var X=0;X<Y.length;X++){var ie=Y[X].unit;O.set(ie,w),w+=ie.byteLength}var Ke=Y[Y.length-1];b=Ke.dts+Ke.duration;var Ne=new g.MediaSegmentInfo;Ne.beginDts=_,Ne.endDts=b,Ne.beginPts=_,Ne.endPts=b,Ne.originalBeginDts=Y[0].originalDts,Ne.originalEndDts=Ke.originalDts+Ke.duration,Ne.firstSample=new g.SampleInfo(Y[0].dts,Y[0].pts,Y[0].duration,Y[0].originalDts,!1),Ne.lastSample=new g.SampleInfo(Ke.dts,Ke.pts,Ke.duration,Ke.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(Ne),p.samples=Y,p.sequenceNumber++;var Te=null;A?Te=new Uint8Array:Te=h.default.moof(p,_),p.samples=[],p.length=0;var et={type:"audio",data:this._mergeBoxes(Te,O).buffer,sampleCount:Y.length,info:Ne};A&&L&&(et.timestampOffset=_),this._onMediaSegment("audio",et)}}},x.prototype._remuxVideo=function(m,c){if(this._videoMeta!=null){var p=m,y=p.samples,u=void 0,_=-1,b=-1,T=-1,A=-1;if(!(!y||y.length===0)&&!(y.length===1&&!c)){var L=8,R=null,w=8+m.length,O=null;if(y.length>1&&(O=y.pop(),w-=O.length),this._videoStashedLastSample!=null){var I=this._videoStashedLastSample;this._videoStashedLastSample=null,y.unshift(I),w+=I.length}O!=null&&(this._videoStashedLastSample=O);var D=y[0].dts-this._dtsBase;if(this._videoNextDts)u=D-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())u=0;else{var C=this._videoSegmentInfoList.getLastSampleBefore(D);if(C!=null){var P=D-(C.originalDts+C.duration);P<=3&&(P=0);var M=C.dts+C.duration+P;u=D-M}else u=0}for(var N=new g.MediaSegmentInfo,B=[],U=0;U<y.length;U++){var I=y[U],F=I.dts-this._dtsBase,j=I.isKeyframe,V=F-u,G=I.cts,Y=V+G;_===-1&&(_=V,T=Y);var X=0;if(U!==y.length-1){var ie=y[U+1].dts-this._dtsBase-u;X=ie-V}else if(O!=null){var ie=O.dts-this._dtsBase-u;X=ie-V}else B.length>=1?X=B[B.length-1].duration:X=Math.floor(this._videoMeta.refSampleDuration);if(j){var he=new g.SampleInfo(V,Y,X,I.dts,!0);he.fileposition=I.fileposition,N.appendSyncPoint(he)}B.push({dts:V,pts:Y,cts:G,units:I.units,size:I.length,isKeyframe:j,duration:X,originalDts:F,flags:{isLeading:0,dependsOn:j?2:1,isDependedOn:j?1:0,hasRedundancy:0,isNonSync:j?0:1}})}R=new Uint8Array(w),R[0]=w>>>24&255,R[1]=w>>>16&255,R[2]=w>>>8&255,R[3]=w&255,R.set(h.default.types.mdat,4);for(var U=0;U<B.length;U++)for(var de=B[U].units;de.length;){var Ae=de.shift(),pe=Ae.data;R.set(pe,L),L+=pe.byteLength}var le=B[B.length-1];if(b=le.dts+le.duration,A=le.pts+le.duration,this._videoNextDts=b,N.beginDts=_,N.endDts=b,N.beginPts=T,N.endPts=A,N.originalBeginDts=B[0].originalDts,N.originalEndDts=le.originalDts+le.duration,N.firstSample=new g.SampleInfo(B[0].dts,B[0].pts,B[0].duration,B[0].originalDts,B[0].isKeyframe),N.lastSample=new g.SampleInfo(le.dts,le.pts,le.duration,le.originalDts,le.isKeyframe),this._isLive||this._videoSegmentInfoList.append(N),p.samples=B,p.sequenceNumber++,this._forceFirstIDR){var Ie=B[0].flags;Ie.dependsOn=2,Ie.isNonSync=0}var Ce=h.default.moof(p,_);p.samples=[],p.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(Ce,R).buffer,sampleCount:B.length,info:N})}}},x.prototype._mergeBoxes=function(m,c){var p=new Uint8Array(m.byteLength+c.byteLength);return p.set(m,0),p.set(c,m.byteLength),p},x}();o.default=S},"./src/utils/browser.js":function(a,o,l){l.r(o);var v={};function h(){var f=self.navigator.userAgent.toLowerCase(),d=/(edge)\/([\w.]+)/.exec(f)||/(opr)[\/]([\w.]+)/.exec(f)||/(chrome)[ \/]([\w.]+)/.exec(f)||/(iemobile)[\/]([\w.]+)/.exec(f)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(f)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(f)||/(webkit)[ \/]([\w.]+)/.exec(f)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(f)||/(msie) ([\w.]+)/.exec(f)||f.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(f)||f.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(f)||[],g=/(ipad)/.exec(f)||/(ipod)/.exec(f)||/(windows phone)/.exec(f)||/(iphone)/.exec(f)||/(kindle)/.exec(f)||/(android)/.exec(f)||/(windows)/.exec(f)||/(mac)/.exec(f)||/(linux)/.exec(f)||/(cros)/.exec(f)||[],E={browser:d[5]||d[3]||d[1]||"",version:d[2]||d[4]||"0",majorVersion:d[4]||d[2]||"0",platform:g[0]||""},S={};if(E.browser){S[E.browser]=!0;var x=E.majorVersion.split(".");S.version={major:parseInt(E.majorVersion,10),string:E.version},x.length>1&&(S.version.minor=parseInt(x[1],10)),x.length>2&&(S.version.build=parseInt(x[2],10))}if(E.platform&&(S[E.platform]=!0),(S.chrome||S.opr||S.safari)&&(S.webkit=!0),S.rv||S.iemobile){S.rv&&delete S.rv;var m="msie";E.browser=m,S[m]=!0}if(S.edge){delete S.edge;var c="msedge";E.browser=c,S[c]=!0}if(S.opr){var p="opera";E.browser=p,S[p]=!0}if(S.safari&&S.android){var y="android";E.browser=y,S[y]=!0}S.name=E.browser,S.platform=E.platform;for(var u in v)v.hasOwnProperty(u)&&delete v[u];Object.assign(v,S)}h(),o.default=v},"./src/utils/exception.js":function(a,o,l){l.r(o),l.d(o,{RuntimeException:function(){return h},IllegalStateException:function(){return f},InvalidArgumentException:function(){return d},NotImplementedException:function(){return g}});var v=function(){var E=function(S,x){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,c){m.__proto__=c}||function(m,c){for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(m[p]=c[p])},E(S,x)};return function(S,x){if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");E(S,x);function m(){this.constructor=S}S.prototype=x===null?Object.create(x):(m.prototype=x.prototype,new m)}}(),h=function(){function E(S){this._message=S}return Object.defineProperty(E.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),E.prototype.toString=function(){return this.name+": "+this.message},E}(),f=function(E){v(S,E);function S(x){return E.call(this,x)||this}return Object.defineProperty(S.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),S}(h),d=function(E){v(S,E);function S(x){return E.call(this,x)||this}return Object.defineProperty(S.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),S}(h),g=function(E){v(S,E);function S(x){return E.call(this,x)||this}return Object.defineProperty(S.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),S}(h)},"./src/utils/logger.js":function(a,o,l){l.r(o);var v=l("./node_modules/events/events.js"),h=l.n(v),f=function(){function d(){}return d.e=function(g,E){(!g||d.FORCE_GLOBAL_TAG)&&(g=d.GLOBAL_TAG);var S="["+g+"] > "+E;d.ENABLE_CALLBACK&&d.emitter.emit("log","error",S),!!d.ENABLE_ERROR&&(console.error?console.error(S):console.warn?console.warn(S):console.log(S))},d.i=function(g,E){(!g||d.FORCE_GLOBAL_TAG)&&(g=d.GLOBAL_TAG);var S="["+g+"] > "+E;d.ENABLE_CALLBACK&&d.emitter.emit("log","info",S),!!d.ENABLE_INFO&&(console.info?console.info(S):console.log(S))},d.w=function(g,E){(!g||d.FORCE_GLOBAL_TAG)&&(g=d.GLOBAL_TAG);var S="["+g+"] > "+E;d.ENABLE_CALLBACK&&d.emitter.emit("log","warn",S),!!d.ENABLE_WARN&&(console.warn?console.warn(S):console.log(S))},d.d=function(g,E){(!g||d.FORCE_GLOBAL_TAG)&&(g=d.GLOBAL_TAG);var S="["+g+"] > "+E;d.ENABLE_CALLBACK&&d.emitter.emit("log","debug",S),!!d.ENABLE_DEBUG&&(console.debug?console.debug(S):console.log(S))},d.v=function(g,E){(!g||d.FORCE_GLOBAL_TAG)&&(g=d.GLOBAL_TAG);var S="["+g+"] > "+E;d.ENABLE_CALLBACK&&d.emitter.emit("log","verbose",S),!!d.ENABLE_VERBOSE&&console.log(S)},d}();f.GLOBAL_TAG="flv.js",f.FORCE_GLOBAL_TAG=!1,f.ENABLE_ERROR=!0,f.ENABLE_INFO=!0,f.ENABLE_WARN=!0,f.ENABLE_DEBUG=!0,f.ENABLE_VERBOSE=!0,f.ENABLE_CALLBACK=!1,f.emitter=new(h()),o.default=f},"./src/utils/logging-control.js":function(a,o,l){l.r(o);var v=l("./node_modules/events/events.js"),h=l.n(v),f=l("./src/utils/logger.js"),d=function(){function g(){}return Object.defineProperty(g,"forceGlobalTag",{get:function(){return f.default.FORCE_GLOBAL_TAG},set:function(E){f.default.FORCE_GLOBAL_TAG=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"globalTag",{get:function(){return f.default.GLOBAL_TAG},set:function(E){f.default.GLOBAL_TAG=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableAll",{get:function(){return f.default.ENABLE_VERBOSE&&f.default.ENABLE_DEBUG&&f.default.ENABLE_INFO&&f.default.ENABLE_WARN&&f.default.ENABLE_ERROR},set:function(E){f.default.ENABLE_VERBOSE=E,f.default.ENABLE_DEBUG=E,f.default.ENABLE_INFO=E,f.default.ENABLE_WARN=E,f.default.ENABLE_ERROR=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableDebug",{get:function(){return f.default.ENABLE_DEBUG},set:function(E){f.default.ENABLE_DEBUG=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableVerbose",{get:function(){return f.default.ENABLE_VERBOSE},set:function(E){f.default.ENABLE_VERBOSE=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableInfo",{get:function(){return f.default.ENABLE_INFO},set:function(E){f.default.ENABLE_INFO=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableWarn",{get:function(){return f.default.ENABLE_WARN},set:function(E){f.default.ENABLE_WARN=E,g._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(g,"enableError",{get:function(){return f.default.ENABLE_ERROR},set:function(E){f.default.ENABLE_ERROR=E,g._notifyChange()},enumerable:!1,configurable:!0}),g.getConfig=function(){return{globalTag:f.default.GLOBAL_TAG,forceGlobalTag:f.default.FORCE_GLOBAL_TAG,enableVerbose:f.default.ENABLE_VERBOSE,enableDebug:f.default.ENABLE_DEBUG,enableInfo:f.default.ENABLE_INFO,enableWarn:f.default.ENABLE_WARN,enableError:f.default.ENABLE_ERROR,enableCallback:f.default.ENABLE_CALLBACK}},g.applyConfig=function(E){f.default.GLOBAL_TAG=E.globalTag,f.default.FORCE_GLOBAL_TAG=E.forceGlobalTag,f.default.ENABLE_VERBOSE=E.enableVerbose,f.default.ENABLE_DEBUG=E.enableDebug,f.default.ENABLE_INFO=E.enableInfo,f.default.ENABLE_WARN=E.enableWarn,f.default.ENABLE_ERROR=E.enableError,f.default.ENABLE_CALLBACK=E.enableCallback},g._notifyChange=function(){var E=g.emitter;if(E.listenerCount("change")>0){var S=g.getConfig();E.emit("change",S)}},g.registerListener=function(E){g.emitter.addListener("change",E)},g.removeListener=function(E){g.emitter.removeListener("change",E)},g.addLogListener=function(E){f.default.emitter.addListener("log",E),f.default.emitter.listenerCount("log")>0&&(f.default.ENABLE_CALLBACK=!0,g._notifyChange())},g.removeLogListener=function(E){f.default.emitter.removeListener("log",E),f.default.emitter.listenerCount("log")===0&&(f.default.ENABLE_CALLBACK=!1,g._notifyChange())},g}();d.emitter=new(h()),o.default=d},"./src/utils/polyfill.js":function(a,o,l){l.r(o);var v=function(){function h(){}return h.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(f,d){return f.__proto__=d,f},Object.assign=Object.assign||function(f){if(f==null)throw new TypeError("Cannot convert undefined or null to object");for(var d=Object(f),g=1;g<arguments.length;g++){var E=arguments[g];if(E!=null)for(var S in E)E.hasOwnProperty(S)&&(d[S]=E[S])}return d},typeof self.Promise!="function"&&l("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},h}();v.install(),o.default=v},"./src/utils/utf8-conv.js":function(a,o,l){l.r(o);function v(f,d,g){var E=f;if(d+g<E.length){for(;g--;)if((E[++d]&192)!=128)return!1;return!0}else return!1}function h(f){for(var d=[],g=f,E=0,S=f.length;E<S;){if(g[E]<128){d.push(String.fromCharCode(g[E])),++E;continue}else if(!(g[E]<192)){if(g[E]<224){if(v(g,E,1)){var x=(g[E]&31)<<6|g[E+1]&63;if(x>=128){d.push(String.fromCharCode(x&65535)),E+=2;continue}}}else if(g[E]<240){if(v(g,E,2)){var x=(g[E]&15)<<12|(g[E+1]&63)<<6|g[E+2]&63;if(x>=2048&&(x&63488)!=55296){d.push(String.fromCharCode(x&65535)),E+=3;continue}}}else if(g[E]<248&&v(g,E,3)){var x=(g[E]&7)<<18|(g[E+1]&63)<<12|(g[E+2]&63)<<6|g[E+3]&63;if(x>65536&&x<1114112){x-=65536,d.push(String.fromCharCode(x>>>10|55296)),d.push(String.fromCharCode(x&1023|56320)),E+=4;continue}}}d.push(String.fromCharCode(65533)),++E}return d.join("")}o.default=h}},i={};function t(a){var o=i[a];if(o!==void 0)return o.exports;var l=i[a]={exports:{}};return r[a].call(l.exports,l,l.exports,t),l.exports}t.m=r,function(){t.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return t.d(o,{a:o}),o}}(),function(){t.d=function(a,o){for(var l in o)t.o(o,l)&&!t.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:o[l]})}}(),function(){t.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(a){if(typeof window=="object")return window}}()}(),function(){t.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)}}(),function(){t.r=function(a){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}}();var n=t("./src/index.js");return n}()})})(Rh);var kT=bo(Rh.exports);const Ia=typeof window!="undefined"?window.navigator.userAgent:"",NT=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(Ia);/^((?!chrome|android).)*safari/i.test(Ia);/MicroMessenger/i.test(Ia);/MSIE|Trident/i.test(Ia);var Dh={exports:{}};(function(s,e){typeof window!="undefined"&&function(i,t){s.exports=t()}(Wt,function(){return function(r){var i={};function t(n){if(i[n])return i[n].exports;var a=i[n]={i:n,l:!1,exports:{}};return r[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}return t.m=r,t.c=i,t.d=function(n,a,o){t.o(n,a)||Object.defineProperty(n,a,{enumerable:!0,get:o})},t.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,a){if(a&1&&(n=t(n)),a&8||a&4&&typeof n=="object"&&n&&n.__esModule)return n;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),a&2&&typeof n!="string")for(var l in n)t.d(o,l,function(v){return n[v]}.bind(null,l));return o},t.n=function(n){var a=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(a,"a",a),a},t.o=function(n,a){return Object.prototype.hasOwnProperty.call(n,a)},t.p="/dist/",t(t.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(r,i,t){var n=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function l(d,g,E){this.fn=d,this.context=g,this.once=E||!1}function v(d,g,E,S,x){if(typeof E!="function")throw new TypeError("The listener must be a function");var m=new l(E,S||d,x),c=a?a+g:g;return d._events[c]?d._events[c].fn?d._events[c]=[d._events[c],m]:d._events[c].push(m):(d._events[c]=m,d._eventsCount++),d}function h(d,g){--d._eventsCount==0?d._events=new o:delete d._events[g]}function f(){this._events=new o,this._eventsCount=0}f.prototype.eventNames=function(){var g=[],E,S;if(this._eventsCount===0)return g;for(S in E=this._events)n.call(E,S)&&g.push(a?S.slice(1):S);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(E)):g},f.prototype.listeners=function(g){var E=a?a+g:g,S=this._events[E];if(!S)return[];if(S.fn)return[S.fn];for(var x=0,m=S.length,c=new Array(m);x<m;x++)c[x]=S[x].fn;return c},f.prototype.listenerCount=function(g){var E=a?a+g:g,S=this._events[E];return S?S.fn?1:S.length:0},f.prototype.emit=function(g,E,S,x,m,c){var p=a?a+g:g;if(!this._events[p])return!1;var y=this._events[p],u=arguments.length,_,b;if(y.fn){switch(y.once&&this.removeListener(g,y.fn,void 0,!0),u){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,E),!0;case 3:return y.fn.call(y.context,E,S),!0;case 4:return y.fn.call(y.context,E,S,x),!0;case 5:return y.fn.call(y.context,E,S,x,m),!0;case 6:return y.fn.call(y.context,E,S,x,m,c),!0}for(b=1,_=new Array(u-1);b<u;b++)_[b-1]=arguments[b];y.fn.apply(y.context,_)}else{var T=y.length,A;for(b=0;b<T;b++)switch(y[b].once&&this.removeListener(g,y[b].fn,void 0,!0),u){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,E);break;case 3:y[b].fn.call(y[b].context,E,S);break;case 4:y[b].fn.call(y[b].context,E,S,x);break;default:if(!_)for(A=1,_=new Array(u-1);A<u;A++)_[A-1]=arguments[A];y[b].fn.apply(y[b].context,_)}}return!0},f.prototype.on=function(g,E,S){return v(this,g,E,S,!1)},f.prototype.once=function(g,E,S){return v(this,g,E,S,!0)},f.prototype.removeListener=function(g,E,S,x){var m=a?a+g:g;if(!this._events[m])return this;if(!E)return h(this,m),this;var c=this._events[m];if(c.fn)c.fn===E&&(!x||c.once)&&(!S||c.context===S)&&h(this,m);else{for(var p=0,y=[],u=c.length;p<u;p++)(c[p].fn!==E||x&&!c[p].once||S&&c[p].context!==S)&&y.push(c[p]);y.length?this._events[m]=y.length===1?y[0]:y:h(this,m)}return this},f.prototype.removeAllListeners=function(g){var E;return g?(E=a?a+g:g,this._events[E]&&h(this,E)):(this._events=new o,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=a,f.EventEmitter=f,r.exports=f},"./node_modules/url-toolkit/src/url-toolkit.js":function(r,i,t){(function(n){var a=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,o=/^([^\/?#]*)([^]*)$/,l=/(?:\/|^)\.(?=\/)/g,v=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,h={buildAbsoluteURL:function(f,d,g){if(g=g||{},f=f.trim(),d=d.trim(),!d){if(!g.alwaysNormalize)return f;var E=h.parseURL(f);if(!E)throw new Error("Error trying to parse base URL.");return E.path=h.normalizePath(E.path),h.buildURLFromParts(E)}var S=h.parseURL(d);if(!S)throw new Error("Error trying to parse relative URL.");if(S.scheme)return g.alwaysNormalize?(S.path=h.normalizePath(S.path),h.buildURLFromParts(S)):d;var x=h.parseURL(f);if(!x)throw new Error("Error trying to parse base URL.");if(!x.netLoc&&x.path&&x.path[0]!=="/"){var m=o.exec(x.path);x.netLoc=m[1],x.path=m[2]}x.netLoc&&!x.path&&(x.path="/");var c={scheme:x.scheme,netLoc:S.netLoc,path:null,params:S.params,query:S.query,fragment:S.fragment};if(!S.netLoc&&(c.netLoc=x.netLoc,S.path[0]!=="/"))if(!S.path)c.path=x.path,S.params||(c.params=x.params,S.query||(c.query=x.query));else{var p=x.path,y=p.substring(0,p.lastIndexOf("/")+1)+S.path;c.path=h.normalizePath(y)}return c.path===null&&(c.path=g.alwaysNormalize?h.normalizePath(S.path):S.path),h.buildURLFromParts(c)},parseURL:function(f){var d=a.exec(f);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(l,"");f.length!==(f=f.replace(v,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};r.exports=h})()},"./node_modules/webworkify-webpack/index.js":function(r,i,t){function n(g){var E={};function S(m){if(E[m])return E[m].exports;var c=E[m]={i:m,l:!1,exports:{}};return g[m].call(c.exports,c,c.exports,S),c.l=!0,c.exports}S.m=g,S.c=E,S.i=function(m){return m},S.d=function(m,c,p){S.o(m,c)||Object.defineProperty(m,c,{configurable:!1,enumerable:!0,get:p})},S.r=function(m){Object.defineProperty(m,"__esModule",{value:!0})},S.n=function(m){var c=m&&m.__esModule?function(){return m.default}:function(){return m};return S.d(c,"a",c),c},S.o=function(m,c){return Object.prototype.hasOwnProperty.call(m,c)},S.p="/",S.oe=function(m){throw console.error(m),m};var x=S(S.s=ENTRY_MODULE);return x.default||x}var a="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+a+").*?\\)";function l(g){return(g+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function v(g){return!isNaN(1*g)}function h(g,E,S){var x={};x[S]=[];var m=E.toString(),c=m.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return x;for(var p=c[1],y=new RegExp("(\\\\n|\\W)"+l(p)+o,"g"),u;u=y.exec(m);)u[3]!=="dll-reference"&&x[S].push(u[3]);for(y=new RegExp("\\("+l(p)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+o,"g");u=y.exec(m);)g[u[2]]||(x[S].push(u[1]),g[u[2]]=t(u[1]).m),x[u[2]]=x[u[2]]||[],x[u[2]].push(u[4]);for(var _=Object.keys(x),b=0;b<_.length;b++)for(var T=0;T<x[_[b]].length;T++)v(x[_[b]][T])&&(x[_[b]][T]=1*x[_[b]][T]);return x}function f(g){var E=Object.keys(g);return E.reduce(function(S,x){return S||g[x].length>0},!1)}function d(g,E){for(var S={main:[E]},x={main:[]},m={main:{}};f(S);)for(var c=Object.keys(S),p=0;p<c.length;p++){var y=c[p],u=S[y],_=u.pop();if(m[y]=m[y]||{},!(m[y][_]||!g[y][_])){m[y][_]=!0,x[y]=x[y]||[],x[y].push(_);for(var b=h(g,g[y][_],y),T=Object.keys(b),A=0;A<T.length;A++)S[T[A]]=S[T[A]]||[],S[T[A]]=S[T[A]].concat(b[T[A]])}}return x}r.exports=function(g,E){E=E||{};var S={main:t.m},x=E.all?{main:Object.keys(S.main)}:d(S,g),m="";Object.keys(x).filter(function(_){return _!=="main"}).forEach(function(_){for(var b=0;x[_][b];)b++;x[_].push(b),S[_][b]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",m=m+"var "+_+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(b))+")({"+x[_].map(function(T){return""+JSON.stringify(T)+": "+S[_][T].toString()}).join(",")+`});
`}),m=m+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(g))+")({"+x.main.map(function(_){return""+JSON.stringify(_)+": "+S.main[_].toString()}).join(",")+"}))(self);";var c=new window.Blob([m],{type:"text/javascript"});if(E.bare)return c;var p=window.URL||window.webkitURL||window.mozURL||window.msURL,y=p.createObjectURL(c),u=new window.Worker(y);return u.objectURL=y,u}},"./src/config.ts":function(r,i,t){t.r(i),t.d(i,"hlsDefaultConfig",function(){return A}),t.d(i,"mergeConfig",function(){return R}),t.d(i,"enableStreamingMode",function(){return w});var n=t("./src/controller/abr-controller.ts"),a=t("./src/controller/audio-stream-controller.ts"),o=t("./src/controller/audio-track-controller.ts"),l=t("./src/controller/subtitle-stream-controller.ts"),v=t("./src/controller/subtitle-track-controller.ts"),h=t("./src/controller/buffer-controller.ts"),f=t("./src/controller/timeline-controller.ts"),d=t("./src/controller/cap-level-controller.ts"),g=t("./src/controller/fps-controller.ts"),E=t("./src/controller/eme-controller.ts"),S=t("./src/controller/cmcd-controller.ts"),x=t("./src/utils/xhr-loader.ts"),m=t("./src/utils/fetch-loader.ts"),c=t("./src/utils/cues.ts"),p=t("./src/utils/mediakeys-helper.ts"),y=t("./src/utils/logger.ts");function u(){return u=Object.assign||function(O){for(var I=1;I<arguments.length;I++){var D=arguments[I];for(var C in D)Object.prototype.hasOwnProperty.call(D,C)&&(O[C]=D[C])}return O},u.apply(this,arguments)}function _(O,I){var D=Object.keys(O);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(O);I&&(C=C.filter(function(P){return Object.getOwnPropertyDescriptor(O,P).enumerable})),D.push.apply(D,C)}return D}function b(O){for(var I=1;I<arguments.length;I++){var D=arguments[I]!=null?arguments[I]:{};I%2?_(Object(D),!0).forEach(function(C){T(O,C,D[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(D)):_(Object(D)).forEach(function(C){Object.defineProperty(O,C,Object.getOwnPropertyDescriptor(D,C))})}return O}function T(O,I,D){return I in O?Object.defineProperty(O,I,{value:D,enumerable:!0,configurable:!0,writable:!0}):O[I]=D,O}var A=b(b({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:x.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:n.default,bufferController:h.default,capLevelController:d.default,fpsController:g.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:p.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},L()),{},{subtitleStreamController:l.SubtitleStreamController,subtitleTrackController:v.default,timelineController:f.TimelineController,audioStreamController:a.default,audioTrackController:o.default,emeController:E.default,cmcdController:S.default});function L(){return{cueHandler:c.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function R(O,I){if((I.liveSyncDurationCount||I.liveMaxLatencyDurationCount)&&(I.liveSyncDuration||I.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(I.liveMaxLatencyDurationCount!==void 0&&(I.liveSyncDurationCount===void 0||I.liveMaxLatencyDurationCount<=I.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(I.liveMaxLatencyDuration!==void 0&&(I.liveSyncDuration===void 0||I.liveMaxLatencyDuration<=I.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return u({},O,I)}function w(O){var I=O.loader;if(I!==m.default&&I!==x.default)y.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),O.progressive=!1;else{var D=Object(m.fetchSupported)();D&&(O.loader=m.default,O.progressive=!0,O.enableSoftwareAES=!0,y.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/utils/ewma-bandwidth-estimator.ts"),o=t("./src/events.ts"),l=t("./src/utils/buffer-helper.ts"),v=t("./src/errors.ts"),h=t("./src/types/loader.ts"),f=t("./src/utils/logger.ts");function d(S,x){for(var m=0;m<x.length;m++){var c=x[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(S,c.key,c)}}function g(S,x,m){return x&&d(S.prototype,x),m&&d(S,m),S}var E=function(){function S(m){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=m;var c=m.config;this.bwEstimator=new a.default(c.abrEwmaSlowVoD,c.abrEwmaFastVoD,c.abrEwmaDefaultEstimate),this.registerListeners()}var x=S.prototype;return x.registerListeners=function(){var c=this.hls;c.on(o.Events.FRAG_LOADING,this.onFragLoading,this),c.on(o.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(o.Events.ERROR,this.onError,this)},x.unregisterListeners=function(){var c=this.hls;c.off(o.Events.FRAG_LOADING,this.onFragLoading,this),c.off(o.Events.FRAG_LOADED,this.onFragLoaded,this),c.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(o.Events.ERROR,this.onError,this)},x.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},x.onFragLoading=function(c,p){var y=p.frag;if(y.type===h.PlaylistLevelType.MAIN&&!this.timer){var u;this.fragCurrent=y,this.partCurrent=(u=p.part)!=null?u:null,this.timer=self.setInterval(this.onCheck,100)}},x.onLevelLoaded=function(c,p){var y=this.hls.config;p.details.live?this.bwEstimator.update(y.abrEwmaSlowLive,y.abrEwmaFastLive):this.bwEstimator.update(y.abrEwmaSlowVoD,y.abrEwmaFastVoD)},x._abandonRulesCheck=function(){var c=this.fragCurrent,p=this.partCurrent,y=this.hls,u=y.autoLevelEnabled,_=y.config,b=y.media;if(!(!c||!b)){var T=p?p.stats:c.stats,A=p?p.duration:c.duration;if(T.aborted){f.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!u||b.paused||!b.playbackRate||!b.readyState)){var L=performance.now()-T.loading.start,R=Math.abs(b.playbackRate);if(!(L<=500*A/R)){var w=y.levels,O=y.minAutoLevel,I=w[c.level],D=T.total||Math.max(T.loaded,Math.round(A*I.maxBitrate/8)),C=Math.max(1,T.bwEstimate?T.bwEstimate/8:T.loaded*1e3/L),P=(D-T.loaded)/C,M=b.currentTime,N=(l.BufferHelper.bufferInfo(b,M,_.maxBufferHole).end-M)/R;if(!(N>=2*A/R||P<=N)){var B=Number.POSITIVE_INFINITY,U;for(U=c.level-1;U>O;U--){var F=w[U].maxBitrate;if(B=A*F/(8*.8*C),B<N)break}if(!(B>=P)){var j=this.bwEstimator.getEstimate();f.logger.warn("Fragment "+c.sn+(p?" part "+p.index:"")+" of level "+c.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+U+`
      Current BW estimate: `+(Object(n.isFiniteNumber)(j)?(j/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+P.toFixed(3)+` s
      Estimated load time for the next fragment: `+B.toFixed(3)+` s
      Time to underbuffer: `+N.toFixed(3)+" s"),y.nextLoadLevel=U,this.bwEstimator.sample(L,T.loaded),this.clearTimer(),c.loader&&(this.fragCurrent=this.partCurrent=null,c.loader.abort()),y.trigger(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,part:p,stats:T})}}}}}},x.onFragLoaded=function(c,p){var y=p.frag,u=p.part;if(y.type===h.PlaylistLevelType.MAIN&&Object(n.isFiniteNumber)(y.sn)){var _=u?u.stats:y.stats,b=u?u.duration:y.duration;if(this.clearTimer(),this.lastLoadedFragLevel=y.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var T=this.hls.levels[y.level],A=(T.loaded?T.loaded.bytes:0)+_.loaded,L=(T.loaded?T.loaded.duration:0)+b;T.loaded={bytes:A,duration:L},T.realBitrate=Math.round(8*A/L)}if(y.bitrateTest){var R={stats:_,frag:y,part:u,id:y.type};this.onFragBuffered(o.Events.FRAG_BUFFERED,R),y.bitrateTest=!1}}},x.onFragBuffered=function(c,p){var y=p.frag,u=p.part,_=u?u.stats:y.stats;if(!_.aborted&&!(y.type!==h.PlaylistLevelType.MAIN||y.sn==="initSegment")){var b=_.parsing.end-_.loading.start;this.bwEstimator.sample(b,_.loaded),_.bwEstimate=this.bwEstimator.getEstimate(),y.bitrateTest?this.bitrateTestDelay=b/1e3:this.bitrateTestDelay=0}},x.onError=function(c,p){switch(p.details){case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},x.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},x.getNextABRAutoLevel=function(){var c=this.fragCurrent,p=this.partCurrent,y=this.hls,u=y.maxAutoLevel,_=y.config,b=y.minAutoLevel,T=y.media,A=p?p.duration:c?c.duration:0,L=T?T.currentTime:0,R=T&&T.playbackRate!==0?Math.abs(T.playbackRate):1,w=this.bwEstimator?this.bwEstimator.getEstimate():_.abrEwmaDefaultEstimate,O=(l.BufferHelper.bufferInfo(T,L,_.maxBufferHole).end-L)/R,I=this.findBestLevel(w,b,u,O,_.abrBandWidthFactor,_.abrBandWidthUpFactor);if(I>=0)return I;f.logger.trace((O?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var D=A?Math.min(A,_.maxStarvationDelay):_.maxStarvationDelay,C=_.abrBandWidthFactor,P=_.abrBandWidthUpFactor;if(!O){var M=this.bitrateTestDelay;if(M){var N=A?Math.min(A,_.maxLoadingDelay):_.maxLoadingDelay;D=N-M,f.logger.trace("bitrate test took "+Math.round(1e3*M)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*D)+" ms"),C=P=1}}return I=this.findBestLevel(w,b,u,O+D,C,P),Math.max(I,0)},x.findBestLevel=function(c,p,y,u,_,b){for(var T,A=this.fragCurrent,L=this.partCurrent,R=this.lastLoadedFragLevel,w=this.hls.levels,O=w[R],I=!!(O!=null&&(T=O.details)!==null&&T!==void 0&&T.live),D=O==null?void 0:O.codecSet,C=L?L.duration:A?A.duration:0,P=y;P>=p;P--){var M=w[P];if(!(!M||D&&M.codecSet!==D)){var N=M.details,B=(L?N==null?void 0:N.partTarget:N==null?void 0:N.averagetargetduration)||C,U=void 0;P<=R?U=_*c:U=b*c;var F=w[P].maxBitrate,j=F*B/U;if(f.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+P+"/"+Math.round(U)+"/"+F+"/"+B+"/"+u+"/"+j),U>F&&(!j||I&&!this.bitrateTestDelay||j<u))return P}}return-1},g(S,[{key:"nextAutoLevel",get:function(){var c=this._nextAutoLevel,p=this.bwEstimator;if(c!==-1&&(!p||!p.canEstimate()))return c;var y=this.getNextABRAutoLevel();return c!==-1&&(y=Math.min(c,y)),y},set:function(c){this._nextAutoLevel=c}}]),S}();i.default=E},"./src/controller/audio-stream-controller.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/controller/base-stream-controller.ts"),o=t("./src/events.ts"),l=t("./src/utils/buffer-helper.ts"),v=t("./src/controller/fragment-tracker.ts"),h=t("./src/types/level.ts"),f=t("./src/types/loader.ts"),d=t("./src/loader/fragment.ts"),g=t("./src/demux/chunk-cache.ts"),E=t("./src/demux/transmuxer-interface.ts"),S=t("./src/types/transmuxer.ts"),x=t("./src/controller/fragment-finders.ts"),m=t("./src/utils/discontinuities.ts"),c=t("./src/errors.ts"),p=t("./src/utils/logger.ts");function y(){return y=Object.assign||function(A){for(var L=1;L<arguments.length;L++){var R=arguments[L];for(var w in R)Object.prototype.hasOwnProperty.call(R,w)&&(A[w]=R[w])}return A},y.apply(this,arguments)}function u(A,L){A.prototype=Object.create(L.prototype),A.prototype.constructor=A,_(A,L)}function _(A,L){return _=Object.setPrototypeOf||function(w,O){return w.__proto__=O,w},_(A,L)}var b=100,T=function(A){u(L,A);function L(w,O){var I;return I=A.call(this,w,O,"[audio-stream-controller]")||this,I.videoBuffer=null,I.videoTrackCC=-1,I.waitingVideoCC=-1,I.audioSwitch=!1,I.trackId=-1,I.waitingData=null,I.mainDetails=null,I.bufferFlushed=!1,I._registerListeners(),I}var R=L.prototype;return R.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},R._registerListeners=function(){var O=this.hls;O.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),O.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),O.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),O.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),O.on(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),O.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),O.on(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),O.on(o.Events.ERROR,this.onError,this),O.on(o.Events.BUFFER_RESET,this.onBufferReset,this),O.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),O.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),O.on(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),O.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R._unregisterListeners=function(){var O=this.hls;O.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),O.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),O.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),O.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),O.off(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),O.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),O.off(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),O.off(o.Events.ERROR,this.onError,this),O.off(o.Events.BUFFER_RESET,this.onBufferReset,this),O.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),O.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),O.off(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),O.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},R.onInitPtsFound=function(O,I){var D=I.frag,C=I.id,P=I.initPTS;if(C==="main"){var M=D.cc;this.initPTS[D.cc]=P,this.log("InitPTS for cc: "+M+" found from main: "+P),this.videoTrackCC=M,this.state===a.State.WAITING_INIT_PTS&&this.tick()}},R.startLoad=function(O){if(!this.levels){this.startPosition=O,this.state=a.State.STOPPED;return}var I=this.lastCurrentTime;this.stopLoad(),this.setInterval(b),this.fragLoadError=0,I>0&&O===-1?(this.log("Override startPosition with lastCurrentTime @"+I.toFixed(3)),this.state=a.State.IDLE):(this.loadedmetadata=!1,this.state=a.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=O,this.tick()},R.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_TRACK:{var O,I=this.levels,D=this.trackId,C=I==null||(O=I[D])===null||O===void 0?void 0:O.details;if(C){if(this.waitForCdnTuneIn(C))break;this.state=a.State.WAITING_INIT_PTS}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var P,M=performance.now(),N=this.retryDate;(!N||M>=N||(P=this.media)!==null&&P!==void 0&&P.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=a.State.IDLE);break}case a.State.WAITING_INIT_PTS:{var B=this.waitingData;if(B){var U=B.frag,F=B.part,j=B.cache,V=B.complete;if(this.initPTS[U.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.FRAG_LOADING;var G=j.flush(),Y={frag:U,part:F,payload:G,networkDetails:null};this._handleFragmentLoadProgress(Y),V&&A.prototype._handleFragmentLoadComplete.call(this,Y)}else if(this.videoTrackCC!==this.waitingVideoCC)p.logger.log("Waiting fragment cc ("+U.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var X=this.getLoadPosition(),ie=l.BufferHelper.bufferInfo(this.mediaBuffer,X,this.config.maxBufferHole),he=Object(x.fragmentWithinToleranceTest)(ie.end,this.config.maxFragLookUpTolerance,U);he<0&&(p.logger.log("Waiting fragment cc ("+U.cc+") @ "+U.start+" cancelled because another fragment at "+ie.end+" is needed"),this.clearWaitingFragment())}}else this.state=a.State.IDLE}}this.onTickEnd()},R.clearWaitingFragment=function(){var O=this.waitingData;O&&(this.fragmentTracker.removeFragment(O.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.IDLE)},R.onTickEnd=function(){var O=this.media;if(!(!O||!O.readyState)){var I=this.mediaBuffer?this.mediaBuffer:O,D=I.buffered;!this.loadedmetadata&&D.length&&(this.loadedmetadata=!0),this.lastCurrentTime=O.currentTime}},R.doTickIdle=function(){var O,I,D=this.hls,C=this.levels,P=this.media,M=this.trackId,N=D.config;if(!(!C||!C[M])&&!(!P&&(this.startFragRequested||!N.startFragPrefetch))){var B=C[M],U=B.details;if(!U||U.live&&this.levelLastLoaded!==M||this.waitForCdnTuneIn(U)){this.state=a.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,d.ElementaryStreamTypes.AUDIO,f.PlaylistLevelType.AUDIO));var F=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,f.PlaylistLevelType.AUDIO);if(F!==null){var j=F.len,V=this.getMaxBufferLength(),G=this.audioSwitch;if(!(j>=V&&!G)){if(!G&&this._streamEnded(F,U)){D.trigger(o.Events.BUFFER_EOS,{type:"audio"}),this.state=a.State.ENDED;return}var Y=U.fragments,X=Y[0].start,ie=F.end;if(G){var he=this.getLoadPosition();ie=he,U.PTSKnown&&he<X&&(F.end>X||F.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),P.currentTime=X+.05)}var de=this.getNextFragment(ie,U);if(!de){this.bufferFlushed=!0;return}((O=de.decryptdata)===null||O===void 0?void 0:O.keyFormat)==="identity"&&!((I=de.decryptdata)!==null&&I!==void 0&&I.key)?this.loadKey(de,U):this.loadFragment(de,U,ie)}}}},R.getMaxBufferLength=function(){var O=A.prototype.getMaxBufferLength.call(this),I=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,f.PlaylistLevelType.MAIN);return I===null?O:Math.max(O,I.len)},R.onMediaDetaching=function(){this.videoBuffer=null,A.prototype.onMediaDetaching.call(this)},R.onAudioTracksUpdated=function(O,I){var D=I.audioTracks;this.resetTransmuxer(),this.levels=D.map(function(C){return new h.Level(C)})},R.onAudioTrackSwitching=function(O,I){var D=!!I.url;this.trackId=I.id;var C=this.fragCurrent;C!=null&&C.loader&&C.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),D?this.setInterval(b):this.resetTransmuxer(),D?(this.audioSwitch=!0,this.state=a.State.IDLE):this.state=a.State.STOPPED,this.tick()},R.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},R.onLevelLoaded=function(O,I){this.mainDetails=I.details},R.onAudioTrackLoaded=function(O,I){var D,C=this.levels,P=I.details,M=I.id;if(!C){this.warn("Audio tracks were reset while loading level "+M);return}this.log("Track "+M+" loaded ["+P.startSN+","+P.endSN+"],duration:"+P.totalduration);var N=C[M],B=0;if(P.live||(D=N.details)!==null&&D!==void 0&&D.live){var U=this.mainDetails;if(P.fragments[0]||(P.deltaUpdateFailed=!0),P.deltaUpdateFailed||!U)return;!N.details&&P.hasProgramDateTime&&U.hasProgramDateTime?(Object(m.alignMediaPlaylistByPDT)(P,U),B=P.fragments[0].start):B=this.alignPlaylists(P,N.details)}N.details=P,this.levelLastLoaded=M,!this.startFragRequested&&(this.mainDetails||!P.live)&&this.setStartPosition(N.details,B),this.state===a.State.WAITING_TRACK&&!this.waitForCdnTuneIn(P)&&(this.state=a.State.IDLE),this.tick()},R._handleFragmentLoadProgress=function(O){var I,D=O.frag,C=O.part,P=O.payload,M=this.config,N=this.trackId,B=this.levels;if(!B){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+D.sn+" of level "+D.level+" will not be buffered");return}var U=B[N];console.assert(U,"Audio track is defined on fragment load progress");var F=U.details;console.assert(F,"Audio track details are defined on fragment load progress");var j=M.defaultAudioCodec||U.audioCodec||"mp4a.40.2",V=this.transmuxer;V||(V=this.transmuxer=new E.default(this.hls,f.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var G=this.initPTS[D.cc],Y=(I=D.initSegment)===null||I===void 0?void 0:I.data;if(G!==void 0){var X=!1,ie=C?C.index:-1,he=ie!==-1,de=new S.ChunkMetadata(D.level,D.sn,D.stats.chunkCount,P.byteLength,ie,he);V.push(P,Y,j,"",D,C,F.totalduration,X,de,G)}else{p.logger.log("Unknown video PTS for cc "+D.cc+", waiting for video PTS before demuxing audio frag "+D.sn+" of ["+F.startSN+" ,"+F.endSN+"],track "+N);var Ae=this.waitingData=this.waitingData||{frag:D,part:C,cache:new g.default,complete:!1},pe=Ae.cache;pe.push(new Uint8Array(P)),this.waitingVideoCC=this.videoTrackCC,this.state=a.State.WAITING_INIT_PTS}},R._handleFragmentLoadComplete=function(O){if(this.waitingData){this.waitingData.complete=!0;return}A.prototype._handleFragmentLoadComplete.call(this,O)},R.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},R.onBufferCreated=function(O,I){var D=I.tracks.audio;D&&(this.mediaBuffer=D.buffer),I.tracks.video&&(this.videoBuffer=I.tracks.video.buffer)},R.onFragBuffered=function(O,I){var D=I.frag,C=I.part;if(D.type===f.PlaylistLevelType.AUDIO){if(this.fragContextChanged(D)){this.warn("Fragment "+D.sn+(C?" p: "+C.index:"")+" of level "+D.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}D.sn!=="initSegment"&&(this.fragPrevious=D,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(D,C)}},R.onError=function(O,I){switch(I.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:case c.ErrorDetails.KEY_LOAD_ERROR:case c.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(f.PlaylistLevelType.AUDIO,I);break;case c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case c.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==a.State.ERROR&&this.state!==a.State.STOPPED&&(this.state=I.fatal?a.State.ERROR:a.State.IDLE,this.warn(I.details+" while loading frag, switching to "+this.state+" state"));break;case c.ErrorDetails.BUFFER_FULL_ERROR:if(I.parent==="audio"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var D=!0,C=this.getFwdBufferInfo(this.mediaBuffer,f.PlaylistLevelType.AUDIO);C&&C.len>.5&&(D=!this.reduceMaxBufferLength(C.len)),D&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,A.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},R.onBufferFlushed=function(O,I){var D=I.type;D===d.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},R._handleTransmuxComplete=function(O){var I,D="audio",C=this.hls,P=O.remuxResult,M=O.chunkMeta,N=this.getCurrentContext(M);if(!N){this.warn("The loading context changed while buffering fragment "+M.sn+" of level "+M.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(M.level);return}var B=N.frag,U=N.part,F=P.audio,j=P.text,V=P.id3,G=P.initSegment;if(!this.fragContextChanged(B)){if(this.state=a.State.PARSING,this.audioSwitch&&F&&this.completeAudioSwitch(),G!=null&&G.tracks&&(this._bufferInitSegment(G.tracks,B,M),C.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:B,id:D,tracks:G.tracks})),F){var Y=F.startPTS,X=F.endPTS,ie=F.startDTS,he=F.endDTS;U&&(U.elementaryStreams[d.ElementaryStreamTypes.AUDIO]={startPTS:Y,endPTS:X,startDTS:ie,endDTS:he}),B.setElementaryStreamInfo(d.ElementaryStreamTypes.AUDIO,Y,X,ie,he),this.bufferFragmentData(F,B,U,M)}if(V!=null&&(I=V.samples)!==null&&I!==void 0&&I.length){var de=y({frag:B,id:D},V);C.trigger(o.Events.FRAG_PARSING_METADATA,de)}if(j){var Ae=y({frag:B,id:D},j);C.trigger(o.Events.FRAG_PARSING_USERDATA,Ae)}}},R._bufferInitSegment=function(O,I,D){if(this.state===a.State.PARSING){O.video&&delete O.video;var C=O.audio;if(!!C){C.levelCodec=C.codec,C.id="audio",this.log("Init audio buffer, container:"+C.container+", codecs[parsed]=["+C.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,O);var P=C.initSegment;if(P!=null&&P.byteLength){var M={type:"audio",frag:I,part:null,chunkMeta:D,parent:I.type,data:P};this.hls.trigger(o.Events.BUFFER_APPENDING,M)}this.tick()}}},R.loadFragment=function(O,I,D){var C=this.fragmentTracker.getState(O);this.fragCurrent=O,(this.audioSwitch||C===v.FragmentState.NOT_LOADED||C===v.FragmentState.PARTIAL)&&(O.sn==="initSegment"?this._loadInitSegment(O):I.live&&!Object(n.isFiniteNumber)(this.initPTS[O.cc])?(this.log("Waiting for video PTS in continuity counter "+O.cc+" of live stream before loading audio fragment "+O.sn+" of level "+this.trackId),this.state=a.State.WAITING_INIT_PTS):(this.startFragRequested=!0,A.prototype.loadFragment.call(this,O,I,D)))},R.completeAudioSwitch=function(){var O=this.hls,I=this.media,D=this.trackId;I&&(this.log("Switching audio track : flushing all audio"),A.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,O.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:D})},L}(a.default);i.default=T},"./src/controller/audio-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/controller/base-playlist-controller.ts"),l=t("./src/types/loader.ts");function v(E,S){for(var x=0;x<S.length;x++){var m=S[x];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(E,m.key,m)}}function h(E,S,x){return S&&v(E.prototype,S),x&&v(E,x),E}function f(E,S){E.prototype=Object.create(S.prototype),E.prototype.constructor=E,d(E,S)}function d(E,S){return d=Object.setPrototypeOf||function(m,c){return m.__proto__=c,m},d(E,S)}var g=function(E){f(S,E);function S(m){var c;return c=E.call(this,m,"[audio-track-controller]")||this,c.tracks=[],c.groupId=null,c.tracksInGroup=[],c.trackId=-1,c.trackName="",c.selectDefaultTrack=!0,c.registerListeners(),c}var x=S.prototype;return x.registerListeners=function(){var c=this.hls;c.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),c.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.on(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.on(n.Events.ERROR,this.onError,this)},x.unregisterListeners=function(){var c=this.hls;c.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),c.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.off(n.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.off(n.Events.ERROR,this.onError,this)},x.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,E.prototype.destroy.call(this)},x.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},x.onManifestParsed=function(c,p){this.tracks=p.audioTracks||[]},x.onAudioTrackLoaded=function(c,p){var y=p.id,u=p.details,_=this.tracksInGroup[y];if(!_){this.warn("Invalid audio track id "+y);return}var b=_.details;_.details=p.details,this.log("audioTrack "+y+" loaded ["+u.startSN+"-"+u.endSN+"]"),y===this.trackId&&(this.retryCount=0,this.playlistLoaded(y,p,b))},x.onLevelLoading=function(c,p){this.switchLevel(p.level)},x.onLevelSwitching=function(c,p){this.switchLevel(p.level)},x.switchLevel=function(c){var p=this.hls.levels[c];if(!!(p!=null&&p.audioGroupIds)){var y=p.audioGroupIds[p.urlId];if(this.groupId!==y){this.groupId=y;var u=this.tracks.filter(function(b){return!y||b.groupId===y});this.selectDefaultTrack&&!u.some(function(b){return b.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=u;var _={audioTracks:u};this.log("Updating audio tracks, "+u.length+' track(s) found in "'+y+'" group-id'),this.hls.trigger(n.Events.AUDIO_TRACKS_UPDATED,_),this.selectInitialTrack()}}},x.onError=function(c,p){E.prototype.onError.call(this,c,p),!(p.fatal||!p.context)&&p.context.type===l.PlaylistContextType.AUDIO_TRACK&&p.context.id===this.trackId&&p.context.groupId===this.groupId&&this.retryLoadingOrFail(p)},x.setAudioTrack=function(c){var p=this.tracksInGroup;if(c<0||c>=p.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var y=p[this.trackId];this.log("Now switching to audio-track index "+c);var u=p[c],_=u.id,b=u.groupId,T=b===void 0?"":b,A=u.name,L=u.type,R=u.url;if(this.trackId=c,this.trackName=A,this.selectDefaultTrack=!1,this.hls.trigger(n.Events.AUDIO_TRACK_SWITCHING,{id:_,groupId:T,name:A,type:L,url:R}),!(u.details&&!u.details.live)){var w=this.switchParams(u.url,y==null?void 0:y.details);this.loadPlaylist(w)}},x.selectInitialTrack=function(){var c=this.tracksInGroup;console.assert(c.length,"Initial audio track should be selected when tracks are known");var p=this.trackName,y=this.findTrackId(p)||this.findTrackId();y!==-1?this.setAudioTrack(y):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},x.findTrackId=function(c){for(var p=this.tracksInGroup,y=0;y<p.length;y++){var u=p[y];if((!this.selectDefaultTrack||u.default)&&(!c||c===u.name))return u.id}return-1},x.loadPlaylist=function(c){var p=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(p)){var y=p.id,u=p.groupId,_=p.url;if(c)try{_=c.addDirectives(_)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("loading audio-track playlist for id: "+y),this.clearTimer(),this.hls.trigger(n.Events.AUDIO_TRACK_LOADING,{url:_,id:y,groupId:u,deliveryDirectives:c||null})}},h(S,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(c){this.selectDefaultTrack=!1,this.setAudioTrack(c)}}]),S}(o.default);i.default=g},"./src/controller/base-playlist-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return h});var n=t("./src/polyfills/number.ts"),a=t("./src/types/level.ts"),o=t("./src/controller/level-helper.ts"),l=t("./src/utils/logger.ts"),v=t("./src/errors.ts"),h=function(){function f(g,E){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=l.logger.log.bind(l.logger,E+":"),this.warn=l.logger.warn.bind(l.logger,E+":"),this.hls=g}var d=f.prototype;return d.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},d.onError=function(E,S){S.fatal&&S.type===v.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},d.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},d.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},d.stopLoad=function(){this.canLoad=!1,this.clearTimer()},d.switchParams=function(E,S){var x=S==null?void 0:S.renditionReports;if(x)for(var m=0;m<x.length;m++){var c=x[m],p=""+c.URI;if(p===E.substr(-p.length)){var y=parseInt(c["LAST-MSN"]),u=parseInt(c["LAST-PART"]);if(S&&this.hls.config.lowLatencyMode){var _=Math.min(S.age-S.partTarget,S.targetduration);u!==void 0&&_>S.partTarget&&(u+=1)}if(Object(n.isFiniteNumber)(y))return new a.HlsUrlParameters(y,Object(n.isFiniteNumber)(u)?u:void 0,a.HlsSkip.No)}}},d.loadPlaylist=function(E){},d.shouldLoadTrack=function(E){return this.canLoad&&E&&!!E.url&&(!E.details||E.details.live)},d.playlistLoaded=function(E,S,x){var m=this,c=S.details,p=S.stats,y=p.loading.end?Math.max(0,self.performance.now()-p.loading.end):0;if(c.advancedDateTime=Date.now()-y,c.live||x!=null&&x.live){if(c.reloaded(x),x&&this.log("live playlist "+E+" "+(c.advanced?"REFRESHED "+c.lastPartSn+"-"+c.lastPartIndex:"MISSED")),x&&c.fragments.length>0&&Object(o.mergeDetails)(x,c),!this.canLoad||!c.live)return;var u,_=void 0,b=void 0;if(c.canBlockReload&&c.endSN&&c.advanced){var T=this.hls.config.lowLatencyMode,A=c.lastPartSn,L=c.endSN,R=c.lastPartIndex,w=R!==-1,O=A===L,I=T?0:R;w?(_=O?L+1:A,b=O?I:R+1):_=L+1;var D=c.age,C=D+c.ageHeader,P=Math.min(C-c.partTarget,c.targetduration*1.5);if(P>0){if(x&&P>x.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+x.tuneInGoal+" to: "+P+" with playlist age: "+c.age),P=0;else{var M=Math.floor(P/c.targetduration);if(_+=M,b!==void 0){var N=Math.round(P%c.targetduration/c.partTarget);b+=N}this.log("CDN Tune-in age: "+c.ageHeader+"s last advanced "+D.toFixed(2)+"s goal: "+P+" skip sn "+M+" to part "+b)}c.tuneInGoal=P}if(u=this.getDeliveryDirectives(c,S.deliveryDirectives,_,b),T||!O){this.loadPlaylist(u);return}}else u=this.getDeliveryDirectives(c,S.deliveryDirectives,_,b);var B=Object(o.computeReloadInterval)(c,p);_!==void 0&&c.canBlockReload&&(B-=c.partTarget||1),this.log("reload live playlist "+E+" in "+Math.round(B)+" ms"),this.timer=self.setTimeout(function(){return m.loadPlaylist(u)},B)}else this.clearTimer()},d.getDeliveryDirectives=function(E,S,x,m){var c=Object(a.getSkipValue)(E,x);return S!=null&&S.skip&&E.deltaUpdateFailed&&(x=S.msn,m=S.part,c=a.HlsSkip.No),new a.HlsUrlParameters(x,m,c)},d.retryLoadingOrFail=function(E){var S=this,x=this.hls.config,m=this.retryCount<x.levelLoadingMaxRetry;if(m){var c;if(this.retryCount++,E.details.indexOf("LoadTimeOut")>-1&&(c=E.context)!==null&&c!==void 0&&c.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+E.details+'"'),this.loadPlaylist();else{var p=Math.min(Math.pow(2,this.retryCount)*x.levelLoadingRetryDelay,x.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return S.loadPlaylist()},p),this.warn("retry playlist loading #"+this.retryCount+" in "+p+' ms after "'+E.details+'"')}}else this.warn('cannot recover from error "'+E.details+'"'),this.clearTimer(),E.fatal=!0;return m},f}()},"./src/controller/base-stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"State",function(){return L}),t.d(i,"default",function(){return R});var n=t("./src/polyfills/number.ts"),a=t("./src/task-loop.ts"),o=t("./src/controller/fragment-tracker.ts"),l=t("./src/utils/buffer-helper.ts"),v=t("./src/utils/logger.ts"),h=t("./src/events.ts"),f=t("./src/errors.ts"),d=t("./src/types/transmuxer.ts"),g=t("./src/utils/mp4-tools.ts"),E=t("./src/utils/discontinuities.ts"),S=t("./src/controller/fragment-finders.ts"),x=t("./src/controller/level-helper.ts"),m=t("./src/loader/fragment-loader.ts"),c=t("./src/crypt/decrypter.ts"),p=t("./src/utils/time-ranges.ts"),y=t("./src/types/loader.ts");function u(w,O){for(var I=0;I<O.length;I++){var D=O[I];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(w,D.key,D)}}function _(w,O,I){return O&&u(w.prototype,O),I&&u(w,I),w}function b(w){if(w===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}function T(w,O){w.prototype=Object.create(O.prototype),w.prototype.constructor=w,A(w,O)}function A(w,O){return A=Object.setPrototypeOf||function(D,C){return D.__proto__=C,D},A(w,O)}var L={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},R=function(w){T(O,w);function O(D,C,P){var M;return M=w.call(this)||this,M.hls=void 0,M.fragPrevious=null,M.fragCurrent=null,M.fragmentTracker=void 0,M.transmuxer=null,M._state=L.STOPPED,M.media=void 0,M.mediaBuffer=void 0,M.config=void 0,M.bitrateTest=!1,M.lastCurrentTime=0,M.nextLoadPosition=0,M.startPosition=0,M.loadedmetadata=!1,M.fragLoadError=0,M.retryDate=0,M.levels=null,M.fragmentLoader=void 0,M.levelLastLoaded=null,M.startFragRequested=!1,M.decrypter=void 0,M.initPTS=[],M.onvseeking=null,M.onvended=null,M.logPrefix="",M.log=void 0,M.warn=void 0,M.logPrefix=P,M.log=v.logger.log.bind(v.logger,P+":"),M.warn=v.logger.warn.bind(v.logger,P+":"),M.hls=D,M.fragmentLoader=new m.default(D.config),M.fragmentTracker=C,M.config=D.config,M.decrypter=new c.default(D,D.config),D.on(h.Events.KEY_LOADED,M.onKeyLoaded,b(M)),M}var I=O.prototype;return I.doTick=function(){this.onTickEnd()},I.onTickEnd=function(){},I.startLoad=function(C){},I.stopLoad=function(){this.fragmentLoader.abort();var C=this.fragCurrent;C&&this.fragmentTracker.removeFragment(C),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=L.STOPPED},I._streamEnded=function(C,P){var M=this.fragCurrent,N=this.fragmentTracker;if(!P.live&&M&&M.sn>=P.endSN&&!C.nextStart){var B=P.partList;if(B!=null&&B.length){var U=B[B.length-1],F=l.BufferHelper.isBuffered(this.media,U.start+U.duration/2);return F}var j=N.getState(M);return j===o.FragmentState.PARTIAL||j===o.FragmentState.OK}return!1},I.onMediaAttached=function(C,P){var M=this.media=this.mediaBuffer=P.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),M.addEventListener("seeking",this.onvseeking),M.addEventListener("ended",this.onvended);var N=this.config;this.levels&&N.autoStartLoad&&this.state===L.STOPPED&&this.startLoad(N.startPosition)},I.onMediaDetaching=function(){var C=this.media;C!=null&&C.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),C&&(C.removeEventListener("seeking",this.onvseeking),C.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},I.onMediaSeeking=function(){var C=this.config,P=this.fragCurrent,M=this.media,N=this.mediaBuffer,B=this.state,U=M?M.currentTime:0,F=l.BufferHelper.bufferInfo(N||M,U,C.maxBufferHole);if(this.log("media seeking to "+(Object(n.isFiniteNumber)(U)?U.toFixed(3):U)+", state: "+B),B===L.ENDED)this.resetLoadingState();else if(P&&!F.len){var j=C.maxFragLookUpTolerance,V=P.start-j,G=P.start+P.duration+j,Y=U>G;(U<V||Y)&&(Y&&P.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),P.loader.abort()),this.resetLoadingState())}M&&(this.lastCurrentTime=U),!this.loadedmetadata&&!F.len&&(this.nextLoadPosition=this.startPosition=U),this.tickImmediate()},I.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},I.onKeyLoaded=function(C,P){if(!(this.state!==L.KEY_LOADING||P.frag!==this.fragCurrent||!this.levels)){this.state=L.IDLE;var M=this.levels[P.frag.level].details;M&&this.loadFragment(P.frag,M,P.frag.start)}},I.onHandlerDestroying=function(){this.stopLoad(),w.prototype.onHandlerDestroying.call(this)},I.onHandlerDestroyed=function(){this.state=L.STOPPED,this.hls.off(h.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,w.prototype.onHandlerDestroyed.call(this)},I.loadKey=function(C,P){this.log("Loading key for "+C.sn+" of ["+P.startSN+"-"+P.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+C.level),this.state=L.KEY_LOADING,this.fragCurrent=C,this.hls.trigger(h.Events.KEY_LOADING,{frag:C})},I.loadFragment=function(C,P,M){this._loadFragForPlayback(C,P,M)},I._loadFragForPlayback=function(C,P,M){var N=this,B=function(F){if(N.fragContextChanged(C)){N.warn("Fragment "+C.sn+(F.part?" p: "+F.part.index:"")+" of level "+C.level+" was dropped during download."),N.fragmentTracker.removeFragment(C);return}C.stats.chunkCount++,N._handleFragmentLoadProgress(F)};this._doFragLoad(C,P,M,B).then(function(U){if(!!U){N.fragLoadError=0;var F=N.state;if(N.fragContextChanged(C)){(F===L.FRAG_LOADING||F===L.BACKTRACKING||!N.fragCurrent&&F===L.PARSING)&&(N.fragmentTracker.removeFragment(C),N.state=L.IDLE);return}if("payload"in U&&(N.log("Loaded fragment "+C.sn+" of level "+C.level),N.hls.trigger(h.Events.FRAG_LOADED,U),N.state===L.BACKTRACKING)){N.fragmentTracker.backtrack(C,U),N.resetFragmentLoading(C);return}N._handleFragmentLoadComplete(U)}}).catch(function(U){N.warn(U),N.resetFragmentLoading(C)})},I.flushMainBuffer=function(C,P,M){if(M===void 0&&(M=null),!!(C-P)){var N={startOffset:C,endOffset:P,type:M};this.fragLoadError=0,this.hls.trigger(h.Events.BUFFER_FLUSHING,N)}},I._loadInitSegment=function(C){var P=this;this._doFragLoad(C).then(function(M){if(!M||P.fragContextChanged(C)||!P.levels)throw new Error("init load aborted");return M}).then(function(M){var N=P.hls,B=M.payload,U=C.decryptdata;if(B&&B.byteLength>0&&U&&U.key&&U.iv&&U.method==="AES-128"){var F=self.performance.now();return P.decrypter.webCryptoDecrypt(new Uint8Array(B),U.key.buffer,U.iv.buffer).then(function(j){var V=self.performance.now();return N.trigger(h.Events.FRAG_DECRYPTED,{frag:C,payload:j,stats:{tstart:F,tdecrypt:V}}),M.payload=j,M})}return M}).then(function(M){var N=P.fragCurrent,B=P.hls,U=P.levels;if(!U)throw new Error("init load aborted, missing levels");var F=U[C.level].details;console.assert(F,"Level details are defined when init segment is loaded");var j=C.stats;P.state=L.IDLE,P.fragLoadError=0,C.data=new Uint8Array(M.payload),j.parsing.start=j.buffering.start=self.performance.now(),j.parsing.end=j.buffering.end=self.performance.now(),M.frag===N&&B.trigger(h.Events.FRAG_BUFFERED,{stats:j,frag:N,part:null,id:C.type}),P.tick()}).catch(function(M){P.warn(M),P.resetFragmentLoading(C)})},I.fragContextChanged=function(C){var P=this.fragCurrent;return!C||!P||C.level!==P.level||C.sn!==P.sn||C.urlId!==P.urlId},I.fragBufferedComplete=function(C,P){var M=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+C.type+" sn: "+C.sn+(P?" part: "+P.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+C.level+" "+p.default.toString(l.BufferHelper.getBuffered(M))),this.state=L.IDLE,this.tick()},I._handleFragmentLoadComplete=function(C){var P=this.transmuxer;if(!!P){var M=C.frag,N=C.part,B=C.partsLoaded,U=!B||B.length===0||B.some(function(j){return!j}),F=new d.ChunkMetadata(M.level,M.sn,M.stats.chunkCount+1,0,N?N.index:-1,!U);P.flush(F)}},I._handleFragmentLoadProgress=function(C){},I._doFragLoad=function(C,P,M,N){var B=this;if(M===void 0&&(M=null),!this.levels)throw new Error("frag load aborted, missing levels");if(M=Math.max(C.start,M||0),this.config.lowLatencyMode&&P){var U=P.partList;if(U&&N){M>C.end&&P.fragmentHint&&(C=P.fragmentHint);var F=this.getNextPart(U,C,M);if(F>-1){var j=U[F];return this.log("Loading part sn: "+C.sn+" p: "+j.index+" cc: "+C.cc+" of playlist ["+P.startSN+"-"+P.endSN+"] parts [0-"+F+"-"+(U.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+C.level+", target: "+parseFloat(M.toFixed(3))),this.nextLoadPosition=j.start+j.duration,this.state=L.FRAG_LOADING,this.hls.trigger(h.Events.FRAG_LOADING,{frag:C,part:U[F],targetBufferTime:M}),this.doFragPartsLoad(C,U,F,N).catch(function(V){return B.handleFragLoadError(V)})}else if(!C.url||this.loadedEndOfParts(U,M))return Promise.resolve(null)}}return this.log("Loading fragment "+C.sn+" cc: "+C.cc+" "+(P?"of ["+P.startSN+"-"+P.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+C.level+", target: "+parseFloat(M.toFixed(3))),Object(n.isFiniteNumber)(C.sn)&&!this.bitrateTest&&(this.nextLoadPosition=C.start+C.duration),this.state=L.FRAG_LOADING,this.hls.trigger(h.Events.FRAG_LOADING,{frag:C,targetBufferTime:M}),this.fragmentLoader.load(C,N).catch(function(V){return B.handleFragLoadError(V)})},I.doFragPartsLoad=function(C,P,M,N){var B=this;return new Promise(function(U,F){var j=[],V=function G(Y){var X=P[Y];B.fragmentLoader.loadPart(C,X,N).then(function(ie){j[X.index]=ie;var he=ie.part;B.hls.trigger(h.Events.FRAG_LOADED,ie);var de=P[Y+1];if(de&&de.fragment===C)G(Y+1);else return U({frag:C,part:he,partsLoaded:j})}).catch(F)};V(M)})},I.handleFragLoadError=function(C){var P=C.data;return P&&P.details===f.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(P.frag,P.part):this.hls.trigger(h.Events.ERROR,P),null},I._handleTransmuxerFlush=function(C){var P=this.getCurrentContext(C);if(!P||this.state!==L.PARSING){this.fragCurrent||(this.state=L.IDLE);return}var M=P.frag,N=P.part,B=P.level,U=self.performance.now();M.stats.parsing.end=U,N&&(N.stats.parsing.end=U),this.updateLevelTiming(M,N,B,C.partial)},I.getCurrentContext=function(C){var P=this.levels,M=C.level,N=C.sn,B=C.part;if(!P||!P[M])return this.warn("Levels object was unset while buffering fragment "+N+" of level "+M+". The current chunk will not be buffered."),null;var U=P[M],F=B>-1?Object(x.getPartWith)(U,N,B):null,j=F?F.fragment:Object(x.getFragmentWithSN)(U,N,this.fragCurrent);return j?{frag:j,part:F,level:U}:null},I.bufferFragmentData=function(C,P,M,N){if(!(!C||this.state!==L.PARSING)){var B=C.data1,U=C.data2,F=B;if(B&&U&&(F=Object(g.appendUint8Array)(B,U)),!(!F||!F.length)){var j={type:C.type,frag:P,part:M,chunkMeta:N,parent:P.type,data:F};this.hls.trigger(h.Events.BUFFER_APPENDING,j),C.dropped&&C.independent&&!M&&this.flushBufferGap(P)}}},I.flushBufferGap=function(C){var P=this.media;if(!!P){if(!l.BufferHelper.isBuffered(P,P.currentTime)){this.flushMainBuffer(0,C.start);return}var M=P.currentTime,N=l.BufferHelper.bufferInfo(P,M,0),B=C.duration,U=Math.min(this.config.maxFragLookUpTolerance*2,B*.25),F=Math.max(Math.min(C.start-U,N.end-U),M+U);C.start-F>U&&this.flushMainBuffer(F,C.start)}},I.getFwdBufferInfo=function(C,P){var M=this.config,N=this.getLoadPosition();if(!Object(n.isFiniteNumber)(N))return null;var B=l.BufferHelper.bufferInfo(C,N,M.maxBufferHole);if(B.len===0&&B.nextStart!==void 0){var U=this.fragmentTracker.getBufferedFrag(N,P);if(U&&B.nextStart<U.end)return l.BufferHelper.bufferInfo(C,N,Math.max(B.nextStart,M.maxBufferHole))}return B},I.getMaxBufferLength=function(C){var P=this.config,M;return C?M=Math.max(8*P.maxBufferSize/C,P.maxBufferLength):M=P.maxBufferLength,Math.min(M,P.maxMaxBufferLength)},I.reduceMaxBufferLength=function(C){var P=this.config,M=C||P.maxBufferLength;return P.maxMaxBufferLength>=M?(P.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+P.maxMaxBufferLength+"s"),!0):!1},I.getNextFragment=function(C,P){var M,N,B=P.fragments,U=B.length;if(!U)return null;var F=this.config,j=B[0].start,V;if(P.live){var G=F.initialLiveManifestSize;if(U<G)return this.warn("Not enough fragments to start playback (have: "+U+", need: "+G+")"),null;!P.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(V=this.getInitialLiveFragment(P,B),this.startPosition=V?this.hls.liveSyncPosition||V.start:C)}else C<=j&&(V=B[0]);if(!V){var Y=F.lowLatencyMode?P.partEnd:P.fragmentEnd;V=this.getFragmentAtPosition(C,Y,P)}return(M=V)!==null&&M!==void 0&&M.initSegment&&!((N=V)!==null&&N!==void 0&&N.initSegment.data)&&!this.bitrateTest&&(V=V.initSegment),V},I.getNextPart=function(C,P,M){for(var N=-1,B=!1,U=!0,F=0,j=C.length;F<j;F++){var V=C[F];if(U=U&&!V.independent,N>-1&&M<V.start)break;var G=V.loaded;!G&&(B||V.independent||U)&&V.fragment===P&&(N=F),B=G}return N},I.loadedEndOfParts=function(C,P){var M=C[C.length-1];return M&&P>M.start&&M.loaded},I.getInitialLiveFragment=function(C,P){var M=this.fragPrevious,N=null;if(M){if(C.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+M.programDateTime),N=Object(S.findFragmentByPDT)(P,M.endProgramDateTime,this.config.maxFragLookUpTolerance)),!N){var B=M.sn+1;if(B>=C.startSN&&B<=C.endSN){var U=P[B-C.startSN];M.cc===U.cc&&(N=U,this.log("Live playlist, switching playlist, load frag with next SN: "+N.sn))}N||(N=Object(S.findFragWithCC)(P,M.cc),N&&this.log("Live playlist, switching playlist, load frag with same CC: "+N.sn))}}else{var F=this.hls.liveSyncPosition;F!==null&&(N=this.getFragmentAtPosition(F,this.bitrateTest?C.fragmentEnd:C.edge,C))}return N},I.getFragmentAtPosition=function(C,P,M){var N=this.config,B=this.fragPrevious,U=M.fragments,F=M.endSN,j=M.fragmentHint,V=N.maxFragLookUpTolerance,G=!!(N.lowLatencyMode&&M.partList&&j);G&&j&&!this.bitrateTest&&(U=U.concat(j),F=j.sn);var Y;if(C<P){var X=C>P-V?0:V;Y=Object(S.findFragmentByPTS)(B,U,C,X)}else Y=U[U.length-1];if(Y){var ie=Y.sn-M.startSN,he=B&&Y.level===B.level,de=U[ie+1],Ae=this.fragmentTracker.getState(Y);if(Ae===o.FragmentState.BACKTRACKED){Y=null;for(var pe=ie;U[pe]&&this.fragmentTracker.getState(U[pe])===o.FragmentState.BACKTRACKED;)B?Y=U[pe--]:Y=U[--pe];Y||(Y=de)}else B&&Y.sn===B.sn&&!G&&he&&(Y.sn<F&&this.fragmentTracker.getState(de)!==o.FragmentState.OK?(this.log("SN "+Y.sn+" just loaded, load next one: "+de.sn),Y=de):Y=null)}return Y},I.synchronizeToLiveEdge=function(C){var P=this.config,M=this.media;if(!!M){var N=this.hls.liveSyncPosition,B=M.currentTime,U=C.fragments[0].start,F=C.edge,j=B>=U-P.maxFragLookUpTolerance&&B<=F;if(N!==null&&M.duration>N&&(B<N||!j)){var V=P.liveMaxLatencyDuration!==void 0?P.liveMaxLatencyDuration:P.liveMaxLatencyDurationCount*C.targetduration;(!j&&M.readyState<4||B<F-V)&&(this.loadedmetadata||(this.nextLoadPosition=N),M.readyState&&(this.warn("Playback: "+B.toFixed(3)+" is located too far from the end of live sliding playlist: "+F+", reset currentTime to : "+N.toFixed(3)),M.currentTime=N))}}},I.alignPlaylists=function(C,P){var M=this.levels,N=this.levelLastLoaded,B=this.fragPrevious,U=N!==null?M[N]:null,F=C.fragments.length;if(!F)return this.warn("No fragments in live playlist"),0;var j=C.fragments[0].start,V=!P,G=C.alignedSliding&&Object(n.isFiniteNumber)(j);if(V||!G&&!j){Object(E.alignStream)(B,U,C);var Y=C.fragments[0].start;return this.log("Live playlist sliding: "+Y.toFixed(2)+" start-sn: "+(P?P.startSN:"na")+"->"+C.startSN+" prev-sn: "+(B?B.sn:"na")+" fragments: "+F),Y}return j},I.waitForCdnTuneIn=function(C){var P=3;return C.live&&C.canBlockReload&&C.tuneInGoal>Math.max(C.partHoldBack,C.partTarget*P)},I.setStartPosition=function(C,P){var M=this.startPosition;if(M<P&&(M=-1),M===-1||this.lastCurrentTime===-1){var N=C.startTimeOffset;Object(n.isFiniteNumber)(N)?(M=P+N,N<0&&(M+=C.totalduration),M=Math.min(Math.max(P,M),P+C.totalduration),this.log("Start time offset "+N+" found in playlist, adjust startPosition to "+M),this.startPosition=M):C.live?M=this.hls.liveSyncPosition||P:this.startPosition=M=0,this.lastCurrentTime=M}this.nextLoadPosition=M},I.getLoadPosition=function(){var C=this.media,P=0;return this.loadedmetadata&&C?P=C.currentTime:this.nextLoadPosition&&(P=this.nextLoadPosition),P},I.handleFragLoadAborted=function(C,P){this.transmuxer&&C.sn!=="initSegment"&&C.stats.aborted&&(this.warn("Fragment "+C.sn+(P?" part"+P.index:"")+" of level "+C.level+" was aborted"),this.resetFragmentLoading(C))},I.resetFragmentLoading=function(C){(!this.fragCurrent||!this.fragContextChanged(C))&&(this.state=L.IDLE)},I.onFragmentOrKeyLoadError=function(C,P){if(!P.fatal){var M=P.frag;if(!(!M||M.type!==C)){var N=this.fragCurrent;console.assert(N&&M.sn===N.sn&&M.level===N.level&&M.urlId===N.urlId,"Frag load error must match current frag to retry");var B=this.config;if(this.fragLoadError+1<=B.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(M.level))return;var U=Math.min(Math.pow(2,this.fragLoadError)*B.fragLoadingRetryDelay,B.fragLoadingMaxRetryTimeout);this.warn("Fragment "+M.sn+" of "+C+" "+M.level+" failed to load, retrying in "+U+"ms"),this.retryDate=self.performance.now()+U,this.fragLoadError++,this.state=L.FRAG_LOADING_WAITING_RETRY}else P.levelRetry?(C===y.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=L.IDLE):(v.logger.error(P.details+" reaches max retry, redispatch as fatal ..."),P.fatal=!0,this.hls.stopLoad(),this.state=L.ERROR)}}},I.afterBufferFlushed=function(C,P,M){if(!!C){var N=l.BufferHelper.getBuffered(C);this.fragmentTracker.detectEvictedFragments(P,N,M),this.state===L.ENDED&&this.resetLoadingState()}},I.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=L.IDLE},I.resetLiveStartWhenNotLoaded=function(C){if(!this.loadedmetadata){this.startFragRequested=!1;var P=this.levels?this.levels[C].details:null;if(P!=null&&P.live)return this.startPosition=-1,this.setStartPosition(P,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},I.updateLevelTiming=function(C,P,M,N){var B=this,U=M.details;console.assert(!!U,"level.details must be defined");var F=Object.keys(C.elementaryStreams).reduce(function(j,V){var G=C.elementaryStreams[V];if(G){var Y=G.endPTS-G.startPTS;if(Y<=0)return B.warn("Could not parse fragment "+C.sn+" "+V+" duration reliably ("+Y+") resetting transmuxer to fallback to playlist timing"),B.resetTransmuxer(),j||!1;var X=N?0:Object(x.updateFragPTSDTS)(U,C,G.startPTS,G.endPTS,G.startDTS,G.endDTS);return B.hls.trigger(h.Events.LEVEL_PTS_UPDATED,{details:U,level:M,drift:X,type:V,frag:C,start:G.startPTS,end:G.endPTS}),!0}return j},!1);F?(this.state=L.PARSED,this.hls.trigger(h.Events.FRAG_PARSED,{frag:C,part:P})):this.resetLoadingState()},I.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},_(O,[{key:"state",get:function(){return this._state},set:function(C){var P=this._state;P!==C&&(this._state=C,this.log(P+"->"+C))}}]),O}(a.default)},"./src/controller/buffer-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return S});var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts"),l=t("./src/errors.ts"),v=t("./src/utils/buffer-helper.ts"),h=t("./src/utils/mediasource-helper.ts"),f=t("./src/loader/fragment.ts"),d=t("./src/controller/buffer-operation-queue.ts"),g=Object(h.getMediaSource)(),E=/([ha]vc.)(?:\.[^.,]+)+/,S=function(){function x(c){var p=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var y=p.hls,u=p.media,_=p.mediaSource;o.logger.log("[buffer-controller]: Media source opened"),u&&(p.updateMediaElementDuration(),y.trigger(a.Events.MEDIA_ATTACHED,{media:u})),_&&_.removeEventListener("sourceopen",p._onMediaSourceOpen),p.checkPendingTracks()},this._onMediaSourceClose=function(){o.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){o.logger.log("[buffer-controller]: Media source ended")},this.hls=c,this._initSourceBuffer(),this.registerListeners()}var m=x.prototype;return m.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},m.destroy=function(){this.unregisterListeners(),this.details=null},m.registerListeners=function(){var p=this.hls;p.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),p.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.on(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.on(a.Events.BUFFER_RESET,this.onBufferReset,this),p.on(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),p.on(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),p.on(a.Events.BUFFER_EOS,this.onBufferEos,this),p.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),p.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),p.on(a.Events.FRAG_PARSED,this.onFragParsed,this),p.on(a.Events.FRAG_CHANGED,this.onFragChanged,this)},m.unregisterListeners=function(){var p=this.hls;p.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),p.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.off(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.off(a.Events.BUFFER_RESET,this.onBufferReset,this),p.off(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),p.off(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),p.off(a.Events.BUFFER_EOS,this.onBufferEos,this),p.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),p.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),p.off(a.Events.FRAG_PARSED,this.onFragParsed,this),p.off(a.Events.FRAG_CHANGED,this.onFragChanged,this)},m._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new d.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},m.onManifestParsed=function(p,y){var u=2;(y.audio&&!y.video||!y.altAudio)&&(u=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=u,this.details=null,o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},m.onMediaAttaching=function(p,y){var u=this.media=y.media;if(u&&g){var _=this.mediaSource=new g;_.addEventListener("sourceopen",this._onMediaSourceOpen),_.addEventListener("sourceended",this._onMediaSourceEnded),_.addEventListener("sourceclose",this._onMediaSourceClose),u.src=self.URL.createObjectURL(_),this._objectUrl=u.src}},m.onMediaDetaching=function(){var p=this.media,y=this.mediaSource,u=this._objectUrl;if(y){if(o.logger.log("[buffer-controller]: media source detaching"),y.readyState==="open")try{y.endOfStream()}catch(_){o.logger.warn("[buffer-controller]: onMediaDetaching: "+_.message+" while calling endOfStream")}this.onBufferReset(),y.removeEventListener("sourceopen",this._onMediaSourceOpen),y.removeEventListener("sourceended",this._onMediaSourceEnded),y.removeEventListener("sourceclose",this._onMediaSourceClose),p&&(u&&self.URL.revokeObjectURL(u),p.src===u?(p.removeAttribute("src"),p.load()):o.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(a.Events.MEDIA_DETACHED,void 0)},m.onBufferReset=function(){var p=this;this.getSourceBufferTypes().forEach(function(y){var u=p.sourceBuffer[y];try{u&&(p.removeBufferListeners(y),p.mediaSource&&p.mediaSource.removeSourceBuffer(u),p.sourceBuffer[y]=void 0)}catch(_){o.logger.warn("[buffer-controller]: Failed to reset the "+y+" buffer",_)}}),this._initSourceBuffer()},m.onBufferCodecs=function(p,y){var u=this,_=this.getSourceBufferTypes().length;Object.keys(y).forEach(function(b){if(_){var T=u.tracks[b];if(T&&typeof T.buffer.changeType=="function"){var A=y[b],L=A.codec,R=A.levelCodec,w=A.container,O=(T.levelCodec||T.codec).replace(E,"$1"),I=(R||L).replace(E,"$1");if(O!==I){var D=w+";codecs="+(R||L);u.appendChangeType(b,D)}}}else u.pendingTracks[b]=y[b]}),!_&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},m.appendChangeType=function(p,y){var u=this,_=this.operationQueue,b={execute:function(){var A=u.sourceBuffer[p];A&&(o.logger.log("[buffer-controller]: changing "+p+" sourceBuffer type to "+y),A.changeType(y)),_.shiftAndExecuteNext(p)},onStart:function(){},onComplete:function(){},onError:function(A){o.logger.warn("[buffer-controller]: Failed to change "+p+" SourceBuffer type",A)}};_.append(b,p)},m.onBufferAppending=function(p,y){var u=this,_=this.hls,b=this.operationQueue,T=this.tracks,A=y.data,L=y.type,R=y.frag,w=y.part,O=y.chunkMeta,I=O.buffering[L],D=self.performance.now();I.start=D;var C=R.stats.buffering,P=w?w.stats.buffering:null;C.start===0&&(C.start=D),P&&P.start===0&&(P.start=D);var M=T.audio,N=L==="audio"&&O.id===1&&(M==null?void 0:M.container)==="audio/mpeg",B={execute:function(){if(I.executeStart=self.performance.now(),N){var F=u.sourceBuffer[L];if(F){var j=R.start-F.timestampOffset;Math.abs(j)>=.1&&(o.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+R.start+" (delta: "+j+") sn: "+R.sn+")"),F.timestampOffset=R.start)}}u.appendExecutor(A,L)},onStart:function(){},onComplete:function(){var F=self.performance.now();I.executeEnd=I.end=F,C.first===0&&(C.first=F),P&&P.first===0&&(P.first=F);var j=u.sourceBuffer,V={};for(var G in j)V[G]=v.BufferHelper.getBuffered(j[G]);u.appendError=0,u.hls.trigger(a.Events.BUFFER_APPENDED,{type:L,frag:R,part:w,chunkMeta:O,parent:R.type,timeRanges:V})},onError:function(F){o.logger.error("[buffer-controller]: Error encountered while trying to append to the "+L+" SourceBuffer",F);var j={type:l.ErrorTypes.MEDIA_ERROR,parent:R.type,details:l.ErrorDetails.BUFFER_APPEND_ERROR,err:F,fatal:!1};F.code===DOMException.QUOTA_EXCEEDED_ERR?j.details=l.ErrorDetails.BUFFER_FULL_ERROR:(u.appendError++,j.details=l.ErrorDetails.BUFFER_APPEND_ERROR,u.appendError>_.config.appendErrorMaxRetry&&(o.logger.error("[buffer-controller]: Failed "+_.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),j.fatal=!0)),_.trigger(a.Events.ERROR,j)}};b.append(B,L)},m.onBufferFlushing=function(p,y){var u=this,_=this.operationQueue,b=function(A){return{execute:u.removeExecutor.bind(u,A,y.startOffset,y.endOffset),onStart:function(){},onComplete:function(){u.hls.trigger(a.Events.BUFFER_FLUSHED,{type:A})},onError:function(R){o.logger.warn("[buffer-controller]: Failed to remove from "+A+" SourceBuffer",R)}}};y.type?_.append(b(y.type),y.type):this.getSourceBufferTypes().forEach(function(T){_.append(b(T),T)})},m.onFragParsed=function(p,y){var u=this,_=y.frag,b=y.part,T=[],A=b?b.elementaryStreams:_.elementaryStreams;A[f.ElementaryStreamTypes.AUDIOVIDEO]?T.push("audiovideo"):(A[f.ElementaryStreamTypes.AUDIO]&&T.push("audio"),A[f.ElementaryStreamTypes.VIDEO]&&T.push("video"));var L=function(){var w=self.performance.now();_.stats.buffering.end=w,b&&(b.stats.buffering.end=w);var O=b?b.stats:_.stats;u.hls.trigger(a.Events.FRAG_BUFFERED,{frag:_,part:b,stats:O,id:_.type})};T.length===0&&o.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+_.type+" level: "+_.level+" sn: "+_.sn),this.blockBuffers(L,T)},m.onFragChanged=function(p,y){this.flushBackBuffer()},m.onBufferEos=function(p,y){var u=this,_=this.getSourceBufferTypes().reduce(function(b,T){var A=u.sourceBuffer[T];return(!y.type||y.type===T)&&A&&!A.ended&&(A.ended=!0,o.logger.log("[buffer-controller]: "+T+" sourceBuffer now EOS")),b&&!!(!A||A.ended)},!0);_&&this.blockBuffers(function(){var b=u.mediaSource;!b||b.readyState!=="open"||b.endOfStream()})},m.onLevelUpdated=function(p,y){var u=y.details;!u.fragments.length||(this.details=u,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},m.flushBackBuffer=function(){var p=this.hls,y=this.details,u=this.media,_=this.sourceBuffer;if(!(!u||y===null)){var b=this.getSourceBufferTypes();if(!!b.length){var T=y.live&&p.config.liveBackBufferLength!==null?p.config.liveBackBufferLength:p.config.backBufferLength;if(!(!Object(n.isFiniteNumber)(T)||T<0)){var A=u.currentTime,L=y.levelTargetDuration,R=Math.max(T,L),w=Math.floor(A/L)*L-R;b.forEach(function(O){var I=_[O];if(I){var D=v.BufferHelper.getBuffered(I);D.length>0&&w>D.start(0)&&(p.trigger(a.Events.BACK_BUFFER_REACHED,{bufferEnd:w}),y.live&&p.trigger(a.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:w}),p.trigger(a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:w,type:O}))}})}}}},m.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var p=this.details,y=this.hls,u=this.media,_=this.mediaSource,b=p.fragments[0].start+p.totalduration,T=u.duration,A=Object(n.isFiniteNumber)(_.duration)?_.duration:0;p.live&&y.config.liveDurationInfinity?(o.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),_.duration=1/0,this.updateSeekableRange(p)):(b>A&&b>T||!Object(n.isFiniteNumber)(T))&&(o.logger.log("[buffer-controller]: Updating Media Source duration to "+b.toFixed(3)),_.duration=b)}},m.updateSeekableRange=function(p){var y=this.mediaSource,u=p.fragments,_=u.length;if(_&&p.live&&y!==null&&y!==void 0&&y.setLiveSeekableRange){var b=Math.max(0,u[0].start),T=Math.max(b,b+p.totalduration);y.setLiveSeekableRange(b,T)}},m.checkPendingTracks=function(){var p=this.bufferCodecEventsExpected,y=this.operationQueue,u=this.pendingTracks,_=Object.keys(u).length;if(_&&!p||_===2){this.createSourceBuffers(u),this.pendingTracks={};var b=this.getSourceBufferTypes();if(b.length===0){this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}b.forEach(function(T){y.executeNext(T)})}},m.createSourceBuffers=function(p){var y=this.sourceBuffer,u=this.mediaSource;if(!u)throw Error("createSourceBuffers called when mediaSource was null");var _=0;for(var b in p)if(!y[b]){var T=p[b];if(!T)throw Error("source buffer exists for track "+b+", however track does not");var A=T.levelCodec||T.codec,L=T.container+";codecs="+A;o.logger.log("[buffer-controller]: creating sourceBuffer("+L+")");try{var R=y[b]=u.addSourceBuffer(L),w=b;this.addBufferListener(w,"updatestart",this._onSBUpdateStart),this.addBufferListener(w,"updateend",this._onSBUpdateEnd),this.addBufferListener(w,"error",this._onSBUpdateError),this.tracks[b]={buffer:R,codec:A,container:T.container,levelCodec:T.levelCodec,id:T.id},_++}catch(O){o.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+O.message),this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:O,mimeType:L})}}_&&this.hls.trigger(a.Events.BUFFER_CREATED,{tracks:this.tracks})},m._onSBUpdateStart=function(p){var y=this.operationQueue,u=y.current(p);u.onStart()},m._onSBUpdateEnd=function(p){var y=this.operationQueue,u=y.current(p);u.onComplete(),y.shiftAndExecuteNext(p)},m._onSBUpdateError=function(p,y){o.logger.error("[buffer-controller]: "+p+" SourceBuffer error",y),this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var u=this.operationQueue.current(p);u&&u.onError(y)},m.removeExecutor=function(p,y,u){var _=this.media,b=this.mediaSource,T=this.operationQueue,A=this.sourceBuffer,L=A[p];if(!_||!b||!L){o.logger.warn("[buffer-controller]: Attempting to remove from the "+p+" SourceBuffer, but it does not exist"),T.shiftAndExecuteNext(p);return}var R=Object(n.isFiniteNumber)(_.duration)?_.duration:1/0,w=Object(n.isFiniteNumber)(b.duration)?b.duration:1/0,O=Math.max(0,y),I=Math.min(u,R,w);I>O?(o.logger.log("[buffer-controller]: Removing ["+O+","+I+"] from the "+p+" SourceBuffer"),console.assert(!L.updating,p+" sourceBuffer must not be updating"),L.remove(O,I)):T.shiftAndExecuteNext(p)},m.appendExecutor=function(p,y){var u=this.operationQueue,_=this.sourceBuffer,b=_[y];if(!b){o.logger.warn("[buffer-controller]: Attempting to append to the "+y+" SourceBuffer, but it does not exist"),u.shiftAndExecuteNext(y);return}b.ended=!1,console.assert(!b.updating,y+" sourceBuffer must not be updating"),b.appendBuffer(p)},m.blockBuffers=function(p,y){var u=this;if(y===void 0&&(y=this.getSourceBufferTypes()),!y.length){o.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(p);return}var _=this.operationQueue,b=y.map(function(T){return _.appendBlocker(T)});Promise.all(b).then(function(){p(),y.forEach(function(T){var A=u.sourceBuffer[T];(!A||!A.updating)&&_.shiftAndExecuteNext(T)})})},m.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},m.addBufferListener=function(p,y,u){var _=this.sourceBuffer[p];if(!!_){var b=u.bind(this,p);this.listeners[p].push({event:y,listener:b}),_.addEventListener(y,b)}},m.removeBufferListeners=function(p){var y=this.sourceBuffer[p];!y||this.listeners[p].forEach(function(u){y.removeEventListener(u.event,u.listener)})},x}()},"./src/controller/buffer-operation-queue.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return a});var n=t("./src/utils/logger.ts"),a=function(){function o(v){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=v}var l=o.prototype;return l.append=function(h,f){var d=this.queues[f];d.push(h),d.length===1&&this.buffers[f]&&this.executeNext(f)},l.insertAbort=function(h,f){var d=this.queues[f];d.unshift(h),this.executeNext(f)},l.appendBlocker=function(h){var f,d=new Promise(function(E){f=E}),g={execute:f,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(g,h),d},l.executeNext=function(h){var f=this.buffers,d=this.queues,g=f[h],E=d[h];if(E.length){var S=E[0];try{S.execute()}catch(x){n.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),S.onError(x),(!g||!g.updating)&&(E.shift(),this.executeNext(h))}}},l.shiftAndExecuteNext=function(h){this.queues[h].shift(),this.executeNext(h)},l.current=function(h){return this.queues[h][0]},o}()},"./src/controller/cap-level-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts");function a(v,h){for(var f=0;f<h.length;f++){var d=h[f];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(v,d.key,d)}}function o(v,h,f){return h&&a(v.prototype,h),f&&a(v,f),v}var l=function(){function v(f){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=f,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var h=v.prototype;return h.setStreamController=function(d){this.streamController=d},h.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},h.registerListeners=function(){var d=this.hls;d.on(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),d.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.on(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},h.unregisterListener=function(){var d=this.hls;d.off(n.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),d.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.off(n.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},h.onFpsDropLevelCapping=function(d,g){v.isLevelAllowed(g.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(g.droppedLevel)},h.onMediaAttaching=function(d,g){this.media=g.media instanceof HTMLVideoElement?g.media:null},h.onManifestParsed=function(d,g){var E=this.hls;this.restrictedLevels=[],this.firstLevel=g.firstLevel,E.config.capLevelToPlayerSize&&g.video&&this.startCapping()},h.onBufferCodecs=function(d,g){var E=this.hls;E.config.capLevelToPlayerSize&&g.video&&this.startCapping()},h.onMediaDetaching=function(){this.stopCapping()},h.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var d=this.hls.levels;if(d.length){var g=this.hls;g.autoLevelCapping=this.getMaxLevel(d.length-1),g.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=g.autoLevelCapping}}},h.getMaxLevel=function(d){var g=this,E=this.hls.levels;if(!E.length)return-1;var S=E.filter(function(x,m){return v.isLevelAllowed(m,g.restrictedLevels)&&m<=d});return this.clientRect=null,v.getMaxLevelByMediaSize(S,this.mediaWidth,this.mediaHeight)},h.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},h.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},h.getDimensions=function(){if(this.clientRect)return this.clientRect;var d=this.media,g={width:0,height:0};if(d){var E=d.getBoundingClientRect();g.width=E.width,g.height=E.height,!g.width&&!g.height&&(g.width=E.right-E.left||d.width||0,g.height=E.bottom-E.top||d.height||0)}return this.clientRect=g,g},v.isLevelAllowed=function(d,g){return g===void 0&&(g=[]),g.indexOf(d)===-1},v.getMaxLevelByMediaSize=function(d,g,E){if(!d||!d.length)return-1;for(var S=function(y,u){return u?y.width!==u.width||y.height!==u.height:!0},x=d.length-1,m=0;m<d.length;m+=1){var c=d[m];if((c.width>=g||c.height>=E)&&S(c,d[m+1])){x=m;break}}return x},o(v,[{key:"mediaWidth",get:function(){return this.getDimensions().width*v.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*v.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var d=1;try{d=self.devicePixelRatio}catch(g){}return d}}]),v}();i.default=l},"./src/controller/cmcd-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return S});var n=t("./src/events.ts"),a=t("./src/types/cmcd.ts"),o=t("./src/utils/buffer-helper.ts"),l=t("./src/utils/logger.ts");function v(x,m){for(var c=0;c<m.length;c++){var p=m[c];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(x,p.key,p)}}function h(x,m,c){return m&&v(x.prototype,m),c&&v(x,c),x}function f(x,m){var c=typeof Symbol!="undefined"&&x[Symbol.iterator]||x["@@iterator"];if(c)return(c=c.call(x)).next.bind(c);if(Array.isArray(x)||(c=d(x))||m&&x&&typeof x.length=="number"){c&&(x=c);var p=0;return function(){return p>=x.length?{done:!0}:{done:!1,value:x[p++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d(x,m){if(!!x){if(typeof x=="string")return g(x,m);var c=Object.prototype.toString.call(x).slice(8,-1);if(c==="Object"&&x.constructor&&(c=x.constructor.name),c==="Map"||c==="Set")return Array.from(x);if(c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return g(x,m)}}function g(x,m){(m==null||m>x.length)&&(m=x.length);for(var c=0,p=new Array(m);c<m;c++)p[c]=x[c];return p}function E(){return E=Object.assign||function(x){for(var m=1;m<arguments.length;m++){var c=arguments[m];for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(x[p]=c[p])}return x},E.apply(this,arguments)}var S=function(){function x(c){var p=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){p.initialized&&(p.starved=!0),p.buffering=!0},this.onPlaying=function(){p.initialized||(p.initialized=!0),p.buffering=!1},this.applyPlaylistData=function(_){try{p.apply(_,{ot:a.CMCDObjectType.MANIFEST,su:!p.initialized})}catch(b){l.logger.warn("Could not generate manifest CMCD data.",b)}},this.applyFragmentData=function(_){try{var b=_.frag,T=p.hls.levels[b.level],A=p.getObjectType(b),L={d:b.duration*1e3,ot:A};(A===a.CMCDObjectType.VIDEO||A===a.CMCDObjectType.AUDIO||A==a.CMCDObjectType.MUXED)&&(L.br=T.bitrate/1e3,L.tb=p.getTopBandwidth(A)/1e3,L.bl=p.getBufferLength(A)),p.apply(_,L)}catch(R){l.logger.warn("Could not generate segment CMCD data.",R)}},this.hls=c;var y=this.config=c.config,u=y.cmcd;u!=null&&(y.pLoader=this.createPlaylistLoader(),y.fLoader=this.createFragmentLoader(),this.sid=u.sessionId||x.uuid(),this.cid=u.contentId,this.useHeaders=u.useHeaders===!0,this.registerListeners())}var m=x.prototype;return m.registerListeners=function(){var p=this.hls;p.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.on(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),p.on(n.Events.BUFFER_CREATED,this.onBufferCreated,this)},m.unregisterListeners=function(){var p=this.hls;p.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.off(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),p.off(n.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},m.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},m.onMediaAttached=function(p,y){this.media=y.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},m.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},m.onBufferCreated=function(p,y){var u,_;this.audioBuffer=(u=y.tracks.audio)===null||u===void 0?void 0:u.buffer,this.videoBuffer=(_=y.tracks.video)===null||_===void 0?void 0:_.buffer},m.createData=function(){var p;return{v:a.CMCDVersion,sf:a.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(p=this.media)===null||p===void 0?void 0:p.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},m.apply=function(p,y){y===void 0&&(y={}),E(y,this.createData());var u=y.ot===a.CMCDObjectType.INIT||y.ot===a.CMCDObjectType.VIDEO||y.ot===a.CMCDObjectType.MUXED;if(this.starved&&u&&(y.bs=!0,y.su=!0,this.starved=!1),y.su==null&&(y.su=this.buffering),this.useHeaders){var _=x.toHeaders(y);if(!Object.keys(_).length)return;p.headers||(p.headers={}),E(p.headers,_)}else{var b=x.toQuery(y);if(!b)return;p.url=x.appendQueryToUri(p.url,b)}},m.getObjectType=function(p){var y=p.type;if(y==="subtitle")return a.CMCDObjectType.TIMED_TEXT;if(p.sn==="initSegment")return a.CMCDObjectType.INIT;if(y==="audio")return a.CMCDObjectType.AUDIO;if(y==="main")return this.hls.audioTracks.length?a.CMCDObjectType.VIDEO:a.CMCDObjectType.MUXED},m.getTopBandwidth=function(p){var y=0,u,_=this.hls;if(p===a.CMCDObjectType.AUDIO)u=_.audioTracks;else{var b=_.maxAutoLevel,T=b>-1?b+1:_.levels.length;u=_.levels.slice(0,T)}for(var A=f(u),L;!(L=A()).done;){var R=L.value;R.bitrate>y&&(y=R.bitrate)}return y>0?y:NaN},m.getBufferLength=function(p){var y=this.hls.media,u=p===a.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!u||!y)return NaN;var _=o.BufferHelper.bufferInfo(u,y.currentTime,this.config.maxBufferHole);return _.len*1e3},m.createPlaylistLoader=function(){var p=this.config.pLoader,y=this.applyPlaylistData,u=p||this.config.loader;return function(){function _(T){this.loader=void 0,this.loader=new u(T)}var b=_.prototype;return b.destroy=function(){this.loader.destroy()},b.abort=function(){this.loader.abort()},b.load=function(A,L,R){y(A),this.loader.load(A,L,R)},h(_,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),_}()},m.createFragmentLoader=function(){var p=this.config.fLoader,y=this.applyFragmentData,u=p||this.config.loader;return function(){function _(T){this.loader=void 0,this.loader=new u(T)}var b=_.prototype;return b.destroy=function(){this.loader.destroy()},b.abort=function(){this.loader.abort()},b.load=function(A,L,R){y(A),this.loader.load(A,L,R)},h(_,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),_}()},x.uuid=function(){var p=URL.createObjectURL(new Blob),y=p.toString();return URL.revokeObjectURL(p),y.substr(y.lastIndexOf("/")+1)},x.serialize=function(p){for(var y=[],u=function(N){return!Number.isNaN(N)&&N!=null&&N!==""&&N!==!1},_=function(N){return Math.round(N)},b=function(N){return _(N/100)*100},T=function(N){return encodeURIComponent(N)},A={br:_,d:_,bl:b,dl:b,mtp:b,nor:T,rtp:b,tb:_},L=Object.keys(p||{}).sort(),R=f(L),w;!(w=R()).done;){var O=w.value,I=p[O];if(!!u(I)&&!(O==="v"&&I===1)&&!(O=="pr"&&I===1)){var D=A[O];D&&(I=D(I));var C=typeof I,P=void 0;O==="ot"||O==="sf"||O==="st"?P=O+"="+I:C==="boolean"?P=O:C==="number"?P=O+"="+I:P=O+"="+JSON.stringify(I),y.push(P)}}return y.join(",")},x.toHeaders=function(p){for(var y=Object.keys(p),u={},_=["Object","Request","Session","Status"],b=[{},{},{},{}],T={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},A=0,L=y;A<L.length;A++){var R=L[A],w=T[R]!=null?T[R]:1;b[w][R]=p[R]}for(var O=0;O<b.length;O++){var I=x.serialize(b[O]);I&&(u["CMCD-"+_[O]]=I)}return u},x.toQuery=function(p){return"CMCD="+encodeURIComponent(x.serialize(p))},x.appendQueryToUri=function(p,y){if(!y)return p;var u=p.includes("?")?"&":"?";return""+p+u+y},x}()},"./src/controller/eme-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/utils/logger.ts"),l=t("./src/utils/mediakeys-helper.ts");function v(S,x){for(var m=0;m<x.length;m++){var c=x[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(S,c.key,c)}}function h(S,x,m){return x&&v(S.prototype,x),m&&v(S,m),S}var f=3,d=function(x,m,c){var p={audioCapabilities:[],videoCapabilities:[]};return x.forEach(function(y){p.audioCapabilities.push({contentType:'audio/mp4; codecs="'+y+'"',robustness:c.audioRobustness||""})}),m.forEach(function(y){p.videoCapabilities.push({contentType:'video/mp4; codecs="'+y+'"',robustness:c.videoRobustness||""})}),[p]},g=function(x,m,c,p){switch(x){case l.KeySystems.WIDEVINE:return d(m,c,p);default:throw new Error("Unknown key-system: "+x)}},E=function(){function S(m){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=m,this._config=m.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var x=S.prototype;return x.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},x._registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},x._unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(n.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this)},x.getLicenseServerUrl=function(c){switch(c){case l.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+c+'"')},x._attemptKeySystemAccess=function(c,p,y){var u=this,_=g(c,p,y,this._drmSystemOptions);o.logger.log("Requesting encrypted media key-system access");var b=this.requestMediaKeySystemAccess(c,_);this.mediaKeysPromise=b.then(function(T){return u._onMediaKeySystemAccessObtained(c,T)}),b.catch(function(T){o.logger.error('Failed to obtain key-system "'+c+'" access:',T)})},x._onMediaKeySystemAccessObtained=function(c,p){var y=this;o.logger.log('Access for key-system "'+c+'" obtained');var u={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:p,mediaKeySystemDomain:c};this._mediaKeysList.push(u);var _=Promise.resolve().then(function(){return p.createMediaKeys()}).then(function(b){return u.mediaKeys=b,o.logger.log('Media-keys created for key-system "'+c+'"'),y._onMediaKeysCreated(),b});return _.catch(function(b){o.logger.error("Failed to create media-keys:",b)}),_},x._onMediaKeysCreated=function(){var c=this;this._mediaKeysList.forEach(function(p){p.mediaKeysSession||(p.mediaKeysSession=p.mediaKeys.createSession(),c._onNewMediaKeySession(p.mediaKeysSession))})},x._onNewMediaKeySession=function(c){var p=this;o.logger.log("New key-system session "+c.sessionId),c.addEventListener("message",function(y){p._onKeySessionMessage(c,y.message)},!1)},x._onKeySessionMessage=function(c,p){o.logger.log("Got EME message event, creating license request"),this._requestLicense(p,function(y){o.logger.log("Received license data (length: "+(y&&y.byteLength)+"), updating key-session"),c.update(y)})},x.onMediaEncrypted=function(c){var p=this;if(o.logger.log('Media is encrypted using "'+c.initDataType+'" init data type'),!this.mediaKeysPromise){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var y=function(_){!p._media||(p._attemptSetMediaKeys(_),p._generateRequestWithPreferredKeySession(c.initDataType,c.initData))};this.mediaKeysPromise.then(y).catch(y)},x._attemptSetMediaKeys=function(c){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var p=this._mediaKeysList[0];if(!p||!p.mediaKeys){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}o.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(p.mediaKeys),this._hasSetMediaKeys=!0}},x._generateRequestWithPreferredKeySession=function(c,p){var y=this,u=this._mediaKeysList[0];if(!u){o.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(u.mediaKeysSessionInitialized){o.logger.warn("Key-Session already initialized but requested again");return}var _=u.mediaKeysSession;if(!_){o.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!p){o.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}o.logger.log('Generating key-session request for "'+c+'" init data type'),u.mediaKeysSessionInitialized=!0,_.generateRequest(c,p).then(function(){o.logger.debug("Key-session generation succeeded")}).catch(function(b){o.logger.error("Error generating key-session request:",b),y.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},x._createLicenseXhr=function(c,p,y){var u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,u,c,p,y);var _=this._licenseXhrSetup;if(_)try{_.call(this.hls,u,c),_=void 0}catch(b){o.logger.error(b)}try{u.readyState||u.open("POST",c,!0),_&&_.call(this.hls,u,c)}catch(b){throw new Error("issue setting up KeySystem license XHR "+b)}return u},x._onLicenseRequestReadyStageChange=function(c,p,y,u){switch(c.readyState){case 4:if(c.status===200){this._requestLicenseFailureCount=0,o.logger.log("License request succeeded");var _=c.response,b=this._licenseResponseCallback;if(b)try{_=b.call(this.hls,c,p)}catch(A){o.logger.error(A)}u(_)}else{if(o.logger.error("License Request XHR failed ("+p+"). Status: "+c.status+" ("+c.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>f){this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var T=f-this._requestLicenseFailureCount+1;o.logger.warn("Retrying license request, "+T+" attempts left"),this._requestLicense(y,u)}break}},x._generateLicenseRequestChallenge=function(c,p){switch(c.mediaKeySystemDomain){case l.KeySystems.WIDEVINE:return p}throw new Error("unsupported key-system: "+c.mediaKeySystemDomain)},x._requestLicense=function(c,p){o.logger.log("Requesting content license for key-system");var y=this._mediaKeysList[0];if(!y){o.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var u=this.getLicenseServerUrl(y.mediaKeySystemDomain),_=this._createLicenseXhr(u,c,p);o.logger.log("Sending license request to URL: "+u);var b=this._generateLicenseRequestChallenge(y,c);_.send(b)}catch(T){o.logger.error("Failure requesting DRM license: "+T),this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},x.onMediaAttached=function(c,p){if(!!this._emeEnabled){var y=p.media;this._media=y,y.addEventListener("encrypted",this._onMediaEncrypted)}},x.onMediaDetached=function(){var c=this._media,p=this._mediaKeysList;!c||(c.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(p.map(function(y){if(y.mediaKeysSession)return y.mediaKeysSession.close().catch(function(){})})).then(function(){return c.setMediaKeys(null)}).catch(function(){}))},x.onManifestParsed=function(c,p){if(!!this._emeEnabled){var y=p.levels.map(function(_){return _.audioCodec}).filter(function(_){return!!_}),u=p.levels.map(function(_){return _.videoCodec}).filter(function(_){return!!_});this._attemptKeySystemAccess(l.KeySystems.WIDEVINE,y,u)}},h(S,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),S}();i.default=E},"./src/controller/fps-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/logger.ts"),o=function(){function l(h){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=h,this.registerListeners()}var v=l.prototype;return v.setStreamController=function(f){this.streamController=f},v.registerListeners=function(){this.hls.on(n.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},v.unregisterListeners=function(){this.hls.off(n.Events.MEDIA_ATTACHING,this.onMediaAttaching)},v.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},v.onMediaAttaching=function(f,d){var g=this.hls.config;if(g.capLevelOnFPSDrop){var E=d.media instanceof self.HTMLVideoElement?d.media:null;this.media=E,E&&typeof E.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),g.fpsDroppedMonitoringPeriod)}},v.checkFPS=function(f,d,g){var E=performance.now();if(d){if(this.lastTime){var S=E-this.lastTime,x=g-this.lastDroppedFrames,m=d-this.lastDecodedFrames,c=1e3*x/S,p=this.hls;if(p.trigger(n.Events.FPS_DROP,{currentDropped:x,currentDecoded:m,totalDroppedFrames:g}),c>0&&x>p.config.fpsDroppedMonitoringThreshold*m){var y=p.currentLevel;a.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+y),y>0&&(p.autoLevelCapping===-1||p.autoLevelCapping>=y)&&(y=y-1,p.trigger(n.Events.FPS_DROP_LEVEL_CAPPING,{level:y,droppedLevel:p.currentLevel}),p.autoLevelCapping=y,this.streamController.nextLevelSwitch())}}this.lastTime=E,this.lastDroppedFrames=g,this.lastDecodedFrames=d}},v.checkFPSInterval=function(){var f=this.media;if(f)if(this.isVideoPlaybackQualityAvailable){var d=f.getVideoPlaybackQuality();this.checkFPS(f,d.totalVideoFrames,d.droppedVideoFrames)}else this.checkFPS(f,f.webkitDecodedFrameCount,f.webkitDroppedFrameCount)},l}();i.default=o},"./src/controller/fragment-finders.ts":function(r,i,t){t.r(i),t.d(i,"findFragmentByPDT",function(){return o}),t.d(i,"findFragmentByPTS",function(){return l}),t.d(i,"fragmentWithinToleranceTest",function(){return v}),t.d(i,"pdtWithinToleranceTest",function(){return h}),t.d(i,"findFragWithCC",function(){return f});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/binary-search.ts");function o(d,g,E){if(g===null||!Array.isArray(d)||!d.length||!Object(n.isFiniteNumber)(g))return null;var S=d[0].programDateTime;if(g<(S||0))return null;var x=d[d.length-1].endProgramDateTime;if(g>=(x||0))return null;E=E||0;for(var m=0;m<d.length;++m){var c=d[m];if(h(g,E,c))return c}return null}function l(d,g,E,S){E===void 0&&(E=0),S===void 0&&(S=0);var x=null;if(d?x=g[d.sn-g[0].sn+1]||null:E===0&&g[0].start===0&&(x=g[0]),x&&v(E,S,x)===0)return x;var m=a.default.search(g,v.bind(null,E,S));return m||x}function v(d,g,E){d===void 0&&(d=0),g===void 0&&(g=0);var S=Math.min(g,E.duration+(E.deltaPTS?E.deltaPTS:0));return E.start+E.duration-S<=d?1:E.start-S>d&&E.start?-1:0}function h(d,g,E){var S=Math.min(g,E.duration+(E.deltaPTS?E.deltaPTS:0))*1e3,x=E.endProgramDateTime||0;return x-S>d}function f(d,g){return a.default.search(d,function(E){return E.cc<g?1:E.cc>g?-1:0})}},"./src/controller/fragment-tracker.ts":function(r,i,t){t.r(i),t.d(i,"FragmentState",function(){return o}),t.d(i,"FragmentTracker",function(){return l});var n=t("./src/events.ts"),a=t("./src/types/loader.ts"),o;(function(f){f.NOT_LOADED="NOT_LOADED",f.BACKTRACKED="BACKTRACKED",f.APPENDING="APPENDING",f.PARTIAL="PARTIAL",f.OK="OK"})(o||(o={}));var l=function(){function f(g){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=g,this._registerListeners()}var d=f.prototype;return d._registerListeners=function(){var E=this.hls;E.on(n.Events.BUFFER_APPENDED,this.onBufferAppended,this),E.on(n.Events.FRAG_BUFFERED,this.onFragBuffered,this),E.on(n.Events.FRAG_LOADED,this.onFragLoaded,this)},d._unregisterListeners=function(){var E=this.hls;E.off(n.Events.BUFFER_APPENDED,this.onBufferAppended,this),E.off(n.Events.FRAG_BUFFERED,this.onFragBuffered,this),E.off(n.Events.FRAG_LOADED,this.onFragLoaded,this)},d.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},d.getAppendedFrag=function(E,S){if(S===a.PlaylistLevelType.MAIN){var x=this.activeFragment,m=this.activeParts;if(!x)return null;if(m)for(var c=m.length;c--;){var p=m[c],y=p?p.end:x.appendedPTS;if(p.start<=E&&y!==void 0&&E<=y)return c>9&&(this.activeParts=m.slice(c-9)),p}else if(x.start<=E&&x.appendedPTS!==void 0&&E<=x.appendedPTS)return x}return this.getBufferedFrag(E,S)},d.getBufferedFrag=function(E,S){for(var x=this.fragments,m=Object.keys(x),c=m.length;c--;){var p=x[m[c]];if((p==null?void 0:p.body.type)===S&&p.buffered){var y=p.body;if(y.start<=E&&E<=y.end)return y}}return null},d.detectEvictedFragments=function(E,S,x){var m=this;Object.keys(this.fragments).forEach(function(c){var p=m.fragments[c];if(!!p){if(!p.buffered){p.body.type===x&&m.removeFragment(p.body);return}var y=p.range[E];!y||y.time.some(function(u){var _=!m.isTimeBuffered(u.startPTS,u.endPTS,S);return _&&m.removeFragment(p.body),_})}})},d.detectPartialFragments=function(E){var S=this,x=this.timeRanges,m=E.frag,c=E.part;if(!(!x||m.sn==="initSegment")){var p=h(m),y=this.fragments[p];!y||(Object.keys(x).forEach(function(u){var _=m.elementaryStreams[u];if(!!_){var b=x[u],T=c!==null||_.partial===!0;y.range[u]=S.getBufferedTimes(m,c,T,b)}}),y.backtrack=y.loaded=null,Object.keys(y.range).length?y.buffered=!0:this.removeFragment(y.body))}},d.fragBuffered=function(E){var S=h(E),x=this.fragments[S];x&&(x.backtrack=x.loaded=null,x.buffered=!0)},d.getBufferedTimes=function(E,S,x,m){for(var c={time:[],partial:x},p=S?S.start:E.start,y=S?S.end:E.end,u=E.minEndPTS||y,_=E.maxStartPTS||p,b=0;b<m.length;b++){var T=m.start(b)-this.bufferPadding,A=m.end(b)+this.bufferPadding;if(_>=T&&u<=A){c.time.push({startPTS:Math.max(p,m.start(b)),endPTS:Math.min(y,m.end(b))});break}else if(p<A&&y>T)c.partial=!0,c.time.push({startPTS:Math.max(p,m.start(b)),endPTS:Math.min(y,m.end(b))});else if(y<=T)break}return c},d.getPartialFragment=function(E){var S=null,x,m,c,p=0,y=this.bufferPadding,u=this.fragments;return Object.keys(u).forEach(function(_){var b=u[_];!b||v(b)&&(m=b.body.start-y,c=b.body.end+y,E>=m&&E<=c&&(x=Math.min(E-m,c-E),p<=x&&(S=b.body,p=x)))}),S},d.getState=function(E){var S=h(E),x=this.fragments[S];return x?x.buffered?v(x)?o.PARTIAL:o.OK:x.backtrack?o.BACKTRACKED:o.APPENDING:o.NOT_LOADED},d.backtrack=function(E,S){var x=h(E),m=this.fragments[x];if(!m||m.backtrack)return null;var c=m.backtrack=S||m.loaded;return m.loaded=null,c},d.getBacktrackData=function(E){var S=h(E),x=this.fragments[S];if(x){var m,c=x.backtrack;if(c!=null&&(m=c.payload)!==null&&m!==void 0&&m.byteLength)return c;this.removeFragment(E)}return null},d.isTimeBuffered=function(E,S,x){for(var m,c,p=0;p<x.length;p++){if(m=x.start(p)-this.bufferPadding,c=x.end(p)+this.bufferPadding,E>=m&&S<=c)return!0;if(S<=m)return!1}return!1},d.onFragLoaded=function(E,S){var x=S.frag,m=S.part;if(!(x.sn==="initSegment"||x.bitrateTest||m)){var c=h(x);this.fragments[c]={body:x,loaded:S,backtrack:null,buffered:!1,range:Object.create(null)}}},d.onBufferAppended=function(E,S){var x=this,m=S.frag,c=S.part,p=S.timeRanges;if(m.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=m,c){var y=this.activeParts;y||(this.activeParts=y=[]),y.push(c)}else this.activeParts=null;this.timeRanges=p,Object.keys(p).forEach(function(u){var _=p[u];if(x.detectEvictedFragments(u,_),!c)for(var b=0;b<_.length;b++)m.appendedPTS=Math.max(_.end(b),m.appendedPTS||0)})},d.onFragBuffered=function(E,S){this.detectPartialFragments(S)},d.hasFragment=function(E){var S=h(E);return!!this.fragments[S]},d.removeFragmentsInRange=function(E,S,x){var m=this;Object.keys(this.fragments).forEach(function(c){var p=m.fragments[c];if(!!p&&p.buffered){var y=p.body;y.type===x&&y.start<S&&y.end>E&&m.removeFragment(y)}})},d.removeFragment=function(E){var S=h(E);E.stats.loaded=0,E.clearElementaryStreamInfo(),delete this.fragments[S]},d.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},f}();function v(f){var d,g;return f.buffered&&(((d=f.range.video)===null||d===void 0?void 0:d.partial)||((g=f.range.audio)===null||g===void 0?void 0:g.partial))}function h(f){return f.type+"_"+f.level+"_"+f.urlId+"_"+f.sn}},"./src/controller/gap-controller.ts":function(r,i,t){t.r(i),t.d(i,"STALL_MINIMUM_DURATION_MS",function(){return v}),t.d(i,"MAX_START_GAP_JUMP",function(){return h}),t.d(i,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return f}),t.d(i,"SKIP_BUFFER_RANGE_START",function(){return d}),t.d(i,"default",function(){return g});var n=t("./src/utils/buffer-helper.ts"),a=t("./src/errors.ts"),o=t("./src/events.ts"),l=t("./src/utils/logger.ts"),v=250,h=2,f=.1,d=.05,g=function(){function E(x,m,c,p){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=x,this.media=m,this.fragmentTracker=c,this.hls=p}var S=E.prototype;return S.destroy=function(){this.hls=this.fragmentTracker=this.media=null},S.poll=function(m){var c=this.config,p=this.media,y=this.stalled,u=p.currentTime,_=p.seeking,b=this.seeking&&!_,T=!this.seeking&&_;if(this.seeking=_,u!==m){if(this.moved=!0,y!==null){if(this.stallReported){var A=self.performance.now()-y;l.logger.warn("playback not stuck anymore @"+u+", after "+Math.round(A)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((T||b)&&(this.stalled=null),!(p.paused||p.ended||p.playbackRate===0||!n.BufferHelper.getBuffered(p).length)){var L=n.BufferHelper.bufferInfo(p,u,0),R=L.len>0,w=L.nextStart||0;if(!(!R&&!w)){if(_){var O=L.len>h,I=!w||w-u>h&&!this.fragmentTracker.getPartialFragment(u);if(O||I)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var D,C=Math.max(w,L.start||0)-u,P=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,M=P==null||(D=P.details)===null||D===void 0?void 0:D.live,N=M?P.details.targetduration*2:h;if(C>0&&C<=N){this._trySkipBufferHole(null);return}}var B=self.performance.now();if(y===null){this.stalled=B;return}var U=B-y;!_&&U>=v&&this._reportStall(L.len);var F=n.BufferHelper.bufferInfo(p,u,c.maxBufferHole);this._tryFixBufferStall(F,U)}}},S._tryFixBufferStall=function(m,c){var p=this.config,y=this.fragmentTracker,u=this.media,_=u.currentTime,b=y.getPartialFragment(_);if(b){var T=this._trySkipBufferHole(b);if(T)return}m.len>p.maxBufferHole&&c>p.highBufferWatchdogPeriod*1e3&&(l.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},S._reportStall=function(m){var c=this.hls,p=this.media,y=this.stallReported;y||(this.stallReported=!0,l.logger.warn("Playback stalling at @"+p.currentTime+" due to low buffer (buffer="+m+")"),c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:m}))},S._trySkipBufferHole=function(m){for(var c=this.config,p=this.hls,y=this.media,u=y.currentTime,_=0,b=n.BufferHelper.getBuffered(y),T=0;T<b.length;T++){var A=b.start(T);if(u+c.maxBufferHole>=_&&u<A){var L=Math.max(A+d,y.currentTime+f);return l.logger.warn("skipping hole, adjusting currentTime from "+u+" to "+L),this.moved=!0,this.stalled=null,y.currentTime=L,m&&p.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+u+" to "+L,frag:m}),L}_=b.end(T)}return 0},S._tryNudgeBuffer=function(){var m=this.config,c=this.hls,p=this.media,y=p.currentTime,u=(this.nudgeRetry||0)+1;if(this.nudgeRetry=u,u<m.nudgeMaxRetry){var _=y+u*m.nudgeOffset;l.logger.warn("Nudging 'currentTime' from "+y+" to "+_),p.currentTime=_,c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.logger.error("Playhead still not moving while enough data buffered @"+y+" after "+m.nudgeMaxRetry+" nudges"),c.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},E}()},"./src/controller/id3-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/texttrack-utils.ts"),o=t("./src/demux/id3.ts"),l=.25,v=function(){function h(d){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=d,this._registerListeners()}var f=h.prototype;return f.destroy=function(){this._unregisterListeners()},f._registerListeners=function(){var g=this.hls;g.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),g.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),g.on(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),g.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},f._unregisterListeners=function(){var g=this.hls;g.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),g.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),g.off(n.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),g.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},f.onMediaAttached=function(g,E){this.media=E.media},f.onMediaDetaching=function(){!this.id3Track||(Object(a.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},f.getID3Track=function(g){if(!!this.media){for(var E=0;E<g.length;E++){var S=g[E];if(S.kind==="metadata"&&S.label==="id3")return Object(a.sendAddTrackEvent)(S,this.media),S}return this.media.addTextTrack("metadata","id3")}},f.onFragParsingMetadata=function(g,E){if(!!this.media){var S=E.frag,x=E.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var m=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,c=0;c<x.length;c++){var p=o.getID3Frames(x[c].data);if(p){var y=x[c].pts,u=c<x.length-1?x[c+1].pts:S.end,_=u-y;_<=0&&(u=y+l);for(var b=0;b<p.length;b++){var T=p[b];if(!o.isTimeStampFrame(T)){var A=new m(y,u,"");A.value=T,this.id3Track.addCue(A)}}}}}},f.onBufferFlushing=function(g,E){var S=E.startOffset,x=E.endOffset,m=E.type;if(!m||m==="audio"){var c=this.id3Track;c&&Object(a.removeCuesInRange)(c,S,x)}},h}();i.default=v},"./src/controller/latency-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return h});var n=t("./src/errors.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts");function l(f,d){for(var g=0;g<d.length;g++){var E=d[g];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function v(f,d,g){return d&&l(f.prototype,d),g&&l(f,g),f}var h=function(){function f(g){var E=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return E.timeupdate()},this.hls=g,this.config=g.config,this.registerListeners()}var d=f.prototype;return d.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},d.registerListeners=function(){this.hls.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(a.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){this.hls.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(a.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(a.Events.ERROR,this.onError)},d.onMediaAttached=function(E,S){this.media=S.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},d.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},d.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},d.onLevelUpdated=function(E,S){var x=S.details;this.levelDetails=x,x.advanced&&this.timeupdate(),!x.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},d.onError=function(E,S){S.details===n.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,o.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},d.timeupdate=function(){var E=this.media,S=this.levelDetails;if(!(!E||!S)){this.currentTime=E.currentTime;var x=this.computeLatency();if(x!==null){this._latency=x;var m=this.config,c=m.lowLatencyMode,p=m.maxLiveSyncPlaybackRate;if(!(!c||p===1)){var y=this.targetLatency;if(y!==null){var u=x-y,_=Math.min(this.maxLatency,y+S.targetduration),b=u<_;if(S.live&&b&&u>.05&&this.forwardBufferLength>1){var T=Math.min(2,Math.max(1,p)),A=Math.round(2/(1+Math.exp(-.75*u-this.edgeStalled))*20)/20;E.playbackRate=Math.min(T,Math.max(1,A))}else E.playbackRate!==1&&E.playbackRate!==0&&(E.playbackRate=1)}}}}},d.estimateLiveEdge=function(){var E=this.levelDetails;return E===null?null:E.edge+E.age},d.computeLatency=function(){var E=this.estimateLiveEdge();return E===null?null:E-this.currentTime},v(f,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var E=this.config,S=this.levelDetails;return E.liveMaxLatencyDuration!==void 0?E.liveMaxLatencyDuration:S?E.liveMaxLatencyDurationCount*S.targetduration:0}},{key:"targetLatency",get:function(){var E=this.levelDetails;if(E===null)return null;var S=E.holdBack,x=E.partHoldBack,m=E.targetduration,c=this.config,p=c.liveSyncDuration,y=c.liveSyncDurationCount,u=c.lowLatencyMode,_=this.hls.userConfig,b=u&&x||S;(_.liveSyncDuration||_.liveSyncDurationCount||b===0)&&(b=p!==void 0?p:y*m);var T=m,A=1;return b+Math.min(this.stallCount*A,T)}},{key:"liveSyncPosition",get:function(){var E=this.estimateLiveEdge(),S=this.targetLatency,x=this.levelDetails;if(E===null||S===null||x===null)return null;var m=x.edge,c=E-S-this.edgeStalled,p=m-x.totalduration,y=m-(this.config.lowLatencyMode&&x.partTarget||x.targetduration);return Math.min(Math.max(p,c),y)}},{key:"drift",get:function(){var E=this.levelDetails;return E===null?1:E.drift}},{key:"edgeStalled",get:function(){var E=this.levelDetails;if(E===null)return 0;var S=(this.config.lowLatencyMode&&E.partTarget||E.targetduration)*3;return Math.max(E.age-S,0)}},{key:"forwardBufferLength",get:function(){var E=this.media,S=this.levelDetails;if(!E||!S)return 0;var x=E.buffered.length;return x?E.buffered.end(x-1):S.edge-this.currentTime}}]),f}()},"./src/controller/level-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return c});var n=t("./src/types/level.ts"),a=t("./src/events.ts"),o=t("./src/errors.ts"),l=t("./src/utils/codecs.ts"),v=t("./src/controller/level-helper.ts"),h=t("./src/controller/base-playlist-controller.ts"),f=t("./src/types/loader.ts");function d(){return d=Object.assign||function(p){for(var y=1;y<arguments.length;y++){var u=arguments[y];for(var _ in u)Object.prototype.hasOwnProperty.call(u,_)&&(p[_]=u[_])}return p},d.apply(this,arguments)}function g(p,y){for(var u=0;u<y.length;u++){var _=y[u];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(p,_.key,_)}}function E(p,y,u){return y&&g(p.prototype,y),u&&g(p,u),p}function S(p,y){p.prototype=Object.create(y.prototype),p.prototype.constructor=p,x(p,y)}function x(p,y){return x=Object.setPrototypeOf||function(_,b){return _.__proto__=b,_},x(p,y)}var m=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),c=function(p){S(y,p);function y(_){var b;return b=p.call(this,_,"[level-controller]")||this,b._levels=[],b._firstLevel=-1,b._startLevel=void 0,b.currentLevelIndex=-1,b.manualLevelIndex=-1,b.onParsedComplete=void 0,b._registerListeners(),b}var u=y.prototype;return u._registerListeners=function(){var b=this.hls;b.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),b.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.on(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),b.on(a.Events.ERROR,this.onError,this)},u._unregisterListeners=function(){var b=this.hls;b.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),b.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.off(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),b.off(a.Events.ERROR,this.onError,this)},u.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,p.prototype.destroy.call(this)},u.startLoad=function(){var b=this._levels;b.forEach(function(T){T.loadError=0}),p.prototype.startLoad.call(this)},u.onManifestLoaded=function(b,T){var A=[],L=[],R=[],w,O={},I,D=!1,C=!1,P=!1;if(T.levels.forEach(function(U){var F=U.attrs;D=D||!!(U.width&&U.height),C=C||!!U.videoCodec,P=P||!!U.audioCodec,m&&U.audioCodec&&U.audioCodec.indexOf("mp4a.40.34")!==-1&&(U.audioCodec=void 0);var j=U.bitrate+"-"+U.attrs.RESOLUTION+"-"+U.attrs.CODECS;I=O[j],I?I.url.push(U.url):(I=new n.Level(U),O[j]=I,A.push(I)),F&&(F.AUDIO&&Object(v.addGroupId)(I,"audio",F.AUDIO),F.SUBTITLES&&Object(v.addGroupId)(I,"text",F.SUBTITLES))}),(D||C)&&P&&(A=A.filter(function(U){var F=U.videoCodec,j=U.width,V=U.height;return!!F||!!(j&&V)})),A=A.filter(function(U){var F=U.audioCodec,j=U.videoCodec;return(!F||Object(l.isCodecSupportedInMp4)(F,"audio"))&&(!j||Object(l.isCodecSupportedInMp4)(j,"video"))}),T.audioTracks&&(L=T.audioTracks.filter(function(U){return!U.audioCodec||Object(l.isCodecSupportedInMp4)(U.audioCodec,"audio")}),Object(v.assignTrackIdsByGroup)(L)),T.subtitles&&(R=T.subtitles,Object(v.assignTrackIdsByGroup)(R)),A.length>0){w=A[0].bitrate,A.sort(function(U,F){return U.bitrate-F.bitrate}),this._levels=A;for(var M=0;M<A.length;M++)if(A[M].bitrate===w){this._firstLevel=M,this.log("manifest loaded, "+A.length+" level(s) found, first bitrate: "+w);break}var N=P&&!C,B={levels:A,audioTracks:L,subtitleTracks:R,firstLevel:this._firstLevel,stats:T.stats,audio:P,video:C,altAudio:!N&&L.some(function(U){return!!U.url})};this.hls.trigger(a.Events.MANIFEST_PARSED,B),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:T.url,reason:"no level with compatible codecs found in manifest"})},u.onError=function(b,T){if(p.prototype.onError.call(this,b,T),!T.fatal){var A=T.context,L=this._levels[this.currentLevelIndex];if(A&&(A.type===f.PlaylistContextType.AUDIO_TRACK&&L.audioGroupIds&&A.groupId===L.audioGroupIds[L.urlId]||A.type===f.PlaylistContextType.SUBTITLE_TRACK&&L.textGroupIds&&A.groupId===L.textGroupIds[L.urlId])){this.redundantFailover(this.currentLevelIndex);return}var R=!1,w=!0,O;switch(T.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:if(T.frag){var I=this._levels[T.frag.level];I?(I.fragmentError++,I.fragmentError>this.hls.config.fragLoadingMaxRetry&&(O=T.frag.level)):O=T.frag.level}break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:A&&(A.deliveryDirectives&&(w=!1),O=A.level),R=!0;break;case o.ErrorDetails.REMUX_ALLOC_ERROR:O=T.level,R=!0;break}O!==void 0&&this.recoverLevel(T,O,R,w)}},u.recoverLevel=function(b,T,A,L){var R=b.details,w=this._levels[T];if(w.loadError++,A){var O=this.retryLoadingOrFail(b);if(O)b.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(L){var I=w.url.length;if(I>1&&w.loadError<I)b.levelRetry=!0,this.redundantFailover(T);else if(this.manualLevelIndex===-1){var D=T===0?this._levels.length-1:T-1;this.currentLevelIndex!==D&&this._levels[D].loadError===0&&(this.warn(R+": switch to "+D),b.levelRetry=!0,this.hls.nextAutoLevel=D)}}},u.redundantFailover=function(b){var T=this._levels[b],A=T.url.length;if(A>1){var L=(T.urlId+1)%A;this.warn("Switching to redundant URL-id "+L),this._levels.forEach(function(R){R.urlId=L}),this.level=b}},u.onFragLoaded=function(b,T){var A=T.frag;if(A!==void 0&&A.type===f.PlaylistLevelType.MAIN){var L=this._levels[A.level];L!==void 0&&(L.fragmentError=0,L.loadError=0)}},u.onLevelLoaded=function(b,T){var A,L=T.level,R=T.details,w=this._levels[L];if(!w){var O;this.warn("Invalid level index "+L),(O=T.deliveryDirectives)!==null&&O!==void 0&&O.skip&&(R.deltaUpdateFailed=!0);return}L===this.currentLevelIndex?(w.fragmentError===0&&(w.loadError=0,this.retryCount=0),this.playlistLoaded(L,T,w.details)):(A=T.deliveryDirectives)!==null&&A!==void 0&&A.skip&&(R.deltaUpdateFailed=!0)},u.onAudioTrackSwitched=function(b,T){var A=this.hls.levels[this.currentLevelIndex];if(!!A&&A.audioGroupIds){for(var L=-1,R=this.hls.audioTracks[T.id].groupId,w=0;w<A.audioGroupIds.length;w++)if(A.audioGroupIds[w]===R){L=w;break}L!==A.urlId&&(A.urlId=L,this.startLoad())}},u.loadPlaylist=function(b){var T=this.currentLevelIndex,A=this._levels[T];if(this.canLoad&&A&&A.url.length>0){var L=A.urlId,R=A.url[L];if(b)try{R=b.addDirectives(R)}catch(w){this.warn("Could not construct new URL with HLS Delivery Directives: "+w)}this.log("Attempt loading level index "+T+(b?" at sn "+b.msn+" part "+b.part:"")+" with URL-id "+L+" "+R),this.clearTimer(),this.hls.trigger(a.Events.LEVEL_LOADING,{url:R,level:T,id:L,deliveryDirectives:b||null})}},u.removeLevel=function(b,T){var A=function(w,O){return O!==T},L=this._levels.filter(function(R,w){return w!==b?!0:R.url.length>1&&T!==void 0?(R.url=R.url.filter(A),R.audioGroupIds&&(R.audioGroupIds=R.audioGroupIds.filter(A)),R.textGroupIds&&(R.textGroupIds=R.textGroupIds.filter(A)),R.urlId=0,!0):!1}).map(function(R,w){var O=R.details;return O!=null&&O.fragments&&O.fragments.forEach(function(I){I.level=w}),R});this._levels=L,this.hls.trigger(a.Events.LEVELS_UPDATED,{levels:L})},E(y,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(b){var T,A=this._levels;if(A.length!==0&&!(this.currentLevelIndex===b&&(T=A[b])!==null&&T!==void 0&&T.details)){if(b<0||b>=A.length){var L=b<0;if(this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.LEVEL_SWITCH_ERROR,level:b,fatal:L,reason:"invalid level idx"}),L)return;b=Math.min(b,A.length-1)}this.clearTimer();var R=this.currentLevelIndex,w=A[R],O=A[b];this.log("switching to level "+b+" from "+R),this.currentLevelIndex=b;var I=d({},O,{level:b,maxBitrate:O.maxBitrate,uri:O.uri,urlId:O.urlId});delete I._urlId,this.hls.trigger(a.Events.LEVEL_SWITCHING,I);var D=O.details;if(!D||D.live){var C=this.switchParams(O.uri,w==null?void 0:w.details);this.loadPlaylist(C)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(b){this.manualLevelIndex=b,this._startLevel===void 0&&(this._startLevel=b),b!==-1&&(this.level=b)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(b){this._firstLevel=b}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var b=this.hls.config.startLevel;return b!==void 0?b:this._firstLevel}else return this._startLevel},set:function(b){this._startLevel=b}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(b){this.level=b,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=b)}}]),y}(h.default)},"./src/controller/level-helper.ts":function(r,i,t){t.r(i),t.d(i,"addGroupId",function(){return o}),t.d(i,"assignTrackIdsByGroup",function(){return l}),t.d(i,"updatePTS",function(){return v}),t.d(i,"updateFragPTSDTS",function(){return f}),t.d(i,"mergeDetails",function(){return d}),t.d(i,"mapPartIntersection",function(){return g}),t.d(i,"mapFragmentIntersection",function(){return E}),t.d(i,"adjustSliding",function(){return S}),t.d(i,"addSliding",function(){return x}),t.d(i,"computeReloadInterval",function(){return m}),t.d(i,"getFragmentWithSN",function(){return c}),t.d(i,"getPartWith",function(){return p});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/logger.ts");function o(y,u,_){switch(u){case"audio":y.audioGroupIds||(y.audioGroupIds=[]),y.audioGroupIds.push(_);break;case"text":y.textGroupIds||(y.textGroupIds=[]),y.textGroupIds.push(_);break}}function l(y){var u={};y.forEach(function(_){var b=_.groupId||"";_.id=u[b]=u[b]||0,u[b]++})}function v(y,u,_){var b=y[u],T=y[_];h(b,T)}function h(y,u){var _=u.startPTS;if(Object(n.isFiniteNumber)(_)){var b=0,T;u.sn>y.sn?(b=_-y.start,T=y):(b=y.start-_,T=u),T.duration!==b&&(T.duration=b)}else if(u.sn>y.sn){var A=y.cc===u.cc;A&&y.minEndPTS?u.start=y.start+(y.minEndPTS-y.start):u.start=y.start+y.duration}else u.start=Math.max(y.start-u.duration,0)}function f(y,u,_,b,T,A){var L=b-_;L<=0&&(a.logger.warn("Fragment should have a positive duration",u),b=_+u.duration,A=T+u.duration);var R=_,w=b,O=u.startPTS,I=u.endPTS;if(Object(n.isFiniteNumber)(O)){var D=Math.abs(O-_);Object(n.isFiniteNumber)(u.deltaPTS)?u.deltaPTS=Math.max(D,u.deltaPTS):u.deltaPTS=D,R=Math.max(_,O),_=Math.min(_,O),T=Math.min(T,u.startDTS),w=Math.min(b,I),b=Math.max(b,I),A=Math.max(A,u.endDTS)}u.duration=b-_;var C=_-u.start;u.appendedPTS=b,u.start=u.startPTS=_,u.maxStartPTS=R,u.startDTS=T,u.endPTS=b,u.minEndPTS=w,u.endDTS=A;var P=u.sn;if(!y||P<y.startSN||P>y.endSN)return 0;var M,N=P-y.startSN,B=y.fragments;for(B[N]=u,M=N;M>0;M--)h(B[M],B[M-1]);for(M=N;M<B.length-1;M++)h(B[M],B[M+1]);return y.fragmentHint&&h(B[B.length-1],y.fragmentHint),y.PTSKnown=y.alignedSliding=!0,C}function d(y,u){for(var _=null,b=y.fragments,T=b.length-1;T>=0;T--){var A=b[T].initSegment;if(A){_=A;break}}y.fragmentHint&&delete y.fragmentHint.endPTS;var L=0,R;if(E(y,u,function(M,N){M.relurl&&(L=M.cc-N.cc),Object(n.isFiniteNumber)(M.startPTS)&&Object(n.isFiniteNumber)(M.endPTS)&&(N.start=N.startPTS=M.startPTS,N.startDTS=M.startDTS,N.appendedPTS=M.appendedPTS,N.maxStartPTS=M.maxStartPTS,N.endPTS=M.endPTS,N.endDTS=M.endDTS,N.minEndPTS=M.minEndPTS,N.duration=M.endPTS-M.startPTS,N.duration&&(R=N),u.PTSKnown=u.alignedSliding=!0),N.elementaryStreams=M.elementaryStreams,N.loader=M.loader,N.stats=M.stats,N.urlId=M.urlId,M.initSegment&&(N.initSegment=M.initSegment,_=M.initSegment)}),_){var w=u.fragmentHint?u.fragments.concat(u.fragmentHint):u.fragments;w.forEach(function(M){var N;(!M.initSegment||M.initSegment.relurl===((N=_)===null||N===void 0?void 0:N.relurl))&&(M.initSegment=_)})}if(u.skippedSegments&&(u.deltaUpdateFailed=u.fragments.some(function(M){return!M}),u.deltaUpdateFailed)){a.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var O=u.skippedSegments;O--;)u.fragments.shift();u.startSN=u.fragments[0].sn,u.startCC=u.fragments[0].cc}var I=u.fragments;if(L){a.logger.warn("discontinuity sliding from playlist, take drift into account");for(var D=0;D<I.length;D++)I[D].cc+=L}u.skippedSegments&&(u.startCC=u.fragments[0].cc),g(y.partList,u.partList,function(M,N){N.elementaryStreams=M.elementaryStreams,N.stats=M.stats}),R?f(u,R,R.startPTS,R.endPTS,R.startDTS,R.endDTS):S(y,u),I.length&&(u.totalduration=u.edge-I[0].start),u.driftStartTime=y.driftStartTime,u.driftStart=y.driftStart;var C=u.advancedDateTime;if(u.advanced&&C){var P=u.edge;u.driftStart||(u.driftStartTime=C,u.driftStart=P),u.driftEndTime=C,u.driftEnd=P}else u.driftEndTime=y.driftEndTime,u.driftEnd=y.driftEnd,u.advancedDateTime=y.advancedDateTime}function g(y,u,_){if(y&&u)for(var b=0,T=0,A=y.length;T<=A;T++){var L=y[T],R=u[T+b];L&&R&&L.index===R.index&&L.fragment.sn===R.fragment.sn?_(L,R):b--}}function E(y,u,_){for(var b=u.skippedSegments,T=Math.max(y.startSN,u.startSN)-u.startSN,A=(y.fragmentHint?1:0)+(b?u.endSN:Math.min(y.endSN,u.endSN))-u.startSN,L=u.startSN-y.startSN,R=u.fragmentHint?u.fragments.concat(u.fragmentHint):u.fragments,w=y.fragmentHint?y.fragments.concat(y.fragmentHint):y.fragments,O=T;O<=A;O++){var I=w[L+O],D=R[O];b&&!D&&O<b&&(D=u.fragments[O]=I),I&&D&&_(I,D)}}function S(y,u){var _=u.startSN+u.skippedSegments-y.startSN,b=y.fragments;_<0||_>=b.length||x(u,b[_].start)}function x(y,u){if(u){for(var _=y.fragments,b=y.skippedSegments;b<_.length;b++)_[b].start+=u;y.fragmentHint&&(y.fragmentHint.start+=u)}}function m(y,u){var _=1e3*y.levelTargetDuration,b=_/2,T=y.age,A=T>0&&T<_*3,L=u.loading.end-u.loading.start,R,w=y.availabilityDelay;if(y.updated===!1)if(A){var O=333*y.misses;R=Math.max(Math.min(b,L*2),O),y.availabilityDelay=(y.availabilityDelay||0)+R}else R=b;else A?(w=Math.min(w||_/2,T),y.availabilityDelay=w,R=w+_-T):R=_-L;return Math.round(R)}function c(y,u,_){if(!y||!y.details)return null;var b=y.details,T=b.fragments[u-b.startSN];return T||(T=b.fragmentHint,T&&T.sn===u)?T:u<b.startSN&&_&&_.sn===u?_:null}function p(y,u,_){if(!y||!y.details)return null;var b=y.details.partList;if(b)for(var T=b.length;T--;){var A=b[T];if(A.index===_&&A.fragment.sn===u)return A}return null}},"./src/controller/stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return b});var n=t("./src/polyfills/number.ts"),a=t("./src/controller/base-stream-controller.ts"),o=t("./src/is-supported.ts"),l=t("./src/events.ts"),v=t("./src/utils/buffer-helper.ts"),h=t("./src/controller/fragment-tracker.ts"),f=t("./src/types/loader.ts"),d=t("./src/loader/fragment.ts"),g=t("./src/demux/transmuxer-interface.ts"),E=t("./src/types/transmuxer.ts"),S=t("./src/controller/gap-controller.ts"),x=t("./src/errors.ts"),m=t("./src/utils/logger.ts");function c(T,A){for(var L=0;L<A.length;L++){var R=A[L];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(T,R.key,R)}}function p(T,A,L){return A&&c(T.prototype,A),L&&c(T,L),T}function y(T,A){T.prototype=Object.create(A.prototype),T.prototype.constructor=T,u(T,A)}function u(T,A){return u=Object.setPrototypeOf||function(R,w){return R.__proto__=w,R},u(T,A)}var _=100,b=function(T){y(A,T);function A(R,w){var O;return O=T.call(this,R,w,"[stream-controller]")||this,O.audioCodecSwap=!1,O.gapController=null,O.level=-1,O._forceStartLoad=!1,O.altAudio=!1,O.audioOnly=!1,O.fragPlaying=null,O.onvplaying=null,O.onvseeked=null,O.fragLastKbps=0,O.stalled=!1,O.couldBacktrack=!1,O.audioCodecSwitch=!1,O.videoBuffer=null,O._registerListeners(),O}var L=A.prototype;return L._registerListeners=function(){var w=this.hls;w.on(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),w.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),w.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),w.on(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),w.on(l.Events.LEVEL_LOADING,this.onLevelLoading,this),w.on(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),w.on(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),w.on(l.Events.ERROR,this.onError,this),w.on(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),w.on(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),w.on(l.Events.BUFFER_CREATED,this.onBufferCreated,this),w.on(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),w.on(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),w.on(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L._unregisterListeners=function(){var w=this.hls;w.off(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),w.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),w.off(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),w.off(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),w.off(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),w.off(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),w.off(l.Events.ERROR,this.onError,this),w.off(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),w.off(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),w.off(l.Events.BUFFER_CREATED,this.onBufferCreated,this),w.off(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),w.off(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),w.off(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},L.startLoad=function(w){if(this.levels){var O=this.lastCurrentTime,I=this.hls;if(this.stopLoad(),this.setInterval(_),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var D=I.startLevel;D===-1&&(I.config.testBandwidth?(D=0,this.bitrateTest=!0):D=I.nextAutoLevel),this.level=I.nextLoadLevel=D,this.loadedmetadata=!1}O>0&&w===-1&&(this.log("Override startPosition with lastCurrentTime @"+O.toFixed(3)),w=O),this.state=a.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=w,this.tick()}else this._forceStartLoad=!0,this.state=a.State.STOPPED},L.stopLoad=function(){this._forceStartLoad=!1,T.prototype.stopLoad.call(this)},L.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_LEVEL:{var w,O=this.levels,I=this.level,D=O==null||(w=O[I])===null||w===void 0?void 0:w.details;if(D&&(!D.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(D))break;this.state=a.State.IDLE;break}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var C,P=self.performance.now(),M=this.retryDate;(!M||P>=M||(C=this.media)!==null&&C!==void 0&&C.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=a.State.IDLE)}break}this.onTickEnd()},L.onTickEnd=function(){T.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},L.doTickIdle=function(){var w,O,I=this.hls,D=this.levelLastLoaded,C=this.levels,P=this.media,M=I.config,N=I.nextLoadLevel;if(!(D===null||!P&&(this.startFragRequested||!M.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!C||!C[N])){var B=C[N];this.level=I.nextLoadLevel=N;var U=B.details;if(!U||this.state===a.State.WAITING_LEVEL||U.live&&this.levelLastLoaded!==N){this.state=a.State.WAITING_LEVEL;return}var F=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:P,f.PlaylistLevelType.MAIN);if(F!==null){var j=F.len,V=this.getMaxBufferLength(B.maxBitrate);if(!(j>=V)){if(this._streamEnded(F,U)){var G={};this.altAudio&&(G.type="video"),this.hls.trigger(l.Events.BUFFER_EOS,G),this.state=a.State.ENDED;return}var Y=F.end,X=this.getNextFragment(Y,U);if(this.couldBacktrack&&!this.fragPrevious&&X&&X.sn!=="initSegment"){var ie=X.sn-U.startSN;ie>1&&(X=U.fragments[ie-1],this.fragmentTracker.removeFragment(X))}if(X&&this.fragmentTracker.getState(X)===h.FragmentState.OK&&this.nextLoadPosition>Y){var he=this.audioOnly&&!this.altAudio?d.ElementaryStreamTypes.AUDIO:d.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(P,he,f.PlaylistLevelType.MAIN),X=this.getNextFragment(this.nextLoadPosition,U)}!X||(X.initSegment&&!X.initSegment.data&&!this.bitrateTest&&(X=X.initSegment),((w=X.decryptdata)===null||w===void 0?void 0:w.keyFormat)==="identity"&&!((O=X.decryptdata)!==null&&O!==void 0&&O.key)?this.loadKey(X,U):this.loadFragment(X,U,Y))}}}},L.loadFragment=function(w,O,I){var D,C=this.fragmentTracker.getState(w);if(this.fragCurrent=w,C===h.FragmentState.BACKTRACKED){var P=this.fragmentTracker.getBacktrackData(w);if(P){this._handleFragmentLoadProgress(P),this._handleFragmentLoadComplete(P);return}else C=h.FragmentState.NOT_LOADED}C===h.FragmentState.NOT_LOADED||C===h.FragmentState.PARTIAL?w.sn==="initSegment"?this._loadInitSegment(w):this.bitrateTest?(w.bitrateTest=!0,this.log("Fragment "+w.sn+" of level "+w.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(w)):(this.startFragRequested=!0,T.prototype.loadFragment.call(this,w,O,I)):C===h.FragmentState.APPENDING?this.reduceMaxBufferLength(w.duration)&&this.fragmentTracker.removeFragment(w):((D=this.media)===null||D===void 0?void 0:D.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},L.getAppendedFrag=function(w){var O=this.fragmentTracker.getAppendedFrag(w,f.PlaylistLevelType.MAIN);return O&&"fragment"in O?O.fragment:O},L.getBufferedFrag=function(w){return this.fragmentTracker.getBufferedFrag(w,f.PlaylistLevelType.MAIN)},L.followingBufferedFrag=function(w){return w?this.getBufferedFrag(w.end+.5):null},L.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},L.nextLevelSwitch=function(){var w=this.levels,O=this.media;if(O!=null&&O.readyState){var I,D=this.getAppendedFrag(O.currentTime);if(D&&D.start>1&&this.flushMainBuffer(0,D.start-1),!O.paused&&w){var C=this.hls.nextLoadLevel,P=w[C],M=this.fragLastKbps;M&&this.fragCurrent?I=this.fragCurrent.duration*P.maxBitrate/(1e3*M)+1:I=0}else I=0;var N=this.getBufferedFrag(O.currentTime+I);if(N){var B=this.followingBufferedFrag(N);if(B){this.abortCurrentFrag();var U=B.maxStartPTS?B.maxStartPTS:B.start,F=B.duration,j=Math.max(N.end,U+Math.min(Math.max(F-this.config.maxFragLookUpTolerance,F*.5),F*.75));this.flushMainBuffer(j,Number.POSITIVE_INFINITY)}}}},L.abortCurrentFrag=function(){var w=this.fragCurrent;this.fragCurrent=null,w!=null&&w.loader&&w.loader.abort(),this.state===a.State.KEY_LOADING&&(this.state=a.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},L.flushMainBuffer=function(w,O){T.prototype.flushMainBuffer.call(this,w,O,this.altAudio?"video":null)},L.onMediaAttached=function(w,O){T.prototype.onMediaAttached.call(this,w,O);var I=O.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),I.addEventListener("playing",this.onvplaying),I.addEventListener("seeked",this.onvseeked),this.gapController=new S.default(this.config,I,this.fragmentTracker,this.hls)},L.onMediaDetaching=function(){var w=this.media;w&&(w.removeEventListener("playing",this.onvplaying),w.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),T.prototype.onMediaDetaching.call(this)},L.onMediaPlaying=function(){this.tick()},L.onMediaSeeked=function(){var w=this.media,O=w?w.currentTime:null;Object(n.isFiniteNumber)(O)&&this.log("Media seeked to "+O.toFixed(3)),this.tick()},L.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(l.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},L.onManifestParsed=function(w,O){var I=!1,D=!1,C;O.levels.forEach(function(P){C=P.audioCodec,C&&(C.indexOf("mp4a.40.2")!==-1&&(I=!0),C.indexOf("mp4a.40.5")!==-1&&(D=!0))}),this.audioCodecSwitch=I&&D&&!Object(o.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=O.levels,this.startFragRequested=!1},L.onLevelLoading=function(w,O){var I=this.levels;if(!(!I||this.state!==a.State.IDLE)){var D=I[O.level];(!D.details||D.details.live&&this.levelLastLoaded!==O.level||this.waitForCdnTuneIn(D.details))&&(this.state=a.State.WAITING_LEVEL)}},L.onLevelLoaded=function(w,O){var I,D=this.levels,C=O.level,P=O.details,M=P.totalduration;if(!D){this.warn("Levels were reset while loading level "+C);return}this.log("Level "+C+" loaded ["+P.startSN+","+P.endSN+"], cc ["+P.startCC+", "+P.endCC+"] duration:"+M);var N=this.fragCurrent;N&&(this.state===a.State.FRAG_LOADING||this.state===a.State.FRAG_LOADING_WAITING_RETRY)&&N.level!==O.level&&N.loader&&(this.state=a.State.IDLE,N.loader.abort());var B=D[C],U=0;if(P.live||(I=B.details)!==null&&I!==void 0&&I.live){if(P.fragments[0]||(P.deltaUpdateFailed=!0),P.deltaUpdateFailed)return;U=this.alignPlaylists(P,B.details)}if(B.details=P,this.levelLastLoaded=C,this.hls.trigger(l.Events.LEVEL_UPDATED,{details:P,level:C}),this.state===a.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(P))return;this.state=a.State.IDLE}this.startFragRequested?P.live&&this.synchronizeToLiveEdge(P):this.setStartPosition(P,U),this.tick()},L._handleFragmentLoadProgress=function(w){var O,I=w.frag,D=w.part,C=w.payload,P=this.levels;if(!P){this.warn("Levels were reset while fragment load was in progress. Fragment "+I.sn+" of level "+I.level+" will not be buffered");return}var M=P[I.level],N=M.details;if(!N){this.warn("Dropping fragment "+I.sn+" of level "+I.level+" after level details were reset");return}var B=M.videoCodec,U=N.PTSKnown||!N.live,F=(O=I.initSegment)===null||O===void 0?void 0:O.data,j=this._getAudioCodec(M),V=this.transmuxer=this.transmuxer||new g.default(this.hls,f.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),G=D?D.index:-1,Y=G!==-1,X=new E.ChunkMetadata(I.level,I.sn,I.stats.chunkCount,C.byteLength,G,Y),ie=this.initPTS[I.cc];V.push(C,F,j,B,I,D,N.totalduration,U,X,ie)},L.onAudioTrackSwitching=function(w,O){var I=this.altAudio,D=!!O.url,C=O.id;if(!D){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var P=this.fragCurrent;P!=null&&P.loader&&(this.log("Switching to main audio track, cancel main fragment load"),P.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var M=this.hls;I&&M.trigger(l.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),M.trigger(l.Events.AUDIO_TRACK_SWITCHED,{id:C})}},L.onAudioTrackSwitched=function(w,O){var I=O.id,D=!!this.hls.audioTracks[I].url;if(D){var C=this.videoBuffer;C&&this.mediaBuffer!==C&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=C)}this.altAudio=D,this.tick()},L.onBufferCreated=function(w,O){var I=O.tracks,D,C,P=!1;for(var M in I){var N=I[M];if(N.id==="main"){if(C=M,D=N,M==="video"){var B=I[M];B&&(this.videoBuffer=B.buffer)}}else P=!0}P&&D?(this.log("Alternate track found, use "+C+".buffered to schedule main fragment loading"),this.mediaBuffer=D.buffer):this.mediaBuffer=this.media},L.onFragBuffered=function(w,O){var I=O.frag,D=O.part;if(!(I&&I.type!==f.PlaylistLevelType.MAIN)){if(this.fragContextChanged(I)){this.warn("Fragment "+I.sn+(D?" p: "+D.index:"")+" of level "+I.level+" finished buffering, but was aborted. state: "+this.state),this.state===a.State.PARSED&&(this.state=a.State.IDLE);return}var C=D?D.stats:I.stats;this.fragLastKbps=Math.round(8*C.total/(C.buffering.end-C.loading.first)),I.sn!=="initSegment"&&(this.fragPrevious=I),this.fragBufferedComplete(I,D)}},L.onError=function(w,O){switch(O.details){case x.ErrorDetails.FRAG_LOAD_ERROR:case x.ErrorDetails.FRAG_LOAD_TIMEOUT:case x.ErrorDetails.KEY_LOAD_ERROR:case x.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(f.PlaylistLevelType.MAIN,O);break;case x.ErrorDetails.LEVEL_LOAD_ERROR:case x.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==a.State.ERROR&&(O.fatal?(this.warn(""+O.details),this.state=a.State.ERROR):!O.levelRetry&&this.state===a.State.WAITING_LEVEL&&(this.state=a.State.IDLE));break;case x.ErrorDetails.BUFFER_FULL_ERROR:if(O.parent==="main"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var I=!0,D=this.getFwdBufferInfo(this.media,f.PlaylistLevelType.MAIN);D&&D.len>.5&&(I=!this.reduceMaxBufferLength(D.len)),I&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},L.checkBuffer=function(){var w=this.media,O=this.gapController;if(!(!w||!O||!w.readyState)){var I=v.BufferHelper.getBuffered(w);!this.loadedmetadata&&I.length?(this.loadedmetadata=!0,this.seekToStartPos()):O.poll(this.lastCurrentTime),this.lastCurrentTime=w.currentTime}},L.onFragLoadEmergencyAborted=function(){this.state=a.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},L.onBufferFlushed=function(w,O){var I=O.type;if(I!==d.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var D=(I===d.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(D,I,f.PlaylistLevelType.MAIN)}},L.onLevelsUpdated=function(w,O){this.levels=O.levels},L.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},L.seekToStartPos=function(){var w=this.media,O=w.currentTime,I=this.startPosition;if(I>=0&&O<I){if(w.seeking){m.logger.log("could not seek to "+I+", already seeking at "+O);return}var D=v.BufferHelper.getBuffered(w),C=D.length?D.start(0):0,P=C-I;P>0&&(P<this.config.maxBufferHole||P<this.config.maxFragLookUpTolerance)&&(m.logger.log("adjusting start position by "+P+" to match buffer start"),I+=P,this.startPosition=I),this.log("seek to target start position "+I+" from current time "+O),w.currentTime=I}},L._getAudioCodec=function(w){var O=this.config.defaultAudioCodec||w.audioCodec;return this.audioCodecSwap&&O&&(this.log("Swapping audio codec"),O.indexOf("mp4a.40.5")!==-1?O="mp4a.40.2":O="mp4a.40.5"),O},L._loadBitrateTestFrag=function(w){var O=this;this._doFragLoad(w).then(function(I){var D=O.hls;if(!(!I||D.nextLoadLevel||O.fragContextChanged(w))){O.fragLoadError=0,O.state=a.State.IDLE,O.startFragRequested=!1,O.bitrateTest=!1;var C=w.stats;C.parsing.start=C.parsing.end=C.buffering.start=C.buffering.end=self.performance.now(),D.trigger(l.Events.FRAG_LOADED,I)}})},L._handleTransmuxComplete=function(w){var O,I="main",D=this.hls,C=w.remuxResult,P=w.chunkMeta,M=this.getCurrentContext(P);if(!M){this.warn("The loading context changed while buffering fragment "+P.sn+" of level "+P.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(P.level);return}var N=M.frag,B=M.part,U=M.level,F=C.video,j=C.text,V=C.id3,G=C.initSegment,Y=this.altAudio?void 0:C.audio;if(!this.fragContextChanged(N)){if(this.state=a.State.PARSING,G){G.tracks&&(this._bufferInitSegment(U,G.tracks,N,P),D.trigger(l.Events.FRAG_PARSING_INIT_SEGMENT,{frag:N,id:I,tracks:G.tracks}));var X=G.initPTS,ie=G.timescale;Object(n.isFiniteNumber)(X)&&(this.initPTS[N.cc]=X,D.trigger(l.Events.INIT_PTS_FOUND,{frag:N,id:I,initPTS:X,timescale:ie}))}if(F&&C.independent!==!1){if(U.details){var he=F.startPTS,de=F.endPTS,Ae=F.startDTS,pe=F.endDTS;if(B)B.elementaryStreams[F.type]={startPTS:he,endPTS:de,startDTS:Ae,endDTS:pe};else if(F.firstKeyFrame&&F.independent&&(this.couldBacktrack=!0),F.dropped&&F.independent){var le=this.getLoadPosition()+this.config.maxBufferHole;if(le<he){this.backtrack(N);return}N.setElementaryStreamInfo(F.type,N.start,de,N.start,pe,!0)}N.setElementaryStreamInfo(F.type,he,de,Ae,pe),this.bufferFragmentData(F,N,B,P)}}else if(C.independent===!1){this.backtrack(N);return}if(Y){var Ie=Y.startPTS,Ce=Y.endPTS,Ue=Y.startDTS,Me=Y.endDTS;B&&(B.elementaryStreams[d.ElementaryStreamTypes.AUDIO]={startPTS:Ie,endPTS:Ce,startDTS:Ue,endDTS:Me}),N.setElementaryStreamInfo(d.ElementaryStreamTypes.AUDIO,Ie,Ce,Ue,Me),this.bufferFragmentData(Y,N,B,P)}if(V!=null&&(O=V.samples)!==null&&O!==void 0&&O.length){var ze={frag:N,id:I,samples:V.samples};D.trigger(l.Events.FRAG_PARSING_METADATA,ze)}if(j){var Ge={frag:N,id:I,samples:j.samples};D.trigger(l.Events.FRAG_PARSING_USERDATA,Ge)}}},L._bufferInitSegment=function(w,O,I,D){var C=this;if(this.state===a.State.PARSING){this.audioOnly=!!O.audio&&!O.video,this.altAudio&&!this.audioOnly&&delete O.audio;var P=O.audio,M=O.video,N=O.audiovideo;if(P){var B=w.audioCodec,U=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(B&&(B.indexOf("mp4a.40.5")!==-1?B="mp4a.40.2":B="mp4a.40.5"),P.metadata.channelCount!==1&&U.indexOf("firefox")===-1&&(B="mp4a.40.5")),U.indexOf("android")!==-1&&P.container!=="audio/mpeg"&&(B="mp4a.40.2",this.log("Android: force audio codec to "+B)),w.audioCodec&&w.audioCodec!==B&&this.log('Swapping manifest audio codec "'+w.audioCodec+'" for "'+B+'"'),P.levelCodec=B,P.id="main",this.log("Init audio buffer, container:"+P.container+", codecs[selected/level/parsed]=["+(B||"")+"/"+(w.audioCodec||"")+"/"+P.codec+"]")}M&&(M.levelCodec=w.videoCodec,M.id="main",this.log("Init video buffer, container:"+M.container+", codecs[level/parsed]=["+(w.videoCodec||"")+"/"+M.codec+"]")),N&&this.log("Init audiovideo buffer, container:"+N.container+", codecs[level/parsed]=["+(w.attrs.CODECS||"")+"/"+N.codec+"]"),this.hls.trigger(l.Events.BUFFER_CODECS,O),Object.keys(O).forEach(function(F){var j=O[F],V=j.initSegment;V!=null&&V.byteLength&&C.hls.trigger(l.Events.BUFFER_APPENDING,{type:F,data:V,frag:I,part:null,chunkMeta:D,parent:I.type})}),this.tick()}},L.backtrack=function(w){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(w);var O=this.fragmentTracker.backtrack(w);this.fragPrevious=null,this.nextLoadPosition=w.start,O?this.resetFragmentLoading(w):this.state=a.State.BACKTRACKING},L.checkFragmentChanged=function(){var w=this.media,O=null;if(w&&w.readyState>1&&w.seeking===!1){var I=w.currentTime;if(v.BufferHelper.isBuffered(w,I)?O=this.getAppendedFrag(I):v.BufferHelper.isBuffered(w,I+.1)&&(O=this.getAppendedFrag(I+.1)),O){var D=this.fragPlaying,C=O.level;(!D||O.sn!==D.sn||D.level!==C||O.urlId!==D.urlId)&&(this.hls.trigger(l.Events.FRAG_CHANGED,{frag:O}),(!D||D.level!==C)&&this.hls.trigger(l.Events.LEVEL_SWITCHED,{level:C}),this.fragPlaying=O)}}},p(A,[{key:"nextLevel",get:function(){var w=this.nextBufferedFrag;return w?w.level:-1}},{key:"currentLevel",get:function(){var w=this.media;if(w){var O=this.getAppendedFrag(w.currentTime);if(O)return O.level}return-1}},{key:"nextBufferedFrag",get:function(){var w=this.media;if(w){var O=this.getAppendedFrag(w.currentTime);return this.followingBufferedFrag(O)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),A}(a.default)},"./src/controller/subtitle-stream-controller.ts":function(r,i,t){t.r(i),t.d(i,"SubtitleStreamController",function(){return p});var n=t("./src/events.ts"),a=t("./src/utils/buffer-helper.ts"),o=t("./src/controller/fragment-finders.ts"),l=t("./src/utils/discontinuities.ts"),v=t("./src/controller/level-helper.ts"),h=t("./src/controller/fragment-tracker.ts"),f=t("./src/controller/base-stream-controller.ts"),d=t("./src/types/loader.ts"),g=t("./src/types/level.ts");function E(y,u){for(var _=0;_<u.length;_++){var b=u[_];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(y,b.key,b)}}function S(y,u,_){return u&&E(y.prototype,u),_&&E(y,_),y}function x(y,u){y.prototype=Object.create(u.prototype),y.prototype.constructor=y,m(y,u)}function m(y,u){return m=Object.setPrototypeOf||function(b,T){return b.__proto__=T,b},m(y,u)}var c=500,p=function(y){x(u,y);function u(b,T){var A;return A=y.call(this,b,T,"[subtitle-stream-controller]")||this,A.levels=[],A.currentTrackId=-1,A.tracksBuffered=[],A.mainDetails=null,A._registerListeners(),A}var _=u.prototype;return _.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},_._registerListeners=function(){var T=this.hls;T.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.on(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.on(n.Events.ERROR,this.onError,this),T.on(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),T.on(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),T.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),T.on(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),T.on(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},_._unregisterListeners=function(){var T=this.hls;T.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.off(n.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.off(n.Events.ERROR,this.onError,this),T.off(n.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),T.off(n.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),T.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),T.off(n.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),T.off(n.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},_.startLoad=function(){this.stopLoad(),this.state=f.State.IDLE,this.setInterval(c),this.tick()},_.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},_.onLevelLoaded=function(T,A){this.mainDetails=A.details},_.onSubtitleFragProcessed=function(T,A){var L=A.frag,R=A.success;if(this.fragPrevious=L,this.state=f.State.IDLE,!!R){var w=this.tracksBuffered[this.currentTrackId];if(!!w){for(var O,I=L.start,D=0;D<w.length;D++)if(I>=w[D].start&&I<=w[D].end){O=w[D];break}var C=L.start+L.duration;O?O.end=C:(O={start:I,end:C},w.push(O)),this.fragmentTracker.fragBuffered(L)}}},_.onBufferFlushing=function(T,A){var L=A.startOffset,R=A.endOffset;if(L===0&&R!==Number.POSITIVE_INFINITY){var w=this.currentTrackId,O=this.levels;if(!O.length||!O[w]||!O[w].details)return;var I=O[w].details,D=I.targetduration,C=R-D;if(C<=0)return;A.endOffsetSubtitles=Math.max(0,C),this.tracksBuffered.forEach(function(P){for(var M=0;M<P.length;){if(P[M].end<=C){P.shift();continue}else if(P[M].start<C)P[M].start=C;else break;M++}}),this.fragmentTracker.removeFragmentsInRange(L,C,d.PlaylistLevelType.SUBTITLE)}},_.onError=function(T,A){var L,R=A.frag;!R||R.type!==d.PlaylistLevelType.SUBTITLE||((L=this.fragCurrent)!==null&&L!==void 0&&L.loader&&this.fragCurrent.loader.abort(),this.state=f.State.IDLE)},_.onSubtitleTracksUpdated=function(T,A){var L=this,R=A.subtitleTracks;this.tracksBuffered=[],this.levels=R.map(function(w){return new g.Level(w)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(w){L.tracksBuffered[w.id]=[]}),this.mediaBuffer=null},_.onSubtitleTrackSwitch=function(T,A){if(this.currentTrackId=A.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var L=this.levels[this.currentTrackId];L!=null&&L.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,L&&this.setInterval(c)},_.onSubtitleTrackLoaded=function(T,A){var L,R=A.details,w=A.id,O=this.currentTrackId,I=this.levels;if(!!I.length){var D=I[O];if(!(w>=I.length||w!==O||!D)){if(this.mediaBuffer=this.mediaBufferTimeRanges,R.live||(L=D.details)!==null&&L!==void 0&&L.live){var C=this.mainDetails;if(R.deltaUpdateFailed||!C)return;var P=C.fragments[0];if(!D.details)R.hasProgramDateTime&&C.hasProgramDateTime?Object(l.alignMediaPlaylistByPDT)(R,C):P&&Object(v.addSliding)(R,P.start);else{var M=this.alignPlaylists(R,D.details);M===0&&P&&Object(v.addSliding)(R,P.start)}}if(D.details=R,this.levelLastLoaded=w,this.tick(),R.live&&!this.fragCurrent&&this.media&&this.state===f.State.IDLE){var N=Object(o.findFragmentByPTS)(null,R.fragments,this.media.currentTime,0);N||(this.warn("Subtitle playlist not aligned with playback"),D.details=void 0)}}}},_._handleFragmentLoadComplete=function(T){var A=T.frag,L=T.payload,R=A.decryptdata,w=this.hls;if(!this.fragContextChanged(A)&&L&&L.byteLength>0&&R&&R.key&&R.iv&&R.method==="AES-128"){var O=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(L),R.key.buffer,R.iv.buffer).then(function(I){var D=performance.now();w.trigger(n.Events.FRAG_DECRYPTED,{frag:A,payload:I,stats:{tstart:O,tdecrypt:D}})})}},_.doTick=function(){if(!this.media){this.state=f.State.IDLE;return}if(this.state===f.State.IDLE){var T,A=this.currentTrackId,L=this.levels;if(!L.length||!L[A]||!L[A].details)return;var R=L[A].details,w=R.targetduration,O=this.config,I=this.media,D=a.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,I.currentTime-w,O.maxBufferHole),C=D.end,P=D.len,M=this.getMaxBufferLength()+w;if(P>M)return;console.assert(R,"Subtitle track details are defined on idle subtitle stream controller tick");var N=R.fragments,B=N.length,U=R.edge,F,j=this.fragPrevious;if(C<U){var V=O.maxFragLookUpTolerance;F=Object(o.findFragmentByPTS)(j,N,C,V),!F&&j&&j.start<N[0].start&&(F=N[0])}else F=N[B-1];(T=F)!==null&&T!==void 0&&T.encrypted?this.loadKey(F,R):F&&this.fragmentTracker.getState(F)===h.FragmentState.NOT_LOADED&&this.loadFragment(F,R,C)}},_.loadFragment=function(T,A,L){this.fragCurrent=T,y.prototype.loadFragment.call(this,T,A,L)},S(u,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),u}(f.default)},"./src/controller/subtitle-track-controller.ts":function(r,i,t){t.r(i);var n=t("./src/events.ts"),a=t("./src/utils/texttrack-utils.ts"),o=t("./src/controller/base-playlist-controller.ts"),l=t("./src/types/loader.ts");function v(S,x){for(var m=0;m<x.length;m++){var c=x[m];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(S,c.key,c)}}function h(S,x,m){return x&&v(S.prototype,x),m&&v(S,m),S}function f(S,x){S.prototype=Object.create(x.prototype),S.prototype.constructor=S,d(S,x)}function d(S,x){return d=Object.setPrototypeOf||function(c,p){return c.__proto__=p,c},d(S,x)}var g=function(S){f(x,S);function x(c){var p;return p=S.call(this,c,"[subtitle-track-controller]")||this,p.media=null,p.tracks=[],p.groupId=null,p.tracksInGroup=[],p.trackId=-1,p.selectDefaultTrack=!0,p.queuedDefaultTrack=-1,p.trackChangeListener=function(){return p.onTextTracksChanged()},p.asyncPollTrackChange=function(){return p.pollTrackChange(0)},p.useTextTrackPolling=!1,p.subtitlePollingInterval=-1,p.subtitleDisplay=!0,p.registerListeners(),p}var m=x.prototype;return m.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,S.prototype.destroy.call(this)},m.registerListeners=function(){var p=this.hls;p.on(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.on(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.on(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.on(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.on(n.Events.LEVEL_LOADING,this.onLevelLoading,this),p.on(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),p.on(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),p.on(n.Events.ERROR,this.onError,this)},m.unregisterListeners=function(){var p=this.hls;p.off(n.Events.MEDIA_ATTACHED,this.onMediaAttached,this),p.off(n.Events.MEDIA_DETACHING,this.onMediaDetaching,this),p.off(n.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.off(n.Events.MANIFEST_PARSED,this.onManifestParsed,this),p.off(n.Events.LEVEL_LOADING,this.onLevelLoading,this),p.off(n.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),p.off(n.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),p.off(n.Events.ERROR,this.onError,this)},m.onMediaAttached=function(p,y){this.media=y.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},m.pollTrackChange=function(p){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,p)},m.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var p=E(this.media.textTracks);p.forEach(function(y){Object(a.clearCurrentCues)(y)}),this.subtitleTrack=-1,this.media=null}},m.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},m.onManifestParsed=function(p,y){this.tracks=y.subtitleTracks},m.onSubtitleTrackLoaded=function(p,y){var u=y.id,_=y.details,b=this.trackId,T=this.tracksInGroup[b];if(!T){this.warn("Invalid subtitle track id "+u);return}var A=T.details;T.details=y.details,this.log("subtitle track "+u+" loaded ["+_.startSN+"-"+_.endSN+"]"),u===this.trackId&&(this.retryCount=0,this.playlistLoaded(u,y,A))},m.onLevelLoading=function(p,y){this.switchLevel(y.level)},m.onLevelSwitching=function(p,y){this.switchLevel(y.level)},m.switchLevel=function(p){var y=this.hls.levels[p];if(!!(y!=null&&y.textGroupIds)){var u=y.textGroupIds[y.urlId];if(this.groupId!==u){var _=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,b=this.tracks.filter(function(L){return!u||L.groupId===u});this.tracksInGroup=b;var T=this.findTrackId(_==null?void 0:_.name)||this.findTrackId();this.groupId=u;var A={subtitleTracks:b};this.log("Updating subtitle tracks, "+b.length+' track(s) found in "'+u+'" group-id'),this.hls.trigger(n.Events.SUBTITLE_TRACKS_UPDATED,A),T!==-1&&this.setSubtitleTrack(T,_)}}},m.findTrackId=function(p){for(var y=this.tracksInGroup,u=0;u<y.length;u++){var _=y[u];if((!this.selectDefaultTrack||_.default)&&(!p||p===_.name))return _.id}return-1},m.onError=function(p,y){S.prototype.onError.call(this,p,y),!(y.fatal||!y.context)&&y.context.type===l.PlaylistContextType.SUBTITLE_TRACK&&y.context.id===this.trackId&&y.context.groupId===this.groupId&&this.retryLoadingOrFail(y)},m.loadPlaylist=function(p){var y=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(y)){var u=y.id,_=y.groupId,b=y.url;if(p)try{b=p.addDirectives(b)}catch(T){this.warn("Could not construct new URL with HLS Delivery Directives: "+T)}this.log("Loading subtitle playlist for id "+u),this.hls.trigger(n.Events.SUBTITLE_TRACK_LOADING,{url:b,id:u,groupId:_,deliveryDirectives:p||null})}},m.toggleTrackModes=function(p){var y=this,u=this.media,_=this.subtitleDisplay,b=this.trackId;if(!!u){var T=E(u.textTracks),A=T.filter(function(w){return w.groupId===y.groupId});if(p===-1)[].slice.call(T).forEach(function(w){w.mode="disabled"});else{var L=A[b];L&&(L.mode="disabled")}var R=A[p];R&&(R.mode=_?"showing":"hidden")}},m.setSubtitleTrack=function(p,y){var u,_=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=p;return}if(this.trackId!==p&&this.toggleTrackModes(p),!(this.trackId===p&&(p===-1||(u=_[p])!==null&&u!==void 0&&u.details)||p<-1||p>=_.length)){this.clearTimer();var b=_[p];if(this.log("Switching to subtitle track "+p),this.trackId=p,b){var T=b.id,A=b.groupId,L=A===void 0?"":A,R=b.name,w=b.type,O=b.url;this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:T,groupId:L,name:R,type:w,url:O});var I=this.switchParams(b.url,y==null?void 0:y.details);this.loadPlaylist(I)}else this.hls.trigger(n.Events.SUBTITLE_TRACK_SWITCH,{id:p})}},m.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var p=-1,y=E(this.media.textTracks),u=0;u<y.length;u++)if(y[u].mode==="hidden")p=u;else if(y[u].mode==="showing"){p=u;break}this.subtitleTrack!==p&&(this.subtitleTrack=p)}},h(x,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(p){this.selectDefaultTrack=!1;var y=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(p,y)}}]),x}(o.default);function E(S){for(var x=[],m=0;m<S.length;m++){var c=S[m];c.kind==="subtitles"&&c.label&&x.push(S[m])}return x}i.default=g},"./src/controller/timeline-controller.ts":function(r,i,t){t.r(i),t.d(i,"TimelineController",function(){return E});var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/utils/cea-608-parser.ts"),l=t("./src/utils/output-filter.ts"),v=t("./src/utils/webvtt-parser.ts"),h=t("./src/utils/texttrack-utils.ts"),f=t("./src/utils/imsc1-ttml-parser.ts"),d=t("./src/types/loader.ts"),g=t("./src/utils/logger.ts"),E=function(){function c(y){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=m(),this.captionsProperties=void 0,this.hls=y,this.config=y.config,this.Cues=y.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var u=new l.default(this,"textTrack1"),_=new l.default(this,"textTrack2"),b=new l.default(this,"textTrack3"),T=new l.default(this,"textTrack4");this.cea608Parser1=new o.default(1,u,_),this.cea608Parser2=new o.default(3,b,T)}y.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),y.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),y.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),y.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),y.on(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),y.on(a.Events.FRAG_LOADING,this.onFragLoading,this),y.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),y.on(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),y.on(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),y.on(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),y.on(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),y.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var p=c.prototype;return p.destroy=function(){var u=this.hls;u.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),u.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),u.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),u.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),u.off(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),u.off(a.Events.FRAG_LOADING,this.onFragLoading,this),u.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),u.off(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),u.off(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),u.off(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),u.off(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),u.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},p.addCues=function(u,_,b,T,A){for(var L=!1,R=A.length;R--;){var w=A[R],O=x(w[0],w[1],_,b);if(O>=0&&(w[0]=Math.min(w[0],_),w[1]=Math.max(w[1],b),L=!0,O/(b-_)>.5))return}if(L||A.push([_,b]),this.config.renderTextTracksNatively){var I=this.captionsTracks[u];this.Cues.newCue(I,_,b,T)}else{var D=this.Cues.newCue(null,_,b,T);this.hls.trigger(a.Events.CUES_PARSED,{type:"captions",cues:D,track:u})}},p.onInitPtsFound=function(u,_){var b=this,T=_.frag,A=_.id,L=_.initPTS,R=_.timescale,w=this.unparsedVttFrags;A==="main"&&(this.initPTS[T.cc]=L,this.timescale[T.cc]=R),w.length&&(this.unparsedVttFrags=[],w.forEach(function(O){b.onFragLoaded(a.Events.FRAG_LOADED,O)}))},p.getExistingTrack=function(u){var _=this.media;if(_)for(var b=0;b<_.textTracks.length;b++){var T=_.textTracks[b];if(T[u])return T}return null},p.createCaptionsTrack=function(u){this.config.renderTextTracksNatively?this.createNativeTrack(u):this.createNonNativeTrack(u)},p.createNativeTrack=function(u){if(!this.captionsTracks[u]){var _=this.captionsProperties,b=this.captionsTracks,T=this.media,A=_[u],L=A.label,R=A.languageCode,w=this.getExistingTrack(u);if(w)b[u]=w,Object(h.clearCurrentCues)(b[u]),Object(h.sendAddTrackEvent)(b[u],T);else{var O=this.createTextTrack("captions",L,R);O&&(O[u]=!0,b[u]=O)}}},p.createNonNativeTrack=function(u){if(!this.nonNativeCaptionsTracks[u]){var _=this.captionsProperties[u];if(!!_){var b=_.label,T={_id:u,label:b,kind:"captions",default:_.media?!!_.media.default:!1,closedCaptions:_.media};this.nonNativeCaptionsTracks[u]=T,this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[T]})}}},p.createTextTrack=function(u,_,b){var T=this.media;if(!!T)return T.addTextTrack(u,_,b)},p.onMediaAttaching=function(u,_){this.media=_.media,this._cleanTracks()},p.onMediaDetaching=function(){var u=this.captionsTracks;Object.keys(u).forEach(function(_){Object(h.clearCurrentCues)(u[_]),delete u[_]}),this.nonNativeCaptionsTracks={}},p.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=m(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},p._cleanTracks=function(){var u=this.media;if(!!u){var _=u.textTracks;if(_)for(var b=0;b<_.length;b++)Object(h.clearCurrentCues)(_[b])}},p.onSubtitleTracksUpdated=function(u,_){var b=this;this.textTracks=[];var T=_.subtitleTracks||[],A=T.some(function(O){return O.textCodec===f.IMSC1_CODEC});if(this.config.enableWebVTT||A&&this.config.enableIMSC1){var L=this.tracks&&T&&this.tracks.length===T.length;if(this.tracks=T||[],this.config.renderTextTracksNatively){var R=this.media?this.media.textTracks:[];this.tracks.forEach(function(O,I){var D;if(I<R.length){for(var C=null,P=0;P<R.length;P++)if(S(R[P],O)){C=R[P];break}C&&(D=C)}D?Object(h.clearCurrentCues)(D):(D=b.createTextTrack("subtitles",O.name,O.lang),D&&(D.mode="disabled")),D&&(D.groupId=O.groupId,b.textTracks.push(D))})}else if(!L&&this.tracks&&this.tracks.length){var w=this.tracks.map(function(O){return{label:O.name,kind:O.type.toLowerCase(),default:O.default,subtitleTrack:O}});this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:w})}}},p.onManifestLoaded=function(u,_){var b=this;this.config.enableCEA708Captions&&_.captions&&_.captions.forEach(function(T){var A=/(?:CC|SERVICE)([1-4])/.exec(T.instreamId);if(!!A){var L="textTrack"+A[1],R=b.captionsProperties[L];!R||(R.label=T.name,T.lang&&(R.languageCode=T.lang),R.media=T)}})},p.onFragLoading=function(u,_){var b=this.cea608Parser1,T=this.cea608Parser2,A=this.lastSn,L=this.lastPartIndex;if(!(!this.enabled||!(b&&T))&&_.frag.type===d.PlaylistLevelType.MAIN){var R,w,O=_.frag.sn,I=(R=_==null||(w=_.part)===null||w===void 0?void 0:w.index)!=null?R:-1;O===A+1||O===A&&I===L+1||(b.reset(),T.reset()),this.lastSn=O,this.lastPartIndex=I}},p.onFragLoaded=function(u,_){var b=_.frag,T=_.payload,A=this.initPTS,L=this.unparsedVttFrags;if(b.type===d.PlaylistLevelType.SUBTITLE)if(T.byteLength){if(!Object(n.isFiniteNumber)(A[b.cc])){L.push(_),A.length&&this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b,error:new Error("Missing initial subtitle PTS")});return}var R=b.decryptdata,w="stats"in _;if(R==null||R.key==null||R.method!=="AES-128"||w){var O=this.tracks[b.level],I=this.vttCCs;I[b.cc]||(I[b.cc]={start:b.start,prevCC:this.prevCC,new:!0},this.prevCC=b.cc),O&&O.textCodec===f.IMSC1_CODEC?this._parseIMSC1(b,T):this._parseVTTs(b,T,I)}}else this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:b,error:new Error("Empty subtitle payload")})},p._parseIMSC1=function(u,_){var b=this,T=this.hls;Object(f.parseIMSC1)(_,this.initPTS[u.cc],this.timescale[u.cc],function(A){b._appendCues(A,u.level),T.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:u})},function(A){g.logger.log("Failed to parse IMSC1: "+A),T.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:u,error:A})})},p._parseVTTs=function(u,_,b){var T=this,A=this.hls;Object(v.parseWebVTT)(_,this.initPTS[u.cc],this.timescale[u.cc],b,u.cc,u.start,function(L){T._appendCues(L,u.level),A.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:u})},function(L){T._fallbackToIMSC1(u,_),g.logger.log("Failed to parse VTT cue: "+L),A.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:u,error:L})})},p._fallbackToIMSC1=function(u,_){var b=this,T=this.tracks[u.level];T.textCodec||Object(f.parseIMSC1)(_,this.initPTS[u.cc],this.timescale[u.cc],function(){T.textCodec=f.IMSC1_CODEC,b._parseIMSC1(u,_)},function(){T.textCodec="wvtt"})},p._appendCues=function(u,_){var b=this.hls;if(this.config.renderTextTracksNatively){var T=this.textTracks[_];if(T.mode==="disabled")return;u.forEach(function(R){return Object(h.addCueToTrack)(T,R)})}else{var A=this.tracks[_],L=A.default?"default":"subtitles"+_;b.trigger(a.Events.CUES_PARSED,{type:"subtitles",cues:u,track:L})}},p.onFragDecrypted=function(u,_){var b=_.frag;if(b.type===d.PlaylistLevelType.SUBTITLE){if(!Object(n.isFiniteNumber)(this.initPTS[b.cc])){this.unparsedVttFrags.push(_);return}this.onFragLoaded(a.Events.FRAG_LOADED,_)}},p.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},p.onFragParsingUserdata=function(u,_){var b=this.cea608Parser1,T=this.cea608Parser2;if(!(!this.enabled||!(b&&T)))for(var A=0;A<_.samples.length;A++){var L=_.samples[A].bytes;if(L){var R=this.extractCea608Data(L);b.addData(_.samples[A].pts,R[0]),T.addData(_.samples[A].pts,R[1])}}},p.onBufferFlushing=function(u,_){var b=_.startOffset,T=_.endOffset,A=_.endOffsetSubtitles,L=_.type,R=this.media;if(!(!R||R.currentTime<T)){if(!L||L==="video"){var w=this.captionsTracks;Object.keys(w).forEach(function(I){return Object(h.removeCuesInRange)(w[I],b,T)})}if(this.config.renderTextTracksNatively&&b===0&&A!==void 0){var O=this.textTracks;Object.keys(O).forEach(function(I){return Object(h.removeCuesInRange)(O[I],b,A)})}}},p.extractCea608Data=function(u){for(var _=u[0]&31,b=2,T=[[],[]],A=0;A<_;A++){var L=u[b++],R=127&u[b++],w=127&u[b++],O=(4&L)!=0,I=3&L;R===0&&w===0||O&&(I===0||I===1)&&(T[I].push(R),T[I].push(w))}return T},c}();function S(c,p){return c&&c.label===p.name&&!(c.textTrack1||c.textTrack2)}function x(c,p,y,u){return Math.min(p,u)-Math.max(c,y)}function m(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(l,v){this.subtle=void 0,this.aesIV=void 0,this.subtle=l,this.aesIV=v}var o=a.prototype;return o.decrypt=function(v,h){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},h,v)},a}()},"./src/crypt/aes-decryptor.ts":function(r,i,t){t.r(i),t.d(i,"removePadding",function(){return a}),t.d(i,"default",function(){return o});var n=t("./src/utils/typed-array.ts");function a(l){var v=l.byteLength,h=v&&new DataView(l.buffer).getUint8(v-1);return h?Object(n.sliceUint8)(l,0,v-h):l}var o=function(){function l(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var v=l.prototype;return v.uint8ArrayToUint32Array_=function(f){for(var d=new DataView(f),g=new Uint32Array(4),E=0;E<4;E++)g[E]=d.getUint32(E*4);return g},v.initTable=function(){var f=this.sBox,d=this.invSBox,g=this.subMix,E=g[0],S=g[1],x=g[2],m=g[3],c=this.invSubMix,p=c[0],y=c[1],u=c[2],_=c[3],b=new Uint32Array(256),T=0,A=0,L=0;for(L=0;L<256;L++)L<128?b[L]=L<<1:b[L]=L<<1^283;for(L=0;L<256;L++){var R=A^A<<1^A<<2^A<<3^A<<4;R=R>>>8^R&255^99,f[T]=R,d[R]=T;var w=b[T],O=b[w],I=b[O],D=b[R]*257^R*16843008;E[T]=D<<24|D>>>8,S[T]=D<<16|D>>>16,x[T]=D<<8|D>>>24,m[T]=D,D=I*16843009^O*65537^w*257^T*16843008,p[R]=D<<24|D>>>8,y[R]=D<<16|D>>>16,u[R]=D<<8|D>>>24,_[R]=D,T?(T=w^b[b[b[I^w]]],A^=b[b[A]]):T=A=1}},v.expandKey=function(f){for(var d=this.uint8ArrayToUint32Array_(f),g=!0,E=0;E<d.length&&g;)g=d[E]===this.key[E],E++;if(!g){this.key=d;var S=this.keySize=d.length;if(S!==4&&S!==6&&S!==8)throw new Error("Invalid aes key size="+S);var x=this.ksRows=(S+6+1)*4,m,c,p=this.keySchedule=new Uint32Array(x),y=this.invKeySchedule=new Uint32Array(x),u=this.sBox,_=this.rcon,b=this.invSubMix,T=b[0],A=b[1],L=b[2],R=b[3],w,O;for(m=0;m<x;m++){if(m<S){w=p[m]=d[m];continue}O=w,m%S==0?(O=O<<8|O>>>24,O=u[O>>>24]<<24|u[O>>>16&255]<<16|u[O>>>8&255]<<8|u[O&255],O^=_[m/S|0]<<24):S>6&&m%S==4&&(O=u[O>>>24]<<24|u[O>>>16&255]<<16|u[O>>>8&255]<<8|u[O&255]),p[m]=w=(p[m-S]^O)>>>0}for(c=0;c<x;c++)m=x-c,c&3?O=p[m]:O=p[m-4],c<4||m<=4?y[c]=O:y[c]=T[u[O>>>24]]^A[u[O>>>16&255]]^L[u[O>>>8&255]]^R[u[O&255]],y[c]=y[c]>>>0}},v.networkToHostOrderSwap=function(f){return f<<24|(f&65280)<<8|(f&16711680)>>8|f>>>24},v.decrypt=function(f,d,g){for(var E=this.keySize+6,S=this.invKeySchedule,x=this.invSBox,m=this.invSubMix,c=m[0],p=m[1],y=m[2],u=m[3],_=this.uint8ArrayToUint32Array_(g),b=_[0],T=_[1],A=_[2],L=_[3],R=new Int32Array(f),w=new Int32Array(R.length),O,I,D,C,P,M,N,B,U,F,j,V,G,Y,X=this.networkToHostOrderSwap;d<R.length;){for(U=X(R[d]),F=X(R[d+1]),j=X(R[d+2]),V=X(R[d+3]),P=U^S[0],M=V^S[1],N=j^S[2],B=F^S[3],G=4,Y=1;Y<E;Y++)O=c[P>>>24]^p[M>>16&255]^y[N>>8&255]^u[B&255]^S[G],I=c[M>>>24]^p[N>>16&255]^y[B>>8&255]^u[P&255]^S[G+1],D=c[N>>>24]^p[B>>16&255]^y[P>>8&255]^u[M&255]^S[G+2],C=c[B>>>24]^p[P>>16&255]^y[M>>8&255]^u[N&255]^S[G+3],P=O,M=I,N=D,B=C,G=G+4;O=x[P>>>24]<<24^x[M>>16&255]<<16^x[N>>8&255]<<8^x[B&255]^S[G],I=x[M>>>24]<<24^x[N>>16&255]<<16^x[B>>8&255]<<8^x[P&255]^S[G+1],D=x[N>>>24]<<24^x[B>>16&255]<<16^x[P>>8&255]<<8^x[M&255]^S[G+2],C=x[B>>>24]<<24^x[P>>16&255]<<16^x[M>>8&255]<<8^x[N&255]^S[G+3],w[d]=X(O^b),w[d+1]=X(C^T),w[d+2]=X(D^A),w[d+3]=X(I^L),b=U,T=F,A=j,L=V,d=d+4}return w.buffer},l}()},"./src/crypt/decrypter.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return d});var n=t("./src/crypt/aes-crypto.ts"),a=t("./src/crypt/fast-aes-key.ts"),o=t("./src/crypt/aes-decryptor.ts"),l=t("./src/utils/logger.ts"),v=t("./src/utils/mp4-tools.ts"),h=t("./src/utils/typed-array.ts"),f=16,d=function(){function g(S,x,m){var c=m===void 0?{}:m,p=c.removePKCS7Padding,y=p===void 0?!0:p;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=S,this.config=x,this.removePKCS7Padding=y,y)try{var u=self.crypto;u&&(this.subtle=u.subtle||u.webkitSubtle)}catch(_){}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var E=g.prototype;return E.destroy=function(){this.observer=null},E.isSync=function(){return this.config.enableSoftwareAES},E.flush=function(){var x=this.currentResult;if(!x){this.reset();return}var m=new Uint8Array(x);return this.reset(),this.removePKCS7Padding?Object(o.removePadding)(m):m},E.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},E.decrypt=function(x,m,c,p){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(x),m,c);var y=this.flush();y&&p(y.buffer)}else this.webCryptoDecrypt(new Uint8Array(x),m,c).then(p)},E.softwareDecrypt=function(x,m,c){var p=this.currentIV,y=this.currentResult,u=this.remainderData;this.logOnce("JS AES decrypt"),u&&(x=Object(v.appendUint8Array)(u,x),this.remainderData=null);var _=this.getValidChunk(x);if(!_.length)return null;p&&(c=p);var b=this.softwareDecrypter;b||(b=this.softwareDecrypter=new o.default),b.expandKey(m);var T=y;return this.currentResult=b.decrypt(_.buffer,0,c),this.currentIV=Object(h.sliceUint8)(_,-16).buffer,T||null},E.webCryptoDecrypt=function(x,m,c){var p=this,y=this.subtle;return(this.key!==m||!this.fastAesKey)&&(this.key=m,this.fastAesKey=new a.default(y,m)),this.fastAesKey.expandKey().then(function(u){if(!y)return Promise.reject(new Error("web crypto not initialized"));var _=new n.default(y,c);return _.decrypt(x.buffer,u)}).catch(function(u){return p.onWebCryptoError(u,x,m,c)})},E.onWebCryptoError=function(x,m,c,p){return l.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",x),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(m,c,p)},E.getValidChunk=function(x){var m=x,c=x.length-x.length%f;return c!==x.length&&(m=Object(h.sliceUint8)(x,0,c),this.remainderData=Object(h.sliceUint8)(x,c)),m},E.logOnce=function(x){!this.logEnabled||(l.logger.log("[decrypter.ts]: "+x),this.logEnabled=!1)},g}()},"./src/crypt/fast-aes-key.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(l,v){this.subtle=void 0,this.key=void 0,this.subtle=l,this.key=v}var o=a.prototype;return o.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},a}()},"./src/demux/aacdemuxer.ts":function(r,i,t){t.r(i);var n=t("./src/demux/base-audio-demuxer.ts"),a=t("./src/demux/adts.ts"),o=t("./src/utils/logger.ts"),l=t("./src/demux/id3.ts");function v(d,g){d.prototype=Object.create(g.prototype),d.prototype.constructor=d,h(d,g)}function h(d,g){return h=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},h(d,g)}var f=function(d){v(g,d);function g(S,x){var m;return m=d.call(this)||this,m.observer=void 0,m.config=void 0,m.observer=S,m.config=x,m}var E=g.prototype;return E.resetInitSegment=function(x,m,c){d.prototype.resetInitSegment.call(this,x,m,c),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:x,duration:c,inputTimeScale:9e4,dropped:0}},g.probe=function(x){if(!x)return!1;for(var m=l.getID3Data(x,0)||[],c=m.length,p=x.length;c<p;c++)if(a.probe(x,c))return o.logger.log("ADTS sync word found !"),!0;return!1},E.canParse=function(x,m){return a.canParse(x,m)},E.appendFrame=function(x,m,c){a.initTrackConfig(x,this.observer,m,c,x.manifestCodec);var p=a.appendFrame(x,m,c,this.initPTS,this.frameIndex);if(p&&p.missing===0)return p},g}(n.default);f.minProbeByteLength=9,i.default=f},"./src/demux/adts.ts":function(r,i,t){t.r(i),t.d(i,"getAudioConfig",function(){return l}),t.d(i,"isHeaderPattern",function(){return v}),t.d(i,"getHeaderLength",function(){return h}),t.d(i,"getFullFrameLength",function(){return f}),t.d(i,"canGetFrameLength",function(){return d}),t.d(i,"isHeader",function(){return g}),t.d(i,"canParse",function(){return E}),t.d(i,"probe",function(){return S}),t.d(i,"initTrackConfig",function(){return x}),t.d(i,"getFrameDuration",function(){return m}),t.d(i,"parseFrameHeader",function(){return c}),t.d(i,"appendFrame",function(){return p});var n=t("./src/utils/logger.ts"),a=t("./src/errors.ts"),o=t("./src/events.ts");function l(y,u,_,b){var T,A,L,R,w=navigator.userAgent.toLowerCase(),O=b,I=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];T=((u[_+2]&192)>>>6)+1;var D=(u[_+2]&60)>>>2;if(D>I.length-1){y.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+D});return}return L=(u[_+2]&1)<<2,L|=(u[_+3]&192)>>>6,n.logger.log("manifest codec:"+b+", ADTS type:"+T+", samplingIndex:"+D),/firefox/i.test(w)?D>=6?(T=5,R=new Array(4),A=D-3):(T=2,R=new Array(2),A=D):w.indexOf("android")!==-1?(T=2,R=new Array(2),A=D):(T=5,R=new Array(4),b&&(b.indexOf("mp4a.40.29")!==-1||b.indexOf("mp4a.40.5")!==-1)||!b&&D>=6?A=D-3:((b&&b.indexOf("mp4a.40.2")!==-1&&(D>=6&&L===1||/vivaldi/i.test(w))||!b&&L===1)&&(T=2,R=new Array(2)),A=D)),R[0]=T<<3,R[0]|=(D&14)>>1,R[1]|=(D&1)<<7,R[1]|=L<<3,T===5&&(R[1]|=(A&14)>>1,R[2]=(A&1)<<7,R[2]|=2<<2,R[3]=0),{config:R,samplerate:I[D],channelCount:L,codec:"mp4a.40."+T,manifestCodec:O}}function v(y,u){return y[u]===255&&(y[u+1]&246)==240}function h(y,u){return y[u+1]&1?7:9}function f(y,u){return(y[u+3]&3)<<11|y[u+4]<<3|(y[u+5]&224)>>>5}function d(y,u){return u+5<y.length}function g(y,u){return u+1<y.length&&v(y,u)}function E(y,u){return d(y,u)&&v(y,u)&&f(y,u)<=y.length-u}function S(y,u){if(g(y,u)){var _=h(y,u);if(u+_>=y.length)return!1;var b=f(y,u);if(b<=_)return!1;var T=u+b;return T===y.length||g(y,T)}return!1}function x(y,u,_,b,T){if(!y.samplerate){var A=l(u,_,b,T);if(!A)return;y.config=A.config,y.samplerate=A.samplerate,y.channelCount=A.channelCount,y.codec=A.codec,y.manifestCodec=A.manifestCodec,n.logger.log("parsed codec:"+y.codec+", rate:"+A.samplerate+", channels:"+A.channelCount)}}function m(y){return 1024*9e4/y}function c(y,u,_,b,T){var A=h(y,u),L=f(y,u);if(L-=A,L>0){var R=_+b*T;return{headerLength:A,frameLength:L,stamp:R}}}function p(y,u,_,b,T){var A=m(y.samplerate),L=c(u,_,b,T,A);if(L){var R=L.frameLength,w=L.headerLength,O=L.stamp,I=w+R,D=Math.max(0,_+I-u.length),C;D?(C=new Uint8Array(I-w),C.set(u.subarray(_+w,u.length),0)):C=u.subarray(_+w,_+I);var P={unit:C,pts:O};return D||y.samples.push(P),{sample:P,length:I,missing:D}}}},"./src/demux/base-audio-demuxer.ts":function(r,i,t){t.r(i),t.d(i,"initPTSFn",function(){return f});var n=t("./src/polyfills/number.ts"),a=t("./src/demux/id3.ts"),o=t("./src/demux/dummy-demuxed-track.ts"),l=t("./src/utils/mp4-tools.ts"),v=t("./src/utils/typed-array.ts"),h=function(){function d(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var g=d.prototype;return g.resetInitSegment=function(S,x,m){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},g.resetTimeStamp=function(){},g.resetContiguity=function(){},g.canParse=function(S,x){return!1},g.appendFrame=function(S,x,m){},g.demux=function(S,x){this.cachedData&&(S=Object(l.appendUint8Array)(this.cachedData,S),this.cachedData=null);var m=a.getID3Data(S,0),c=m?m.length:0,p,y,u=this._audioTrack,_=this._id3Track,b=m?a.getTimeStamp(m):void 0,T=S.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=f(b,x)),m&&m.length>0&&_.samples.push({pts:this.initPTS,dts:this.initPTS,data:m}),y=this.initPTS;c<T;){if(this.canParse(S,c)){var A=this.appendFrame(u,S,c);A?(this.frameIndex++,y=A.sample.pts,c+=A.length,p=c):c=T}else a.canParse(S,c)?(m=a.getID3Data(S,c),_.samples.push({pts:y,dts:y,data:m}),c+=m.length,p=c):c++;if(c===T&&p!==T){var L=Object(v.sliceUint8)(S,p);this.cachedData?this.cachedData=Object(l.appendUint8Array)(this.cachedData,L):this.cachedData=L}}return{audioTrack:u,avcTrack:Object(o.dummyTrack)(),id3Track:_,textTrack:Object(o.dummyTrack)()}},g.demuxSampleAes=function(S,x,m){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},g.flush=function(S){var x=this.cachedData;return x&&(this.cachedData=null,this.demux(x,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(o.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(o.dummyTrack)()}},g.destroy=function(){},d}(),f=function(g,E){return Object(n.isFiniteNumber)(g)?g*90:E*9e4};i.default=h},"./src/demux/chunk-cache.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function o(){this.chunks=[],this.dataLength=0}var l=o.prototype;return l.push=function(h){this.chunks.push(h),this.dataLength+=h.length},l.flush=function(){var h=this.chunks,f=this.dataLength,d;if(h.length)h.length===1?d=h[0]:d=a(h,f);else return new Uint8Array(0);return this.reset(),d},l.reset=function(){this.chunks.length=0,this.dataLength=0},o}();function a(o,l){for(var v=new Uint8Array(l),h=0,f=0;f<o.length;f++){var d=o[f];v.set(d,h),h+=d.length}return v}},"./src/demux/dummy-demuxed-track.ts":function(r,i,t){t.r(i),t.d(i,"dummyTrack",function(){return n});function n(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(r,i,t){t.r(i);var n=t("./src/utils/logger.ts"),a=function(){function o(v){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=v,this.bytesAvailable=v.byteLength,this.word=0,this.bitsAvailable=0}var l=o.prototype;return l.loadWord=function(){var h=this.data,f=this.bytesAvailable,d=h.byteLength-f,g=new Uint8Array(4),E=Math.min(4,f);if(E===0)throw new Error("no bytes available");g.set(h.subarray(d,d+E)),this.word=new DataView(g.buffer).getUint32(0),this.bitsAvailable=E*8,this.bytesAvailable-=E},l.skipBits=function(h){var f;this.bitsAvailable>h?(this.word<<=h,this.bitsAvailable-=h):(h-=this.bitsAvailable,f=h>>3,h-=f>>3,this.bytesAvailable-=f,this.loadWord(),this.word<<=h,this.bitsAvailable-=h)},l.readBits=function(h){var f=Math.min(this.bitsAvailable,h),d=this.word>>>32-f;return h>32&&n.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=f,this.bitsAvailable>0?this.word<<=f:this.bytesAvailable>0&&this.loadWord(),f=h-f,f>0&&this.bitsAvailable?d<<f|this.readBits(f):d},l.skipLZ=function(){var h;for(h=0;h<this.bitsAvailable;++h)if((this.word&2147483648>>>h)!=0)return this.word<<=h,this.bitsAvailable-=h,h;return this.loadWord(),h+this.skipLZ()},l.skipUEG=function(){this.skipBits(1+this.skipLZ())},l.skipEG=function(){this.skipBits(1+this.skipLZ())},l.readUEG=function(){var h=this.skipLZ();return this.readBits(h+1)-1},l.readEG=function(){var h=this.readUEG();return 1&h?1+h>>>1:-1*(h>>>1)},l.readBoolean=function(){return this.readBits(1)===1},l.readUByte=function(){return this.readBits(8)},l.readUShort=function(){return this.readBits(16)},l.readUInt=function(){return this.readBits(32)},l.skipScalingList=function(h){for(var f=8,d=8,g,E=0;E<h;E++)d!==0&&(g=this.readEG(),d=(f+g+256)%256),f=d===0?f:d},l.readSPS=function(){var h=0,f=0,d=0,g=0,E,S,x,m=this.readUByte.bind(this),c=this.readBits.bind(this),p=this.readUEG.bind(this),y=this.readBoolean.bind(this),u=this.skipBits.bind(this),_=this.skipEG.bind(this),b=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);m();var A=m();if(c(5),u(3),m(),b(),A===100||A===110||A===122||A===244||A===44||A===83||A===86||A===118||A===128){var L=p();if(L===3&&u(1),b(),b(),u(1),y())for(S=L!==3?8:12,x=0;x<S;x++)y()&&(x<6?T(16):T(64))}b();var R=p();if(R===0)p();else if(R===1)for(u(1),_(),_(),E=p(),x=0;x<E;x++)_();b(),u(1);var w=p(),O=p(),I=c(1);I===0&&u(1),u(1),y()&&(h=p(),f=p(),d=p(),g=p());var D=[1,1];if(y()&&y()){var C=m();switch(C){case 1:D=[1,1];break;case 2:D=[12,11];break;case 3:D=[10,11];break;case 4:D=[16,11];break;case 5:D=[40,33];break;case 6:D=[24,11];break;case 7:D=[20,11];break;case 8:D=[32,11];break;case 9:D=[80,33];break;case 10:D=[18,11];break;case 11:D=[15,11];break;case 12:D=[64,33];break;case 13:D=[160,99];break;case 14:D=[4,3];break;case 15:D=[3,2];break;case 16:D=[2,1];break;case 255:{D=[m()<<8|m(),m()<<8|m()];break}}}return{width:Math.ceil((w+1)*16-h*2-f*2),height:(2-I)*(O+1)*16-(I?2:4)*(d+g),pixelRatio:D}},l.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},o}();i.default=a},"./src/demux/id3.ts":function(r,i,t){t.r(i),t.d(i,"isHeader",function(){return n}),t.d(i,"isFooter",function(){return a}),t.d(i,"getID3Data",function(){return o}),t.d(i,"canParse",function(){return v}),t.d(i,"getTimeStamp",function(){return h}),t.d(i,"isTimeStampFrame",function(){return f}),t.d(i,"getID3Frames",function(){return g}),t.d(i,"decodeFrame",function(){return E}),t.d(i,"utf8ArrayToStr",function(){return p}),t.d(i,"testables",function(){return y});var n=function(T,A){return A+10<=T.length&&T[A]===73&&T[A+1]===68&&T[A+2]===51&&T[A+3]<255&&T[A+4]<255&&T[A+6]<128&&T[A+7]<128&&T[A+8]<128&&T[A+9]<128},a=function(T,A){return A+10<=T.length&&T[A]===51&&T[A+1]===68&&T[A+2]===73&&T[A+3]<255&&T[A+4]<255&&T[A+6]<128&&T[A+7]<128&&T[A+8]<128&&T[A+9]<128},o=function(T,A){for(var L=A,R=0;n(T,A);){R+=10;var w=l(T,A+6);R+=w,a(T,A+10)&&(R+=10),A+=R}if(R>0)return T.subarray(L,L+R)},l=function(T,A){var L=0;return L=(T[A]&127)<<21,L|=(T[A+1]&127)<<14,L|=(T[A+2]&127)<<7,L|=T[A+3]&127,L},v=function(T,A){return n(T,A)&&l(T,A+6)+10<=T.length-A},h=function(T){for(var A=g(T),L=0;L<A.length;L++){var R=A[L];if(f(R))return c(R)}},f=function(T){return T&&T.key==="PRIV"&&T.info==="com.apple.streaming.transportStreamTimestamp"},d=function(T){var A=String.fromCharCode(T[0],T[1],T[2],T[3]),L=l(T,4),R=10;return{type:A,size:L,data:T.subarray(R,R+L)}},g=function(T){for(var A=0,L=[];n(T,A);){var R=l(T,A+6);A+=10;for(var w=A+R;A+8<w;){var O=d(T.subarray(A)),I=E(O);I&&L.push(I),A+=O.size+10}a(T,A)&&(A+=10)}return L},E=function(T){return T.type==="PRIV"?S(T):T.type[0]==="W"?m(T):x(T)},S=function(T){if(!(T.size<2)){var A=p(T.data,!0),L=new Uint8Array(T.data.subarray(A.length+1));return{key:T.type,info:A,data:L.buffer}}},x=function(T){if(!(T.size<2)){if(T.type==="TXXX"){var A=1,L=p(T.data.subarray(A),!0);A+=L.length+1;var R=p(T.data.subarray(A));return{key:T.type,info:L,data:R}}var w=p(T.data.subarray(1));return{key:T.type,data:w}}},m=function(T){if(T.type==="WXXX"){if(T.size<2)return;var A=1,L=p(T.data.subarray(A),!0);A+=L.length+1;var R=p(T.data.subarray(A));return{key:T.type,info:L,data:R}}var w=p(T.data);return{key:T.type,data:w}},c=function(T){if(T.data.byteLength===8){var A=new Uint8Array(T.data),L=A[3]&1,R=(A[4]<<23)+(A[5]<<15)+(A[6]<<7)+A[7];return R/=45,L&&(R+=4772185884e-2),Math.round(R)}},p=function(T,A){A===void 0&&(A=!1);var L=_();if(L){var R=L.decode(T);if(A){var w=R.indexOf("\0");return w!==-1?R.substring(0,w):R}return R.replace(/\0/g,"")}for(var O=T.length,I,D,C,P="",M=0;M<O;){if(I=T[M++],I===0&&A)return P;if(I===0||I===3)continue;switch(I>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:P+=String.fromCharCode(I);break;case 12:case 13:D=T[M++],P+=String.fromCharCode((I&31)<<6|D&63);break;case 14:D=T[M++],C=T[M++],P+=String.fromCharCode((I&15)<<12|(D&63)<<6|(C&63)<<0);break}}return P},y={decodeTextFrame:x},u;function _(){return!u&&typeof self.TextDecoder!="undefined"&&(u=new self.TextDecoder("utf-8")),u}},"./src/demux/mp3demuxer.ts":function(r,i,t){t.r(i);var n=t("./src/demux/base-audio-demuxer.ts"),a=t("./src/demux/id3.ts"),o=t("./src/utils/logger.ts"),l=t("./src/demux/mpegaudio.ts");function v(d,g){d.prototype=Object.create(g.prototype),d.prototype.constructor=d,h(d,g)}function h(d,g){return h=Object.setPrototypeOf||function(S,x){return S.__proto__=x,S},h(d,g)}var f=function(d){v(g,d);function g(){return d.apply(this,arguments)||this}var E=g.prototype;return E.resetInitSegment=function(x,m,c){d.prototype.resetInitSegment.call(this,x,m,c),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:x,duration:c,inputTimeScale:9e4,dropped:0}},g.probe=function(x){if(!x)return!1;for(var m=a.getID3Data(x,0)||[],c=m.length,p=x.length;c<p;c++)if(l.probe(x,c))return o.logger.log("MPEG Audio sync word found !"),!0;return!1},E.canParse=function(x,m){return l.canParse(x,m)},E.appendFrame=function(x,m,c){if(this.initPTS!==null)return l.appendFrame(x,m,c,this.initPTS,this.frameIndex)},g}(n.default);f.minProbeByteLength=4,i.default=f},"./src/demux/mp4demuxer.ts":function(r,i,t){t.r(i);var n=t("./src/utils/mp4-tools.ts"),a=t("./src/demux/dummy-demuxed-track.ts"),o=function(){function l(h,f){this.remainderData=null,this.config=void 0,this.config=f}var v=l.prototype;return v.resetTimeStamp=function(){},v.resetInitSegment=function(){},v.resetContiguity=function(){},l.probe=function(f){return Object(n.findBox)({data:f,start:0,end:Math.min(f.length,16384)},["moof"]).length>0},v.demux=function(f){var d=f,g=Object(a.dummyTrack)();if(this.config.progressive){this.remainderData&&(d=Object(n.appendUint8Array)(this.remainderData,f));var E=Object(n.segmentValidRange)(d);this.remainderData=E.remainder,g.samples=E.valid||new Uint8Array}else g.samples=d;return{audioTrack:Object(a.dummyTrack)(),avcTrack:g,id3Track:Object(a.dummyTrack)(),textTrack:Object(a.dummyTrack)()}},v.flush=function(){var f=Object(a.dummyTrack)();return f.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(a.dummyTrack)(),avcTrack:f,id3Track:Object(a.dummyTrack)(),textTrack:Object(a.dummyTrack)()}},v.demuxSampleAes=function(f,d,g){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},v.destroy=function(){},l}();o.minProbeByteLength=1024,i.default=o},"./src/demux/mpegaudio.ts":function(r,i,t){t.r(i),t.d(i,"appendFrame",function(){return h}),t.d(i,"parseHeader",function(){return f}),t.d(i,"isHeaderPattern",function(){return d}),t.d(i,"isHeader",function(){return g}),t.d(i,"canParse",function(){return E}),t.d(i,"probe",function(){return S});var n=null,a=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],o=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],l=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],v=[0,1,1,4];function h(x,m,c,p,y){if(!(c+24>m.length)){var u=f(m,c);if(u&&c+u.frameLength<=m.length){var _=u.samplesPerFrame*9e4/u.sampleRate,b=p+y*_,T={unit:m.subarray(c,c+u.frameLength),pts:b,dts:b};return x.config=[],x.channelCount=u.channelCount,x.samplerate=u.sampleRate,x.samples.push(T),{sample:T,length:u.frameLength,missing:0}}}}function f(x,m){var c=x[m+1]>>3&3,p=x[m+1]>>1&3,y=x[m+2]>>4&15,u=x[m+2]>>2&3;if(c!==1&&y!==0&&y!==15&&u!==3){var _=x[m+2]>>1&1,b=x[m+3]>>6,T=c===3?3-p:p===3?3:4,A=a[T*14+y-1]*1e3,L=c===3?0:c===2?1:2,R=o[L*3+u],w=b===3?1:2,O=l[c][p],I=v[p],D=O*8*I,C=Math.floor(O*A/R+_)*I;if(n===null){var P=navigator.userAgent||"",M=P.match(/Chrome\/(\d+)/i);n=M?parseInt(M[1]):0}var N=!!n&&n<=87;return N&&p===2&&A>=224e3&&b===0&&(x[m+3]=x[m+3]|128),{sampleRate:R,channelCount:w,frameLength:C,samplesPerFrame:D}}}function d(x,m){return x[m]===255&&(x[m+1]&224)==224&&(x[m+1]&6)!=0}function g(x,m){return m+1<x.length&&d(x,m)}function E(x,m){var c=4;return d(x,m)&&c<=x.length-m}function S(x,m){if(m+1<x.length&&d(x,m)){var c=4,p=f(x,m),y=c;p!=null&&p.frameLength&&(y=p.frameLength);var u=m+y;return u===x.length||g(x,u)}return!1}},"./src/demux/sample-aes.ts":function(r,i,t){t.r(i);var n=t("./src/crypt/decrypter.ts"),a=t("./src/demux/tsdemuxer.ts"),o=function(){function l(h,f,d){this.keyData=void 0,this.decrypter=void 0,this.keyData=d,this.decrypter=new n.default(h,f,{removePKCS7Padding:!1})}var v=l.prototype;return v.decryptBuffer=function(f,d){this.decrypter.decrypt(f,this.keyData.key.buffer,this.keyData.iv.buffer,d)},v.decryptAacSample=function(f,d,g,E){var S=f[d].unit,x=S.subarray(16,S.length-S.length%16),m=x.buffer.slice(x.byteOffset,x.byteOffset+x.length),c=this;this.decryptBuffer(m,function(p){var y=new Uint8Array(p);S.set(y,16),E||c.decryptAacSamples(f,d+1,g)})},v.decryptAacSamples=function(f,d,g){for(;;d++){if(d>=f.length){g();return}if(!(f[d].unit.length<32)){var E=this.decrypter.isSync();if(this.decryptAacSample(f,d,g,E),!E)return}}},v.getAvcEncryptedData=function(f){for(var d=Math.floor((f.length-48)/160)*16+16,g=new Int8Array(d),E=0,S=32;S<f.length-16;S+=160,E+=16)g.set(f.subarray(S,S+16),E);return g},v.getAvcDecryptedUnit=function(f,d){for(var g=new Uint8Array(d),E=0,S=32;S<f.length-16;S+=160,E+=16)f.set(g.subarray(E,E+16),S);return f},v.decryptAvcSample=function(f,d,g,E,S,x){var m=Object(a.discardEPB)(S.data),c=this.getAvcEncryptedData(m),p=this;this.decryptBuffer(c.buffer,function(y){S.data=p.getAvcDecryptedUnit(m,y),x||p.decryptAvcSamples(f,d,g+1,E)})},v.decryptAvcSamples=function(f,d,g,E){if(f instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;d++,g=0){if(d>=f.length){E();return}for(var S=f[d].units;!(g>=S.length);g++){var x=S[g];if(!(x.data.length<=48||x.type!==1&&x.type!==5)){var m=this.decrypter.isSync();if(this.decryptAvcSample(f,d,g,E,x,m),!m)return}}}},l}();i.default=o},"./src/demux/transmuxer-interface.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return g});var n=t("./node_modules/webworkify-webpack/index.js"),a=t("./src/events.ts"),o=t("./src/demux/transmuxer.ts"),l=t("./src/utils/logger.ts"),v=t("./src/errors.ts"),h=t("./src/utils/mediasource-helper.ts"),f=t("./node_modules/eventemitter3/index.js"),d=Object(h.getMediaSource)()||{isTypeSupported:function(){return!1}},g=function(){function E(x,m,c,p){var y=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=x,this.id=m,this.onTransmuxComplete=c,this.onFlush=p;var u=x.config,_=function(R,w){w=w||{},w.frag=y.frag,w.id=y.id,x.trigger(R,w)};this.observer=new f.EventEmitter,this.observer.on(a.Events.FRAG_DECRYPTED,_),this.observer.on(a.Events.ERROR,_);var b={mp4:d.isTypeSupported("video/mp4"),mpeg:d.isTypeSupported("audio/mpeg"),mp3:d.isTypeSupported('audio/mp4; codecs="mp3"')},T=navigator.vendor;if(u.enableWorker&&typeof Worker!="undefined"){l.logger.log("demuxing in webworker");var A;try{A=this.worker=n("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),A.addEventListener("message",this.onwmsg),A.onerror=function(L){x.trigger(a.Events.ERROR,{type:v.ErrorTypes.OTHER_ERROR,details:v.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(L.message+"  ("+L.filename+":"+L.lineno+")")})},A.postMessage({cmd:"init",typeSupported:b,vendor:T,id:m,config:JSON.stringify(u)})}catch(L){l.logger.warn("Error in worker:",L),l.logger.error("Error while initializing DemuxerWorker, fallback to inline"),A&&self.URL.revokeObjectURL(A.objectURL),this.transmuxer=new o.default(this.observer,b,u,T,m),this.worker=null}}else this.transmuxer=new o.default(this.observer,b,u,T,m)}var S=E.prototype;return S.destroy=function(){var m=this.worker;if(m)m.removeEventListener("message",this.onwmsg),m.terminate(),this.worker=null;else{var c=this.transmuxer;c&&(c.destroy(),this.transmuxer=null)}var p=this.observer;p&&p.removeAllListeners(),this.observer=null},S.push=function(m,c,p,y,u,_,b,T,A,L){var R,w,O=this;A.transmuxing.start=self.performance.now();var I=this.transmuxer,D=this.worker,C=_?_.start:u.start,P=u.decryptdata,M=this.frag,N=!(M&&u.cc===M.cc),B=!(M&&A.level===M.level),U=M?A.sn-M.sn:-1,F=this.part?A.part-this.part.index:1,j=!B&&(U===1||U===0&&F===1),V=self.performance.now();(B||U||u.stats.parsing.start===0)&&(u.stats.parsing.start=V),_&&(F||!j)&&(_.stats.parsing.start=V);var G=!(M&&((R=u.initSegment)===null||R===void 0?void 0:R.url)===((w=M.initSegment)===null||w===void 0?void 0:w.url)),Y=new o.TransmuxState(N,j,T,B,C,G);if(!j||N||G){l.logger.log("[transmuxer-interface, "+u.type+"]: Starting new transmux session for sn: "+A.sn+" p: "+A.part+" level: "+A.level+" id: "+A.id+`
        discontinuity: `+N+`
        trackSwitch: `+B+`
        contiguous: `+j+`
        accurateTimeOffset: `+T+`
        timeOffset: `+C+`
        initSegmentChange: `+G);var X=new o.TransmuxConfig(p,y,c,b,L);this.configureTransmuxer(X)}if(this.frag=u,this.part=_,D)D.postMessage({cmd:"demux",data:m,decryptdata:P,chunkMeta:A,state:Y},m instanceof ArrayBuffer?[m]:[]);else if(I){var ie=I.push(m,P,A,Y);Object(o.isPromise)(ie)?ie.then(function(he){O.handleTransmuxComplete(he)}):this.handleTransmuxComplete(ie)}},S.flush=function(m){var c=this;m.transmuxing.start=self.performance.now();var p=this.transmuxer,y=this.worker;if(y)y.postMessage({cmd:"flush",chunkMeta:m});else if(p){var u=p.flush(m);Object(o.isPromise)(u)?u.then(function(_){c.handleFlushResult(_,m)}):this.handleFlushResult(u,m)}},S.handleFlushResult=function(m,c){var p=this;m.forEach(function(y){p.handleTransmuxComplete(y)}),this.onFlush(c)},S.onWorkerMessage=function(m){var c=m.data,p=this.hls;switch(c.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(c.data);break}case"flush":{this.onFlush(c.data);break}default:{c.data=c.data||{},c.data.frag=this.frag,c.data.id=this.id,p.trigger(c.event,c.data);break}}},S.configureTransmuxer=function(m){var c=this.worker,p=this.transmuxer;c?c.postMessage({cmd:"configure",config:m}):p&&p.configure(m)},S.handleTransmuxComplete=function(m){m.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(m)},E}()},"./src/demux/transmuxer-worker.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return v});var n=t("./src/demux/transmuxer.ts"),a=t("./src/events.ts"),o=t("./src/utils/logger.ts"),l=t("./node_modules/eventemitter3/index.js");function v(E){var S=new l.EventEmitter,x=function(c,p){E.postMessage({event:c,data:p})};S.on(a.Events.FRAG_DECRYPTED,x),S.on(a.Events.ERROR,x),E.addEventListener("message",function(m){var c=m.data;switch(c.cmd){case"init":{var p=JSON.parse(c.config);E.transmuxer=new n.default(S,c.typeSupported,p,c.vendor,c.id),Object(o.enableLogs)(p.debug),x("init",null);break}case"configure":{E.transmuxer.configure(c.config);break}case"demux":{var y=E.transmuxer.push(c.data,c.decryptdata,c.chunkMeta,c.state);Object(n.isPromise)(y)?y.then(function(b){h(E,b)}):h(E,y);break}case"flush":{var u=c.chunkMeta,_=E.transmuxer.flush(u);Object(n.isPromise)(_)?_.then(function(b){d(E,b,u)}):d(E,_,u);break}}})}function h(E,S){if(!g(S.remuxResult)){var x=[],m=S.remuxResult,c=m.audio,p=m.video;c&&f(x,c),p&&f(x,p),E.postMessage({event:"transmuxComplete",data:S},x)}}function f(E,S){S.data1&&E.push(S.data1.buffer),S.data2&&E.push(S.data2.buffer)}function d(E,S,x){S.forEach(function(m){h(E,m)}),E.postMessage({event:"flush",data:x})}function g(E){return!E.audio&&!E.video&&!E.text&&!E.id3&&!E.initSegment}},"./src/demux/transmuxer.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return y}),t.d(i,"isPromise",function(){return b}),t.d(i,"TransmuxConfig",function(){return T}),t.d(i,"TransmuxState",function(){return A});var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/crypt/decrypter.ts"),l=t("./src/demux/aacdemuxer.ts"),v=t("./src/demux/mp4demuxer.ts"),h=t("./src/demux/tsdemuxer.ts"),f=t("./src/demux/mp3demuxer.ts"),d=t("./src/remux/mp4-remuxer.ts"),g=t("./src/remux/passthrough-remuxer.ts"),E=t("./src/demux/chunk-cache.ts"),S=t("./src/utils/mp4-tools.ts"),x=t("./src/utils/logger.ts"),m;try{m=self.performance.now.bind(self.performance)}catch(L){x.logger.debug("Unable to use Performance API on this environment"),m=self.Date.now}var c=[{demux:h.default,remux:d.default},{demux:v.default,remux:g.default},{demux:l.default,remux:d.default},{demux:f.default,remux:d.default}],p=1024;c.forEach(function(L){var R=L.demux;p=Math.max(p,R.minProbeByteLength)});var y=function(){function L(w,O,I,D,C){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new E.default,this.observer=w,this.typeSupported=O,this.config=I,this.vendor=D,this.id=C}var R=L.prototype;return R.configure=function(O){this.transmuxConfig=O,this.decrypter&&this.decrypter.reset()},R.push=function(O,I,D,C){var P=this,M=D.transmuxing;M.executeStart=m();var N=new Uint8Array(O),B=this.cache,U=this.config,F=this.currentTransmuxState,j=this.transmuxConfig;C&&(this.currentTransmuxState=C);var V=u(N,I);if(V&&V.method==="AES-128"){var G=this.getDecrypter();if(U.enableSoftwareAES){var Y=G.softwareDecrypt(N,V.key.buffer,V.iv.buffer);if(!Y)return M.executeEnd=m(),_(D);N=new Uint8Array(Y)}else return this.decryptionPromise=G.webCryptoDecrypt(N,V.key.buffer,V.iv.buffer).then(function(Ne){var Te=P.push(Ne,null,D);return P.decryptionPromise=null,Te}),this.decryptionPromise}var X=C||F,ie=X.contiguous,he=X.discontinuity,de=X.trackSwitch,Ae=X.accurateTimeOffset,pe=X.timeOffset,le=X.initSegmentChange,Ie=j.audioCodec,Ce=j.videoCodec,Ue=j.defaultInitPts,Me=j.duration,ze=j.initSegmentData;if((he||de||le)&&this.resetInitSegment(ze,Ie,Ce,Me),(he||le)&&this.resetInitialTimestamp(Ue),ie||this.resetContiguity(),this.needsProbing(N,he,de)){if(B.dataLength){var Ge=B.flush();N=Object(S.appendUint8Array)(Ge,N)}this.configureTransmuxer(N,j)}var $e=this.transmux(N,V,pe,Ae,D),Ke=this.currentTransmuxState;return Ke.contiguous=!0,Ke.discontinuity=!1,Ke.trackSwitch=!1,M.executeEnd=m(),$e},R.flush=function(O){var I=this,D=O.transmuxing;D.executeStart=m();var C=this.decrypter,P=this.cache,M=this.currentTransmuxState,N=this.decryptionPromise;if(N)return N.then(function(){return I.flush(O)});var B=[],U=M.timeOffset;if(C){var F=C.flush();F&&B.push(this.push(F,null,O))}var j=P.dataLength;P.reset();var V=this.demuxer,G=this.remuxer;if(!V||!G)return j>=p&&this.observer.emit(n.Events.ERROR,n.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),D.executeEnd=m(),[_(O)];var Y=V.flush(U);return b(Y)?Y.then(function(X){return I.flushRemux(B,X,O),B}):(this.flushRemux(B,Y,O),B)},R.flushRemux=function(O,I,D){var C=I.audioTrack,P=I.avcTrack,M=I.id3Track,N=I.textTrack,B=this.currentTransmuxState,U=B.accurateTimeOffset,F=B.timeOffset;x.logger.log("[transmuxer.ts]: Flushed fragment "+D.sn+(D.part>-1?" p: "+D.part:"")+" of level "+D.level);var j=this.remuxer.remux(C,P,M,N,F,U,!0,this.id);O.push({remuxResult:j,chunkMeta:D}),D.transmuxing.executeEnd=m()},R.resetInitialTimestamp=function(O){var I=this.demuxer,D=this.remuxer;!I||!D||(I.resetTimeStamp(O),D.resetTimeStamp(O))},R.resetContiguity=function(){var O=this.demuxer,I=this.remuxer;!O||!I||(O.resetContiguity(),I.resetNextTimestamp())},R.resetInitSegment=function(O,I,D,C){var P=this.demuxer,M=this.remuxer;!P||!M||(P.resetInitSegment(I,D,C),M.resetInitSegment(O,I,D))},R.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},R.transmux=function(O,I,D,C,P){var M;return I&&I.method==="SAMPLE-AES"?M=this.transmuxSampleAes(O,I,D,C,P):M=this.transmuxUnencrypted(O,D,C,P),M},R.transmuxUnencrypted=function(O,I,D,C){var P=this.demuxer.demux(O,I,!1,!this.config.progressive),M=P.audioTrack,N=P.avcTrack,B=P.id3Track,U=P.textTrack,F=this.remuxer.remux(M,N,B,U,I,D,!1,this.id);return{remuxResult:F,chunkMeta:C}},R.transmuxSampleAes=function(O,I,D,C,P){var M=this;return this.demuxer.demuxSampleAes(O,I,D).then(function(N){var B=M.remuxer.remux(N.audioTrack,N.avcTrack,N.id3Track,N.textTrack,D,C,!1,M.id);return{remuxResult:B,chunkMeta:P}})},R.configureTransmuxer=function(O,I){for(var D=this.config,C=this.observer,P=this.typeSupported,M=this.vendor,N=I.audioCodec,B=I.defaultInitPts,U=I.duration,F=I.initSegmentData,j=I.videoCodec,V,G=0,Y=c.length;G<Y;G++)if(c[G].demux.probe(O)){V=c[G];break}V||(x.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),V={demux:v.default,remux:g.default});var X=this.demuxer,ie=this.remuxer,he=V.remux,de=V.demux;(!ie||!(ie instanceof he))&&(this.remuxer=new he(C,D,P,M)),(!X||!(X instanceof de))&&(this.demuxer=new de(C,D,P),this.probe=de.probe),this.resetInitSegment(F,N,j,U),this.resetInitialTimestamp(B)},R.needsProbing=function(O,I,D){return!this.demuxer||!this.remuxer||I||D},R.getDecrypter=function(){var O=this.decrypter;return O||(O=this.decrypter=new o.default(this.observer,this.config)),O},L}();function u(L,R){var w=null;return L.byteLength>0&&R!=null&&R.key!=null&&R.iv!==null&&R.method!=null&&(w=R),w}var _=function(R){return{remuxResult:{},chunkMeta:R}};function b(L){return"then"in L&&L.then instanceof Function}var T=function(R,w,O,I,D){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=R,this.videoCodec=w,this.initSegmentData=O,this.duration=I,this.defaultInitPts=D},A=function(R,w,O,I,D,C){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=R,this.contiguous=w,this.accurateTimeOffset=O,this.trackSwitch=I,this.timeOffset=D,this.initSegmentChange=C}},"./src/demux/tsdemuxer.ts":function(r,i,t){t.r(i),t.d(i,"discardEPB",function(){return _});var n=t("./src/demux/adts.ts"),a=t("./src/demux/mpegaudio.ts"),o=t("./src/demux/exp-golomb.ts"),l=t("./src/demux/id3.ts"),v=t("./src/demux/sample-aes.ts"),h=t("./src/events.ts"),f=t("./src/utils/mp4-tools.ts"),d=t("./src/utils/logger.ts"),g=t("./src/errors.ts"),E={video:1,audio:2,id3:3,text:4},S=function(){function b(A,L,R){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=A,this.config=L,this.typeSupported=R}b.probe=function(L){var R=b.syncOffset(L);return R<0?!1:(R&&d.logger.warn("MPEG2-TS detected but first sync word found @ offset "+R+", junk ahead ?"),!0)},b.syncOffset=function(L){for(var R=Math.min(1e3,L.length-3*188),w=0;w<R;){if(L[w]===71&&L[w+188]===71&&L[w+2*188]===71)return w;w++}return-1},b.createTrack=function(L,R){return{container:L==="video"||L==="audio"?"video/mp2t":void 0,type:L,id:E[L],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:L==="audio"?R:void 0}};var T=b.prototype;return T.resetInitSegment=function(L,R,w){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=b.createTrack("video",w),this._audioTrack=b.createTrack("audio",w),this._id3Track=b.createTrack("id3",w),this._txtTrack=b.createTrack("text",w),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=L,this.videoCodec=R,this._duration=w},T.resetTimeStamp=function(){},T.resetContiguity=function(){var L=this._audioTrack,R=this._avcTrack,w=this._id3Track;L&&(L.pesData=null),R&&(R.pesData=null),w&&(w.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},T.demux=function(L,R,w,O){w===void 0&&(w=!1),O===void 0&&(O=!1),w||(this.sampleAes=null);var I,D=this._avcTrack,C=this._audioTrack,P=this._id3Track,M=D.pid,N=D.pesData,B=C.pid,U=P.pid,F=C.pesData,j=P.pesData,V=!1,G=this.pmtParsed,Y=this._pmtId,X=L.length;if(this.remainderData&&(L=Object(f.appendUint8Array)(this.remainderData,L),X=L.length,this.remainderData=null),X<188&&!O)return this.remainderData=L,{audioTrack:C,avcTrack:D,id3Track:P,textTrack:this._txtTrack};var ie=Math.max(0,b.syncOffset(L));X-=(X+ie)%188,X<L.byteLength&&!O&&(this.remainderData=new Uint8Array(L.buffer,X,L.buffer.byteLength-X));for(var he=0,de=ie;de<X;de+=188)if(L[de]===71){var Ae=!!(L[de+1]&64),pe=((L[de+1]&31)<<8)+L[de+2],le=(L[de+3]&48)>>4,Ie=void 0;if(le>1){if(Ie=de+5+L[de+4],Ie===de+188)continue}else Ie=de+4;switch(pe){case M:Ae&&(N&&(I=p(N))&&this.parseAVCPES(I,!1),N={data:[],size:0}),N&&(N.data.push(L.subarray(Ie,de+188)),N.size+=de+188-Ie);break;case B:Ae&&(F&&(I=p(F))&&(C.isAAC?this.parseAACPES(I):this.parseMPEGPES(I)),F={data:[],size:0}),F&&(F.data.push(L.subarray(Ie,de+188)),F.size+=de+188-Ie);break;case U:Ae&&(j&&(I=p(j))&&this.parseID3PES(I),j={data:[],size:0}),j&&(j.data.push(L.subarray(Ie,de+188)),j.size+=de+188-Ie);break;case 0:Ae&&(Ie+=L[Ie]+1),Y=this._pmtId=m(L,Ie);break;case Y:{Ae&&(Ie+=L[Ie]+1);var Ce=c(L,Ie,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,w);M=Ce.avc,M>0&&(D.pid=M),B=Ce.audio,B>0&&(C.pid=B,C.isAAC=Ce.isAAC),U=Ce.id3,U>0&&(P.pid=U),V&&!G&&(d.logger.log("reparse from beginning"),V=!1,de=ie-188),G=this.pmtParsed=!0;break}case 17:case 8191:break;default:V=!0;break}}else he++;he>0&&this.observer.emit(h.Events.ERROR,h.Events.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+he+" TS packet/s that do not start with 0x47"}),D.pesData=N,C.pesData=F,P.pesData=j;var Ue={audioTrack:C,avcTrack:D,id3Track:P,textTrack:this._txtTrack};return O&&this.extractRemainingSamples(Ue),Ue},T.flush=function(){var L=this.remainderData;this.remainderData=null;var R;return L?R=this.demux(L,-1,!1,!0):R={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(R),this.sampleAes?this.decrypt(R,this.sampleAes):R},T.extractRemainingSamples=function(L){var R=L.audioTrack,w=L.avcTrack,O=L.id3Track,I=w.pesData,D=R.pesData,C=O.pesData,P;I&&(P=p(I))?(this.parseAVCPES(P,!0),w.pesData=null):w.pesData=I,D&&(P=p(D))?(R.isAAC?this.parseAACPES(P):this.parseMPEGPES(P),R.pesData=null):(D!=null&&D.size&&d.logger.log("last AAC PES packet truncated,might overlap between fragments"),R.pesData=D),C&&(P=p(C))?(this.parseID3PES(P),O.pesData=null):O.pesData=C},T.demuxSampleAes=function(L,R,w){var O=this.demux(L,w,!0,!this.config.progressive),I=this.sampleAes=new v.default(this.observer,this.config,R);return this.decrypt(O,I)},T.decrypt=function(L,R){return new Promise(function(w){var O=L.audioTrack,I=L.avcTrack;O.samples&&O.isAAC?R.decryptAacSamples(O.samples,0,function(){I.samples?R.decryptAvcSamples(I.samples,0,0,function(){w(L)}):w(L)}):I.samples&&R.decryptAvcSamples(I.samples,0,0,function(){w(L)})})},T.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},T.parseAVCPES=function(L,R){var w=this,O=this._avcTrack,I=this.parseAVCNALu(L.data),D=this.avcSample,C,P=!1;L.data=null,D&&I.length&&!O.audFound&&(y(D,O),D=this.avcSample=x(!1,L.pts,L.dts,"")),I.forEach(function(M){switch(M.type){case 1:{C=!0,D||(D=w.avcSample=x(!0,L.pts,L.dts,"")),D.frame=!0;var N=M.data;if(P&&N.length>4){var B=new o.default(N).readSliceType();(B===2||B===4||B===7||B===9)&&(D.key=!0)}break}case 5:C=!0,D||(D=w.avcSample=x(!0,L.pts,L.dts,"")),D.key=!0,D.frame=!0;break;case 6:{C=!0;var U=new o.default(_(M.data));U.readUByte();for(var F=0,j=0,V=!1,G=0;!V&&U.bytesAvailable>1;){F=0;do G=U.readUByte(),F+=G;while(G===255);j=0;do G=U.readUByte(),j+=G;while(G===255);if(F===4&&U.bytesAvailable!==0){V=!0;var Y=U.readUByte();if(Y===181){var X=U.readUShort();if(X===49){var ie=U.readUInt();if(ie===1195456820){var he=U.readUByte();if(he===3){for(var de=U.readUByte(),Ae=U.readUByte(),pe=31&de,le=[de,Ae],Ie=0;Ie<pe;Ie++)le.push(U.readUByte()),le.push(U.readUByte()),le.push(U.readUByte());u(w._txtTrack.samples,{type:3,pts:L.pts,bytes:le})}}}}}else if(F===5&&U.bytesAvailable!==0){if(V=!0,j>16){for(var Ce=[],Ue=0;Ue<16;Ue++)Ce.push(U.readUByte().toString(16)),(Ue===3||Ue===5||Ue===7||Ue===9)&&Ce.push("-");for(var Me=j-16,ze=new Uint8Array(Me),Ge=0;Ge<Me;Ge++)ze[Ge]=U.readUByte();u(w._txtTrack.samples,{pts:L.pts,payloadType:F,uuid:Ce.join(""),userData:Object(l.utf8ArrayToStr)(ze),userDataBytes:ze})}}else if(j<U.bytesAvailable)for(var $e=0;$e<j;$e++)U.readUByte()}break}case 7:if(C=!0,P=!0,!O.sps){var Ke=new o.default(M.data),Ne=Ke.readSPS();O.width=Ne.width,O.height=Ne.height,O.pixelRatio=Ne.pixelRatio,O.sps=[M.data],O.duration=w._duration;for(var Te=M.data.subarray(1,4),et="avc1.",st=0;st<3;st++){var qe=Te[st].toString(16);qe.length<2&&(qe="0"+qe),et+=qe}O.codec=et}break;case 8:C=!0,O.pps||(O.pps=[M.data]);break;case 9:C=!1,O.audFound=!0,D&&y(D,O),D=w.avcSample=x(!1,L.pts,L.dts,"");break;case 12:C=!1;break;default:C=!1,D&&(D.debug+="unknown NAL "+M.type+" ");break}if(D&&C){var ot=D.units;ot.push(M)}}),R&&D&&(y(D,O),this.avcSample=null)},T.getLastNalUnit=function(){var L,R=this.avcSample,w;if(!R||R.units.length===0){var O=this._avcTrack.samples;R=O[O.length-1]}if((L=R)!==null&&L!==void 0&&L.units){var I=R.units;w=I[I.length-1]}return w},T.parseAVCNALu=function(L){var R=L.byteLength,w=this._avcTrack,O=w.naluState||0,I=O,D=[],C=0,P,M,N,B=-1,U=0;for(O===-1&&(B=0,U=L[0]&31,O=0,C=1);C<R;){if(P=L[C++],!O){O=P?0:1;continue}if(O===1){O=P?0:2;continue}if(!P)O=3;else if(P===1){if(B>=0){var F={data:L.subarray(B,C-O-1),type:U};D.push(F)}else{var j=this.getLastNalUnit();if(j&&(I&&C<=4-I&&j.state&&(j.data=j.data.subarray(0,j.data.byteLength-I)),M=C-O-1,M>0)){var V=new Uint8Array(j.data.byteLength+M);V.set(j.data,0),V.set(L.subarray(0,M),j.data.byteLength),j.data=V,j.state=0}}C<R?(N=L[C]&31,B=C,U=N,O=0):O=-1}else O=0}if(B>=0&&O>=0){var G={data:L.subarray(B,R),type:U,state:O};D.push(G)}if(D.length===0){var Y=this.getLastNalUnit();if(Y){var X=new Uint8Array(Y.data.byteLength+L.byteLength);X.set(Y.data,0),X.set(L,Y.data.byteLength),Y.data=X}}return w.naluState=O,D},T.parseAACPES=function(L){var R=0,w=this._audioTrack,O=this.aacOverFlow,I=L.data;if(O){this.aacOverFlow=null;var D=O.sample.unit.byteLength,C=Math.min(O.missing,D),P=D-C;O.sample.unit.set(I.subarray(0,C),P),w.samples.push(O.sample),R=O.missing}var M,N;for(M=R,N=I.length;M<N-1&&!n.isHeader(I,M);M++);if(M!==R){var B,U;if(M<N-1?(B="AAC PES did not start with ADTS header,offset:"+M,U=!1):(B="no ADTS header found in AAC PES",U=!0),d.logger.warn("parsing error:"+B),this.observer.emit(h.Events.ERROR,h.Events.ERROR,{type:g.ErrorTypes.MEDIA_ERROR,details:g.ErrorDetails.FRAG_PARSING_ERROR,fatal:U,reason:B}),U)return}n.initTrackConfig(w,this.observer,I,M,this.audioCodec);var F;if(L.pts!==void 0)F=L.pts;else if(O){var j=n.getFrameDuration(w.samplerate);F=O.sample.pts+j}else{d.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var V=0;M<N;)if(n.isHeader(I,M)){if(M+5<N){var G=n.appendFrame(w,I,M,F,V);if(G)if(G.missing)this.aacOverFlow=G;else{M+=G.length,V++;continue}}break}else M++},T.parseMPEGPES=function(L){var R=L.data,w=R.length,O=0,I=0,D=L.pts;if(D===void 0){d.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;I<w;)if(a.isHeader(R,I)){var C=a.appendFrame(this._audioTrack,R,I,D,O);if(C)I+=C.length,O++;else break}else I++},T.parseID3PES=function(L){if(L.pts===void 0){d.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(L)},b}();S.minProbeByteLength=188;function x(b,T,A,L){return{key:b,frame:!1,pts:T,dts:A,units:[],debug:L,length:0}}function m(b,T){return(b[T+10]&31)<<8|b[T+11]}function c(b,T,A,L){var R={audio:-1,avc:-1,id3:-1,isAAC:!0},w=(b[T+1]&15)<<8|b[T+2],O=T+3+w-4,I=(b[T+10]&15)<<8|b[T+11];for(T+=12+I;T<O;){var D=(b[T+1]&31)<<8|b[T+2];switch(b[T]){case 207:if(!L){d.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:R.audio===-1&&(R.audio=D);break;case 21:R.id3===-1&&(R.id3=D);break;case 219:if(!L){d.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:R.avc===-1&&(R.avc=D);break;case 3:case 4:A?R.audio===-1&&(R.audio=D,R.isAAC=!1):d.logger.log("MPEG audio found, not supported in this browser");break;case 36:d.logger.warn("Unsupported HEVC stream type found");break}T+=((b[T+3]&15)<<8|b[T+4])+5}return R}function p(b){var T=0,A,L,R,w,O,I=b.data;if(!b||b.size===0)return null;for(;I[0].length<19&&I.length>1;){var D=new Uint8Array(I[0].length+I[1].length);D.set(I[0]),D.set(I[1],I[0].length),I[0]=D,I.splice(1,1)}A=I[0];var C=(A[0]<<16)+(A[1]<<8)+A[2];if(C===1){if(L=(A[4]<<8)+A[5],L&&L>b.size-6)return null;var P=A[7];P&192&&(w=(A[9]&14)*536870912+(A[10]&255)*4194304+(A[11]&254)*16384+(A[12]&255)*128+(A[13]&254)/2,P&64?(O=(A[14]&14)*536870912+(A[15]&255)*4194304+(A[16]&254)*16384+(A[17]&255)*128+(A[18]&254)/2,w-O>60*9e4&&(d.logger.warn(Math.round((w-O)/9e4)+"s delta between PTS and DTS, align them"),w=O)):O=w),R=A[8];var M=R+9;if(b.size<=M)return null;b.size-=M;for(var N=new Uint8Array(b.size),B=0,U=I.length;B<U;B++){A=I[B];var F=A.byteLength;if(M)if(M>F){M-=F;continue}else A=A.subarray(M),F-=M,M=0;N.set(A,T),T+=F}return L&&(L-=R+3),{data:N,pts:w,dts:O,len:L}}return null}function y(b,T){if(b.units.length&&b.frame){if(b.pts===void 0){var A=T.samples,L=A.length;if(L){var R=A[L-1];b.pts=R.pts,b.dts=R.dts}else{T.dropped++;return}}T.samples.push(b)}b.debug.length&&d.logger.log(b.pts+"/"+b.dts+":"+b.debug)}function u(b,T){var A=b.length;if(A>0){if(T.pts>=b[A-1].pts)b.push(T);else for(var L=A-1;L>=0;L--)if(T.pts<b[L].pts){b.splice(L,0,T);break}}else b.push(T)}function _(b){for(var T=b.byteLength,A=[],L=1;L<T-2;)b[L]===0&&b[L+1]===0&&b[L+2]===3?(A.push(L+2),L+=2):L++;if(A.length===0)return b;var R=T-A.length,w=new Uint8Array(R),O=0;for(L=0;L<R;O++,L++)O===A[0]&&(O++,A.shift()),w[L]=b[O];return w}i.default=S},"./src/errors.ts":function(r,i,t){t.r(i),t.d(i,"ErrorTypes",function(){return n}),t.d(i,"ErrorDetails",function(){return a});var n;(function(o){o.NETWORK_ERROR="networkError",o.MEDIA_ERROR="mediaError",o.KEY_SYSTEM_ERROR="keySystemError",o.MUX_ERROR="muxError",o.OTHER_ERROR="otherError"})(n||(n={}));var a;(function(o){o.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",o.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",o.KEY_SYSTEM_NO_SESSION="keySystemNoSession",o.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",o.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",o.MANIFEST_LOAD_ERROR="manifestLoadError",o.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",o.MANIFEST_PARSING_ERROR="manifestParsingError",o.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",o.LEVEL_EMPTY_ERROR="levelEmptyError",o.LEVEL_LOAD_ERROR="levelLoadError",o.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",o.LEVEL_SWITCH_ERROR="levelSwitchError",o.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",o.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",o.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",o.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",o.FRAG_LOAD_ERROR="fragLoadError",o.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",o.FRAG_DECRYPT_ERROR="fragDecryptError",o.FRAG_PARSING_ERROR="fragParsingError",o.REMUX_ALLOC_ERROR="remuxAllocError",o.KEY_LOAD_ERROR="keyLoadError",o.KEY_LOAD_TIMEOUT="keyLoadTimeOut",o.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",o.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",o.BUFFER_APPEND_ERROR="bufferAppendError",o.BUFFER_APPENDING_ERROR="bufferAppendingError",o.BUFFER_STALLED_ERROR="bufferStalledError",o.BUFFER_FULL_ERROR="bufferFullError",o.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",o.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",o.INTERNAL_EXCEPTION="internalException",o.INTERNAL_ABORTED="aborted",o.UNKNOWN="unknown"})(a||(a={}))},"./src/events.ts":function(r,i,t){t.r(i),t.d(i,"Events",function(){return n});var n;(function(a){a.MEDIA_ATTACHING="hlsMediaAttaching",a.MEDIA_ATTACHED="hlsMediaAttached",a.MEDIA_DETACHING="hlsMediaDetaching",a.MEDIA_DETACHED="hlsMediaDetached",a.BUFFER_RESET="hlsBufferReset",a.BUFFER_CODECS="hlsBufferCodecs",a.BUFFER_CREATED="hlsBufferCreated",a.BUFFER_APPENDING="hlsBufferAppending",a.BUFFER_APPENDED="hlsBufferAppended",a.BUFFER_EOS="hlsBufferEos",a.BUFFER_FLUSHING="hlsBufferFlushing",a.BUFFER_FLUSHED="hlsBufferFlushed",a.MANIFEST_LOADING="hlsManifestLoading",a.MANIFEST_LOADED="hlsManifestLoaded",a.MANIFEST_PARSED="hlsManifestParsed",a.LEVEL_SWITCHING="hlsLevelSwitching",a.LEVEL_SWITCHED="hlsLevelSwitched",a.LEVEL_LOADING="hlsLevelLoading",a.LEVEL_LOADED="hlsLevelLoaded",a.LEVEL_UPDATED="hlsLevelUpdated",a.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",a.LEVELS_UPDATED="hlsLevelsUpdated",a.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",a.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",a.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",a.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",a.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",a.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",a.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",a.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",a.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",a.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",a.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",a.CUES_PARSED="hlsCuesParsed",a.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",a.INIT_PTS_FOUND="hlsInitPtsFound",a.FRAG_LOADING="hlsFragLoading",a.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",a.FRAG_LOADED="hlsFragLoaded",a.FRAG_DECRYPTED="hlsFragDecrypted",a.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",a.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",a.FRAG_PARSING_METADATA="hlsFragParsingMetadata",a.FRAG_PARSED="hlsFragParsed",a.FRAG_BUFFERED="hlsFragBuffered",a.FRAG_CHANGED="hlsFragChanged",a.FPS_DROP="hlsFpsDrop",a.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",a.ERROR="hlsError",a.DESTROYING="hlsDestroying",a.KEY_LOADING="hlsKeyLoading",a.KEY_LOADED="hlsKeyLoaded",a.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",a.BACK_BUFFER_REACHED="hlsBackBufferReached"})(n||(n={}))},"./src/hls.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return u});var n=t("./node_modules/url-toolkit/src/url-toolkit.js"),a=t("./src/loader/playlist-loader.ts"),o=t("./src/loader/key-loader.ts"),l=t("./src/controller/id3-track-controller.ts"),v=t("./src/controller/latency-controller.ts"),h=t("./src/controller/level-controller.ts"),f=t("./src/controller/fragment-tracker.ts"),d=t("./src/controller/stream-controller.ts"),g=t("./src/is-supported.ts"),E=t("./src/utils/logger.ts"),S=t("./src/config.ts"),x=t("./node_modules/eventemitter3/index.js"),m=t("./src/events.ts"),c=t("./src/errors.ts");function p(_,b){for(var T=0;T<b.length;T++){var A=b[T];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(_,A.key,A)}}function y(_,b,T){return b&&p(_.prototype,b),T&&p(_,T),_}var u=function(){_.isSupported=function(){return Object(g.isSupported)()};function _(T){T===void 0&&(T={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new x.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var A=this.config=Object(S.mergeConfig)(_.DefaultConfig,T);this.userConfig=T,Object(E.enableLogs)(A.debug),this._autoLevelCapping=-1,A.progressive&&Object(S.enableStreamingMode)(A);var L=A.abrController,R=A.bufferController,w=A.capLevelController,O=A.fpsController,I=this.abrController=new L(this),D=this.bufferController=new R(this),C=this.capLevelController=new w(this),P=new O(this),M=new a.default(this),N=new o.default(this),B=new l.default(this),U=this.levelController=new h.default(this),F=new f.FragmentTracker(this),j=this.streamController=new d.default(this,F);C.setStreamController(j),P.setStreamController(j);var V=[U,j];this.networkControllers=V;var G=[M,N,I,D,C,P,B,F];this.audioTrackController=this.createController(A.audioTrackController,null,V),this.createController(A.audioStreamController,F,V),this.subtitleTrackController=this.createController(A.subtitleTrackController,null,V),this.createController(A.subtitleStreamController,F,V),this.createController(A.timelineController,null,G),this.emeController=this.createController(A.emeController,null,G),this.cmcdController=this.createController(A.cmcdController,null,G),this.latencyController=this.createController(v.default,null,G),this.coreComponents=G}var b=_.prototype;return b.createController=function(A,L,R){if(A){var w=L?new A(this,L):new A(this);return R&&R.push(w),w}return null},b.on=function(A,L,R){R===void 0&&(R=this),this._emitter.on(A,L,R)},b.once=function(A,L,R){R===void 0&&(R=this),this._emitter.once(A,L,R)},b.removeAllListeners=function(A){this._emitter.removeAllListeners(A)},b.off=function(A,L,R,w){R===void 0&&(R=this),this._emitter.off(A,L,R,w)},b.listeners=function(A){return this._emitter.listeners(A)},b.emit=function(A,L,R){return this._emitter.emit(A,L,R)},b.trigger=function(A,L){if(this.config.debug)return this.emit(A,A,L);try{return this.emit(A,A,L)}catch(R){E.logger.error("An internal error happened while handling event "+A+'. Error message: "'+R.message+'". Here is a stacktrace:',R),this.trigger(m.Events.ERROR,{type:c.ErrorTypes.OTHER_ERROR,details:c.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:A,error:R})}return!1},b.listenerCount=function(A){return this._emitter.listenerCount(A)},b.destroy=function(){E.logger.log("destroy"),this.trigger(m.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(A){return A.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(A){return A.destroy()}),this.coreComponents.length=0},b.attachMedia=function(A){E.logger.log("attachMedia"),this._media=A,this.trigger(m.Events.MEDIA_ATTACHING,{media:A})},b.detachMedia=function(){E.logger.log("detachMedia"),this.trigger(m.Events.MEDIA_DETACHING,void 0),this._media=null},b.loadSource=function(A){this.stopLoad();var L=this.media,R=this.url,w=this.url=n.buildAbsoluteURL(self.location.href,A,{alwaysNormalize:!0});E.logger.log("loadSource:"+w),L&&R&&R!==w&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(L)),this.trigger(m.Events.MANIFEST_LOADING,{url:A})},b.startLoad=function(A){A===void 0&&(A=-1),E.logger.log("startLoad("+A+")"),this.networkControllers.forEach(function(L){L.startLoad(A)})},b.stopLoad=function(){E.logger.log("stopLoad"),this.networkControllers.forEach(function(A){A.stopLoad()})},b.swapAudioCodec=function(){E.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},b.recoverMediaError=function(){E.logger.log("recoverMediaError");var A=this._media;this.detachMedia(),A&&this.attachMedia(A)},b.removeLevel=function(A,L){L===void 0&&(L=0),this.levelController.removeLevel(A,L)},y(_,[{key:"levels",get:function(){var A=this.levelController.levels;return A||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(A){E.logger.log("set currentLevel:"+A),this.loadLevel=A,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(A){E.logger.log("set nextLevel:"+A),this.levelController.manualLevel=A,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(A){E.logger.log("set loadLevel:"+A),this.levelController.manualLevel=A}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(A){this.levelController.nextLoadLevel=A}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(A){E.logger.log("set firstLevel:"+A),this.levelController.firstLevel=A}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(A){E.logger.log("set startLevel:"+A),A!==-1&&(A=Math.max(A,this.minAutoLevel)),this.levelController.startLevel=A}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(A){var L=!!A;L!==this.config.capLevelToPlayerSize&&(L?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=L)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(A){this._autoLevelCapping!==A&&(E.logger.log("set autoLevelCapping:"+A),this._autoLevelCapping=A)}},{key:"bandwidthEstimate",get:function(){var A=this.abrController.bwEstimator;return A?A.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var A=this.levels,L=this.config.minAutoBitrate;if(!A)return 0;for(var R=A.length,w=0;w<R;w++)if(A[w].maxBitrate>L)return w;return 0}},{key:"maxAutoLevel",get:function(){var A=this.levels,L=this.autoLevelCapping,R;return L===-1&&A&&A.length?R=A.length-1:R=L,R}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(A){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,A)}},{key:"audioTracks",get:function(){var A=this.audioTrackController;return A?A.audioTracks:[]}},{key:"audioTrack",get:function(){var A=this.audioTrackController;return A?A.audioTrack:-1},set:function(A){var L=this.audioTrackController;L&&(L.audioTrack=A)}},{key:"subtitleTracks",get:function(){var A=this.subtitleTrackController;return A?A.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var A=this.subtitleTrackController;return A?A.subtitleTrack:-1},set:function(A){var L=this.subtitleTrackController;L&&(L.subtitleTrack=A)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var A=this.subtitleTrackController;return A?A.subtitleDisplay:!1},set:function(A){var L=this.subtitleTrackController;L&&(L.subtitleDisplay=A)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(A){this.config.lowLatencyMode=A}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return m.Events}},{key:"ErrorTypes",get:function(){return c.ErrorTypes}},{key:"ErrorDetails",get:function(){return c.ErrorDetails}},{key:"DefaultConfig",get:function(){return _.defaultConfig?_.defaultConfig:S.hlsDefaultConfig},set:function(A){_.defaultConfig=A}}]),_}();u.defaultConfig=void 0},"./src/is-supported.ts":function(r,i,t){t.r(i),t.d(i,"isSupported",function(){return o}),t.d(i,"changeTypeSupported",function(){return l});var n=t("./src/utils/mediasource-helper.ts");function a(){return self.SourceBuffer||self.WebKitSourceBuffer}function o(){var v=Object(n.getMediaSource)();if(!v)return!1;var h=a(),f=v&&typeof v.isTypeSupported=="function"&&v.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),d=!h||h.prototype&&typeof h.prototype.appendBuffer=="function"&&typeof h.prototype.remove=="function";return!!f&&!!d}function l(){var v,h=a();return typeof(h==null||(v=h.prototype)===null||v===void 0?void 0:v.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return S}),t.d(i,"LoadError",function(){return m});var n=t("./src/polyfills/number.ts"),a=t("./src/errors.ts");function o(c,p){c.prototype=Object.create(p.prototype),c.prototype.constructor=c,d(c,p)}function l(c){var p=typeof Map=="function"?new Map:void 0;return l=function(u){if(u===null||!f(u))return u;if(typeof u!="function")throw new TypeError("Super expression must either be null or a function");if(typeof p!="undefined"){if(p.has(u))return p.get(u);p.set(u,_)}function _(){return v(u,arguments,g(this).constructor)}return _.prototype=Object.create(u.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),d(_,u)},l(c)}function v(c,p,y){return h()?v=Reflect.construct:v=function(_,b,T){var A=[null];A.push.apply(A,b);var L=Function.bind.apply(_,A),R=new L;return T&&d(R,T.prototype),R},v.apply(null,arguments)}function h(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(c){return!1}}function f(c){return Function.toString.call(c).indexOf("[native code]")!==-1}function d(c,p){return d=Object.setPrototypeOf||function(u,_){return u.__proto__=_,u},d(c,p)}function g(c){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(y){return y.__proto__||Object.getPrototypeOf(y)},g(c)}var E=Math.pow(2,17),S=function(){function c(y){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=y}var p=c.prototype;return p.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},p.abort=function(){this.loader&&this.loader.abort()},p.load=function(u,_){var b=this,T=u.url;if(!T)return Promise.reject(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:u,networkDetails:null},"Fragment does not have a "+(T?"part list":"url")));this.abort();var A=this.config,L=A.fLoader,R=A.loader;return new Promise(function(w,O){b.loader&&b.loader.destroy();var I=b.loader=u.loader=L?new L(A):new R(A),D=x(u),C={timeout:A.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:A.fragLoadingMaxRetryTimeout,highWaterMark:E};u.stats=I.stats,I.load(D,C,{onSuccess:function(M,N,B,U){b.resetLoader(u,I),w({frag:u,part:null,payload:M.data,networkDetails:U})},onError:function(M,N,B){b.resetLoader(u,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:u,response:M,networkDetails:B}))},onAbort:function(M,N,B){b.resetLoader(u,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:u,networkDetails:B}))},onTimeout:function(M,N,B){b.resetLoader(u,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:u,networkDetails:B}))},onProgress:function(M,N,B,U){_&&_({frag:u,part:null,payload:B,networkDetails:U})}})})},p.loadPart=function(u,_,b){var T=this;this.abort();var A=this.config,L=A.fLoader,R=A.loader;return new Promise(function(w,O){T.loader&&T.loader.destroy();var I=T.loader=u.loader=L?new L(A):new R(A),D=x(u,_),C={timeout:A.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:A.fragLoadingMaxRetryTimeout,highWaterMark:E};_.stats=I.stats,I.load(D,C,{onSuccess:function(M,N,B,U){T.resetLoader(u,I),T.updateStatsFromPart(u,_);var F={frag:u,part:_,payload:M.data,networkDetails:U};b(F),w(F)},onError:function(M,N,B){T.resetLoader(u,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:u,part:_,response:M,networkDetails:B}))},onAbort:function(M,N,B){u.stats.aborted=_.stats.aborted,T.resetLoader(u,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:u,part:_,networkDetails:B}))},onTimeout:function(M,N,B){T.resetLoader(u,I),O(new m({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:u,part:_,networkDetails:B}))}})})},p.updateStatsFromPart=function(u,_){var b=u.stats,T=_.stats,A=T.total;if(b.loaded+=T.loaded,A){var L=Math.round(u.duration/_.duration),R=Math.min(Math.round(b.loaded/A),L),w=L-R,O=w*Math.round(b.loaded/R);b.total=b.loaded+O}else b.total=Math.max(b.loaded,b.total);var I=b.loading,D=T.loading;I.start?I.first+=D.first-D.start:(I.start=D.start,I.first=D.first),I.end=D.end},p.resetLoader=function(u,_){u.loader=null,this.loader===_&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),_.destroy()},c}();function x(c,p){p===void 0&&(p=null);var y=p||c,u={frag:c,part:p,responseType:"arraybuffer",url:y.url,headers:{},rangeStart:0,rangeEnd:0},_=y.byteRangeStartOffset,b=y.byteRangeEndOffset;return Object(n.isFiniteNumber)(_)&&Object(n.isFiniteNumber)(b)&&(u.rangeStart=_,u.rangeEnd=b),u}var m=function(c){o(p,c);function p(y){for(var u,_=arguments.length,b=new Array(_>1?_-1:0),T=1;T<_;T++)b[T-1]=arguments[T];return u=c.call.apply(c,[this].concat(b))||this,u.data=void 0,u.data=y,u}return p}(l(Error))},"./src/loader/fragment.ts":function(r,i,t){t.r(i),t.d(i,"ElementaryStreamTypes",function(){return E}),t.d(i,"BaseSegment",function(){return S}),t.d(i,"Fragment",function(){return x}),t.d(i,"Part",function(){return m});var n=t("./src/polyfills/number.ts"),a=t("./node_modules/url-toolkit/src/url-toolkit.js"),o=t("./src/utils/logger.ts"),l=t("./src/loader/level-key.ts"),v=t("./src/loader/load-stats.ts");function h(c,p){c.prototype=Object.create(p.prototype),c.prototype.constructor=c,f(c,p)}function f(c,p){return f=Object.setPrototypeOf||function(u,_){return u.__proto__=_,u},f(c,p)}function d(c,p){for(var y=0;y<p.length;y++){var u=p[y];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(c,u.key,u)}}function g(c,p,y){return p&&d(c.prototype,p),y&&d(c,y),c}var E;(function(c){c.AUDIO="audio",c.VIDEO="video",c.AUDIOVIDEO="audiovideo"})(E||(E={}));var S=function(){function c(y){var u;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(u={},u[E.AUDIO]=null,u[E.VIDEO]=null,u[E.AUDIOVIDEO]=null,u),this.baseurl=y}var p=c.prototype;return p.setByteRange=function(u,_){var b=u.split("@",2),T=[];b.length===1?T[0]=_?_.byteRangeEndOffset:0:T[0]=parseInt(b[1]),T[1]=parseInt(b[0])+T[0],this._byteRange=T},g(c,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(u){this._url=u}}]),c}(),x=function(c){h(p,c);function p(u,_){var b;return b=c.call(this,_)||this,b._decryptdata=null,b.rawProgramDateTime=null,b.programDateTime=null,b.tagList=[],b.duration=0,b.sn=0,b.levelkey=void 0,b.type=void 0,b.loader=null,b.level=-1,b.cc=0,b.startPTS=void 0,b.endPTS=void 0,b.appendedPTS=void 0,b.startDTS=void 0,b.endDTS=void 0,b.start=0,b.deltaPTS=void 0,b.maxStartPTS=void 0,b.minEndPTS=void 0,b.stats=new v.LoadStats,b.urlId=0,b.data=void 0,b.bitrateTest=!1,b.title=null,b.initSegment=null,b.type=u,b}var y=p.prototype;return y.createInitializationVector=function(_){for(var b=new Uint8Array(16),T=12;T<16;T++)b[T]=_>>8*(15-T)&255;return b},y.setDecryptDataFromLevelKey=function(_,b){var T=_;return(_==null?void 0:_.method)==="AES-128"&&_.uri&&!_.iv&&(T=l.LevelKey.fromURI(_.uri),T.method=_.method,T.iv=this.createInitializationVector(b),T.keyFormat="identity"),T},y.setElementaryStreamInfo=function(_,b,T,A,L,R){R===void 0&&(R=!1);var w=this.elementaryStreams,O=w[_];if(!O){w[_]={startPTS:b,endPTS:T,startDTS:A,endDTS:L,partial:R};return}O.startPTS=Math.min(O.startPTS,b),O.endPTS=Math.max(O.endPTS,T),O.startDTS=Math.min(O.startDTS,A),O.endDTS=Math.max(O.endDTS,L)},y.clearElementaryStreamInfo=function(){var _=this.elementaryStreams;_[E.AUDIO]=null,_[E.VIDEO]=null,_[E.AUDIOVIDEO]=null},g(p,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var _=this.sn;typeof _!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&o.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),_=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,_)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(n.isFiniteNumber)(this.programDateTime))return null;var _=Object(n.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+_*1e3}},{key:"encrypted",get:function(){var _;return!!((_=this.decryptdata)!==null&&_!==void 0&&_.keyFormat&&this.decryptdata.uri)}}]),p}(S),m=function(c){h(p,c);function p(y,u,_,b,T){var A;A=c.call(this,_)||this,A.fragOffset=0,A.duration=0,A.gap=!1,A.independent=!1,A.relurl=void 0,A.fragment=void 0,A.index=void 0,A.stats=new v.LoadStats,A.duration=y.decimalFloatingPoint("DURATION"),A.gap=y.bool("GAP"),A.independent=y.bool("INDEPENDENT"),A.relurl=y.enumeratedString("URI"),A.fragment=u,A.index=b;var L=y.enumeratedString("BYTERANGE");return L&&A.setByteRange(L,T),T&&(A.fragOffset=T.fragOffset+T.duration),A}return g(p,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var u=this.elementaryStreams;return!!(u.audio||u.video||u.audiovideo)}}]),p}(S)},"./src/loader/key-loader.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return l});var n=t("./src/events.ts"),a=t("./src/errors.ts"),o=t("./src/utils/logger.ts"),l=function(){function v(f){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=f,this._registerListeners()}var h=v.prototype;return h._registerListeners=function(){this.hls.on(n.Events.KEY_LOADING,this.onKeyLoading,this)},h._unregisterListeners=function(){this.hls.off(n.Events.KEY_LOADING,this.onKeyLoading)},h.destroy=function(){this._unregisterListeners();for(var d in this.loaders){var g=this.loaders[d];g&&g.destroy()}this.loaders={}},h.onKeyLoading=function(d,g){var E=g.frag,S=E.type,x=this.loaders[S];if(!E.decryptdata){o.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var m=E.decryptdata.uri;if(m!==this.decrypturl||this.decryptkey===null){var c=this.hls.config;if(x&&(o.logger.warn("abort previous key loader for type:"+S),x.abort()),!m){o.logger.warn("key uri is falsy");return}var p=c.loader,y=E.loader=this.loaders[S]=new p(c);this.decrypturl=m,this.decryptkey=null;var u={url:m,frag:E,responseType:"arraybuffer"},_={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:c.fragLoadingRetryDelay,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:0},b={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};y.load(u,_,b)}else this.decryptkey&&(E.decryptdata.key=this.decryptkey,this.hls.trigger(n.Events.KEY_LOADED,{frag:E}))},h.loadsuccess=function(d,g,E){var S=E.frag;if(!S.decryptdata){o.logger.error("after key load, decryptdata unset");return}this.decryptkey=S.decryptdata.key=new Uint8Array(d.data),S.loader=null,delete this.loaders[S.type],this.hls.trigger(n.Events.KEY_LOADED,{frag:S})},h.loaderror=function(d,g){var E=g.frag,S=E.loader;S&&S.abort(),delete this.loaders[E.type],this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:E,response:d})},h.loadtimeout=function(d,g){var E=g.frag,S=E.loader;S&&S.abort(),delete this.loaders[E.type],this.hls.trigger(n.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:E})},v}()},"./src/loader/level-details.ts":function(r,i,t){t.r(i),t.d(i,"LevelDetails",function(){return v});var n=t("./src/polyfills/number.ts");function a(h,f){for(var d=0;d<f.length;d++){var g=f[d];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(h,g.key,g)}}function o(h,f,d){return f&&a(h.prototype,f),d&&a(h,d),h}var l=10,v=function(){function h(d){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=d}var f=h.prototype;return f.reloaded=function(g){if(!g){this.advanced=!0,this.updated=!0;return}var E=this.lastPartSn-g.lastPartSn,S=this.lastPartIndex-g.lastPartIndex;this.updated=this.endSN!==g.endSN||!!S||!!E,this.advanced=this.endSN>g.endSN||E>0||E===0&&S>0,this.updated||this.advanced?this.misses=Math.floor(g.misses*.6):this.misses=g.misses+1,this.availabilityDelay=g.availabilityDelay},o(h,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(n.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||l}},{key:"drift",get:function(){var g=this.driftEndTime-this.driftStartTime;if(g>0){var E=this.driftEnd-this.driftStart;return E*1e3/g}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var g;return(g=this.partList)!==null&&g!==void 0&&g.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var g;return(g=this.fragments)!==null&&g!==void 0&&g.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var g;return(g=this.partList)!==null&&g!==void 0&&g.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var g;return(g=this.partList)!==null&&g!==void 0&&g.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),h}()},"./src/loader/level-key.ts":function(r,i,t){t.r(i),t.d(i,"LevelKey",function(){return l});var n=t("./node_modules/url-toolkit/src/url-toolkit.js");function a(v,h){for(var f=0;f<h.length;f++){var d=h[f];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(v,d.key,d)}}function o(v,h,f){return h&&a(v.prototype,h),f&&a(v,f),v}var l=function(){v.fromURL=function(f,d){return new v(f,d)},v.fromURI=function(f){return new v(f)};function v(h,f){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,f?this._uri=Object(n.buildAbsoluteURL)(h,f,{alwaysNormalize:!0}):this._uri=h}return o(v,[{key:"uri",get:function(){return this._uri}}]),v}()},"./src/loader/load-stats.ts":function(r,i,t){t.r(i),t.d(i,"LoadStats",function(){return n});var n=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return p});var n=t("./src/polyfills/number.ts"),a=t("./node_modules/url-toolkit/src/url-toolkit.js"),o=t("./src/loader/fragment.ts"),l=t("./src/loader/level-details.ts"),v=t("./src/loader/level-key.ts"),h=t("./src/utils/attr-list.ts"),f=t("./src/utils/logger.ts"),d=t("./src/utils/codecs.ts"),g=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,E=/#EXT-X-MEDIA:(.*)/g,S=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),x=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),m=/\.(mp4|m4s|m4v|m4a)$/i;function c(T){var A,L;return m.test((A=(L=a.parseURL(T))===null||L===void 0?void 0:L.path)!=null?A:"")}var p=function(){function T(){}return T.findGroup=function(L,R){for(var w=0;w<L.length;w++){var O=L[w];if(O.id===R)return O}},T.convertAVC1ToAVCOTI=function(L){var R=L.split(".");if(R.length>2){var w=R.shift()+".";return w+=parseInt(R.shift()).toString(16),w+=("000"+parseInt(R.shift()).toString(16)).substr(-4),w}return L},T.resolve=function(L,R){return a.buildAbsoluteURL(R,L,{alwaysNormalize:!0})},T.parseMasterPlaylist=function(L,R){var w=[],O={},I=!1;g.lastIndex=0;for(var D;(D=g.exec(L))!=null;)if(D[1]){var C=new h.AttrList(D[1]),P={attrs:C,bitrate:C.decimalInteger("AVERAGE-BANDWIDTH")||C.decimalInteger("BANDWIDTH"),name:C.NAME,url:T.resolve(D[2],R)},M=C.decimalResolution("RESOLUTION");M&&(P.width=M.width,P.height=M.height),y((C.CODECS||"").split(/[ ,]+/).filter(function(B){return B}),P),P.videoCodec&&P.videoCodec.indexOf("avc1")!==-1&&(P.videoCodec=T.convertAVC1ToAVCOTI(P.videoCodec)),w.push(P)}else if(D[3]){var N=new h.AttrList(D[3]);N["DATA-ID"]&&(I=!0,O[N["DATA-ID"]]=N)}return{levels:w,sessionData:I?O:null}},T.parseMasterPlaylistMedia=function(L,R,w,O){O===void 0&&(O=[]);var I,D=[],C=0;for(E.lastIndex=0;(I=E.exec(L))!==null;){var P=new h.AttrList(I[1]);if(P.TYPE===w){var M={attrs:P,bitrate:0,id:C++,groupId:P["GROUP-ID"],instreamId:P["INSTREAM-ID"],name:P.NAME||P.LANGUAGE||"",type:w,default:P.bool("DEFAULT"),autoselect:P.bool("AUTOSELECT"),forced:P.bool("FORCED"),lang:P.LANGUAGE,url:P.URI?T.resolve(P.URI,R):""};if(O.length){var N=T.findGroup(O,M.groupId)||O[0];u(M,N,"audioCodec"),u(M,N,"textCodec")}D.push(M)}}return D},T.parseLevelPlaylist=function(L,R,w,O,I){var D=new l.LevelDetails(R),C=D.fragments,P=null,M=0,N=0,B=0,U=0,F=null,j=new o.Fragment(O,R),V,G,Y,X=-1,ie=!1;for(S.lastIndex=0,D.m3u8=L;(V=S.exec(L))!==null;){ie&&(ie=!1,j=new o.Fragment(O,R),j.start=B,j.sn=M,j.cc=U,j.level=w,P&&(j.initSegment=P,j.rawProgramDateTime=P.rawProgramDateTime));var he=V[1];if(he){j.duration=parseFloat(he);var de=(" "+V[2]).slice(1);j.title=de||null,j.tagList.push(de?["INF",he,de]:["INF",he])}else if(V[3])Object(n.isFiniteNumber)(j.duration)&&(j.start=B,Y&&(j.levelkey=Y),j.sn=M,j.level=w,j.cc=U,j.urlId=I,C.push(j),j.relurl=(" "+V[3]).slice(1),b(j,F),F=j,B+=j.duration,M++,N=0,ie=!0);else if(V[4]){var Ae=(" "+V[4]).slice(1);F?j.setByteRange(Ae,F):j.setByteRange(Ae)}else if(V[5])j.rawProgramDateTime=(" "+V[5]).slice(1),j.tagList.push(["PROGRAM-DATE-TIME",j.rawProgramDateTime]),X===-1&&(X=C.length);else{if(V=V[0].match(x),!V){f.logger.warn("No matches on slow regex match for level playlist!");continue}for(G=1;G<V.length&&typeof V[G]=="undefined";G++);var pe=(" "+V[G]).slice(1),le=(" "+V[G+1]).slice(1),Ie=V[G+2]?(" "+V[G+2]).slice(1):"";switch(pe){case"PLAYLIST-TYPE":D.type=le.toUpperCase();break;case"MEDIA-SEQUENCE":M=D.startSN=parseInt(le);break;case"SKIP":{var Ce=new h.AttrList(le),Ue=Ce.decimalInteger("SKIPPED-SEGMENTS");if(Object(n.isFiniteNumber)(Ue)){D.skippedSegments=Ue;for(var Me=Ue;Me--;)C.unshift(null);M+=Ue}var ze=Ce.enumeratedString("RECENTLY-REMOVED-DATERANGES");ze&&(D.recentlyRemovedDateranges=ze.split("	"));break}case"TARGETDURATION":D.targetduration=parseFloat(le);break;case"VERSION":D.version=parseInt(le);break;case"EXTM3U":break;case"ENDLIST":D.live=!1;break;case"#":(le||Ie)&&j.tagList.push(Ie?[le,Ie]:[le]);break;case"DIS":U++;case"GAP":j.tagList.push([pe]);break;case"BITRATE":j.tagList.push([pe,le]);break;case"DISCONTINUITY-SEQ":U=parseInt(le);break;case"KEY":{var Ge,$e=new h.AttrList(le),Ke=$e.enumeratedString("METHOD"),Ne=$e.URI,Te=$e.hexadecimalInteger("IV"),et=$e.enumeratedString("KEYFORMATVERSIONS"),st=$e.enumeratedString("KEYID"),qe=(Ge=$e.enumeratedString("KEYFORMAT"))!=null?Ge:"identity",ot=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(ot.indexOf(qe)>-1){f.logger.warn("Keyformat "+qe+" is not supported from the manifest");continue}else if(qe!=="identity")continue;Ke&&(Y=v.LevelKey.fromURL(R,Ne),Ne&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(Ke)>=0&&(Y.method=Ke,Y.keyFormat=qe,st&&(Y.keyID=st),et&&(Y.keyFormatVersions=et),Y.iv=Te));break}case"START":{var nt=new h.AttrList(le),dt=nt.decimalFloatingPoint("TIME-OFFSET");Object(n.isFiniteNumber)(dt)&&(D.startTimeOffset=dt);break}case"MAP":{var ne=new h.AttrList(le);j.relurl=ne.URI,ne.BYTERANGE&&j.setByteRange(ne.BYTERANGE),j.level=w,j.sn="initSegment",Y&&(j.levelkey=Y),j.initSegment=null,P=j,ie=!0;break}case"SERVER-CONTROL":{var Ee=new h.AttrList(le);D.canBlockReload=Ee.bool("CAN-BLOCK-RELOAD"),D.canSkipUntil=Ee.optionalFloat("CAN-SKIP-UNTIL",0),D.canSkipDateRanges=D.canSkipUntil>0&&Ee.bool("CAN-SKIP-DATERANGES"),D.partHoldBack=Ee.optionalFloat("PART-HOLD-BACK",0),D.holdBack=Ee.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var xe=new h.AttrList(le);D.partTarget=xe.decimalFloatingPoint("PART-TARGET");break}case"PART":{var we=D.partList;we||(we=D.partList=[]);var be=N>0?we[we.length-1]:void 0,je=N++,K=new o.Part(new h.AttrList(le),j,R,je,be);we.push(K),j.duration+=K.duration;break}case"PRELOAD-HINT":{var ce=new h.AttrList(le);D.preloadHint=ce;break}case"RENDITION-REPORT":{var _e=new h.AttrList(le);D.renditionReports=D.renditionReports||[],D.renditionReports.push(_e);break}default:f.logger.warn("line parsed but not handled: "+V);break}}}F&&!F.relurl?(C.pop(),B-=F.duration,D.partList&&(D.fragmentHint=F)):D.partList&&(b(j,F),j.cc=U,D.fragmentHint=j);var Re=C.length,Z=C[0],ue=C[Re-1];if(B+=D.skippedSegments*D.targetduration,B>0&&Re&&ue){D.averagetargetduration=B/Re;var W=ue.sn;D.endSN=W!=="initSegment"?W:0,Z&&(D.startCC=Z.cc,Z.initSegment||D.fragments.every(function(me){return me.relurl&&c(me.relurl)})&&(f.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),j=new o.Fragment(O,R),j.relurl=ue.relurl,j.level=w,j.sn="initSegment",Z.initSegment=j,D.needSidxRanges=!0))}else D.endSN=0,D.startCC=0;return D.fragmentHint&&(B+=D.fragmentHint.duration),D.totalduration=B,D.endCC=U,X>0&&_(C,X),D},T}();function y(T,A){["video","audio","text"].forEach(function(L){var R=T.filter(function(O){return Object(d.isCodecType)(O,L)});if(R.length){var w=R.filter(function(O){return O.lastIndexOf("avc1",0)===0||O.lastIndexOf("mp4a",0)===0});A[L+"Codec"]=w.length>0?w[0]:R[0],T=T.filter(function(O){return R.indexOf(O)===-1})}}),A.unknownCodecs=T}function u(T,A,L){var R=A[L];R&&(T[L]=R)}function _(T,A){for(var L=T[A],R=A;R--;){var w=T[R];if(!w)return;w.programDateTime=L.programDateTime-w.duration*1e3,L=w}}function b(T,A){T.rawProgramDateTime?T.programDateTime=Date.parse(T.rawProgramDateTime):A!=null&&A.programDateTime&&(T.programDateTime=A.endProgramDateTime),Object(n.isFiniteNumber)(T.programDateTime)||(T.programDateTime=null,T.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/events.ts"),o=t("./src/errors.ts"),l=t("./src/utils/logger.ts"),v=t("./src/utils/mp4-tools.ts"),h=t("./src/loader/m3u8-parser.ts"),f=t("./src/types/loader.ts"),d=t("./src/utils/attr-list.ts");function g(x){var m=x.type;switch(m){case f.PlaylistContextType.AUDIO_TRACK:return f.PlaylistLevelType.AUDIO;case f.PlaylistContextType.SUBTITLE_TRACK:return f.PlaylistLevelType.SUBTITLE;default:return f.PlaylistLevelType.MAIN}}function E(x,m){var c=x.url;return(c===void 0||c.indexOf("data:")===0)&&(c=m.url),c}var S=function(){function x(c){this.hls=void 0,this.loaders=Object.create(null),this.hls=c,this.registerListeners()}var m=x.prototype;return m.registerListeners=function(){var p=this.hls;p.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.on(a.Events.LEVEL_LOADING,this.onLevelLoading,this),p.on(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),p.on(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},m.unregisterListeners=function(){var p=this.hls;p.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),p.off(a.Events.LEVEL_LOADING,this.onLevelLoading,this),p.off(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),p.off(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},m.createInternalLoader=function(p){var y=this.hls.config,u=y.pLoader,_=y.loader,b=u||_,T=new b(y);return p.loader=T,this.loaders[p.type]=T,T},m.getInternalLoader=function(p){return this.loaders[p.type]},m.resetInternalLoader=function(p){this.loaders[p]&&delete this.loaders[p]},m.destroyInternalLoaders=function(){for(var p in this.loaders){var y=this.loaders[p];y&&y.destroy(),this.resetInternalLoader(p)}},m.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},m.onManifestLoading=function(p,y){var u=y.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:f.PlaylistContextType.MANIFEST,url:u,deliveryDirectives:null})},m.onLevelLoading=function(p,y){var u=y.id,_=y.level,b=y.url,T=y.deliveryDirectives;this.load({id:u,groupId:null,level:_,responseType:"text",type:f.PlaylistContextType.LEVEL,url:b,deliveryDirectives:T})},m.onAudioTrackLoading=function(p,y){var u=y.id,_=y.groupId,b=y.url,T=y.deliveryDirectives;this.load({id:u,groupId:_,level:null,responseType:"text",type:f.PlaylistContextType.AUDIO_TRACK,url:b,deliveryDirectives:T})},m.onSubtitleTrackLoading=function(p,y){var u=y.id,_=y.groupId,b=y.url,T=y.deliveryDirectives;this.load({id:u,groupId:_,level:null,responseType:"text",type:f.PlaylistContextType.SUBTITLE_TRACK,url:b,deliveryDirectives:T})},m.load=function(p){var y,u=this.hls.config,_=this.getInternalLoader(p);if(_){var b=_.context;if(b&&b.url===p.url){l.logger.trace("[playlist-loader]: playlist request ongoing");return}l.logger.log("[playlist-loader]: aborting previous loader for type: "+p.type),_.abort()}var T,A,L,R;switch(p.type){case f.PlaylistContextType.MANIFEST:T=u.manifestLoadingMaxRetry,A=u.manifestLoadingTimeOut,L=u.manifestLoadingRetryDelay,R=u.manifestLoadingMaxRetryTimeout;break;case f.PlaylistContextType.LEVEL:case f.PlaylistContextType.AUDIO_TRACK:case f.PlaylistContextType.SUBTITLE_TRACK:T=0,A=u.levelLoadingTimeOut;break;default:T=u.levelLoadingMaxRetry,A=u.levelLoadingTimeOut,L=u.levelLoadingRetryDelay,R=u.levelLoadingMaxRetryTimeout;break}if(_=this.createInternalLoader(p),(y=p.deliveryDirectives)!==null&&y!==void 0&&y.part){var w;if(p.type===f.PlaylistContextType.LEVEL&&p.level!==null?w=this.hls.levels[p.level].details:p.type===f.PlaylistContextType.AUDIO_TRACK&&p.id!==null?w=this.hls.audioTracks[p.id].details:p.type===f.PlaylistContextType.SUBTITLE_TRACK&&p.id!==null&&(w=this.hls.subtitleTracks[p.id].details),w){var O=w.partTarget,I=w.targetduration;O&&I&&(A=Math.min(Math.max(O*3,I*.8)*1e3,A))}}var D={timeout:A,maxRetry:T,retryDelay:L,maxRetryDelay:R,highWaterMark:0},C={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};_.load(p,D,C)},m.loadsuccess=function(p,y,u,_){if(_===void 0&&(_=null),u.isSidxRequest){this.handleSidxRequest(p,u),this.handlePlaylistLoaded(p,y,u,_);return}this.resetInternalLoader(u.type);var b=p.data;if(b.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(p,u,"no EXTM3U delimiter",_);return}y.parsing.start=performance.now(),b.indexOf("#EXTINF:")>0||b.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(p,y,u,_):this.handleMasterPlaylist(p,y,u,_)},m.loaderror=function(p,y,u){u===void 0&&(u=null),this.handleNetworkError(y,u,!1,p)},m.loadtimeout=function(p,y,u){u===void 0&&(u=null),this.handleNetworkError(y,u,!0)},m.handleMasterPlaylist=function(p,y,u,_){var b=this.hls,T=p.data,A=E(p,u),L=h.default.parseMasterPlaylist(T,A),R=L.levels,w=L.sessionData;if(!R.length){this.handleManifestParsingError(p,u,"no level found in manifest",_);return}var O=R.map(function(N){return{id:N.attrs.AUDIO,audioCodec:N.audioCodec}}),I=R.map(function(N){return{id:N.attrs.SUBTITLES,textCodec:N.textCodec}}),D=h.default.parseMasterPlaylistMedia(T,A,"AUDIO",O),C=h.default.parseMasterPlaylistMedia(T,A,"SUBTITLES",I),P=h.default.parseMasterPlaylistMedia(T,A,"CLOSED-CAPTIONS");if(D.length){var M=D.some(function(N){return!N.url});!M&&R[0].audioCodec&&!R[0].attrs.AUDIO&&(l.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),D.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new d.AttrList({}),bitrate:0,url:""}))}b.trigger(a.Events.MANIFEST_LOADED,{levels:R,audioTracks:D,subtitles:C,captions:P,url:A,stats:y,networkDetails:_,sessionData:w})},m.handleTrackOrLevelPlaylist=function(p,y,u,_){var b=this.hls,T=u.id,A=u.level,L=u.type,R=E(p,u),w=Object(n.isFiniteNumber)(T)?T:0,O=Object(n.isFiniteNumber)(A)?A:w,I=g(u),D=h.default.parseLevelPlaylist(p.data,R,O,I,w);if(!D.fragments.length){b.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:R,reason:"no fragments found in level",level:typeof u.level=="number"?u.level:void 0});return}if(L===f.PlaylistContextType.MANIFEST){var C={attrs:new d.AttrList({}),bitrate:0,details:D,name:"",url:R};b.trigger(a.Events.MANIFEST_LOADED,{levels:[C],audioTracks:[],url:R,stats:y,networkDetails:_,sessionData:null})}if(y.parsing.end=performance.now(),D.needSidxRanges){var P,M=(P=D.fragments[0].initSegment)===null||P===void 0?void 0:P.url;this.load({url:M,isSidxRequest:!0,type:L,level:A,levelDetails:D,id:T,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}u.levelDetails=D,this.handlePlaylistLoaded(p,y,u,_)},m.handleSidxRequest=function(p,y){var u=Object(v.parseSegmentIndex)(new Uint8Array(p.data));if(!!u){var _=u.references,b=y.levelDetails;_.forEach(function(T,A){var L=T.info,R=b.fragments[A];R.byteRange.length===0&&R.setByteRange(String(1+L.end-L.start)+"@"+String(L.start)),R.initSegment&&R.initSegment.setByteRange(String(u.moovEndOffset)+"@0")})}},m.handleManifestParsingError=function(p,y,u,_){this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:y.type===f.PlaylistContextType.MANIFEST,url:p.url,reason:u,response:p,context:y,networkDetails:_})},m.handleNetworkError=function(p,y,u,_){u===void 0&&(u=!1),l.logger.warn("[playlist-loader]: A network "+(u?"timeout":"error")+" occurred while loading "+p.type+" level: "+p.level+" id: "+p.id+' group-id: "'+p.groupId+'"');var b=o.ErrorDetails.UNKNOWN,T=!1,A=this.getInternalLoader(p);switch(p.type){case f.PlaylistContextType.MANIFEST:b=u?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,T=!0;break;case f.PlaylistContextType.LEVEL:b=u?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,T=!1;break;case f.PlaylistContextType.AUDIO_TRACK:b=u?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,T=!1;break;case f.PlaylistContextType.SUBTITLE_TRACK:b=u?o.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:o.ErrorDetails.SUBTITLE_LOAD_ERROR,T=!1;break}A&&this.resetInternalLoader(p.type);var L={type:o.ErrorTypes.NETWORK_ERROR,details:b,fatal:T,url:p.url,loader:A,context:p,networkDetails:y};_&&(L.response=_),this.hls.trigger(a.Events.ERROR,L)},m.handlePlaylistLoaded=function(p,y,u,_){var b=u.type,T=u.level,A=u.id,L=u.groupId,R=u.loader,w=u.levelDetails,O=u.deliveryDirectives;if(!(w!=null&&w.targetduration)){this.handleManifestParsingError(p,u,"invalid target duration",_);return}if(!!R)switch(w.live&&(R.getCacheAge&&(w.ageHeader=R.getCacheAge()||0),(!R.getCacheAge||isNaN(w.ageHeader))&&(w.ageHeader=0)),b){case f.PlaylistContextType.MANIFEST:case f.PlaylistContextType.LEVEL:this.hls.trigger(a.Events.LEVEL_LOADED,{details:w,level:T||0,id:A||0,stats:y,networkDetails:_,deliveryDirectives:O});break;case f.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(a.Events.AUDIO_TRACK_LOADED,{details:w,id:A||0,groupId:L||"",stats:y,networkDetails:_,deliveryDirectives:O});break;case f.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(a.Events.SUBTITLE_TRACK_LOADED,{details:w,id:A||0,groupId:L||"",stats:y,networkDetails:_,deliveryDirectives:O});break}},x}();i.default=S},"./src/polyfills/number.ts":function(r,i,t){t.r(i),t.d(i,"isFiniteNumber",function(){return n}),t.d(i,"MAX_SAFE_INTEGER",function(){return a});var n=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},a=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(r,i,t){t.r(i);var n=function(){function a(){}return a.getSilentFrame=function(l,v){switch(l){case"mp4a.40.2":if(v===1)return new Uint8Array([0,200,0,128,35,128]);if(v===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(v===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(v===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(v===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(v===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(v===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(v===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(v===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},a}();i.default=n},"./src/remux/mp4-generator.ts":function(r,i,t){t.r(i);var n=Math.pow(2,32)-1,a=function(){function o(){}return o.init=function(){o.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var v;for(v in o.types)o.types.hasOwnProperty(v)&&(o.types[v]=[v.charCodeAt(0),v.charCodeAt(1),v.charCodeAt(2),v.charCodeAt(3)]);var h=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),f=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);o.HDLR_TYPES={video:h,audio:f};var d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),g=new Uint8Array([0,0,0,0,0,0,0,0]);o.STTS=o.STSC=o.STCO=g,o.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),o.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),o.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),o.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var E=new Uint8Array([105,115,111,109]),S=new Uint8Array([97,118,99,49]),x=new Uint8Array([0,0,0,1]);o.FTYP=o.box(o.types.ftyp,E,x,E,S),o.DINF=o.box(o.types.dinf,o.box(o.types.dref,d))},o.box=function(v){for(var h=8,f=arguments.length,d=new Array(f>1?f-1:0),g=1;g<f;g++)d[g-1]=arguments[g];for(var E=d.length,S=E;E--;)h+=d[E].byteLength;var x=new Uint8Array(h);for(x[0]=h>>24&255,x[1]=h>>16&255,x[2]=h>>8&255,x[3]=h&255,x.set(v,4),E=0,h=8;E<S;E++)x.set(d[E],h),h+=d[E].byteLength;return x},o.hdlr=function(v){return o.box(o.types.hdlr,o.HDLR_TYPES[v])},o.mdat=function(v){return o.box(o.types.mdat,v)},o.mdhd=function(v,h){h*=v;var f=Math.floor(h/(n+1)),d=Math.floor(h%(n+1));return o.box(o.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,v>>24&255,v>>16&255,v>>8&255,v&255,f>>24,f>>16&255,f>>8&255,f&255,d>>24,d>>16&255,d>>8&255,d&255,85,196,0,0]))},o.mdia=function(v){return o.box(o.types.mdia,o.mdhd(v.timescale,v.duration),o.hdlr(v.type),o.minf(v))},o.mfhd=function(v){return o.box(o.types.mfhd,new Uint8Array([0,0,0,0,v>>24,v>>16&255,v>>8&255,v&255]))},o.minf=function(v){return v.type==="audio"?o.box(o.types.minf,o.box(o.types.smhd,o.SMHD),o.DINF,o.stbl(v)):o.box(o.types.minf,o.box(o.types.vmhd,o.VMHD),o.DINF,o.stbl(v))},o.moof=function(v,h,f){return o.box(o.types.moof,o.mfhd(v),o.traf(f,h))},o.moov=function(v){for(var h=v.length,f=[];h--;)f[h]=o.trak(v[h]);return o.box.apply(null,[o.types.moov,o.mvhd(v[0].timescale,v[0].duration)].concat(f).concat(o.mvex(v)))},o.mvex=function(v){for(var h=v.length,f=[];h--;)f[h]=o.trex(v[h]);return o.box.apply(null,[o.types.mvex].concat(f))},o.mvhd=function(v,h){h*=v;var f=Math.floor(h/(n+1)),d=Math.floor(h%(n+1)),g=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,v>>24&255,v>>16&255,v>>8&255,v&255,f>>24,f>>16&255,f>>8&255,f&255,d>>24,d>>16&255,d>>8&255,d&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o.box(o.types.mvhd,g)},o.sdtp=function(v){var h=v.samples||[],f=new Uint8Array(4+h.length),d,g;for(d=0;d<h.length;d++)g=h[d].flags,f[d+4]=g.dependsOn<<4|g.isDependedOn<<2|g.hasRedundancy;return o.box(o.types.sdtp,f)},o.stbl=function(v){return o.box(o.types.stbl,o.stsd(v),o.box(o.types.stts,o.STTS),o.box(o.types.stsc,o.STSC),o.box(o.types.stsz,o.STSZ),o.box(o.types.stco,o.STCO))},o.avc1=function(v){var h=[],f=[],d,g,E;for(d=0;d<v.sps.length;d++)g=v.sps[d],E=g.byteLength,h.push(E>>>8&255),h.push(E&255),h=h.concat(Array.prototype.slice.call(g));for(d=0;d<v.pps.length;d++)g=v.pps[d],E=g.byteLength,f.push(E>>>8&255),f.push(E&255),f=f.concat(Array.prototype.slice.call(g));var S=o.box(o.types.avcC,new Uint8Array([1,h[3],h[4],h[5],252|3,224|v.sps.length].concat(h).concat([v.pps.length]).concat(f))),x=v.width,m=v.height,c=v.pixelRatio[0],p=v.pixelRatio[1];return o.box(o.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,x>>8&255,x&255,m>>8&255,m&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),S,o.box(o.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),o.box(o.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,p>>24,p>>16&255,p>>8&255,p&255])))},o.esds=function(v){var h=v.config.length;return new Uint8Array([0,0,0,0,3,23+h,0,1,0,4,15+h,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([h]).concat(v.config).concat([6,1,2]))},o.mp4a=function(v){var h=v.samplerate;return o.box(o.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,v.channelCount,0,16,0,0,0,0,h>>8&255,h&255,0,0]),o.box(o.types.esds,o.esds(v)))},o.mp3=function(v){var h=v.samplerate;return o.box(o.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,v.channelCount,0,16,0,0,0,0,h>>8&255,h&255,0,0]))},o.stsd=function(v){return v.type==="audio"?!v.isAAC&&v.codec==="mp3"?o.box(o.types.stsd,o.STSD,o.mp3(v)):o.box(o.types.stsd,o.STSD,o.mp4a(v)):o.box(o.types.stsd,o.STSD,o.avc1(v))},o.tkhd=function(v){var h=v.id,f=v.duration*v.timescale,d=v.width,g=v.height,E=Math.floor(f/(n+1)),S=Math.floor(f%(n+1));return o.box(o.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,h>>24&255,h>>16&255,h>>8&255,h&255,0,0,0,0,E>>24,E>>16&255,E>>8&255,E&255,S>>24,S>>16&255,S>>8&255,S&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>8&255,d&255,0,0,g>>8&255,g&255,0,0]))},o.traf=function(v,h){var f=o.sdtp(v),d=v.id,g=Math.floor(h/(n+1)),E=Math.floor(h%(n+1));return o.box(o.types.traf,o.box(o.types.tfhd,new Uint8Array([0,0,0,0,d>>24,d>>16&255,d>>8&255,d&255])),o.box(o.types.tfdt,new Uint8Array([1,0,0,0,g>>24,g>>16&255,g>>8&255,g&255,E>>24,E>>16&255,E>>8&255,E&255])),o.trun(v,f.length+16+20+8+16+8+8),f)},o.trak=function(v){return v.duration=v.duration||4294967295,o.box(o.types.trak,o.tkhd(v),o.mdia(v))},o.trex=function(v){var h=v.id;return o.box(o.types.trex,new Uint8Array([0,0,0,0,h>>24,h>>16&255,h>>8&255,h&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},o.trun=function(v,h){var f=v.samples||[],d=f.length,g=12+16*d,E=new Uint8Array(g),S,x,m,c,p,y;for(h+=8+g,E.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,d&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255],0),S=0;S<d;S++)x=f[S],m=x.duration,c=x.size,p=x.flags,y=x.cts,E.set([m>>>24&255,m>>>16&255,m>>>8&255,m&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&240<<8,p.degradPrio&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*S);return o.box(o.types.trun,E)},o.initSegment=function(v){o.types||o.init();var h=o.moov(v),f=new Uint8Array(o.FTYP.byteLength+h.byteLength);return f.set(o.FTYP),f.set(h,o.FTYP.byteLength),f},o}();a.types=void 0,a.HDLR_TYPES=void 0,a.STTS=void 0,a.STSC=void 0,a.STCO=void 0,a.STSZ=void 0,a.VMHD=void 0,a.SMHD=void 0,a.STSD=void 0,a.FTYP=void 0,a.DINF=void 0,i.default=a},"./src/remux/mp4-remuxer.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return y}),t.d(i,"normalizePts",function(){return u});var n=t("./src/polyfills/number.ts"),a=t("./src/remux/aac-helper.ts"),o=t("./src/remux/mp4-generator.ts"),l=t("./src/events.ts"),v=t("./src/errors.ts"),h=t("./src/utils/logger.ts"),f=t("./src/types/loader.ts"),d=t("./src/utils/timescale-conversion.ts");function g(){return g=Object.assign||function(A){for(var L=1;L<arguments.length;L++){var R=arguments[L];for(var w in R)Object.prototype.hasOwnProperty.call(R,w)&&(A[w]=R[w])}return A},g.apply(this,arguments)}var E=10*1e3,S=1024,x=1152,m=null,c=null,p=!1,y=function(){function A(R,w,O,I){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=R,this.config=w,this.typeSupported=O,this.ISGenerated=!1,m===null){var D=navigator.userAgent||"",C=D.match(/Chrome\/(\d+)/i);m=C?parseInt(C[1]):0}if(c===null){var P=navigator.userAgent.match(/Safari\/(\d+)/i);c=P?parseInt(P[1]):0}p=!!m&&m<75||!!c&&c<600}var L=A.prototype;return L.destroy=function(){},L.resetTimeStamp=function(w){h.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=w},L.resetNextTimestamp=function(){h.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},L.resetInitSegment=function(){h.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},L.getVideoStartPts=function(w){var O=!1,I=w.reduce(function(D,C){var P=C.pts-D;return P<-4294967296?(O=!0,u(D,C.pts)):P>0?D:C.pts},w[0].pts);return O&&h.logger.debug("PTS rollover detected"),I},L.remux=function(w,O,I,D,C,P,M,N){var B,U,F,j,V,G,Y=C,X=C,ie=w.pid>-1,he=O.pid>-1,de=O.samples.length,Ae=w.samples.length>0,pe=de>1,le=(!ie||Ae)&&(!he||pe)||this.ISGenerated||M;if(le){this.ISGenerated||(F=this.generateIS(w,O,C));var Ie=this.isVideoContiguous,Ce=-1;if(pe&&(Ce=_(O.samples),!Ie&&this.config.forceKeyFrameOnDiscontinuity))if(G=!0,Ce>0){h.logger.warn("[mp4-remuxer]: Dropped "+Ce+" out of "+de+" video samples due to a missing keyframe");var Ue=this.getVideoStartPts(O.samples);O.samples=O.samples.slice(Ce),O.dropped+=Ce,X+=(O.samples[0].pts-Ue)/(O.timescale||9e4)}else Ce===-1&&(h.logger.warn("[mp4-remuxer]: No keyframe found out of "+de+" video samples"),G=!1);if(this.ISGenerated){if(Ae&&pe){var Me=this.getVideoStartPts(O.samples),ze=u(w.samples[0].pts,Me)-Me,Ge=ze/O.inputTimeScale;Y+=Math.max(0,Ge),X+=Math.max(0,-Ge)}if(Ae){if(w.samplerate||(h.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),F=this.generateIS(w,O,C)),U=this.remuxAudio(w,Y,this.isAudioContiguous,P,he||pe||N===f.PlaylistLevelType.AUDIO?X:void 0),pe){var $e=U?U.endPTS-U.startPTS:0;O.inputTimeScale||(h.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),F=this.generateIS(w,O,C)),B=this.remuxVideo(O,X,Ie,$e)}}else pe&&(B=this.remuxVideo(O,X,Ie,0));B&&(B.firstKeyFrame=Ce,B.independent=Ce!==-1)}}return this.ISGenerated&&(I.samples.length&&(V=this.remuxID3(I,C)),D.samples.length&&(j=this.remuxText(D,C))),{audio:U,video:B,initSegment:F,independent:G,text:j,id3:V}},L.generateIS=function(w,O,I){var D=w.samples,C=O.samples,P=this.typeSupported,M={},N=!Object(n.isFiniteNumber)(this._initPTS),B="audio/mp4",U,F,j;if(N&&(U=F=1/0),w.config&&D.length&&(w.timescale=w.samplerate,w.isAAC||(P.mpeg?(B="audio/mpeg",w.codec=""):P.mp3&&(w.codec="mp3")),M.audio={id:"audio",container:B,codec:w.codec,initSegment:!w.isAAC&&P.mpeg?new Uint8Array(0):o.default.initSegment([w]),metadata:{channelCount:w.channelCount}},N&&(j=w.inputTimeScale,U=F=D[0].pts-Math.round(j*I))),O.sps&&O.pps&&C.length&&(O.timescale=O.inputTimeScale,M.video={id:"main",container:"video/mp4",codec:O.codec,initSegment:o.default.initSegment([O]),metadata:{width:O.width,height:O.height}},N)){j=O.inputTimeScale;var V=this.getVideoStartPts(C),G=Math.round(j*I);F=Math.min(F,u(C[0].dts,V)-G),U=Math.min(U,V-G)}if(Object.keys(M).length)return this.ISGenerated=!0,N&&(this._initPTS=U,this._initDTS=F),{tracks:M,initPTS:U,timescale:j}},L.remuxVideo=function(w,O,I,D){var C=w.inputTimeScale,P=w.samples,M=[],N=P.length,B=this._initPTS,U=this.nextAvcDts,F=8,j,V,G,Y=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,ie=0,he=!1;if(!I||U===null){var de=O*C,Ae=P[0].pts-u(P[0].dts,P[0].pts);U=de-Ae}for(var pe=0;pe<N;pe++){var le=P[pe];if(le.pts=u(le.pts-B,U),le.dts=u(le.dts-B,U),le.dts>le.pts){var Ie=9e4*.2;ie=Math.max(Math.min(ie,le.pts-le.dts),-1*Ie)}le.dts<P[pe>0?pe-1:pe].dts&&(he=!0)}he&&P.sort(function(ke,Fe){var rt=ke.dts-Fe.dts,nr=ke.pts-Fe.pts;return rt||nr}),V=P[0].dts,G=P[P.length-1].dts;var Ce=Math.round((G-V)/(N-1));if(ie<0){if(ie<Ce*-2){h.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(d.toMsFromMpegTsClock)(-Ce,!0)+" ms");for(var Ue=ie,Me=0;Me<N;Me++)P[Me].dts=Ue=Math.max(Ue,P[Me].pts-Ce),P[Me].pts=Math.max(Ue,P[Me].pts)}else{h.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(d.toMsFromMpegTsClock)(ie,!0)+" ms to overcome this issue");for(var ze=0;ze<N;ze++)P[ze].dts=P[ze].dts+ie}V=P[0].dts}if(I){var Ge=V-U,$e=Ge>Ce,Ke=Ge<-1;if($e||Ke){$e?h.logger.warn("AVC: "+Object(d.toMsFromMpegTsClock)(Ge,!0)+" ms ("+Ge+"dts) hole between fragments detected, filling it"):h.logger.warn("AVC: "+Object(d.toMsFromMpegTsClock)(-Ge,!0)+" ms ("+Ge+"dts) overlapping between fragments detected"),V=U;var Ne=P[0].pts-Ge;P[0].dts=V,P[0].pts=Ne,h.logger.log("Video: First PTS/DTS adjusted: "+Object(d.toMsFromMpegTsClock)(Ne,!0)+"/"+Object(d.toMsFromMpegTsClock)(V,!0)+", delta: "+Object(d.toMsFromMpegTsClock)(Ge,!0)+" ms")}}p&&(V=Math.max(0,V));for(var Te=0,et=0,st=0;st<N;st++){for(var qe=P[st],ot=qe.units,nt=ot.length,dt=0,ne=0;ne<nt;ne++)dt+=ot[ne].data.length;et+=dt,Te+=nt,qe.length=dt,qe.dts=Math.max(qe.dts,V),qe.pts=Math.max(qe.pts,qe.dts,0),Y=Math.min(qe.pts,Y),X=Math.max(qe.pts,X)}G=P[N-1].dts;var Ee=et+4*Te+8,xe;try{xe=new Uint8Array(Ee)}catch(ke){this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:v.ErrorTypes.MUX_ERROR,details:v.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Ee,reason:"fail allocating video mdat "+Ee});return}var we=new DataView(xe.buffer);we.setUint32(0,Ee),xe.set(o.default.types.mdat,4);for(var be=0;be<N;be++){for(var je=P[be],K=je.units,ce=0,_e=0,Re=K.length;_e<Re;_e++){var Z=K[_e],ue=Z.data,W=Z.data.byteLength;we.setUint32(F,W),F+=4,xe.set(ue,F),F+=W,ce+=4+W}if(be<N-1)j=P[be+1].dts-je.dts;else{var me=this.config,He=je.dts-P[be>0?be-1:be].dts;if(me.stretchShortVideoTrack&&this.nextAudioPts!==null){var k=Math.floor(me.maxBufferHole*C),oe=(D?Y+D*C:this.nextAudioPts)-je.pts;oe>k?(j=oe-He,j<0&&(j=He),h.logger.log("[mp4-remuxer]: It is approximately "+oe/90+" ms to the next segment; using duration "+j/90+" ms for the last video frame.")):j=He}else j=He}var fe=Math.round(je.pts-je.dts);M.push(new b(je.key,j,ce,fe))}if(M.length&&m&&m<70){var z=M[0].flags;z.dependsOn=2,z.isNonSync=0}console.assert(j!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=U=G+j,this.isVideoContiguous=!0;var J=o.default.moof(w.sequenceNumber++,V,g({},w,{samples:M})),ae="video",We={data1:J,data2:xe,startPTS:Y/C,endPTS:(X+j)/C,startDTS:V/C,endDTS:U/C,type:ae,hasAudio:!1,hasVideo:!0,nb:M.length,dropped:w.dropped};return w.samples=[],w.dropped=0,console.assert(xe.length,"MDAT length must not be zero"),We},L.remuxAudio=function(w,O,I,D,C){var P=w.inputTimeScale,M=w.samplerate?w.samplerate:P,N=P/M,B=w.isAAC?S:x,U=B*N,F=this._initPTS,j=!w.isAAC&&this.typeSupported.mpeg,V=[],G=w.samples,Y=j?0:8,X=this.nextAudioPts||-1,ie=O*P;if(this.isAudioContiguous=I=I||G.length&&X>0&&(D&&Math.abs(ie-X)<9e3||Math.abs(u(G[0].pts-F,ie)-X)<20*U),G.forEach(function(ue){ue.pts=u(ue.pts-F,ie)}),!I||X<0){if(G=G.filter(function(ue){return ue.pts>=0}),!G.length)return;C===0?X=0:D?X=Math.max(0,ie):X=G[0].pts}if(w.isAAC)for(var he=C!==void 0,de=this.config.maxAudioFramesDrift,Ae=0,pe=X;Ae<G.length;Ae++){var le=G[Ae],Ie=le.pts,Ce=Ie-pe,Ue=Math.abs(1e3*Ce/P);if(Ce<=-de*U&&he)Ae===0&&(h.logger.warn("Audio frame @ "+(Ie/P).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*Ce/P)+" ms."),this.nextAudioPts=X=pe=Ie);else if(Ce>=de*U&&Ue<E&&he){var Me=Math.round(Ce/U);pe=Ie-Me*U,pe<0&&(Me--,pe+=U),Ae===0&&(this.nextAudioPts=X=pe),h.logger.warn("[mp4-remuxer]: Injecting "+Me+" audio frame @ "+(pe/P).toFixed(3)+"s due to "+Math.round(1e3*Ce/P)+" ms gap.");for(var ze=0;ze<Me;ze++){var Ge=Math.max(pe,0),$e=a.default.getSilentFrame(w.manifestCodec||w.codec,w.channelCount);$e||(h.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),$e=le.unit.subarray()),G.splice(Ae,0,{unit:$e,pts:Ge}),pe+=U,Ae++}}le.pts=pe,pe+=U}for(var Ke=null,Ne=null,Te,et=0,st=G.length;st--;)et+=G[st].unit.byteLength;for(var qe=0,ot=G.length;qe<ot;qe++){var nt=G[qe],dt=nt.unit,ne=nt.pts;if(Ne!==null){var Ee=V[qe-1];Ee.duration=Math.round((ne-Ne)/N)}else if(I&&w.isAAC&&(ne=X),Ke=ne,et>0){et+=Y;try{Te=new Uint8Array(et)}catch(ue){this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:v.ErrorTypes.MUX_ERROR,details:v.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:et,reason:"fail allocating audio mdat "+et});return}if(!j){var xe=new DataView(Te.buffer);xe.setUint32(0,et),Te.set(o.default.types.mdat,4)}}else return;Te.set(dt,Y);var we=dt.byteLength;Y+=we,V.push(new b(!0,B,we,0)),Ne=ne}var be=V.length;if(!!be){var je=V[V.length-1];this.nextAudioPts=X=Ne+N*je.duration;var K=j?new Uint8Array(0):o.default.moof(w.sequenceNumber++,Ke/N,g({},w,{samples:V}));w.samples=[];var ce=Ke/P,_e=X/P,Re="audio",Z={data1:K,data2:Te,startPTS:ce,endPTS:_e,startDTS:ce,endDTS:_e,type:Re,hasAudio:!0,hasVideo:!1,nb:be};return this.isAudioContiguous=!0,console.assert(Te.length,"MDAT length must not be zero"),Z}},L.remuxEmptyAudio=function(w,O,I,D){var C=w.inputTimeScale,P=w.samplerate?w.samplerate:C,M=C/P,N=this.nextAudioPts,B=(N!==null?N:D.startDTS*C)+this._initDTS,U=D.endDTS*C+this._initDTS,F=M*S,j=Math.ceil((U-B)/F),V=a.default.getSilentFrame(w.manifestCodec||w.codec,w.channelCount);if(h.logger.warn("[mp4-remuxer]: remux empty Audio"),!V){h.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var G=[],Y=0;Y<j;Y++){var X=B+Y*F;G.push({unit:V,pts:X,dts:X})}return w.samples=G,this.remuxAudio(w,O,I,!1)},L.remuxID3=function(w,O){var I=w.samples.length;if(!!I){for(var D=w.inputTimeScale,C=this._initPTS,P=this._initDTS,M=0;M<I;M++){var N=w.samples[M];N.pts=u(N.pts-C,O*D)/D,N.dts=u(N.dts-P,O*D)/D}var B=w.samples;return w.samples=[],{samples:B}}},L.remuxText=function(w,O){var I=w.samples.length;if(!!I){for(var D=w.inputTimeScale,C=this._initPTS,P=0;P<I;P++){var M=w.samples[P];M.pts=u(M.pts-C,O*D)/D}w.samples.sort(function(B,U){return B.pts-U.pts});var N=w.samples;return w.samples=[],{samples:N}}},A}();function u(A,L){var R;if(L===null)return A;for(L<A?R=-8589934592:R=8589934592;Math.abs(A-L)>4294967296;)A+=R;return A}function _(A){for(var L=0;L<A.length;L++)if(A[L].key)return L;return-1}var b=function(L,R,w,O){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=R,this.size=w,this.cts=O,this.flags=new T(L)},T=function(L){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=L?2:1,this.isNonSync=L?0:1}},"./src/remux/passthrough-remuxer.ts":function(r,i,t){t.r(i);var n=t("./src/polyfills/number.ts"),a=t("./src/utils/mp4-tools.ts"),o=t("./src/loader/fragment.ts"),l=t("./src/utils/logger.ts"),v=function(){function d(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var g=d.prototype;return g.destroy=function(){},g.resetTimeStamp=function(S){this.initPTS=S,this.lastEndDTS=null},g.resetNextTimestamp=function(){this.lastEndDTS=null},g.resetInitSegment=function(S,x,m){this.audioCodec=x,this.videoCodec=m,this.generateInitSegment(S),this.emitInitSegment=!0},g.generateInitSegment=function(S){var x=this.audioCodec,m=this.videoCodec;if(!S||!S.byteLength){this.initTracks=void 0,this.initData=void 0;return}var c=this.initData=Object(a.parseInitSegment)(S);x||(x=f(c.audio,o.ElementaryStreamTypes.AUDIO)),m||(m=f(c.video,o.ElementaryStreamTypes.VIDEO));var p={};c.audio&&c.video?p.audiovideo={container:"video/mp4",codec:x+","+m,initSegment:S,id:"main"}:c.audio?p.audio={container:"audio/mp4",codec:x,initSegment:S,id:"audio"}:c.video?p.video={container:"video/mp4",codec:m,initSegment:S,id:"main"}:l.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=p},g.remux=function(S,x,m,c,p){var y=this.initPTS,u=this.lastEndDTS,_={audio:void 0,video:void 0,text:c,id3:m,initSegment:void 0};Object(n.isFiniteNumber)(u)||(u=this.lastEndDTS=p||0);var b=x.samples;if(!b||!b.length)return _;var T={initPTS:void 0,timescale:1},A=this.initData;if((!A||!A.length)&&(this.generateInitSegment(b),A=this.initData),!A||!A.length)return l.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),_;this.emitInitSegment&&(T.tracks=this.initTracks,this.emitInitSegment=!1),Object(n.isFiniteNumber)(y)||(this.initPTS=T.initPTS=y=h(A,b,u));var L=Object(a.getDuration)(b,A),R=u,w=L+R;Object(a.offsetStartDTS)(A,b,y),L>0?this.lastEndDTS=w:(l.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var O=!!A.audio,I=!!A.video,D="";O&&(D+="audio"),I&&(D+="video");var C={data1:b,startPTS:R,startDTS:R,endPTS:w,endDTS:w,type:D,hasAudio:O,hasVideo:I,nb:1,dropped:0};return _.audio=C.type==="audio"?C:void 0,_.video=C.type!=="audio"?C:void 0,_.text=c,_.id3=m,_.initSegment=T,_},d}(),h=function(g,E,S){return Object(a.getStartDTS)(g,E)-S};function f(d,g){var E=d==null?void 0:d.codec;return E&&E.length>4?E:E==="hvc1"?"hvc1.1.c.L120.90":E==="av01"?"av01.0.04M.08":E==="avc1"||g===o.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}i.default=v},"./src/task-loop.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var o=a.prototype;return o.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},o.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},o.onHandlerDestroyed=function(){},o.hasInterval=function(){return!!this._tickInterval},o.hasNextTick=function(){return!!this._tickTimer},o.setInterval=function(v){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,v),!0)},o.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},o.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},o.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},o.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},o.doTick=function(){},a}()},"./src/types/cmcd.ts":function(r,i,t){t.r(i),t.d(i,"CMCDVersion",function(){return n}),t.d(i,"CMCDObjectType",function(){return a}),t.d(i,"CMCDStreamingFormat",function(){return o}),t.d(i,"CMCDStreamType",function(){return l});var n=1,a;(function(v){v.MANIFEST="m",v.AUDIO="a",v.VIDEO="v",v.MUXED="av",v.INIT="i",v.CAPTION="c",v.TIMED_TEXT="tt",v.KEY="k",v.OTHER="o"})(a||(a={}));var o;(function(v){v.DASH="d",v.HLS="h",v.SMOOTH="s",v.OTHER="o"})(o||(o={}));var l;(function(v){v.VOD="v",v.LIVE="l"})(l||(l={}))},"./src/types/level.ts":function(r,i,t){t.r(i),t.d(i,"HlsSkip",function(){return o}),t.d(i,"getSkipValue",function(){return l}),t.d(i,"HlsUrlParameters",function(){return v}),t.d(i,"Level",function(){return h});function n(f,d){for(var g=0;g<d.length;g++){var E=d[g];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(f,E.key,E)}}function a(f,d,g){return d&&n(f.prototype,d),g&&n(f,g),f}var o;(function(f){f.No="",f.Yes="YES",f.v2="v2"})(o||(o={}));function l(f,d){var g=f.canSkipUntil,E=f.canSkipDateRanges,S=f.endSN,x=d!==void 0?d-S:0;return g&&x<g?E?o.v2:o.Yes:o.No}var v=function(){function f(g,E,S){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=g,this.part=E,this.skip=S}var d=f.prototype;return d.addDirectives=function(E){var S=new self.URL(E);return this.msn!==void 0&&S.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&S.searchParams.set("_HLS_part",this.part.toString()),this.skip&&S.searchParams.set("_HLS_skip",this.skip),S.toString()},f}(),h=function(){function f(d){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[d.url],this.attrs=d.attrs,this.bitrate=d.bitrate,d.details&&(this.details=d.details),this.id=d.id||0,this.name=d.name,this.width=d.width||0,this.height=d.height||0,this.audioCodec=d.audioCodec,this.videoCodec=d.videoCodec,this.unknownCodecs=d.unknownCodecs,this.codecSet=[d.videoCodec,d.audioCodec].filter(function(g){return g}).join(",").replace(/\.[^.,]+/g,"")}return a(f,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(g){var E=g%this.url.length;this._urlId!==E&&(this.details=void 0,this._urlId=E)}}]),f}()},"./src/types/loader.ts":function(r,i,t){t.r(i),t.d(i,"PlaylistContextType",function(){return n}),t.d(i,"PlaylistLevelType",function(){return a});var n;(function(o){o.MANIFEST="manifest",o.LEVEL="level",o.AUDIO_TRACK="audioTrack",o.SUBTITLE_TRACK="subtitleTrack"})(n||(n={}));var a;(function(o){o.MAIN="main",o.AUDIO="audio",o.SUBTITLE="subtitle"})(a||(a={}))},"./src/types/transmuxer.ts":function(r,i,t){t.r(i),t.d(i,"ChunkMetadata",function(){return n});var n=function(l,v,h,f,d,g){f===void 0&&(f=0),d===void 0&&(d=-1),g===void 0&&(g=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=a(),this.buffering={audio:a(),video:a(),audiovideo:a()},this.level=l,this.sn=v,this.id=h,this.size=f,this.part=d,this.partial=g};function a(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(r,i,t){t.r(i),t.d(i,"AttrList",function(){return o});var n=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function l(h){typeof h=="string"&&(h=l.parseAttrList(h));for(var f in h)h.hasOwnProperty(f)&&(this[f]=h[f])}var v=l.prototype;return v.decimalInteger=function(f){var d=parseInt(this[f],10);return d>Number.MAX_SAFE_INTEGER?1/0:d},v.hexadecimalInteger=function(f){if(this[f]){var d=(this[f]||"0x").slice(2);d=(d.length&1?"0":"")+d;for(var g=new Uint8Array(d.length/2),E=0;E<d.length/2;E++)g[E]=parseInt(d.slice(E*2,E*2+2),16);return g}else return null},v.hexadecimalIntegerAsNumber=function(f){var d=parseInt(this[f],16);return d>Number.MAX_SAFE_INTEGER?1/0:d},v.decimalFloatingPoint=function(f){return parseFloat(this[f])},v.optionalFloat=function(f,d){var g=this[f];return g?parseFloat(g):d},v.enumeratedString=function(f){return this[f]},v.bool=function(f){return this[f]==="YES"},v.decimalResolution=function(f){var d=n.exec(this[f]);if(d!==null)return{width:parseInt(d[1],10),height:parseInt(d[2],10)}},l.parseAttrList=function(f){var d,g={},E='"';for(a.lastIndex=0;(d=a.exec(f))!==null;){var S=d[2];S.indexOf(E)===0&&S.lastIndexOf(E)===S.length-1&&(S=S.slice(1,-1)),g[d[1]]=S}return g},l}()},"./src/utils/binary-search.ts":function(r,i,t){t.r(i);var n={search:function(o,l){for(var v=0,h=o.length-1,f=null,d=null;v<=h;){f=(v+h)/2|0,d=o[f];var g=l(d);if(g>0)v=f+1;else if(g<0)h=f-1;else return d}return null}};i.default=n},"./src/utils/buffer-helper.ts":function(r,i,t){t.r(i),t.d(i,"BufferHelper",function(){return o});var n=t("./src/utils/logger.ts"),a={length:0,start:function(){return 0},end:function(){return 0}},o=function(){function l(){}return l.isBuffered=function(h,f){try{if(h){for(var d=l.getBuffered(h),g=0;g<d.length;g++)if(f>=d.start(g)&&f<=d.end(g))return!0}}catch(E){}return!1},l.bufferInfo=function(h,f,d){try{if(h){var g=l.getBuffered(h),E=[],S;for(S=0;S<g.length;S++)E.push({start:g.start(S),end:g.end(S)});return this.bufferedInfo(E,f,d)}}catch(x){}return{len:0,start:f,end:f,nextStart:void 0}},l.bufferedInfo=function(h,f,d){f=Math.max(0,f),h.sort(function(T,A){var L=T.start-A.start;return L||A.end-T.end});var g=[];if(d)for(var E=0;E<h.length;E++){var S=g.length;if(S){var x=g[S-1].end;h[E].start-x<d?h[E].end>x&&(g[S-1].end=h[E].end):g.push(h[E])}else g.push(h[E])}else g=h;for(var m=0,c,p=f,y=f,u=0;u<g.length;u++){var _=g[u].start,b=g[u].end;if(f+d>=_&&f<b)p=_,y=b,m=y-f;else if(f+d<_){c=_;break}}return{len:m,start:p||0,end:y||0,nextStart:c}},l.getBuffered=function(h){try{return h.buffered}catch(f){return n.logger.log("failed to get media.buffered",f),a}},l}()},"./src/utils/cea-608-parser.ts":function(r,i,t){t.r(i),t.d(i,"Row",function(){return y}),t.d(i,"CaptionScreen",function(){return u});var n=t("./src/utils/logger.ts"),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(w){var O=w;return a.hasOwnProperty(w)&&(O=a[w]),String.fromCharCode(O)},l=15,v=100,h={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},f={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},g={25:2,26:4,29:6,30:8,31:10,27:13,28:15},E=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],S;(function(R){R[R.ERROR=0]="ERROR",R[R.TEXT=1]="TEXT",R[R.WARNING=2]="WARNING",R[R.INFO=2]="INFO",R[R.DEBUG=3]="DEBUG",R[R.DATA=3]="DATA"})(S||(S={}));var x=function(){function R(){this.time=null,this.verboseLevel=S.ERROR}var w=R.prototype;return w.log=function(I,D){this.verboseLevel>=I&&n.logger.log(this.time+" ["+I+"] "+D)},R}(),m=function(w){for(var O=[],I=0;I<w.length;I++)O.push(w[I].toString(16));return O},c=function(){function R(O,I,D,C,P){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=O||"white",this.underline=I||!1,this.italics=D||!1,this.background=C||"black",this.flash=P||!1}var w=R.prototype;return w.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},w.setStyles=function(I){for(var D=["foreground","underline","italics","background","flash"],C=0;C<D.length;C++){var P=D[C];I.hasOwnProperty(P)&&(this[P]=I[P])}},w.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},w.equals=function(I){return this.foreground===I.foreground&&this.underline===I.underline&&this.italics===I.italics&&this.background===I.background&&this.flash===I.flash},w.copy=function(I){this.foreground=I.foreground,this.underline=I.underline,this.italics=I.italics,this.background=I.background,this.flash=I.flash},w.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},R}(),p=function(){function R(O,I,D,C,P,M){this.uchar=void 0,this.penState=void 0,this.uchar=O||" ",this.penState=new c(I,D,C,P,M)}var w=R.prototype;return w.reset=function(){this.uchar=" ",this.penState.reset()},w.setChar=function(I,D){this.uchar=I,this.penState.copy(D)},w.setPenState=function(I){this.penState.copy(I)},w.equals=function(I){return this.uchar===I.uchar&&this.penState.equals(I.penState)},w.copy=function(I){this.uchar=I.uchar,this.penState.copy(I.penState)},w.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},R}(),y=function(){function R(O){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var I=0;I<v;I++)this.chars.push(new p);this.logger=O,this.pos=0,this.currPenState=new c}var w=R.prototype;return w.equals=function(I){for(var D=!0,C=0;C<v;C++)if(!this.chars[C].equals(I.chars[C])){D=!1;break}return D},w.copy=function(I){for(var D=0;D<v;D++)this.chars[D].copy(I.chars[D])},w.isEmpty=function(){for(var I=!0,D=0;D<v;D++)if(!this.chars[D].isEmpty()){I=!1;break}return I},w.setCursor=function(I){this.pos!==I&&(this.pos=I),this.pos<0?(this.logger.log(S.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>v&&(this.logger.log(S.DEBUG,"Too large cursor position "+this.pos),this.pos=v)},w.moveCursor=function(I){var D=this.pos+I;if(I>1)for(var C=this.pos+1;C<D+1;C++)this.chars[C].setPenState(this.currPenState);this.setCursor(D)},w.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},w.insertChar=function(I){I>=144&&this.backSpace();var D=o(I);if(this.pos>=v){this.logger.log(S.ERROR,"Cannot insert "+I.toString(16)+" ("+D+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(D,this.currPenState),this.moveCursor(1)},w.clearFromPos=function(I){var D;for(D=I;D<v;D++)this.chars[D].reset()},w.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},w.clearToEndOfRow=function(){this.clearFromPos(this.pos)},w.getTextString=function(){for(var I=[],D=!0,C=0;C<v;C++){var P=this.chars[C].uchar;P!==" "&&(D=!1),I.push(P)}return D?"":I.join("")},w.setPenStyles=function(I){this.currPenState.setStyles(I);var D=this.chars[this.pos];D.setPenState(this.currPenState)},R}(),u=function(){function R(O){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var I=0;I<l;I++)this.rows.push(new y(O));this.logger=O,this.currRow=l-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var w=R.prototype;return w.reset=function(){for(var I=0;I<l;I++)this.rows[I].clear();this.currRow=l-1},w.equals=function(I){for(var D=!0,C=0;C<l;C++)if(!this.rows[C].equals(I.rows[C])){D=!1;break}return D},w.copy=function(I){for(var D=0;D<l;D++)this.rows[D].copy(I.rows[D])},w.isEmpty=function(){for(var I=!0,D=0;D<l;D++)if(!this.rows[D].isEmpty()){I=!1;break}return I},w.backSpace=function(){var I=this.rows[this.currRow];I.backSpace()},w.clearToEndOfRow=function(){var I=this.rows[this.currRow];I.clearToEndOfRow()},w.insertChar=function(I){var D=this.rows[this.currRow];D.insertChar(I)},w.setPen=function(I){var D=this.rows[this.currRow];D.setPenStyles(I)},w.moveCursor=function(I){var D=this.rows[this.currRow];D.moveCursor(I)},w.setCursor=function(I){this.logger.log(S.INFO,"setCursor: "+I);var D=this.rows[this.currRow];D.setCursor(I)},w.setPAC=function(I){this.logger.log(S.INFO,"pacData = "+JSON.stringify(I));var D=I.row-1;if(this.nrRollUpRows&&D<this.nrRollUpRows-1&&(D=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==D){for(var C=0;C<l;C++)this.rows[C].clear();var P=this.currRow+1-this.nrRollUpRows,M=this.lastOutputScreen;if(M){var N=M.rows[P].cueStartTime,B=this.logger.time;if(N&&B!==null&&N<B)for(var U=0;U<this.nrRollUpRows;U++)this.rows[D-this.nrRollUpRows+U+1].copy(M.rows[P+U])}}this.currRow=D;var F=this.rows[this.currRow];if(I.indent!==null){var j=I.indent,V=Math.max(j-1,0);F.setCursor(I.indent),I.color=F.chars[V].penState.foreground}var G={foreground:I.color,underline:I.underline,italics:I.italics,background:"black",flash:!1};this.setPen(G)},w.setBkgData=function(I){this.logger.log(S.INFO,"bkgData = "+JSON.stringify(I)),this.backSpace(),this.setPen(I),this.insertChar(32)},w.setRollUpRows=function(I){this.nrRollUpRows=I},w.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(S.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(S.TEXT,this.getDisplayText());var I=this.currRow+1-this.nrRollUpRows,D=this.rows.splice(I,1)[0];D.clear(),this.rows.splice(this.currRow,0,D),this.logger.log(S.INFO,"Rolling up")},w.getDisplayText=function(I){I=I||!1;for(var D=[],C="",P=-1,M=0;M<l;M++){var N=this.rows[M].getTextString();N&&(P=M+1,I?D.push("Row "+P+": '"+N+"'"):D.push(N.trim()))}return D.length>0&&(I?C="["+D.join(" | ")+"]":C=D.join(`
`)),C},w.getTextAndFormat=function(){return this.rows},R}(),_=function(){function R(O,I,D){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=O,this.outputFilter=I,this.mode=null,this.verbose=0,this.displayedMemory=new u(D),this.nonDisplayedMemory=new u(D),this.lastOutputScreen=new u(D),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=D}var w=R.prototype;return w.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},w.getHandler=function(){return this.outputFilter},w.setHandler=function(I){this.outputFilter=I},w.setPAC=function(I){this.writeScreen.setPAC(I)},w.setBkgData=function(I){this.writeScreen.setBkgData(I)},w.setMode=function(I){I!==this.mode&&(this.mode=I,this.logger.log(S.INFO,"MODE="+I),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=I)},w.insertChars=function(I){for(var D=0;D<I.length;D++)this.writeScreen.insertChar(I[D]);var C=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(S.INFO,C+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(S.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},w.ccRCL=function(){this.logger.log(S.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},w.ccBS=function(){this.logger.log(S.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},w.ccAOF=function(){},w.ccAON=function(){},w.ccDER=function(){this.logger.log(S.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},w.ccRU=function(I){this.logger.log(S.INFO,"RU("+I+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(I)},w.ccFON=function(){this.logger.log(S.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},w.ccRDC=function(){this.logger.log(S.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},w.ccTR=function(){this.logger.log(S.INFO,"TR"),this.setMode("MODE_TEXT")},w.ccRTD=function(){this.logger.log(S.INFO,"RTD"),this.setMode("MODE_TEXT")},w.ccEDM=function(){this.logger.log(S.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},w.ccCR=function(){this.logger.log(S.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},w.ccENM=function(){this.logger.log(S.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},w.ccEOC=function(){if(this.logger.log(S.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var I=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=I,this.writeScreen=this.nonDisplayedMemory,this.logger.log(S.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},w.ccTO=function(I){this.logger.log(S.INFO,"TO("+I+") - Tab Offset"),this.writeScreen.moveCursor(I)},w.ccMIDROW=function(I){var D={flash:!1};if(D.underline=I%2==1,D.italics=I>=46,D.italics)D.foreground="white";else{var C=Math.floor(I/2)-16,P=["white","green","blue","cyan","red","yellow","magenta"];D.foreground=P[C]}this.logger.log(S.INFO,"MIDROW: "+JSON.stringify(D)),this.writeScreen.setPen(D)},w.outputDataUpdate=function(I){I===void 0&&(I=!1);var D=this.logger.time;D!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=D:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,D,this.lastOutputScreen),I&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:D),this.lastOutputScreen.copy(this.displayedMemory))},w.cueSplitAtTime=function(I){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,I,this.displayedMemory),this.cueStartTime=I))},R}(),b=function(){function R(O,I,D){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var C=new x;this.channels=[null,new _(O,I,C),new _(O+1,D,C)],this.cmdHistory=L(),this.logger=C}var w=R.prototype;return w.getHandler=function(I){return this.channels[I].getHandler()},w.setHandler=function(I,D){this.channels[I].setHandler(D)},w.addData=function(I,D){var C,P,M,N=!1;this.logger.time=I;for(var B=0;B<D.length;B+=2)if(P=D[B]&127,M=D[B+1]&127,!(P===0&&M===0)){if(this.logger.log(S.DATA,"["+m([D[B],D[B+1]])+"] -> ("+m([P,M])+")"),C=this.parseCmd(P,M),C||(C=this.parseMidrow(P,M)),C||(C=this.parsePAC(P,M)),C||(C=this.parseBackgroundAttributes(P,M)),!C&&(N=this.parseChars(P,M),N)){var U=this.currentChannel;if(U&&U>0){var F=this.channels[U];F.insertChars(N)}else this.logger.log(S.WARNING,"No channel found yet. TEXT-MODE?")}!C&&!N&&this.logger.log(S.WARNING,"Couldn't parse cleaned data "+m([P,M])+" orig: "+m([D[B],D[B+1]]))}},w.parseCmd=function(I,D){var C=this.cmdHistory,P=(I===20||I===28||I===21||I===29)&&D>=32&&D<=47,M=(I===23||I===31)&&D>=33&&D<=35;if(!(P||M))return!1;if(A(I,D,C))return T(null,null,C),this.logger.log(S.DEBUG,"Repeated command ("+m([I,D])+") is dropped"),!0;var N=I===20||I===21||I===23?1:2,B=this.channels[N];return I===20||I===21||I===28||I===29?D===32?B.ccRCL():D===33?B.ccBS():D===34?B.ccAOF():D===35?B.ccAON():D===36?B.ccDER():D===37?B.ccRU(2):D===38?B.ccRU(3):D===39?B.ccRU(4):D===40?B.ccFON():D===41?B.ccRDC():D===42?B.ccTR():D===43?B.ccRTD():D===44?B.ccEDM():D===45?B.ccCR():D===46?B.ccENM():D===47&&B.ccEOC():B.ccTO(D-32),T(I,D,C),this.currentChannel=N,!0},w.parseMidrow=function(I,D){var C=0;if((I===17||I===25)&&D>=32&&D<=47){if(I===17?C=1:C=2,C!==this.currentChannel)return this.logger.log(S.ERROR,"Mismatch channel in midrow parsing"),!1;var P=this.channels[C];return P?(P.ccMIDROW(D),this.logger.log(S.DEBUG,"MIDROW ("+m([I,D])+")"),!0):!1}return!1},w.parsePAC=function(I,D){var C,P=this.cmdHistory,M=(I>=17&&I<=23||I>=25&&I<=31)&&D>=64&&D<=127,N=(I===16||I===24)&&D>=64&&D<=95;if(!(M||N))return!1;if(A(I,D,P))return T(null,null,P),!0;var B=I<=23?1:2;D>=64&&D<=95?C=B===1?h[I]:d[I]:C=B===1?f[I]:g[I];var U=this.channels[B];return U?(U.setPAC(this.interpretPAC(C,D)),T(I,D,P),this.currentChannel=B,!0):!1},w.interpretPAC=function(I,D){var C,P={color:null,italics:!1,indent:null,underline:!1,row:I};return D>95?C=D-96:C=D-64,P.underline=(C&1)==1,C<=13?P.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(C/2)]:C<=15?(P.italics=!0,P.color="white"):P.indent=Math.floor((C-16)/2)*4,P},w.parseChars=function(I,D){var C,P=null,M=null;if(I>=25?(C=2,M=I-8):(C=1,M=I),M>=17&&M<=19){var N;M===17?N=D+80:M===18?N=D+112:N=D+144,this.logger.log(S.INFO,"Special char '"+o(N)+"' in channel "+C),P=[N]}else I>=32&&I<=127&&(P=D===0?[I]:[I,D]);if(P){var B=m(P);this.logger.log(S.DEBUG,"Char codes =  "+B.join(",")),T(I,D,this.cmdHistory)}return P},w.parseBackgroundAttributes=function(I,D){var C=(I===16||I===24)&&D>=32&&D<=47,P=(I===23||I===31)&&D>=45&&D<=47;if(!(C||P))return!1;var M,N={};I===16||I===24?(M=Math.floor((D-32)/2),N.background=E[M],D%2==1&&(N.background=N.background+"_semi")):D===45?N.background="transparent":(N.foreground="black",D===47&&(N.underline=!0));var B=I<=23?1:2,U=this.channels[B];return U.setBkgData(N),T(I,D,this.cmdHistory),!0},w.reset=function(){for(var I=0;I<Object.keys(this.channels).length;I++){var D=this.channels[I];D&&D.reset()}this.cmdHistory=L()},w.cueSplitAtTime=function(I){for(var D=0;D<this.channels.length;D++){var C=this.channels[D];C&&C.cueSplitAtTime(I)}},R}();function T(R,w,O){O.a=R,O.b=w}function A(R,w,O){return O.a===R&&O.b===w}function L(){return{a:null,b:null}}i.default=b},"./src/utils/codecs.ts":function(r,i,t){t.r(i),t.d(i,"isCodecType",function(){return a}),t.d(i,"isCodecSupportedInMp4",function(){return o});var n={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function a(l,v){var h=n[v];return!!h&&h[l.slice(0,4)]===!0}function o(l,v){return MediaSource.isTypeSupported((v||"video")+'/mp4;codecs="'+l+'"')}},"./src/utils/cues.ts":function(r,i,t){t.r(i);var n=t("./src/utils/vttparser.ts"),a=t("./src/utils/webvtt-parser.ts"),o=t("./src/utils/texttrack-utils.ts"),l=/\s/,v={newCue:function(f,d,g,E){for(var S=[],x,m,c,p,y,u=self.VTTCue||self.TextTrackCue,_=0;_<E.rows.length;_++)if(x=E.rows[_],c=!0,p=0,y="",!x.isEmpty()){for(var b=0;b<x.chars.length;b++)l.test(x.chars[b].uchar)&&c?p++:(y+=x.chars[b].uchar,c=!1);x.cueStartTime=d,d===g&&(g+=1e-4),p>=16?p--:p++;var T=Object(n.fixLineBreaks)(y.trim()),A=Object(a.generateCueId)(d,g,T);(!f||!f.cues||!f.cues.getCueById(A))&&(m=new u(d,g,T),m.id=A,m.line=_+1,m.align="left",m.position=10+Math.min(80,Math.floor(p*8/32)*10),S.push(m))}return f&&S.length&&(S.sort(function(L,R){return L.line==="auto"||R.line==="auto"?0:L.line>8&&R.line>8?R.line-L.line:L.line-R.line}),S.forEach(function(L){return Object(o.addCueToTrack)(f,L)})),S}};i.default=v},"./src/utils/discontinuities.ts":function(r,i,t){t.r(i),t.d(i,"findFirstFragWithCC",function(){return l}),t.d(i,"shouldAlignOnDiscontinuities",function(){return v}),t.d(i,"findDiscontinuousReferenceFrag",function(){return h}),t.d(i,"adjustSlidingStart",function(){return d}),t.d(i,"alignStream",function(){return g}),t.d(i,"alignPDT",function(){return S}),t.d(i,"alignFragmentByPDTDelta",function(){return x}),t.d(i,"alignMediaPlaylistByPDT",function(){return m});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/logger.ts"),o=t("./src/controller/level-helper.ts");function l(c,p){for(var y=null,u=0,_=c.length;u<_;u++){var b=c[u];if(b&&b.cc===p){y=b;break}}return y}function v(c,p,y){return!!(p.details&&(y.endCC>y.startCC||c&&c.cc<y.startCC))}function h(c,p){var y=c.fragments,u=p.fragments;if(!u.length||!y.length){a.logger.log("No fragments to align");return}var _=l(y,u[0].cc);if(!_||_&&!_.startPTS){a.logger.log("No frag in previous level to align on");return}return _}function f(c,p){if(c){var y=c.start+p;c.start=c.startPTS=y,c.endPTS=y+c.duration}}function d(c,p){for(var y=p.fragments,u=0,_=y.length;u<_;u++)f(y[u],c);p.fragmentHint&&f(p.fragmentHint,c),p.alignedSliding=!0}function g(c,p,y){!p||(E(c,y,p),!y.alignedSliding&&p.details&&S(y,p.details),!y.alignedSliding&&p.details&&!y.skippedSegments&&Object(o.adjustSliding)(p.details,y))}function E(c,p,y){if(v(c,y,p)){var u=h(y.details,p);u&&Object(n.isFiniteNumber)(u.start)&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level "+p.url),d(u.start,p))}}function S(c,p){if(!(!p.fragments.length||!c.hasProgramDateTime||!p.hasProgramDateTime)){var y=p.fragments[0].programDateTime,u=c.fragments[0].programDateTime,_=(u-y)/1e3+p.fragments[0].start;_&&Object(n.isFiniteNumber)(_)&&(a.logger.log("Adjusting PTS using programDateTime delta "+(u-y)+"ms, sliding:"+_.toFixed(3)+" "+c.url+" "),d(_,c))}}function x(c,p){var y=c.programDateTime;if(!!y){var u=(y-p)/1e3;c.start=c.startPTS=u,c.endPTS=u+c.duration}}function m(c,p){if(!(!p.fragments.length||!c.hasProgramDateTime||!p.hasProgramDateTime)){var y=p.fragments[0].programDateTime,u=p.fragments[0].start,_=y-u*1e3;c.fragments.forEach(function(b){x(b,_)}),c.fragmentHint&&x(c.fragmentHint,_),c.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(r,i,t){t.r(i);var n=t("./src/utils/ewma.ts"),a=function(){function o(v,h,f){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=f,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new n.default(v),this.fast_=new n.default(h)}var l=o.prototype;return l.update=function(h,f){var d=this.slow_,g=this.fast_;this.slow_.halfLife!==h&&(this.slow_=new n.default(h,d.getEstimate(),d.getTotalWeight())),this.fast_.halfLife!==f&&(this.fast_=new n.default(f,g.getEstimate(),g.getTotalWeight()))},l.sample=function(h,f){h=Math.max(h,this.minDelayMs_);var d=8*f,g=h/1e3,E=d/g;this.fast_.sample(g,E),this.slow_.sample(g,E)},l.canEstimate=function(){var h=this.fast_;return h&&h.getTotalWeight()>=this.minWeight_},l.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},l.destroy=function(){},o}();i.default=a},"./src/utils/ewma.ts":function(r,i,t){t.r(i);var n=function(){function a(l,v,h){v===void 0&&(v=0),h===void 0&&(h=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=l,this.alpha_=l?Math.exp(Math.log(.5)/l):0,this.estimate_=v,this.totalWeight_=h}var o=a.prototype;return o.sample=function(v,h){var f=Math.pow(this.alpha_,v);this.estimate_=h*(1-f)+f*this.estimate_,this.totalWeight_+=v},o.getTotalWeight=function(){return this.totalWeight_},o.getEstimate=function(){if(this.alpha_){var v=1-Math.pow(this.alpha_,this.totalWeight_);if(v)return this.estimate_/v}return this.estimate_},a}();i.default=n},"./src/utils/fetch-loader.ts":function(r,i,t){t.r(i),t.d(i,"fetchSupported",function(){return x});var n=t("./src/polyfills/number.ts"),a=t("./src/loader/load-stats.ts"),o=t("./src/demux/chunk-cache.ts");function l(u,_){u.prototype=Object.create(_.prototype),u.prototype.constructor=u,g(u,_)}function v(u){var _=typeof Map=="function"?new Map:void 0;return v=function(T){if(T===null||!d(T))return T;if(typeof T!="function")throw new TypeError("Super expression must either be null or a function");if(typeof _!="undefined"){if(_.has(T))return _.get(T);_.set(T,A)}function A(){return h(T,arguments,E(this).constructor)}return A.prototype=Object.create(T.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),g(A,T)},v(u)}function h(u,_,b){return f()?h=Reflect.construct:h=function(A,L,R){var w=[null];w.push.apply(w,L);var O=Function.bind.apply(A,w),I=new O;return R&&g(I,R.prototype),I},h.apply(null,arguments)}function f(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(u){return!1}}function d(u){return Function.toString.call(u).indexOf("[native code]")!==-1}function g(u,_){return g=Object.setPrototypeOf||function(T,A){return T.__proto__=A,T},g(u,_)}function E(u){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)},E(u)}function S(){return S=Object.assign||function(u){for(var _=1;_<arguments.length;_++){var b=arguments[_];for(var T in b)Object.prototype.hasOwnProperty.call(b,T)&&(u[T]=b[T])}return u},S.apply(this,arguments)}function x(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(u){}return!1}var m=function(){function u(b){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=b.fetchSetup||p,this.controller=new self.AbortController,this.stats=new a.LoadStats}var _=u.prototype;return _.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},_.abortInternal=function(){var T=this.response;(!T||!T.ok)&&(this.stats.aborted=!0,this.controller.abort())},_.abort=function(){var T;this.abortInternal(),(T=this.callbacks)!==null&&T!==void 0&&T.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},_.load=function(T,A,L){var R=this,w=this.stats;if(w.loading.start)throw new Error("Loader can only be used once.");w.loading.start=self.performance.now();var O=c(T,this.controller.signal),I=L.onProgress,D=T.responseType==="arraybuffer",C=D?"byteLength":"length";this.context=T,this.config=A,this.callbacks=L,this.request=this.fetchSetup(T,O),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){R.abortInternal(),L.onTimeout(w,T,R.response)},A.timeout),self.fetch(this.request).then(function(P){if(R.response=R.loader=P,!P.ok){var M=P.status,N=P.statusText;throw new y(N||"fetch, bad network response",M,P)}return w.loading.first=Math.max(self.performance.now(),w.loading.start),w.total=parseInt(P.headers.get("Content-Length")||"0"),I&&Object(n.isFiniteNumber)(A.highWaterMark)?R.loadProgressively(P,w,T,A.highWaterMark,I):D?P.arrayBuffer():P.text()}).then(function(P){var M=R.response;self.clearTimeout(R.requestTimeout),w.loading.end=Math.max(self.performance.now(),w.loading.first),w.loaded=w.total=P[C];var N={url:M.url,data:P};I&&!Object(n.isFiniteNumber)(A.highWaterMark)&&I(w,T,P,M),L.onSuccess(N,w,T,M)}).catch(function(P){if(self.clearTimeout(R.requestTimeout),!w.aborted){var M=P.code||0;L.onError({code:M,text:P.message},T,P.details)}})},_.getCacheAge=function(){var T=null;if(this.response){var A=this.response.headers.get("age");T=A?parseFloat(A):null}return T},_.loadProgressively=function(T,A,L,R,w){R===void 0&&(R=0);var O=new o.default,I=T.body.getReader(),D=function C(){return I.read().then(function(P){if(P.done)return O.dataLength&&w(A,L,O.flush(),T),Promise.resolve(new ArrayBuffer(0));var M=P.value,N=M.length;return A.loaded+=N,N<R||O.dataLength?(O.push(M),O.dataLength>=R&&w(A,L,O.flush(),T)):w(A,L,M,T),C()}).catch(function(){return Promise.reject()})};return D()},u}();function c(u,_){var b={method:"GET",mode:"cors",credentials:"same-origin",signal:_,headers:new self.Headers(S({},u.headers))};return u.rangeEnd&&b.headers.set("Range","bytes="+u.rangeStart+"-"+String(u.rangeEnd-1)),b}function p(u,_){return new self.Request(u.url,_)}var y=function(u){l(_,u);function _(b,T,A){var L;return L=u.call(this,b)||this,L.code=void 0,L.details=void 0,L.code=T,L.details=A,L}return _}(v(Error));i.default=m},"./src/utils/imsc1-ttml-parser.ts":function(r,i,t){t.r(i),t.d(i,"IMSC1_CODEC",function(){return d}),t.d(i,"parseIMSC1",function(){return x});var n=t("./src/utils/mp4-tools.ts"),a=t("./src/utils/vttparser.ts"),o=t("./src/utils/vttcue.ts"),l=t("./src/demux/id3.ts"),v=t("./src/utils/timescale-conversion.ts"),h=t("./src/utils/webvtt-parser.ts");function f(){return f=Object.assign||function(R){for(var w=1;w<arguments.length;w++){var O=arguments[w];for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(R[I]=O[I])}return R},f.apply(this,arguments)}var d="stpp.ttml.im1t",g=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,E=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,S={left:"start",center:"center",right:"end",start:"start",end:"end"};function x(R,w,O,I,D){var C=Object(n.findBox)(new Uint8Array(R),["mdat"]);if(C.length===0){D(new Error("Could not parse IMSC1 mdat"));return}var P=C[0],M=Object(l.utf8ArrayToStr)(new Uint8Array(R,P.start,P.end-P.start)),N=Object(v.toTimescaleFromScale)(w,1,O);try{I(m(M,N))}catch(B){D(B)}}function m(R,w){var O=new DOMParser,I=O.parseFromString(R,"text/xml"),D=I.getElementsByTagName("tt")[0];if(!D)throw new Error("Invalid ttml");var C={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},P=Object.keys(C).reduce(function(F,j){return F[j]=D.getAttribute("ttp:"+j)||C[j],F},{}),M=D.getAttribute("xml:space")!=="preserve",N=p(c(D,"styling","style")),B=p(c(D,"layout","region")),U=c(D,"body","[begin]");return[].map.call(U,function(F){var j=y(F,M);if(!j||!F.hasAttribute("begin"))return null;var V=T(F.getAttribute("begin"),P),G=T(F.getAttribute("dur"),P),Y=T(F.getAttribute("end"),P);if(V===null)throw b(F);if(Y===null){if(G===null)throw b(F);Y=V+G}var X=new o.default(V-w,Y-w,j);X.id=Object(h.generateCueId)(X.startTime,X.endTime,X.text);var ie=B[F.getAttribute("region")],he=N[F.getAttribute("style")];X.position=10,X.size=80;var de=u(ie,he),Ae=de.textAlign;if(Ae){var pe=S[Ae];pe&&(X.lineAlign=pe),X.align=Ae}return f(X,de),X}).filter(function(F){return F!==null})}function c(R,w,O){var I=R.getElementsByTagName(w)[0];return I?[].slice.call(I.querySelectorAll(O)):[]}function p(R){return R.reduce(function(w,O){var I=O.getAttribute("xml:id");return I&&(w[I]=O),w},{})}function y(R,w){return[].slice.call(R.childNodes).reduce(function(O,I,D){var C;return I.nodeName==="br"&&D?O+`
`:(C=I.childNodes)!==null&&C!==void 0&&C.length?y(I,w):w?O+I.textContent.trim().replace(/\s+/g," "):O+I.textContent},"")}function u(R,w){var O="http://www.w3.org/ns/ttml#styling",I=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return I.reduce(function(D,C){var P=_(w,O,C)||_(R,O,C);return P&&(D[C]=P),D},{})}function _(R,w,O){return R.hasAttributeNS(w,O)?R.getAttributeNS(w,O):null}function b(R){return new Error("Could not parse ttml timestamp "+R)}function T(R,w){if(!R)return null;var O=Object(a.parseTimeStamp)(R);return O===null&&(g.test(R)?O=A(R,w):E.test(R)&&(O=L(R,w))),O}function A(R,w){var O=g.exec(R),I=(O[4]|0)+(O[5]|0)/w.subFrameRate;return(O[1]|0)*3600+(O[2]|0)*60+(O[3]|0)+I/w.frameRate}function L(R,w){var O=E.exec(R),I=Number(O[1]),D=O[2];switch(D){case"h":return I*3600;case"m":return I*60;case"ms":return I*1e3;case"f":return I/w.frameRate;case"t":return I/w.tickRate}return I}},"./src/utils/logger.ts":function(r,i,t){t.r(i),t.d(i,"enableLogs",function(){return h}),t.d(i,"logger",function(){return f});var n=function(){},a={trace:n,debug:n,log:n,warn:n,info:n,error:n},o=a;function l(d){var g=self.console[d];return g?g.bind(self.console,"["+d+"] >"):n}function v(d){for(var g=arguments.length,E=new Array(g>1?g-1:0),S=1;S<g;S++)E[S-1]=arguments[S];E.forEach(function(x){o[x]=d[x]?d[x].bind(d):l(x)})}function h(d){if(self.console&&d===!0||typeof d=="object"){v(d,"debug","log","info","warn","error");try{o.log()}catch(g){o=a}}else o=a}var f=o},"./src/utils/mediakeys-helper.ts":function(r,i,t){t.r(i),t.d(i,"KeySystems",function(){return n}),t.d(i,"requestMediaKeySystemAccess",function(){return a});var n;(function(o){o.WIDEVINE="com.widevine.alpha",o.PLAYREADY="com.microsoft.playready"})(n||(n={}));var a=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(r,i,t){t.r(i),t.d(i,"getMediaSource",function(){return n});function n(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(r,i,t){t.r(i),t.d(i,"bin2str",function(){return v}),t.d(i,"readUint16",function(){return h}),t.d(i,"readUint32",function(){return f}),t.d(i,"writeUint32",function(){return d}),t.d(i,"findBox",function(){return g}),t.d(i,"parseSegmentIndex",function(){return E}),t.d(i,"parseInitSegment",function(){return S}),t.d(i,"getStartDTS",function(){return x}),t.d(i,"getDuration",function(){return m}),t.d(i,"computeRawDurationFromSamples",function(){return c}),t.d(i,"offsetStartDTS",function(){return p}),t.d(i,"segmentValidRange",function(){return y}),t.d(i,"appendUint8Array",function(){return u});var n=t("./src/utils/typed-array.ts"),a=t("./src/loader/fragment.ts"),o=Math.pow(2,32)-1,l=[].push;function v(_){return String.fromCharCode.apply(null,_)}function h(_,b){"data"in _&&(b+=_.start,_=_.data);var T=_[b]<<8|_[b+1];return T<0?65536+T:T}function f(_,b){"data"in _&&(b+=_.start,_=_.data);var T=_[b]<<24|_[b+1]<<16|_[b+2]<<8|_[b+3];return T<0?4294967296+T:T}function d(_,b,T){"data"in _&&(b+=_.start,_=_.data),_[b]=T>>24,_[b+1]=T>>16&255,_[b+2]=T>>8&255,_[b+3]=T&255}function g(_,b){var T=[];if(!b.length)return T;var A,L,R;"data"in _?(A=_.data,L=_.start,R=_.end):(A=_,L=0,R=A.byteLength);for(var w=L;w<R;){var O=f(A,w),I=v(A.subarray(w+4,w+8)),D=O>1?w+O:R;if(I===b[0])if(b.length===1)T.push({data:A,start:w+8,end:D});else{var C=g({data:A,start:w+8,end:D},b.slice(1));C.length&&l.apply(T,C)}w=D}return T}function E(_){var b=g(_,["moov"]),T=b[0],A=T?T.end:null,L=g(_,["sidx"]);if(!L||!L[0])return null;var R=[],w=L[0],O=w.data[0],I=O===0?8:16,D=f(w,I);I+=4;var C=0,P=0;O===0?I+=8:I+=16,I+=2;var M=w.end+P,N=h(w,I);I+=2;for(var B=0;B<N;B++){var U=I,F=f(w,U);U+=4;var j=F&2147483647,V=(F&2147483648)>>>31;if(V===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var G=f(w,U);U+=4,R.push({referenceSize:j,subsegmentDuration:G,info:{duration:G/D,start:M,end:M+j-1}}),M+=j,U+=4,I=U}return{earliestPresentationTime:C,timescale:D,version:O,referencesCount:N,references:R,moovEndOffset:A}}function S(_){for(var b=[],T=g(_,["moov","trak"]),A=0;A<T.length;A++){var L=T[A],R=g(L,["tkhd"])[0];if(R){var w=R.data[R.start],O=w===0?12:20,I=f(R,O),D=g(L,["mdia","mdhd"])[0];if(D){w=D.data[D.start],O=w===0?12:20;var C=f(D,O),P=g(L,["mdia","hdlr"])[0];if(P){var M=v(P.data.subarray(P.start+8,P.start+12)),N={soun:a.ElementaryStreamTypes.AUDIO,vide:a.ElementaryStreamTypes.VIDEO}[M];if(N){var B=g(L,["mdia","minf","stbl","stsd"])[0],U=void 0;B&&(U=v(B.data.subarray(B.start+12,B.start+16))),b[I]={timescale:C,type:N},b[N]={timescale:C,id:I,codec:U}}}}}}var F=g(_,["moov","mvex","trex"]);return F.forEach(function(j){var V=f(j,4),G=b[V];G&&(G.default={duration:f(j,12),flags:f(j,20)})}),b}function x(_,b){return g(b,["moof","traf"]).reduce(function(T,A){var L=g(A,["tfdt"])[0],R=L.data[L.start],w=g(A,["tfhd"]).reduce(function(O,I){var D=f(I,4),C=_[D];if(C){var P=f(L,4);R===1&&(P*=Math.pow(2,32),P+=f(L,8));var M=C.timescale||9e4,N=P/M;if(isFinite(N)&&(O===null||N<O))return N}return O},null);return w!==null&&isFinite(w)&&(T===null||w<T)?w:T},null)||0}function m(_,b){for(var T=0,A=0,L=0,R=g(_,["moof","traf"]),w=0;w<R.length;w++){var O=R[w],I=g(O,["tfhd"])[0],D=f(I,4),C=b[D];if(!!C){var P=C.default,M=f(I,0)|(P==null?void 0:P.flags),N=P==null?void 0:P.duration;M&8&&(M&2?N=f(I,12):N=f(I,8));for(var B=C.timescale||9e4,U=g(O,["trun"]),F=0;F<U.length;F++){if(T=c(U[F]),!T&&N){var j=f(U[F],4);T=N*j}C.type===a.ElementaryStreamTypes.VIDEO?A+=T/B:C.type===a.ElementaryStreamTypes.AUDIO&&(L+=T/B)}}}if(A===0&&L===0){var V=E(_);if(V!=null&&V.references)return V.references.reduce(function(G,Y){return G+Y.info.duration||0},0)}return A||L}function c(_){var b=f(_,0),T=8;b&1&&(T+=4),b&4&&(T+=4);for(var A=0,L=f(_,4),R=0;R<L;R++){if(b&256){var w=f(_,T);A+=w,T+=4}b&512&&(T+=4),b&1024&&(T+=4),b&2048&&(T+=4)}return A}function p(_,b,T){g(b,["moof","traf"]).forEach(function(A){g(A,["tfhd"]).forEach(function(L){var R=f(L,4),w=_[R];if(!!w){var O=w.timescale||9e4;g(A,["tfdt"]).forEach(function(I){var D=I.data[I.start],C=f(I,4);if(D===0)d(I,4,C-T*O);else{C*=Math.pow(2,32),C+=f(I,8),C-=T*O,C=Math.max(C,0);var P=Math.floor(C/(o+1)),M=Math.floor(C%(o+1));d(I,4,P),d(I,8,M)}})}})})}function y(_){var b={valid:null,remainder:null},T=g(_,["moof"]);if(T){if(T.length<2)return b.remainder=_,b}else return b;var A=T[T.length-1];return b.valid=Object(n.sliceUint8)(_,0,A.start-8),b.remainder=Object(n.sliceUint8)(_,A.start-8),b}function u(_,b){var T=new Uint8Array(_.length+b.length);return T.set(_),T.set(b,_.length),T}},"./src/utils/output-filter.ts":function(r,i,t){t.r(i),t.d(i,"default",function(){return n});var n=function(){function a(l,v){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=l,this.trackName=v}var o=a.prototype;return o.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},o.newCue=function(v,h,f){(this.startTime===null||this.startTime>v)&&(this.startTime=v),this.endTime=h,this.screen=f,this.timelineController.createCaptionsTrack(this.trackName)},o.reset=function(){this.cueRanges=[],this.startTime=null},a}()},"./src/utils/texttrack-utils.ts":function(r,i,t){t.r(i),t.d(i,"sendAddTrackEvent",function(){return a}),t.d(i,"addCueToTrack",function(){return o}),t.d(i,"clearCurrentCues",function(){return l}),t.d(i,"removeCuesInRange",function(){return v}),t.d(i,"getCuesInRange",function(){return f});var n=t("./src/utils/logger.ts");function a(d,g){var E;try{E=new Event("addtrack")}catch(S){E=document.createEvent("Event"),E.initEvent("addtrack",!1,!1)}E.track=d,g.dispatchEvent(E)}function o(d,g){var E=d.mode;if(E==="disabled"&&(d.mode="hidden"),d.cues&&!d.cues.getCueById(g.id))try{if(d.addCue(g),!d.cues.getCueById(g.id))throw new Error("addCue is failed for: "+g)}catch(x){n.logger.debug("[texttrack-utils]: "+x);var S=new self.TextTrackCue(g.startTime,g.endTime,g.text);S.id=g.id,d.addCue(S)}E==="disabled"&&(d.mode=E)}function l(d){var g=d.mode;if(g==="disabled"&&(d.mode="hidden"),d.cues)for(var E=d.cues.length;E--;)d.removeCue(d.cues[E]);g==="disabled"&&(d.mode=g)}function v(d,g,E){var S=d.mode;if(S==="disabled"&&(d.mode="hidden"),d.cues&&d.cues.length>0)for(var x=f(d.cues,g,E),m=0;m<x.length;m++)d.removeCue(x[m]);S==="disabled"&&(d.mode=S)}function h(d,g){if(g<d[0].startTime)return 0;var E=d.length-1;if(g>d[E].endTime)return-1;for(var S=0,x=E;S<=x;){var m=Math.floor((x+S)/2);if(g<d[m].startTime)x=m-1;else if(g>d[m].startTime&&S<E)S=m+1;else return m}return d[S].startTime-g<g-d[x].startTime?S:x}function f(d,g,E){var S=[],x=h(d,g);if(x>-1)for(var m=x,c=d.length;m<c;m++){var p=d[m];if(p.startTime>=g&&p.endTime<=E)S.push(p);else if(p.startTime>E)return S}return S}},"./src/utils/time-ranges.ts":function(r,i,t){t.r(i);var n={toString:function(o){for(var l="",v=o.length,h=0;h<v;h++)l+="["+o.start(h).toFixed(3)+","+o.end(h).toFixed(3)+"]";return l}};i.default=n},"./src/utils/timescale-conversion.ts":function(r,i,t){t.r(i),t.d(i,"toTimescaleFromBase",function(){return a}),t.d(i,"toTimescaleFromScale",function(){return o}),t.d(i,"toMsFromMpegTsClock",function(){return l}),t.d(i,"toMpegTsClockFromTimescale",function(){return v});var n=9e4;function a(h,f,d,g){d===void 0&&(d=1),g===void 0&&(g=!1);var E=h*f*d;return g?Math.round(E):E}function o(h,f,d,g){return d===void 0&&(d=1),g===void 0&&(g=!1),a(h,f,1/d,g)}function l(h,f){return f===void 0&&(f=!1),a(h,1e3,1/n,f)}function v(h,f){return f===void 0&&(f=1),a(h,n,1/f)}},"./src/utils/typed-array.ts":function(r,i,t){t.r(i),t.d(i,"sliceUint8",function(){return n});function n(a,o,l){return Uint8Array.prototype.slice?a.slice(o,l):new Uint8Array(Array.prototype.slice.call(a,o,l))}},"./src/utils/vttcue.ts":function(r,i,t){t.r(i),i.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var n=["","lr","rl"],a=["start","middle","end","left","right"];function o(d,g){if(typeof g!="string"||!Array.isArray(d))return!1;var E=g.toLowerCase();return~d.indexOf(E)?E:!1}function l(d){return o(n,d)}function v(d){return o(a,d)}function h(d){for(var g=arguments.length,E=new Array(g>1?g-1:0),S=1;S<g;S++)E[S-1]=arguments[S];for(var x=1;x<arguments.length;x++){var m=arguments[x];for(var c in m)d[c]=m[c]}return d}function f(d,g,E){var S=this,x={enumerable:!0};S.hasBeenReset=!1;var m="",c=!1,p=d,y=g,u=E,_=null,b="",T=!0,A="auto",L="start",R=50,w="middle",O=50,I="middle";Object.defineProperty(S,"id",h({},x,{get:function(){return m},set:function(C){m=""+C}})),Object.defineProperty(S,"pauseOnExit",h({},x,{get:function(){return c},set:function(C){c=!!C}})),Object.defineProperty(S,"startTime",h({},x,{get:function(){return p},set:function(C){if(typeof C!="number")throw new TypeError("Start time must be set to a number.");p=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"endTime",h({},x,{get:function(){return y},set:function(C){if(typeof C!="number")throw new TypeError("End time must be set to a number.");y=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"text",h({},x,{get:function(){return u},set:function(C){u=""+C,this.hasBeenReset=!0}})),Object.defineProperty(S,"region",h({},x,{get:function(){return _},set:function(C){_=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"vertical",h({},x,{get:function(){return b},set:function(C){var P=l(C);if(P===!1)throw new SyntaxError("An invalid or illegal string was specified.");b=P,this.hasBeenReset=!0}})),Object.defineProperty(S,"snapToLines",h({},x,{get:function(){return T},set:function(C){T=!!C,this.hasBeenReset=!0}})),Object.defineProperty(S,"line",h({},x,{get:function(){return A},set:function(C){if(typeof C!="number"&&C!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");A=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"lineAlign",h({},x,{get:function(){return L},set:function(C){var P=v(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");L=P,this.hasBeenReset=!0}})),Object.defineProperty(S,"position",h({},x,{get:function(){return R},set:function(C){if(C<0||C>100)throw new Error("Position must be between 0 and 100.");R=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"positionAlign",h({},x,{get:function(){return w},set:function(C){var P=v(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");w=P,this.hasBeenReset=!0}})),Object.defineProperty(S,"size",h({},x,{get:function(){return O},set:function(C){if(C<0||C>100)throw new Error("Size must be between 0 and 100.");O=C,this.hasBeenReset=!0}})),Object.defineProperty(S,"align",h({},x,{get:function(){return I},set:function(C){var P=v(C);if(!P)throw new SyntaxError("An invalid or illegal string was specified.");I=P,this.hasBeenReset=!0}})),S.displayState=void 0}return f.prototype.getCueAsHTML=function(){var d=self.WebVTT;return d.convertCueToDOMTree(self,this.text)},f}()},"./src/utils/vttparser.ts":function(r,i,t){t.r(i),t.d(i,"parseTimeStamp",function(){return o}),t.d(i,"fixLineBreaks",function(){return g}),t.d(i,"VTTParser",function(){return E});var n=t("./src/utils/vttcue.ts"),a=function(){function S(){}var x=S.prototype;return x.decode=function(c,p){if(!c)return"";if(typeof c!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(c))},S}();function o(S){function x(c,p,y,u){return(c|0)*3600+(p|0)*60+(y|0)+parseFloat(u||0)}var m=S.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return m?parseFloat(m[2])>59?x(m[2],m[3],0,m[4]):x(m[1],m[2],m[3],m[4]):null}var l=function(){function S(){this.values=Object.create(null)}var x=S.prototype;return x.set=function(c,p){!this.get(c)&&p!==""&&(this.values[c]=p)},x.get=function(c,p,y){return y?this.has(c)?this.values[c]:p[y]:this.has(c)?this.values[c]:p},x.has=function(c){return c in this.values},x.alt=function(c,p,y){for(var u=0;u<y.length;++u)if(p===y[u]){this.set(c,p);break}},x.integer=function(c,p){/^-?\d+$/.test(p)&&this.set(c,parseInt(p,10))},x.percent=function(c,p){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(p)){var y=parseFloat(p);if(y>=0&&y<=100)return this.set(c,y),!0}return!1},S}();function v(S,x,m,c){var p=c?S.split(c):[S];for(var y in p)if(typeof p[y]=="string"){var u=p[y].split(m);if(u.length===2){var _=u[0],b=u[1];x(_,b)}}}var h=new n.default(0,0,""),f=h.align==="middle"?"middle":"center";function d(S,x,m){var c=S;function p(){var _=o(S);if(_===null)throw new Error("Malformed timestamp: "+c);return S=S.replace(/^[^\sa-zA-Z-]+/,""),_}function y(_,b){var T=new l;v(_,function(R,w){var O;switch(R){case"region":for(var I=m.length-1;I>=0;I--)if(m[I].id===w){T.set(R,m[I].region);break}break;case"vertical":T.alt(R,w,["rl","lr"]);break;case"line":O=w.split(","),T.integer(R,O[0]),T.percent(R,O[0])&&T.set("snapToLines",!1),T.alt(R,O[0],["auto"]),O.length===2&&T.alt("lineAlign",O[1],["start",f,"end"]);break;case"position":O=w.split(","),T.percent(R,O[0]),O.length===2&&T.alt("positionAlign",O[1],["start",f,"end","line-left","line-right","auto"]);break;case"size":T.percent(R,w);break;case"align":T.alt(R,w,["start",f,"end","left","right"]);break}},/:/,/\s/),b.region=T.get("region",null),b.vertical=T.get("vertical","");var A=T.get("line","auto");A==="auto"&&h.line===-1&&(A=-1),b.line=A,b.lineAlign=T.get("lineAlign","start"),b.snapToLines=T.get("snapToLines",!0),b.size=T.get("size",100),b.align=T.get("align",f);var L=T.get("position","auto");L==="auto"&&h.position===50&&(L=b.align==="start"||b.align==="left"?0:b.align==="end"||b.align==="right"?100:50),b.position=L}function u(){S=S.replace(/^\s+/,"")}if(u(),x.startTime=p(),u(),S.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+c);S=S.substr(3),u(),x.endTime=p(),u(),y(S,x)}function g(S){return S.replace(/<br(?: \/)?>/gi,`
`)}var E=function(){function S(){this.state="INITIAL",this.buffer="",this.decoder=new a,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var x=S.prototype;return x.parse=function(c){var p=this;c&&(p.buffer+=p.decoder.decode(c,{stream:!0}));function y(){var L=p.buffer,R=0;for(L=g(L);R<L.length&&L[R]!=="\r"&&L[R]!==`
`;)++R;var w=L.substr(0,R);return L[R]==="\r"&&++R,L[R]===`
`&&++R,p.buffer=L.substr(R),w}function u(L){v(L,function(R,w){},/:/)}try{var _="";if(p.state==="INITIAL"){if(!/\r\n|\n/.test(p.buffer))return this;_=y();var b=_.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!b||!b[0])throw new Error("Malformed WebVTT signature.");p.state="HEADER"}for(var T=!1;p.buffer;){if(!/\r\n|\n/.test(p.buffer))return this;switch(T?T=!1:_=y(),p.state){case"HEADER":/:/.test(_)?u(_):_||(p.state="ID");continue;case"NOTE":_||(p.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(_)){p.state="NOTE";break}if(!_)continue;if(p.cue=new n.default(0,0,""),p.state="CUE",_.indexOf("-->")===-1){p.cue.id=_;continue}case"CUE":if(!p.cue){p.state="BADCUE";continue}try{d(_,p.cue,p.regionList)}catch(L){p.cue=null,p.state="BADCUE";continue}p.state="CUETEXT";continue;case"CUETEXT":{var A=_.indexOf("-->")!==-1;if(!_||A&&(T=!0)){p.oncue&&p.cue&&p.oncue(p.cue),p.cue=null,p.state="ID";continue}if(p.cue===null)continue;p.cue.text&&(p.cue.text+=`
`),p.cue.text+=_}continue;case"BADCUE":_||(p.state="ID")}}}catch(L){p.state==="CUETEXT"&&p.cue&&p.oncue&&p.oncue(p.cue),p.cue=null,p.state=p.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},x.flush=function(){var c=this;try{if((c.cue||c.state==="HEADER")&&(c.buffer+=`

`,c.parse()),c.state==="INITIAL"||c.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(p){c.onparsingerror&&c.onparsingerror(p)}return c.onflush&&c.onflush(),this},S}()},"./src/utils/webvtt-parser.ts":function(r,i,t){t.r(i),t.d(i,"generateCueId",function(){return E}),t.d(i,"parseWebVTT",function(){return x});var n=t("./src/polyfills/number.ts"),a=t("./src/utils/vttparser.ts"),o=t("./src/demux/id3.ts"),l=t("./src/utils/timescale-conversion.ts"),v=t("./src/remux/mp4-remuxer.ts"),h=/\r\n|\n\r|\n|\r/g,f=function(c,p,y){return y===void 0&&(y=0),c.substr(y,p.length)===p},d=function(c){var p=parseInt(c.substr(-3)),y=parseInt(c.substr(-6,2)),u=parseInt(c.substr(-9,2)),_=c.length>9?parseInt(c.substr(0,c.indexOf(":"))):0;if(!Object(n.isFiniteNumber)(p)||!Object(n.isFiniteNumber)(y)||!Object(n.isFiniteNumber)(u)||!Object(n.isFiniteNumber)(_))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+c);return p+=1e3*y,p+=60*1e3*u,p+=60*60*1e3*_,p},g=function(c){for(var p=5381,y=c.length;y;)p=p*33^c.charCodeAt(--y);return(p>>>0).toString()};function E(m,c,p){return g(m.toString())+g(c.toString())+g(p)}var S=function(c,p,y){var u=c[p],_=c[u.prevCC];if(!_||!_.new&&u.new){c.ccOffset=c.presentationOffset=u.start,u.new=!1;return}for(;(b=_)!==null&&b!==void 0&&b.new;){var b;c.ccOffset+=u.start-_.start,u.new=!1,u=_,_=c[u.prevCC]}c.presentationOffset=y};function x(m,c,p,y,u,_,b,T){var A=new a.VTTParser,L=Object(o.utf8ArrayToStr)(new Uint8Array(m)).trim().replace(h,`
`).split(`
`),R=[],w=Object(l.toMpegTsClockFromTimescale)(c,p),O="00:00.000",I=0,D=0,C,P=!0,M=!1;A.oncue=function(N){var B=y[u],U=y.ccOffset,F=(I-w)/9e4;if(B!=null&&B.new&&(D!==void 0?U=y.ccOffset=B.start:S(y,u,F)),F&&(U=F-y.presentationOffset),M){var j=N.endTime-N.startTime,V=Object(v.normalizePts)((N.startTime+U-D)*9e4,_*9e4)/9e4;N.startTime=V,N.endTime=V+j}var G=N.text.trim();N.text=decodeURIComponent(encodeURIComponent(G)),N.id||(N.id=E(N.startTime,N.endTime,G)),N.endTime>0&&R.push(N)},A.onparsingerror=function(N){C=N},A.onflush=function(){if(C){T(C);return}b(R)},L.forEach(function(N){if(P)if(f(N,"X-TIMESTAMP-MAP=")){P=!1,M=!0,N.substr(16).split(",").forEach(function(B){f(B,"LOCAL:")?O=B.substr(6):f(B,"MPEGTS:")&&(I=parseInt(B.substr(7)))});try{D=d(O)/1e3}catch(B){M=!1,C=B}return}else N===""&&(P=!1);A.parse(N+`
`)}),A.flush()}},"./src/utils/xhr-loader.ts":function(r,i,t){t.r(i);var n=t("./src/utils/logger.ts"),a=t("./src/loader/load-stats.ts"),o=/^age:\s*[\d.]+\s*$/m,l=function(){function v(f){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=f?f.xhrSetup:null,this.stats=new a.LoadStats,this.retryDelay=0}var h=v.prototype;return h.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},h.abortInternal=function(){var d=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),d&&(d.onreadystatechange=null,d.onprogress=null,d.readyState!==4&&(this.stats.aborted=!0,d.abort()))},h.abort=function(){var d;this.abortInternal(),(d=this.callbacks)!==null&&d!==void 0&&d.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},h.load=function(d,g,E){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=d,this.config=g,this.callbacks=E,this.retryDelay=g.retryDelay,this.loadInternal()},h.loadInternal=function(){var d=this.config,g=this.context;if(!!d){var E=this.loader=new self.XMLHttpRequest,S=this.stats;S.loading.first=0,S.loaded=0;var x=this.xhrSetup;try{if(x)try{x(E,g.url)}catch(p){E.open("GET",g.url,!0),x(E,g.url)}E.readyState||E.open("GET",g.url,!0);var m=this.context.headers;if(m)for(var c in m)E.setRequestHeader(c,m[c])}catch(p){this.callbacks.onError({code:E.status,text:p.message},g,E);return}g.rangeEnd&&E.setRequestHeader("Range","bytes="+g.rangeStart+"-"+(g.rangeEnd-1)),E.onreadystatechange=this.readystatechange.bind(this),E.onprogress=this.loadprogress.bind(this),E.responseType=g.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),d.timeout),E.send()}},h.readystatechange=function(){var d=this.context,g=this.loader,E=this.stats;if(!(!d||!g)){var S=g.readyState,x=this.config;if(!E.aborted&&S>=2)if(self.clearTimeout(this.requestTimeout),E.loading.first===0&&(E.loading.first=Math.max(self.performance.now(),E.loading.start)),S===4){g.onreadystatechange=null,g.onprogress=null;var m=g.status;if(m>=200&&m<300){E.loading.end=Math.max(self.performance.now(),E.loading.first);var c,p;if(d.responseType==="arraybuffer"?(c=g.response,p=c.byteLength):(c=g.responseText,p=c.length),E.loaded=E.total=p,!this.callbacks)return;var y=this.callbacks.onProgress;if(y&&y(E,d,c,g),!this.callbacks)return;var u={url:g.responseURL,data:c};this.callbacks.onSuccess(u,E,d,g)}else E.retry>=x.maxRetry||m>=400&&m<499?(n.logger.error(m+" while loading "+d.url),this.callbacks.onError({code:m,text:g.statusText},d,g)):(n.logger.warn(m+" while loading "+d.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,x.maxRetryDelay),E.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),x.timeout)}},h.loadtimeout=function(){n.logger.warn("timeout while loading "+this.context.url);var d=this.callbacks;d&&(this.abortInternal(),d.onTimeout(this.stats,this.context,this.loader))},h.loadprogress=function(d){var g=this.stats;g.loaded=d.loaded,d.lengthComputable&&(g.total=d.total)},h.getCacheAge=function(){var d=null;if(this.loader&&o.test(this.loader.getAllResponseHeaders())){var g=this.loader.getResponseHeader("age");d=g?parseFloat(g):null}return d},v}();i.default=l}}).default})})(Dh);var FT=bo(Dh.exports);const Ch=3,BT=["m3u8"],UT=({file:s})=>{const{getSetting:e,lastFiles:r}=Ye.exports.useContext(ei),i=r.filter(d=>d.type===Ch),{i18n:t}=Nn();let n=ui(),a=n();const o=cp(!0),l=s.name.endsWith(".m3u8")?a:s.url,v=ep();let h;const f=hu({base:"30px",md:"50px"});return Ye.exports.useEffect(()=>{let d={container:"#video-player",title:s.name,url:l,autoplay:e("autoplay video")==="true",autoMini:!0,autoSize:!1,playbackRate:!0,flip:!0,rotate:!0,aspectRatio:!0,fullscreen:!0,fullscreenWeb:!0,mutex:!0,light:!0,backdrop:!0,subtitleOffset:!0,miniProgressBar:!0,localVideo:!0,localSubtitle:!0,lang:t.language==="zh"?"zh-cn":"en",setting:!0,pip:!0,customType:{flv:function(m,c){const p=kT.createPlayer({type:"flv",url:c},{referrerPolicy:"no-referrer"});p.attachMediaElement(m),p.load()},m3u8:function(m,c){var p=new FT;p.loadSource(c),p.attachMedia(m)}},moreVideoAttr:{"webkit-playsinline":!0,playsInline:!0}};s.name.toLowerCase().endsWith(".flv")&&(d.type="flv"),e("artplayer whitelist")?d.whitelist=e("artplayer whitelist").split(","):d.whitelist=[],!NT||d.whitelist.some(m=>m==="*"||Ia.indexOf(m)>-1)||(d.moreVideoAttr.controls=!0),e("artplayer autoSize")==="true"&&(d.autoSize=!0);const E=s.name.substring(0,s.name.lastIndexOf("."));let S="";const x=r.find(m=>{const c=m.name;if(!c.startsWith(E))return!1;for(const p of[".srt",".ass",".vtt"])if(c.endsWith(p))return!0;return!1});return x&&(o+""+x.name,d.subtitle={type:S,url:n(x),bilingual:!0,style:{color:"#03A9F4","font-size":f}}),h=new MT(d),h.on("video:ended",()=>{const m=i.findIndex(c=>c.name===s.name);m<i.length-1&&v.push(encodeURI(i[m+1].name))}),()=>{h&&h.destroy&&h.destroy()}},[]),q.createElement(Xi,{w:"full",className:"video-preview-box"},q.createElement(tp,null,q.createElement(rp,{rightIcon:q.createElement(Fn,{boxSize:6,as:dp}),w:"full",colorScheme:"gray",as:Er,mb:2},q.createElement(ip,{w:"full",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},s.name)),q.createElement(np,{w:"full",maxH:"65vh",overflowY:"auto",zIndex:999},i.map(d=>q.createElement(ap,{key:d.name,w:"full"},q.createElement(xo,{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxW:"85vw",w:"full",as:sp,_hover:{textDecoration:"none"},to:encodeURI(d.name)},d.name))))),q.createElement(Xi,{w:"full",h:"60vh",id:"video-player"}),q.createElement(op,{mt:"2",spacing:"2",justify:"center"},q.createElement(Er,{colorScheme:"purple",as:Qi.a,href:`iina://weblink?url=${a}`},"IINA"),q.createElement(Er,{colorScheme:"yellow",as:Qi.a,href:`potplayer://${a}`},"PotPlayer"),q.createElement(Er,{colorScheme:"orange",as:Qi.a,href:`vlc://${a}`},"VLC"),q.createElement(Er,{colorScheme:"teal",as:Qi.a,href:`nplayer-${a}`},"nPlayer"),q.createElement(Er,{colorScheme:"blue",as:Qi.a,href:`intent:${a}#Intent;package=com.mxtech.videoplayer.ad;S.title=${s.name};end`},"MXPlayer"),q.createElement(Er,{colorScheme:"blue",as:Qi.a,href:`intent:${a}#Intent;package=com.mxtech.videoplayer.pro;S.title=${s.name};end`},"MXPlayer Pro")))};var jT=Object.freeze(Object.defineProperty({__proto__:null,type:Ch,exts:BT,default:UT},Symbol.toStringTag,{value:"Module"}));const Ph={"../preview/audio.tsx":H0,"../preview/codeeditor.tsx":hp,"../preview/epub.tsx":hT,"../preview/image.tsx":mT,"../preview/ipa.tsx":bT,"../preview/markdown.tsx":pp,"../preview/office.tsx":IT,"../preview/pdf.tsx":AT,"../preview/plist.tsx":PT,"../preview/video.tsx":jT},WT=({file:s})=>{const{getSetting:e}=Ye.exports.useContext(ei),r=s.name.split(".").pop()||"",i=ui(),{t}=Nn();return q.createElement(Zi,{className:"no-preview",p:"4"},q.createElement(_o,{spacing:"8"},q.createElement(Fn,{color:e("icon color")||"#1890ff",boxSize:20,as:Pa(s.type,r)}),q.createElement(Ca,{size:"md"},s.name),q.createElement(Er,{onClick:()=>{window.open(i(),"_blank")}},t("Download"))))},JT=()=>{const{files:s}=Ye.exports.useContext(ei);gp(s[0].name);for(const e in Ph){const r=Ph[e],i=r.default;if(r.type===s[0].type||r.exts.includes(s[0].name.split(".").pop()))return q.createElement(i,{file:s[0]})}return q.createElement(WT,{file:s[0]})};export{JT as default};
